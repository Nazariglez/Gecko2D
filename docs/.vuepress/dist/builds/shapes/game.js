!function(e,t){"use strict";e.kha=e.kha||{},e.kha.input=e.kha.input||{},e.kha._Color=e.kha._Color||{};var i={},r=function(){return Re.__string_rec(this,"")};function n(e,t){function i(){}i.prototype=e;var r=new i;for(var n in t)r[n]=t[n];return t.toString!==Object.prototype.toString&&(r.toString=t.toString),r}var s=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};(i.EReg=s).__name__=!0,s.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new dt("EReg::matched")},__class__:s};var a=function(){var e=O.__pool__.get();e.init(!0,60,2,0),e.isAlreadyDestroyed=!1,this._createShape(100,150,e,16711680);var t=O.__pool__.get();t.init(!1,60,8,0),t.isAlreadyDestroyed=!1,this._createShape(300,150,t,16711680);var i=z.__pool__.get();i.init(!0,120,120,2),i.isAlreadyDestroyed=!1,this._createShape(500,150,i,32768);var r=z.__pool__.get();r.init(!1,120,120,8),r.isAlreadyDestroyed=!1,this._createShape(700,150,r,32768);var n=H.__pool__.get();n.init(60,0),n.isAlreadyDestroyed=!1;var s=H.__pool__.get();s.init(0,120),s.isAlreadyDestroyed=!1;var a=H.__pool__.get();a.init(120,120),a.isAlreadyDestroyed=!1;var o=[n,s,a],l=W.__pool__.get();l.init(!0,o,2),l.isAlreadyDestroyed=!1,this._createShape(100,400,l,255);var h=W.__pool__.get();h.init(!1,o,8),h.isAlreadyDestroyed=!1,this._createShape(300,400,h,255);var _=H.__pool__.get();_.init(0,40),_.isAlreadyDestroyed=!1;var c=H.__pool__.get();c.init(40,0),c.isAlreadyDestroyed=!1;var u=H.__pool__.get();u.init(80,0),u.isAlreadyDestroyed=!1;var d=H.__pool__.get();d.init(120,40),d.isAlreadyDestroyed=!1;var f=H.__pool__.get();f.init(120,80),f.isAlreadyDestroyed=!1;var g=H.__pool__.get();g.init(80,120),g.isAlreadyDestroyed=!1;var v=H.__pool__.get();v.init(40,120),v.isAlreadyDestroyed=!1;var p=H.__pool__.get();p.init(0,80),p.isAlreadyDestroyed=!1;var m=[_,c,u,d,f,g,v,p],y=W.__pool__.get();y.init(!0,m,2),y.isAlreadyDestroyed=!1,this._createShape(500,400,y,16776960);var b=W.__pool__.get();b.init(!1,m,8),b.isAlreadyDestroyed=!1,this._createShape(700,400,b,16776960)};(i.Game=a).__name__=!0,a.prototype={_createShape:function(e,t,i,r){var n=f.world.currentScene.createEntity();n.addComponent(i),i.color=r,n.transform.get_position().set(e,t)},__class__:a};var $=function(){};(i.HxOverrides=$).__name__=!0,$.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(t[0]),i.setUTCMinutes(t[1]),i.setUTCSeconds(t[2]),i;case 10:var r=e.split("-");return new Date(r[0],r[1]-1,r[2],0,0,0);case 19:var n=e.split(" "),s=n[0].split("-"),a=n[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new dt("Invalid date format : "+e)}},$.cca=function(e,t){var i=e.charCodeAt(t);if(i==i)return i},$.substr=function(e,t,i){if(null==i)i=e.length;else if(i<0){if(0!=t)return"";i=e.length+i}return e.substr(t,i)},$.remove=function(e,t){var i=e.indexOf(t);return-1!=i&&(e.splice(i,1),!0)},$.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var c=function(){};(i.Lambda=c).__name__=!0,c.array=function(e){for(var t,i=[],r=((t=e)instanceof Array?function(){return $.iter(t)}:"function"==typeof t.iterator?Xr(t,t.iterator):t.iterator)();r.hasNext();){var n=r.next();i.push(n)}return i};var ee=function(){this.length=0};(i.List=ee).__name__=!0,ee.prototype={add:function(e){var t=new o(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},iterator:function(){return new l(this.h)},__class__:ee};var o=function(e,t){this.item=e,this.next=t};(i["_List.ListNode"]=o).__name__=!0,o.prototype={__class__:o};var l=function(e){this.head=e};(i["_List.ListIterator"]=l).__name__=!0,l.prototype={hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:l};var h=function(){};(i.Main=h).__name__=!0,h.main=function(){f.init(h._onReady,{width:800,height:600,maximizable:!0,resizable:!0,screen:{width:800,height:600,mode:k.AspectFit}})},h._onReady=function(){new a},Math.__name__=!0;var U=function(){};(i.Reflect=U).__name__=!0,U.field=function(e,t){try{return e[t]}catch(e){return null}},U.getProperty=function(e,t){var i;return null==e?null:!!e.__properties__&&(i=e.__properties__["get_"+t])?e[i]():e[t]},U.setProperty=function(e,t,i){var r;!!e.__properties__&&(r=e.__properties__["set_"+t])?e[r](i):e[t]=i},U.fields=function(e){var t=[];if(null!=e){var i=Object.prototype.hasOwnProperty;for(var r in e)"__id__"!=r&&"hx__closures__"!=r&&i.call(e,r)&&t.push(r)}return t},U.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},U.isObject=function(e){if(null==e)return!1;var t=typeof e;return"string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)};var E=function(){};(i.Std=E).__name__=!0,E.string=function(e){return Re.__string_rec(e,"")},E.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=$.cca(e,1)&&88!=$.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var _=function(){};(i.StringTools=_).__name__=!0,_.endsWith=function(e,t){var i=t.length,r=e.length;return i<=r&&$.substr(e,r-i,i)==t};var te=function(){};(i.Type=te).__name__=!0,te.resolveClass=function(e){var t=i[e];return null!=t&&t.__name__?t:null},te.resolveEnum=function(e){var t=i[e];return null!=t&&t.__ename__?t:null},te.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new dt("Too many arguments")}},te.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},te.createEnum=function(e,t,i){var r=U.field(e,t);if(null==r)throw new dt("No such constructor "+t);if(U.isFunction(r)){if(null==i)throw new dt("Constructor "+t+" need parameters");return r.apply(e,i)}if(null!=i&&0!=i.length)throw new dt("Constructor "+t+" does not need parameters");return r};var rt={};(i["_UInt.UInt_Impl_"]=rt).__name__=!0,rt.gt=function(e,t){var i=e<0;return i!=t<0?i:t<e},rt.gte=function(e,t){var i=e<0;return i!=t<0?i:t<=e},rt.toFloat=function(e){return e<0?4294967296+e:e+0};var u=function(){};(i["gecko.macros.IAutoPool"]=u).__name__=!0,u.prototype={__class__:u};var d=function(e,i){this._reset=null,this._init=null,this._objects=[];var r=this;if(i=this._parseOptions(i),this._class=e,this._args=i.args,null!=i.init&&(this._init=i.init),null!=i.reset&&(this._reset=i.reset),f.isIniaited)for(var t=0,n=i.amount;t<n;){t++;this._objects.push(this._create())}else f.addOnKhaInitCallback(function(){for(var e=0,t=i.amount;e<t;){e++;r._objects.push(r._create())}})};(i["gecko.utils.Pool"]=d).__name__=!0,d.prototype={setInitCallback:function(e){this._init=e},setResetCallback:function(e){this._reset=e},_parseOptions:function(e){return null==e&&(e={}),e.args=null!=e.args?e.args:null,e.amount=null!=e.amount?e.amount:1,e.init=null!=e.init?e.init:null,e.reset=null!=e.reset?e.reset:null,e},_create:function(){return te.createInstance(this._class,null!=this._args?this._args:d._emptyArgs)},get:function(){var e=0<this._objects.length?this._objects.shift():this._create();return null!=this._init&&this._init(e),e},safePut:function(e){null!=e&&-1==this._objects.indexOf(e)&&(null!=this._reset&&this._reset(e),this._objects.push(e))},put:function(e){null!=e&&(null!=this._reset&&this._reset(e),this._objects.push(e))},clean:function(){this._objects=[]},get_length:function(){return this._objects.length},__class__:d,__properties__:{get_length:"get_length"}};var f=function(){};(i["gecko.Gecko"]=f).__name__=!0,f.__properties__={get_bgColor:"get_bgColor",get_currentScene:"get_currentScene"},f.getUniqueID=function(){return f._countUniqueID++},f.init=function(e,t){var i=f._parseOptions(null!=t?t:{});A.init(i.khaOptions,function(){f._init(i,e)})},f._init=function(e,t){f._opts=e,null==f.graphics&&(f.graphics=new w);var i=e.width,r=e.height;e.maximizable&&(i=window.innerWidth,r=window.innerHeight,e.resizable&&window.addEventListener("resize",f._onHtml5WindowResize)),f.resize(i,r),I.init(e.screen,e.antialiasing,i,r),Ir.init(e.randomSeed);var n=ae.__pool__.get();n.isAlreadyDestroyed=!1,f.timerManager=n;var s=_e.__pool__.get();s.isAlreadyDestroyed=!1,f.tweenManager=s,f._initWorld(),f.renderTicker=new fe,f.onStop.handlers.push(Xr(Hr=f.renderTicker,Hr.clear)),f.onStop.handlers.push(N._clear),f.isIniaited=!0,f.start(),f._dispatchOnKhaInit(),t()},f.addOnKhaInitCallback=function(e){if(f.isIniaited)throw new dt("Kha init callback must be added before Gecko init.");f._onKhaInitCallbacks.push(e)},f._dispatchOnKhaInit=function(){for(var e=f._onKhaInitCallbacks.pop();null!=e;)e(),e=f._onKhaInitCallbacks.pop()},f.start=function(){if(!f.isRunning&&f.isIniaited){A.notifyOnRender(f._render),f._updateTaskId=P.addTimeTask(f._update,0,1/f._opts.fps),f.isRunning=!0;var e=f.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},f.stop=function(){if(f.isRunning&&f.isIniaited){A.removeRenderListener(f._render),P.removeTimeTask(f._updateTaskId),f.isRunning=!1;var e=f.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},f._initWorld=function(){null==f.world&&(f.world=new R),f.onUpdate.handlers.push(Xr(Hr=f.world,Hr.update)),f.onDraw.handlers.push(Xr(Hr=f.world,Hr.draw))},f.resize=function(e,t){e=e<=0?800:e,t=t<=0?600:t,A.changeResolution(e,t),f._resizeHtml5Canvas(e,t);var i=f.onWindowResize.handlers;if(0!=i.length)for(var r=0;r<i.length;){var n=i[r];++r,n(e,t)}},f._resizeHtml5Canvas=function(e,t){var i=f.getHtml5Canvas();i.width=e,i.style.width=e+"px",i.height=t,i.style.height=t+"px"},f._onHtml5WindowResize=function(){f._dirtyWindowResize=!0},f._parseOptions=function(e){var t={},i=null!=e.khaOptions?e.khaOptions:{};return t.title=null!=e.title?e.title:f.gameTitle,t.width=null!=e.width?e.width:800,t.height=null!=e.height?e.height:600,t.bgColor=null!=e.bgColor?e.bgColor:0,t.fullScreen=e.fullScreen,t.maximizable=null!=e.maximizable&&e.maximizable,t.resizable=null!=e.resizable&&e.resizable,t.fps=null!=e.fps?e.fps:60,t.useFixedDelta=null==e.useFixedDelta||e.useFixedDelta,t.screen=null!=e.screen?e.screen:{width:e.width,height:e.height,mode:k.None},null==t.screen.mode&&(t.screen.mode=k.None),null==e.randomSeed?t.randomSeed=1e3*A.get_time()|0:t.randomSeed=e.randomSeed,i.title=t.title,i.width=t.width,i.height=t.height,i.windowMode=null!=i.windowMode?i.windowMode:t.fullScreen?ht.Fullscreen:ht.Window,i.samplesPerPixel=null!=i.samplesPerPixel?i.samplesPerPixel:0!=t.antialiasing?t.antialiasing:0,i.maximizable=null!=i.maximizable?i.maximizable:t.maximizable,i.resizable=null!=i.resizable?i.resizable:t.resizable,t.khaOptions=i,t},f._safeDestroyObjects=function(){for(;0<f._destroyCallbacks.length;){f._destroyCallbacks.shift()()}},f._update=function(){f.isProcessing=!0,f._dirtyWindowResize&&(f.resize(window.innerWidth,window.innerHeight),f._dirtyWindowResize=!1),N._tick();var e=f._opts.useFixedDelta?N.fixedUnscaledDelta*N.scale:N.unscaledDelta*N.scale;f.timerManager.tick(e),f.tweenManager.tick(e);var t=f.onUpdate.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}var n=f.onSystemUpdate.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(N.unscaledDelta*N.scale)}for(f.isProcessing=!1;0<f._destroyCallbacks.length;){f._destroyCallbacks.shift()()}},f._render=function(e){f.isProcessing=!0,f.renderTicker.tick(),f.graphics.setRenderTarget(I.buffer),f.graphics.begin(null,f._opts.bgColor);var t=f.onDraw.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(f.graphics)}f.graphics.end();var n=f._opts.bgColor+-16777216;e.get_g2().begin(null,n);var s=e.get_g2(),a=s.transformations[s.transformations.length-1],o=I.matrix;for(a._00=o._00,a._10=o._10,a._20=o._20,a._01=o._01,a._11=o._11,a._21=o._21,a._02=o._02,a._12=o._12,a._22=o._22,e.get_g2().drawImage(I.buffer,0,0),e.get_g2().end(),f.isProcessing=!1;0<f._destroyCallbacks.length;){f._destroyCallbacks.shift()()}},f.getHtml5Canvas=function(){return window.document.getElementById(Xe.canvas_id)},f.get_currentScene=function(){return f.world.currentScene},f.get_bgColor=function(){return f._opts.bgColor};var g=function(){this.__flagToDestroy__=!1,this.isAlreadyDestroyed=!1,this.id=f.getUniqueID()};(i["gecko.BaseObject"]=g).__name__=!0,g.create=function(){var e=g.__pool__.get();return e.isAlreadyDestroyed=!1,e},g.getPool=function(){return g.__pool__},g.prototype={beforeDestroy:function(){},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),g.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),g.__pool__.safePut(this))},__class__:g};var v=function(){};(i["gecko.IUpdatable"]=v).__name__=!0,v.prototype={__class__:v};var p=function(){this._shakeAxisY=!0,this._shakeAxisX=!0,this._shakeIntensity=0,this._shakeDuration=0,this.style=y.LOCKON,this.deadzone=null,this.bounds=null,this._wasChanged=!0,this._dirty=!0,this.bgColor=null,this.height=0,this.width=0,this.y=0,this.x=0,this._matrix=new C(1,0,0,0,1,0,0,0,1),this._zoom=1,this._scene=null,g.call(this),this._containerTransform=new L(null),this._transform=new L(null);this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]};this.onShakeEnd={handlers:[]}};(i["gecko.Camera"]=p).__name__=!0,p.__interfaces__=[v],p.create=function(e,t,i,r,n){null==r&&(r=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var s=p.__pool__.get();return s.init(e,t,i,r,n),s.isAlreadyDestroyed=!1,s},p.getPool=function(){return p.__pool__},p.__super__=g,p.prototype=n(g.prototype,{init:function(e,t,i,r,n){null==r&&(r=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.bgColor=n,this.resize(0==i?(0|I.buffer.get_width())-e:i,0==r?(0|I.buffer.get_height())-t:r),this._containerTransform.get_anchor().set(.5,.5),this._containerTransform.get_pivot().set(.5,.5),this._containerTransform.get_size().set(this.width,this.height),this._containerTransform.get_position().set(this.width/2,this.height/2);var s=H.__pool__.get();s.init(0,0),s.isAlreadyDestroyed=!1,this.lookAt=s,this.lookAt.setObserver(Xr(this,this._onSetLookAt)),this.lookAt.set(this.width/2,this.height/2);var a=H.__pool__.get();a.init(1,1),a.isAlreadyDestroyed=!1,this.followLerp=a,this._dirty=!0},_onSetPoint:function(e){this._dirty=!0},shake:function(e,t,i,r){null==r&&(r=!0),null==i&&(i=!0),null==t&&(t=.5),null==e&&(e=.02),this._shakeIntensity=e,this._shakeDuration=t,this._shakeAxisX=i,this._shakeAxisY=r},update:function(e){if(null!=this.target){var t=this.target.transform.get_position();if(null!=this.deadzone){var i=this.width/2,r=this.height/2,n=this.lookAt._x,s=this.lookAt._y,a=this.lookAt._x-i+this.deadzone.x-t._x;if(0<a){var o=this.followLerp._x;n=(1-o)*this.lookAt._x+o*(this.lookAt._x-a)}else{var l=this.deadzone;if((a=this.lookAt._x-i+(l.x+l.width)-t._x)<0){var h=this.followLerp._x;n=(1-h)*this.lookAt._x+h*(this.lookAt._x-a)}}if(0<(a=this.lookAt._y-r+this.deadzone.y-t._y)){var _=this.followLerp._y;s=(1-_)*this.lookAt._y+_*(this.lookAt._y-a)}else{var c=this.deadzone;if((a=this.lookAt._y-r+(c.y+c.height)-t._y)<0){var u=this.followLerp._y;s=(1-u)*this.lookAt._y+u*(this.lookAt._y-a)}}this.lookAt.set(n,s)}else{var d=this.followLerp._x,f=this.followLerp._y;this.lookAt.set((1-d)*this.lookAt._x+d*t._x,(1-f)*this.lookAt._y+f*t._y)}}if(null!=this.bounds){var g=this.width/this._containerTransform.get_scale()._x/2,v=this.height/this._containerTransform.get_scale()._y/2,p=this.lookAt._x-g,m=this.lookAt._x+g,y=this.lookAt._y-v,b=this.lookAt._y+v;if(p<this.bounds.x)this.lookAt.set_x(this.bounds.x+g);else{var w=this.bounds;if(m>w.x+w.width){var x=this.bounds;this.lookAt.set_x(x.x+x.width-g)}}if(y<this.bounds.y)this.lookAt.set_y(this.bounds.y+v);else{var B=this.bounds;if(b>B.y+B.height){var S=this.bounds;this.lookAt.set_y(S.y+S.height-v)}}}if(0<this._shakeDuration){var T=this.lookAt._x,k=this.lookAt._y;if(this._shakeAxisX){var I=this.width*this._shakeIntensity;T+=Ir.getFloatIn(-I,I)*this._containerTransform.get_scale()._x}if(this._shakeAxisX){var A=this.height*this._shakeIntensity;k+=Ir.getFloatIn(-A,A)*this._containerTransform.get_scale()._y}if(this._transform.get_position().set(-T+this.width/2,-k+this.height/2),this._shakeDuration-=e,this._shakeDuration<=0){this._transform.get_position().set(-this.lookAt._x+this.width/2,-this.lookAt._y+this.height/2);var C=this.onShakeEnd.handlers;if(0!=C.length)for(var D=0;D<C.length;){var P=C[D];++D,P(this)}}this._dirty=!0}},preDraw:function(e){},postDraw:function(e){},lookAtEntity:function(e){var t=this.lookAt,i=e.transform.get_position();t.set(i._x,i._y)},follow:function(e,t,i,r){null==r&&(r=1),null==i&&(i=1),this.target=e;var n=this.lookAt,s=this.target.transform.get_position();switch(n.set(s._x,s._y),this.followLerp.set(i,r),this.style=null!=t?t:y.LOCKON,this.style[1]){case 0:this.deadzone=null;break;case 1:var a=this.width/8,o=this.height/3,l=(this.width-a)/2,h=(this.height-o)/2-.25*o,_=Z.__pool__.get();_.init(l,h,a,o),_.isAlreadyDestroyed=!1,this.deadzone=_;break;case 2:var c=Math.max(this.width,this.height)/4,u=(this.width-c)/2,d=(this.height-c)/2,f=Z.__pool__.get();f.init(u,d,c,c),f.isAlreadyDestroyed=!1,this.deadzone=f;break;case 3:var g=Math.max(this.width,this.height)/8,v=(this.width-g)/2,p=(this.height-g)/2,m=Z.__pool__.get();m.init(v,p,g,g),m.isAlreadyDestroyed=!1,this.deadzone=m}},unfollow:function(){this.target=null},resize:function(e,t){this.width=e,this.height=t,null!=this.buffer&&this.buffer.unload();var i=f._opts.antialiasing;this.buffer=ze.createRenderTarget(e,t,null,null,i)},containsScreenPoint:function(e){return e._x>=this.x&&e._x<=this.x+this.width&&(e._y>=this.y&&e._y<=this.y+this.height)},updateMatrix:function(){if(this._dirty){var e=this._matrix,t=this._transform.get_localMatrix(),i=this._containerTransform.get_worldMatrix();e._00=t._00*i._00+t._01*i._10,e._01=t._00*i._01+t._01*i._11,e._10=t._10*i._00+t._11*i._10,e._11=t._10*i._01+t._11*i._11,e._20=t._20*i._00+t._21*i._10+i._20,e._21=t._20*i._01+t._21*i._11+i._21,this._dirty=!1,this._wasChanged=!0}},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this._scene&&this._scene.removeCamera(this),this.buffer.unload(),this.buffer=null,this.target=null,this.lookAt.destroy(),this.lookAt=null,this.followLerp.destroy(),(this.followLerp=null)!=this.bounds&&(this.bounds.destroy(),this.bounds=null),null!=this.deadzone&&(this.deadzone.destroy(),this.deadzone=null),this.x=0,this.y=0,this.width=0,this.height=0,this.bgColor=0,this._zoom=1,this._dirty=!0,this._wasChanged=!0,de.clear(this.onAddedToScene),de.clear(this.onRemovedFromScene),de.clear(this.onShakeEnd),this._containerTransform._reset(),this._transform._reset()},_onSetLookAt:function(e){this._transform.get_position().set(-e._x+this.width/2,-e._y+this.height/2),this._dirty=!0},get_zoom:function(){return this._zoom},set_zoom:function(e){return this._dirty=!0,this._containerTransform.get_scale().set(e,e),this._zoom=e},get_matrix:function(){return this._dirty&&this.updateMatrix(),this._matrix},get_rotation:function(){return this._containerTransform.get_rotation()},set_rotation:function(e){return this._dirty=!0,this._containerTransform.set_rotation(e)},get_wasChanged:function(){return this._dirty&&this.updateMatrix(),this._wasChanged},set_wasChanged:function(e){return this._wasChanged=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;if(null!=this._scene){var t=this.onRemovedFromScene.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this,this._scene)}}if(this._scene=e,null!=this._scene){var n=this.onAddedToScene.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(this,this._scene)}}return this._scene},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),p.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),p.__pool__.safePut(this))},__class__:p,__properties__:{set_wasChanged:"set_wasChanged",get_wasChanged:"get_wasChanged",get_matrix:"get_matrix",set_zoom:"set_zoom",get_zoom:"get_zoom",set_rotation:"set_rotation",get_rotation:"get_rotation",set_scene:"set_scene",get_scene:"get_scene"}});var y=i["gecko.CameraStyle"]={__ename__:!0,__constructs__:["LOCKON","PLATFORMER","TOPDOWN","TOPDOWN_TIGHT"]};y.LOCKON=["LOCKON",0],y.LOCKON.toString=r,(y.LOCKON.__enum__=y).PLATFORMER=["PLATFORMER",1],y.PLATFORMER.toString=r,(y.PLATFORMER.__enum__=y).TOPDOWN=["TOPDOWN",2],y.TOPDOWN.toString=r,(y.TOPDOWN.__enum__=y).TOPDOWN_TIGHT=["TOPDOWN_TIGHT",3],y.TOPDOWN_TIGHT.toString=r,y.TOPDOWN_TIGHT.__enum__=y;var m={};(i["gecko._Color.Color_Impl_"]=m).__name__=!0,m.__properties__={set_BlueValue:"set_BlueValue",get_BlueValue:"get_BlueValue",set_GreenValue:"set_GreenValue",get_GreenValue:"get_GreenValue",set_RedValue:"set_RedValue",get_RedValue:"get_RedValue",set_BlueByte:"set_BlueByte",get_BlueByte:"get_BlueByte",set_GreenByte:"set_GreenByte",get_GreenByte:"get_GreenByte",set_RedByte:"set_RedByte",get_RedByte:"get_RedByte"},m._new=function(e){return e},m.fromValue=function(e){return m._new(e)},m.fromBytes=function(e,t,i){return e<<16|t<<8|i},m.fromFloats=function(e,t,i){return(255*e|0)<<16|(255*t|0)<<8|255*i|0},m.random=function(){return Ir.getUpTo(255)<<16|Ir.getUpTo(255)<<8|Ir.getUpTo(255)},m.fromString=function(e){if(7==e.length&&35==e.charCodeAt(0)){var t=E.parseInt("0x"+$.substr(e,1,null));return m._new(t)}throw new dt("Invalid Color string: '"+e+"'")},m.toARGB=function(e){return e+-16777216},m.get_RedByte=function(e){return(16711680&e)>>>16},m.set_RedByte=function(e,t){return e=t<<16|(65280&e)>>>8<<8|255&e,t},m.get_GreenByte=function(e){return(65280&e)>>>8},m.set_GreenByte=function(e,t){return e=(16711680&e)>>>16<<16|t<<8|255&e,t},m.get_BlueByte=function(e){return 255&e},m.set_BlueByte=function(e,t){return e=(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},m.get_RedValue=function(e){return.00392156862745098*((16711680&e)>>>16)},m.set_RedValue=function(e,t){return e=(255*t|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t},m.get_GreenValue=function(e){return.00392156862745098*((65280&e)>>>8)},m.set_GreenValue=function(e,t){return e=(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(255*t|0)<<8|.00392156862745098*(255&e)*255|0,t},m.get_BlueValue=function(e){return.00392156862745098*(255&e)},m.set_BlueValue=function(e,t){return e=(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|255*t|0,t};var b=function(){this._componentTypes=new Ie,this._componentsList=[],this._components=new Ie,this._renderer=null,this._tags=new Ie,this._name="",this.enabled=!0,this._isRoot=!1,g.call(this),this.transform=new L(this);this.onComponentAdded={handlers:[]};this.onComponentRemoved={handlers:[]};this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]}};(i["gecko.Entity"]=b).__name__=!0,b.create=function(){var e=b.__pool__.get();return e.isAlreadyDestroyed=!1,e},b.getPool=function(){return b.__pool__},b.__super__=g,b.prototype=n(g.prototype,{beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this._scene&&this._scene.removeEntity(this),this.transform._reset();for(var e=this._components.keys();e.hasNext();){var t=e.next(),i=this._components,r=null!=$r[t]?i.getReserved(t):i.h[t];this._removeComponent(r,!0)}this.removeAllTags(),this._isRoot=!1,de.clear(this.onComponentAdded),de.clear(this.onComponentRemoved),de.clear(this.onAddedToScene),de.clear(this.onRemovedFromScene)},getDrawComponent:function(){return this._renderer},hasDrawComponent:function(){return null!=this._renderer},addTag:function(e){var t=this._tags;null!=$r[e]?t.setReserved(e,!0):t.h[e]=!0},removeTag:function(e){this._tags.remove(e)},hasTag:function(e){var t=this._tags;return null!=$r[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeAllTags:function(){for(var e=this._tags.keys();e.hasNext();){var t=e.next();this._tags.remove(t)}},hasComponentOfType:function(e){var t=this._componentTypes,i=F.fromComponent(e).__componentName__,r=t;return null!=$r[i]?r.existsReserved(i):r.h.hasOwnProperty(i)},getComponentsOfType:function(e){var t=this._componentTypes,i=F.fromComponent(e).__componentName__,r=t;return null!=$r[i]?r.getReserved(i):r.h[i]},addComponent:function(e){e.set_entity(this),Re.__instanceof(e,G)&&(null!=this._renderer&&this.removeComponent(this._renderer.get___type__()),this._renderer=e);var t=this._components,i=e.get___typeName__(),r=t;null!=$r[i]?r.setReserved(i,e):r.h[i]=e,this._componentsList.push(e);var n=F.fromComponent(e.get___type__()).__componentTypes__;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s;var o=this._componentTypes;if(null!=$r[a]?o.existsReserved(a):o.h.hasOwnProperty(a)){var l=this._componentTypes;(null!=$r[a]?l.getReserved(a):l.h[a]).push(e)}else{var h=this._componentTypes,_=[e];null!=$r[a]?h.setReserved(a,_):h.h[a]=_}}var c=this.onComponentAdded.handlers;if(0!=c.length)for(var u=0;u<c.length;){var d=c[u];++u,d(this,e)}return e},removeComponent:function(e,t){null==t&&(t=!1);var i=this._components,r=F.fromComponent(e).__componentName__,n=i,s=null!=$r[r]?n.getReserved(r):n.h[r];return null!=s?(this._removeComponent(s,t),t?null:s):null},_removeComponent:function(e,t){null==t&&(t=!1),this._components.remove(e.get___typeName__()),$.remove(this._componentsList,e),null!=this._renderer&&e.get___type__()==this._renderer.get___type__()&&(this._renderer=null);var i=F.fromComponent(e.get___type__()).__componentTypes__;if(0!=i.length)for(var r=0;r<i.length;){var n=i[r];++r;var s=this._componentTypes,a=null!=$r[n]?s.getReserved(n):s.h[n];$.remove(a,e),0==a.length&&this._componentTypes.remove(n)}e.set_entity(null);var o=this.onComponentRemoved.handlers;if(0!=o.length)for(var l=0;l<o.length;){var h=o[l];++l,h(this,e)}t&&e.destroy()},removeAllComponents:function(e){null==e&&(e=!1);for(var t=this._components,i=new ke(t,t.arrayKeys());i.hasNext();){var r=i.next();this.removeComponent(r.get___type__(),e)}},getAllComponents:function(){return this._componentsList},getComponent:function(e){return this._components.h[F.fromComponent(e).__componentName__]},hasComponent:function(e){var t=this._components.h,i=F.fromComponent(e).__componentName__;return t.hasOwnProperty(i)},toString:function(){return"Entity: id -> "+this.id+", components -> "+E.string(this._componentsList.map(function(e){return""==e._name?e.get___typeName__():e._name}))},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;var t=this._scene;if(this._scene=e,null!=t){var i=this.onRemovedFromScene.handlers;if(0!=i.length)for(var r=0;r<i.length;){var n=i[r];++r,n(this,t)}}if(null!=this._scene){var s=this.onAddedToScene.handlers;if(0!=s.length)for(var a=0;a<s.length;){var o=s[a];++a,o(this,this._scene)}}return this._scene},get_isRoot:function(){return this._isRoot},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),b.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),b.__pool__.safePut(this))},get___type__:function(){return b},get___typeName__:function(){return"gecko.Entity"},__class__:b,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_scene:"set_scene",get_scene:"get_scene",set_name:"set_name",get_name:"get_name",get_isRoot:"get_isRoot"}});var C=function(e,t,i,r,n,s,a,o,l){this._00=e,this._10=t,this._20=i,this._01=r,this._11=n,this._21=s,this._02=a,this._12=o,this._22=l};(i["kha.math.FastMatrix3"]=C).__name__=!0,C.fromMatrix3=function(e){return new C(e._00,e._10,e._20,e._01,e._11,e._21,e._02,e._12,e._22)},C.prototype={__class__:C};var w=function(){this._fontSize=1,this._alpha=1,this._color=16777215};(i["gecko.Graphics"]=w).__name__=!0,w._pointsToVec2=function(e){for(var t=[],i=0;i<e.length;){var r=e[i];++i,t.push(r._vec2)}return t},w.prototype={setRenderTarget:function(e){if(this.isRendering)throw f.stop(),new dt("You can't change the buffer while rendering");this.buffer=e},beginRenderTarget:function(e){this.g2.end(),this._g2Cache=this.g2,this._g4Cache=this.g4,this.g2=e.get_g2(),this.g4=e.get_g4(),this.g2.begin(!1)},endRenderTarget:function(){this.g2.end(),this.g2=this._g2Cache,this.g4=this._g4Cache,this._g2Cache=null,this._g4Cache=null,this.g2.begin()},begin:function(e,t){null==e&&(e=!0),this.isRendering=!0,this.buffer.get_g2().begin(e,t+-16777216)},end:function(){this.buffer.get_g2().end(),this.isRendering=!1},clear:function(e){this.buffer.get_g2().clear(e+-16777216)},reset:function(){this.buffer.get_g2().set_color(-1),this._color=16777215,this.buffer.get_g2().set_opacity(1),this._alpha=1;var e=w.emptyMatrix,t=this.buffer.get_g2(),i=t.transformations[t.transformations.length-1];i._00=e._00,i._10=e._10,i._20=e._20,i._01=e._01,i._11=e._11,i._21=e._21,i._02=e._02,i._12=e._12,i._22=e._22;this.buffer.get_g2()},apply:function(e,t,i){this.buffer.get_g2().set_color(t+-16777216),this._color=t,this.buffer.get_g2().set_opacity(i),this._alpha=i;var r=this.buffer.get_g2(),n=r.transformations[r.transformations.length-1];n._00=e._00,n._10=e._10,n._20=e._20,n._01=e._01,n._11=e._11,n._21=e._21,n._02=e._02,n._12=e._12,n._22=e._22;this.buffer.get_g2()},drawLine:function(e,t,i,r,n){this.buffer.get_g2().drawLine(e,t,i,r,n)},drawImage:function(e,t,i){this.buffer.get_g2().drawImage(e,t,i)},drawTexture:function(e,t,i){if(e.rotated){this._swtTemp=e.frame.width*e.pivot._x,this._shtTemp=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new C(1,0,-this._swtTemp,0,1,-this._shtTemp,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var r=this.buffer.get_g2();r.transformations[r.transformations.length-1]._20+=this._shtTemp;var n=this.buffer.get_g2();n.transformations[n.transformations.length-1]._21+=this._swtTemp,null!=e.trim?this.buffer.get_g2().drawSubImage(e.image,t-e.trim.x,i+e.trim.y,e.frame.x,e.frame.y,e.trim.width,e.trim.height):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x,e.frame.y,e.frame.width,e.frame.height),this.buffer.get_g2().popTransformation()}else null!=e.trim?this.buffer.get_g2().drawSubImage(e.image,t+e.trim.x,i+e.trim.y,e.frame.x,e.frame.y,e.trim.width,e.trim.height):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x,e.frame.y,e.frame.width,e.frame.height)},drawSubImage:function(e,t,i,r,n,s,a){this.buffer.get_g2().drawSubImage(e,t,i,r,n,s,a)},_drawSubTextureRotated:function(e,t,i,r,n,s,a){this._temp3=e.frame.width*e.pivot._x,this._temp4=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new C(1,0,-this._temp3,0,1,-this._temp4,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var o=this.buffer.get_g2();o.transformations[o.transformations.length-1]._20+=this._temp4;var l=this.buffer.get_g2();l.transformations[l.transformations.length-1]._21+=this._temp3,null!=e.trim?(this._swtTemp=r>e.trim.x?r-e.trim.x:0,this._temp1=e.trim.x-r,this._temp1=this._temp1<0?0:this._temp1,this._shtTemp=n>e.trim.y?n-e.trim.y:0,this._temp2=e.trim.y-n,this._temp2=this._temp2<0?0:this._temp2,this._temp5=s-this._temp1,this._temp5=this._temp5>e.trim.width?e.trim.width:this._temp5,this._temp6=a-this._temp2,this._temp6=this._temp6>e.trim.height?e.trim.height:this._temp6,this.buffer.get_g2().drawSubImage(e.image,t-(this._temp2<0?0:this._temp2),i+(this._temp1<0?0:this._temp1),e.frame.x-this._shtTemp,e.frame.y+this._swtTemp,this._temp6,this._temp5)):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x-n,e.frame.y+r,a,s),this.buffer.get_g2().popTransformation()},_drawSubTexture:function(e,t,i,r,n,s,a){null!=e.trim?(this._swtTemp=r>e.trim.x?r-e.trim.x:0,this._shtTemp=n>e.trim.y?n-e.trim.y:0,this._temp1=e.trim.x-r,this._temp1=this._temp1<0?0:this._temp1,this._temp2=e.trim.y-n,this._temp2=this._temp2<0?0:this._temp2,this._temp3=s-this._temp1,this._temp3=this._temp3>e.trim.width?e.trim.width:this._temp3,this._temp4=a-this._temp2,this._temp4=this._temp4>e.trim.height?e.trim.height:this._temp4,this.buffer.get_g2().drawSubImage(e.image,t+this._temp1,i+this._temp2,e.frame.x+this._swtTemp,e.frame.y+this._shtTemp,this._temp3,this._temp4)):(this._swtTemp=e.frame.width-r,this._shtTemp=e.frame.height-n,this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x+r,e.frame.y+n,s>this._swtTemp?this._swtTemp:s,a>this._shtTemp?this._shtTemp:a))},drawSubTexture:function(e,t,i,r,n,s,a){if(e.rotated){this._temp3=e.frame.width*e.pivot._x,this._temp4=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new C(1,0,-this._temp3,0,1,-this._temp4,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var o=this.buffer.get_g2();o.transformations[o.transformations.length-1]._20+=this._temp4;var l=this.buffer.get_g2();l.transformations[l.transformations.length-1]._21+=this._temp3,null!=e.trim?(this._swtTemp=r>e.trim.x?r-e.trim.x:0,this._temp1=e.trim.x-r,this._temp1=this._temp1<0?0:this._temp1,this._shtTemp=n>e.trim.y?n-e.trim.y:0,this._temp2=e.trim.y-n,this._temp2=this._temp2<0?0:this._temp2,this._temp5=s-this._temp1,this._temp5=this._temp5>e.trim.width?e.trim.width:this._temp5,this._temp6=a-this._temp2,this._temp6=this._temp6>e.trim.height?e.trim.height:this._temp6,this.buffer.get_g2().drawSubImage(e.image,t-(this._temp2<0?0:this._temp2),i+(this._temp1<0?0:this._temp1),e.frame.x-this._shtTemp,e.frame.y+this._swtTemp,this._temp6,this._temp5)):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x-n,e.frame.y+r,a,s),this.buffer.get_g2().popTransformation()}else null!=e.trim?(this._swtTemp=r>e.trim.x?r-e.trim.x:0,this._shtTemp=n>e.trim.y?n-e.trim.y:0,this._temp1=e.trim.x-r,this._temp1=this._temp1<0?0:this._temp1,this._temp2=e.trim.y-n,this._temp2=this._temp2<0?0:this._temp2,this._temp3=s-this._temp1,this._temp3=this._temp3>e.trim.width?e.trim.width:this._temp3,this._temp4=a-this._temp2,this._temp4=this._temp4>e.trim.height?e.trim.height:this._temp4,this.buffer.get_g2().drawSubImage(e.image,t+this._temp1,i+this._temp2,e.frame.x+this._swtTemp,e.frame.y+this._shtTemp,this._temp3,this._temp4)):(this._swtTemp=e.frame.width-r,this._shtTemp=e.frame.height-n,this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x+r,e.frame.y+n,s>this._swtTemp?this._swtTemp:s,a>this._shtTemp?this._shtTemp:a))},drawScaledImage:function(e,t,i,r,n){this.buffer.get_g2().drawScaledImage(e,t,i,r,n)},drawScaledTexture:function(e,t,i,r,n){null!=e.trim?this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x-e.trim.x,e.frame.y-e.trim.y,e.trim.width+e.trim.x,e.trim.height+e.trim.y,t,i,r-e.trim.x,n-e.trim.y):this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x,e.frame.y,e.frame.width,e.frame.height,e.frame.x+t,e.frame.y+i,r,n)},drawScaledSubImage:function(e,t,i,r,n,s,a,o,l){this.buffer.get_g2().drawScaledSubImage(e,t,i,r,n,s,a,o,l)},drawScaledSubTexture:function(e,t,i,r,n,s,a,o,l){null!=e.trim?(this._swtTemp=e.trim.width+e.trim.x-t,this._swtTemp=r<this._swtTemp?r:this._swtTemp,this._shtTemp=e.trim.height+e.trim.y-i,this._shtTemp=n<this._shtTemp?n:this._shtTemp,this._dwTemp=o-e.trim.x,this._dhTemp=l-e.trim.y,this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x-e.trim.x+t,e.frame.y-e.trim.y+i,this._swtTemp,this._shtTemp,s,a,o,l)):this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x+t,e.frame.y+i,r<e.frame.width?r:e.frame.width,n<e.frame.height?n:e.frame.height,s,a,o,l)},drawVideo:function(e,t,i,r,n){this.buffer.get_g2().drawVideo(e,t,i,r,n)},drawText:function(e,t,i){this.buffer.get_g2().drawString(e,t,i)},drawAlignedText:function(e,t,i,r,n){Jt.drawAlignedString(this.buffer.get_g2(),e,t,i,r,n)},drawAlignedCharacters:function(e,t,i,r,n,s,a){Jt.drawAlignedCharacters(this.buffer.get_g2(),e,t,i,r,n,s,a)},drawRect:function(e,t,i,r,n){this.buffer.get_g2().drawRect(e,t,i,r,n)},fillRect:function(e,t,i,r){this.buffer.get_g2().fillRect(e,t,i,r)},fillTriangle:function(e,t,i,r,n,s){this.buffer.get_g2().fillTriangle(e,t,i,r,n,s)},drawArc:function(e,t,i,r,n,s,a){null==a&&(a=!1),null==s&&(s=1),Jt.drawArc(this.buffer.get_g2(),e,t,i,r,n,s,a)},fillArc:function(e,t,i,r,n,s){null==s&&(s=!1),Jt.fillArc(this.buffer.get_g2(),e,t,i,r,n,s)},drawCircle:function(e,t,i,r,n){Jt.drawCircle(this.buffer.get_g2(),e,t,i,r,n)},drawCubicBezier:function(e,t,i,r){Jt.drawCubicBezier(this.buffer.get_g2(),e,t,i,r)},drawCubicBezierPath:function(e,t,i,r){Jt.drawCubicBezierPath(this.buffer.get_g2(),e,t,i,r)},drawPolygon:function(e,t,i,r){var n=w._pointsToVec2(i);Jt.drawPolygon(this.buffer.get_g2(),e,t,n,r)},fillCircle:function(e,t,i,r){Jt.fillCircle(this.buffer.get_g2(),e,t,i,r)},fillPolygon:function(e,t,i){var r=w._pointsToVec2(i);Jt.fillPolygon(this.buffer.get_g2(),e,t,r)},get_color:function(){return this._color},set_color:function(e){return this.buffer.get_g2().set_color(e+-16777216),this._color=e},get_alpha:function(){return this._alpha},set_alpha:function(e){return this.buffer.get_g2().set_opacity(e),this._alpha=e},get_matrix:function(){var e=this.buffer.get_g2();return e.transformations[e.transformations.length-1]},set_matrix:function(e){var t=this.buffer.get_g2(),i=t.transformations[t.transformations.length-1];i._00=e._00,i._10=e._10,i._20=e._20,i._01=e._01,i._11=e._11,i._21=e._21,i._02=e._02,i._12=e._12,i._22=e._22;var r=this.buffer.get_g2();return r.transformations[r.transformations.length-1]},get_font:function(){return this._font},set_font:function(e){return this.buffer.get_g2().set_font(e),this._font=e},get_fontSize:function(){return this._fontSize},set_fontSize:function(e){return this.buffer.get_g2().set_fontSize(e),this._fontSize=e},set_blendMode:function(e){return e!=this._blendMode&&(this._blendMode=e,this.buffer.get_g2().set_pipeline(null!=e?e.getPipeline():null)),this._blendMode},get_blendMode:function(){return this._blendMode},__class__:w,__properties__:{set_matrix:"set_matrix",get_matrix:"get_matrix",set_blendMode:"set_blendMode",get_blendMode:"get_blendMode",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_alpha:"set_alpha",get_alpha:"get_alpha",set_color:"set_color",get_color:"get_color"}};var x=function(){};(i["gecko.IDrawable"]=x).__name__=!0,x.prototype={__class__:x};var B=function(){this._dirtyProcess=!1,this.currentCameraRendering=null,this._cameraRendering=-1,this._entitiesToRemove=[],this._entitiesToAdd=[],this._systemsToRemove=[],this._systemsToAdd=[];this.onCameraRemoved={handlers:[]};this.onCameraAdded={handlers:[]};this.onSystemRemoved={handlers:[]};this.onSystemAdded={handlers:[]};this.onEntityRemoved={handlers:[]};this.onEntityAdded={handlers:[]},this._systemsList=[],this._updatableSystems=[],this._drawableSystems=[],this._systems=new Ie,this._entitesMap=new Be,this.entities=[],this._isProcessing=!1,this._dirtySortSystems=!1,this._camerasToRemove=[],this._camerasToAdd=[],this.cameras=[],this._name="",g.call(this);var e=ae.__pool__.get();e.isAlreadyDestroyed=!1,this.timerManager=e;var t=_e.__pool__.get();t.isAlreadyDestroyed=!1,this.tweenManager=t;var i=b.__pool__.get();i.isAlreadyDestroyed=!1,this.rootEntity=i,this.rootEntity._name="scene-root-entity";var r=this.rootEntity,n=G.__pool__.get();n.isAlreadyDestroyed=!1,r.addComponent(n),this.rootEntity._isRoot=!0};(i["gecko.Scene"]=B).__name__=!0,B.createWithDrawSystem=function(e){var t=B.__pool__.get();t.isAlreadyDestroyed=!1;var i=t,r=re.__pool__.get();r.init(),r.isAlreadyDestroyed=!1;var n=r;return null!=e&&(n.priority=e),i.addSystem(n),i},B.create=function(){var e=B.__pool__.get();return e.isAlreadyDestroyed=!1,e},B.getPool=function(){return B.__pool__},B.__super__=g,B.prototype=n(g.prototype,{beforeDestroy:function(){for(g.prototype.beforeDestroy.call(this);0<this._systemsList.length;){var e=this._systemsList[0];this._removeSystem(e),e.destroy()}for(;0<this.entities.length;){var t=this.entities[0];this._removeEntity(t),t.destroy()}for(;0<this.cameras.length;){var i=this.cameras[0];this._removeCamera(i),i.destroy()}this.timerManager.cleanTimers(),this.tweenManager.cleanTweens(),de.clear(this.onEntityAdded),de.clear(this.onEntityRemoved),de.clear(this.onSystemAdded),de.clear(this.onSystemRemoved),de.clear(this.onCameraAdded),de.clear(this.onCameraRemoved),this.rootEntity.transform._reset()},getEntityById:function(e){return this._entitesMap.h[e]},createCamera:function(e,t,i,r){null==r&&(r=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var n=p.__pool__.get();return n.init(e,t,i,r,null),n.isAlreadyDestroyed=!1,this.addCamera(n)},createEntity:function(){var e=b.__pool__.get();return e.isAlreadyDestroyed=!1,this.addEntity(e)},addEntity:function(e){return null!=this._entitesMap.get(e.id)||(this._isProcessing?(this._entitiesToAdd.push(e),this._dirtyProcess=!0):this._addEntity(e)),e},_addEntity:function(e){e.set_scene(this),null!=e.transform&&null==e.transform._parent&&e.transform.set_parent(this.rootEntity.transform),this.entities.push(e),this._entitesMap.h[e.id]=e;for(var t=0,i=this._systemsList;t<i.length;){var r=i[t];++t,r._registerEntity(e),e.onComponentAdded.handlers.push(Xr(this,this._onEntityAddComponent))}var n=this.onEntityAdded.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(e)}},removeEntity:function(e){if(null!=this._entitesMap.get(e.id))return this._isProcessing?(this._entitiesToRemove.push(e),void(this._dirtyProcess=!0)):void this._removeEntity(e)},_removeEntity:function(e){for(var t=0,i=this._systemsList;t<i.length;){var r=i[t];++t,$.remove(e.onComponentAdded.handlers,Xr(this,this._onEntityAddComponent)),e.set_scene(null),null!=this.rootEntity&&e.transform._parent==this.rootEntity.transform&&e.transform.set_parent(null),r._removeEntity(e)}$.remove(this.entities,e),this._entitesMap.remove(e.id);var n=this.onEntityRemoved.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(e)}},addCamera:function(e){return-1!=this.cameras.indexOf(e)||(this._isProcessing?(this._camerasToAdd.push(e),this._dirtyProcess=!0):this._addCamera(e)),e},_addCamera:function(e){e.set_scene(this),this.cameras.push(e);var t=this.onCameraAdded.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}},removeCamera:function(e){if(-1==this.cameras.indexOf(e))return this._isProcessing?(this._camerasToRemove.push(e),void(this._dirtyProcess=!0)):void this._removeCamera(e)},_removeCamera:function(e){e.set_scene(null),$.remove(this.cameras,e);var t=this.onCameraRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}},addSystem:function(e){var t=e.get___type__();return null!=this._systems.get(ie.fromSystem(t).__systemName__)||(this._isProcessing?(this._systemsToAdd.push(e),this._dirtyProcess=!0):this._addSystem(e)),e},_addSystem:function(e){e.set_scene(this);var t=this._systems,i=e.get___typeName__(),r=t;null!=$r[i]?r.setReserved(i,e):r.h[i]=e,this._systemsList.push(e);for(var n=0,s=this.entities;n<s.length;){var a=s[n];++n,e._registerEntity(a)}Re.__instanceof(e,x)&&this._drawableSystems.push(e),Re.__instanceof(e,v)&&this._updatableSystems.push(e),this._dirtySortSystems=!0;var o=this.onSystemAdded.handlers;if(0!=o.length)for(var l=0;l<o.length;){var h=o[l];++l,h(e)}return e},getSystem:function(e){var t=this._systems,i=ie.fromSystem(e).__systemName__,r=t;return null!=$r[i]?r.getReserved(i):r.h[i]},_sortSystems:function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0},removeSystem:function(e){var t=this._systems,i=ie.fromSystem(e).__systemName__,r=t,n=null!=$r[i]?r.getReserved(i):r.h[i];if(null!=n){if(this._isProcessing)return this._systemsToRemove.push(n),void(this._dirtyProcess=!0);this._removeSystem(n)}},_removeSystem:function(e){e.set_scene(null),this._systems.remove(e.get___typeName__()),$.remove(this._systemsList,e),$.remove(this._drawableSystems,e),$.remove(this._updatableSystems,e),e._removeAllEntities();var t=this.onSystemRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}},process:function(e){if(this._isProcessing=!0,this._dirtySortSystems&&(this._systemsList.sort(Xr(this,this._sortSystems)),this._drawableSystems.sort(Xr(this,this._sortSystems)),this._updatableSystems.sort(Xr(this,this._sortSystems)),this._dirtySortSystems=!1),this.update(e),this._dirtyProcess){for(;0!=this._entitiesToAdd.length;)this._addEntity(this._entitiesToAdd.pop());for(;0!=this._entitiesToRemove.length;)this._removeEntity(this._entitiesToRemove.pop());for(;0!=this._systemsToAdd.length;)this._addSystem(this._systemsToAdd.pop());for(;0!=this._systemsToRemove.length;)this._removeSystem(this._systemsToRemove.pop());for(;0!=this._camerasToAdd.length;)this._addCamera(this._camerasToAdd.pop());for(;0!=this._camerasToRemove.length;)this._removeCamera(this._camerasToRemove.pop());this._dirtyProcess=!1}this._isProcessing=!1},update:function(e){if(this.timerManager.tick(e),this.tweenManager.tick(e),0<this.cameras.length)for(var t=0,i=this.cameras;t<i.length;){var r=i[t];++t,r.update(e)}for(var n=0,s=this._updatableSystems;n<s.length;){var a=s[n];++n,a.enabled&&a.update(e)}},updateCameraTransform:function(e){if(this._cameraRendering!=e.id||e.get_wasChanged()){var t=this.rootEntity.transform.get_worldMatrix(),i=e.get_matrix();t._00=i._00,t._10=i._10,t._20=i._20,t._01=i._01,t._11=i._11,t._21=i._21,t._02=i._02,t._12=i._12,t._22=i._22;for(var r=0,n=this.rootEntity.transform._children.length;r<n;){var s=r++;this.rootEntity.transform._children[s]._setDirty(!0,!0,!0)}e._wasChanged=!1,this._cameraRendering=e.id}},getCameraFocused:function(e){var t=null;if(0<this.cameras.length)for(var i=0,r=this.cameras.length;i<r;){var n=i++,s=this.cameras[n];if(e._x>=s.x&&e._x<=s.x+s.width&&e._y>=s.y&&e._y<=s.y+s.height){t=this.cameras[n];break}}return t},draw:function(e){if(this._isProcessing=!0,this.currentCameraRendering=null,0<this.cameras.length){e.end();for(var t=e.buffer,i=0,r=this.cameras;i<r.length;){var n=r[i];++i,this.currentCameraRendering=n,this.updateCameraTransform(n),e.setRenderTarget(n.buffer),null!=n.bgColor?e.begin(!0,n.bgColor):e.begin();for(var s=0,a=this._drawableSystems;s<a.length;){var o=a[s];++s,o.enabled&&o.draw(e)}e.end()}e.setRenderTarget(t),e.begin();for(var l=0,h=this.cameras;l<h.length;){var _=h[l];++l,_.preDraw(e);var c=_.buffer,u=_.x,d=_.y;e.buffer.get_g2().drawImage(c,u,d),_.postDraw(e)}}else for(var f=0,g=this._drawableSystems;f<g.length;){var v=g[f];++f,v.enabled&&v.draw(e)}this._isProcessing=!1},_onEntityAddComponent:function(e,t){for(var i=0,r=this._systemsList;i<r.length;){var n=r[i];++i,n._entities.h.hasOwnProperty(e.id)||n._registerEntity(e)}},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),B.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),B.__pool__.safePut(this))},get___type__:function(){return B},get___typeName__:function(){return"gecko.Scene"},__class__:B,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name"}});var S=i["gecko._Screen.AnchorMode"]={__ename__:!0,__constructs__:["TopLeft","TopCenter","TopRight","LeftCenter","Center","RightCenter","BottomLeft","BottomCenter","BottomRight"]};S.TopLeft=["TopLeft",0],S.TopLeft.toString=r,(S.TopLeft.__enum__=S).TopCenter=["TopCenter",1],S.TopCenter.toString=r,(S.TopCenter.__enum__=S).TopRight=["TopRight",2],S.TopRight.toString=r,(S.TopRight.__enum__=S).LeftCenter=["LeftCenter",3],S.LeftCenter.toString=r,(S.LeftCenter.__enum__=S).Center=["Center",4],S.Center.toString=r,(S.Center.__enum__=S).RightCenter=["RightCenter",5],S.RightCenter.toString=r,(S.RightCenter.__enum__=S).BottomLeft=["BottomLeft",6],S.BottomLeft.toString=r,(S.BottomLeft.__enum__=S).BottomCenter=["BottomCenter",7],S.BottomCenter.toString=r,(S.BottomCenter.__enum__=S).BottomRight=["BottomRight",8],S.BottomRight.toString=r,S.BottomRight.__enum__=S;var T=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(i["kha.math.Vector2"]=T).__name__=!0,T.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,e},__class__:T,__properties__:{set_length:"set_length",get_length:"get_length"}};var k=i["gecko.ScreenMode"]={__ename__:!0,__constructs__:["None","Fill","AspectFit","AspectFill"]};k.None=["None",0],k.None.toString=r,(k.None.__enum__=k).Fill=["Fill",1],k.Fill.toString=r,(k.Fill.__enum__=k).AspectFit=["AspectFit",2],k.AspectFit.toString=r,(k.AspectFit.__enum__=k).AspectFill=["AspectFill",3],k.AspectFill.toString=r,k.AspectFill.__enum__=k;var I=function(){};(i["gecko.Screen"]=I).__name__=!0,I.__properties__={set_mode:"set_mode",get_mode:"get_mode",get_height:"get_height",get_width:"get_width"},I.init=function(e,t,i,r){I._size.x=e.width,I._size.y=e.height,I.windowWidth=i,I.windowHeight=r,I._fixPosition();var n=0|I._size.x,s=0|I._size.y;I.buffer=ze.createRenderTarget(n,s,Ui.RGBA32,0,t),I.centerX=.5*n,I.centerY=.5*s;var a=e.mode;a!=I._mode&&(I._mode=a,I._setScreenMode(I._mode)),I._updateMatrix(),I._initiated||(f.onWindowResize.handlers.push(I._changeWindowSize),I._initiated=!0)},I.getRealScreenPoint=function(e,t,i){var r=1/(I.matrix._00*I.matrix._11+I.matrix._10*-I.matrix._01);i.set(I.matrix._11*r*e+-I.matrix._10*r*t+(I.matrix._21*I.matrix._10-I.matrix._20*I.matrix._11)*r,I.matrix._00*r*t+-I.matrix._01*r*e+(-I.matrix._21*I.matrix._00+I.matrix._20*I.matrix._01)*r)},I.setAnchor=function(e){switch(e[1]){case 0:I._anchor.x=0,I._anchor.y=0;break;case 1:I._anchor.x=.5,I._anchor.y=0;break;case 2:I._anchor.x=1,I._anchor.y=0;break;case 3:I._anchor.x=0,I._anchor.y=.5;break;case 4:I._anchor.x=.5,I._anchor.y=.5;break;case 5:I._anchor.x=1,I._anchor.y=.5;break;case 6:I._anchor.x=0,I._anchor.y=1;break;case 7:I._anchor.x=.5,I._anchor.y=1;break;case 8:I._anchor.x=1,I._anchor.y=1}I._fixPosition(),I._updateMatrix()},I._fixPosition=function(){I._position.x=I.windowWidth*(1-I._anchor.x),I._position.y=I.windowHeight*(1-I._anchor.y)},I._changeWindowSize=function(e,t){I.windowWidth=e,I.windowHeight=t,I._fixPosition(),I._setScreenMode(I._mode)},I._updateMatrix=function(){I.matrix._00=I._scale.x,I.matrix._11=I._scale.y,I.matrix._20=I._position.x-I._anchor.x*I._size.x*I._scale.x,I.matrix._21=I._position.y-I._anchor.y*I._size.y*I._scale.y},I._setScreenMode=function(e){switch(I._mode[1]){case 1:var t=I.windowWidth,i=I.buffer.get_width();I._scale.x=t/i;var r=I.windowHeight,n=I.buffer.get_height();I._scale.y=r/n;break;case 2:var s=Math.min(I.windowWidth/I.buffer.get_width(),I.windowHeight/I.buffer.get_height());I._scale.x=s,I._scale.y=s;break;case 3:var a=Math.max(I.windowWidth/I.buffer.get_width(),I.windowHeight/I.buffer.get_height());I._scale.x=a,I._scale.y=a}return I._updateMatrix(),I._mode},I.get_width=function(){return I.buffer.get_width()},I.get_height=function(){return I.buffer.get_height()},I.get_mode=function(){return I._mode},I.set_mode=function(e){return e==I._mode?I._mode:(I._mode=e,I._setScreenMode(I._mode))};var P=function(){};(i["kha.Scheduler"]=P).__name__=!0,P.init=function(){P.deltas=[];for(var e=0,t=P.DIF_COUNT;e<t;){var i=e++;P.deltas[i]=0}P.stopped=!0,P.frame_tasks_sorted=!0,P.current=P.lastTime=P.realTime(),P.currentFrameTaskId=0,P.currentTimeTaskId=0,P.currentGroupId=0,P.timeTasks=[],P.pausedTimeTasks=[],P.outdatedTimeTasks=[],P.timeTasksScratchpad=[],P.frameTasks=[],P.toDeleteFrame=[]},P.start=function(e){null==e&&(e=!1),P.vsync=A.get_vsync();var t=A.get_refreshRate();57<=t&&t<=63&&(t=60),P.onedifhz=1/t,P.stopped=!1,P.resetTime(),P.lastTime=P.realTime()-P.startTime;for(var i=0,r=P.DIF_COUNT;i<r;){var n=i++;P.deltas[n]=0}if(e){for(var s=0,a=P.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,h=P.frameTasks;l<h.length;){var _=h[l];++l,_.paused=!1}}},P.stop=function(){P.stopped=!0},P.isStopped=function(){return P.stopped},P.warpTimeTasksBack=function(e,t){for(var i=0;i<t.length;){var r=t[i];if(++i,r.start>=e)r.next=r.start;else if(0<r.period){var n=e-r.start,s=Math.ceil(n/r.period);r.next=r.start+s*r.period}}},P.warp=function(e){if(e<P.lastTime){P.current=e,P.lastTime=e,P.warpTimeTasksBack(e,P.outdatedTimeTasks),P.warpTimeTasksBack(e,P.timeTasks);for(var t=0,i=P.outdatedTimeTasks;t<i.length;){var r=i[t];++t,r.next>=e&&P.timeTasksScratchpad.push(r)}for(var n=0,s=P.timeTasksScratchpad;n<s.length;){var a=s[n];++n,$.remove(P.outdatedTimeTasks,a)}for(var o=0,l=P.timeTasksScratchpad;o<l.length;){var h=l[o];++o,P.insertSorted(P.timeTasks,h)}for(;0<P.timeTasksScratchpad.length;)$.remove(P.timeTasksScratchpad,P.timeTasksScratchpad[0])}else e>P.lastTime&&(P.startTime-=e-P.lastTime,P.current=e,P.lastTime=e,P.executeTimeTasks(e))},P.executeFrame=function(){var e=P.realTime()-P.startTime-P.lastTime,t=P.current;if(0<=e){if(null==Rr.the())if(e>P.maxframetime)P.startTime+=e-P.maxframetime,t+=e=P.maxframetime;else if(P.vsync){for(var i=P.onedifhz;i<e-P.onedifhz;)i+=P.onedifhz;e=i;for(var r=0,n=P.DIF_COUNT-2;r<n;){var s=r++;e+=P.deltas[s],P.deltas[s]=P.deltas[s+1]}e+=P.deltas[P.DIF_COUNT-2],e/=P.DIF_COUNT,P.deltas[P.DIF_COUNT-2]=i,t+=e}else{for(var a=0,o=P.DIF_COUNT-1;a<o;){var l=a++;P.deltas[l]=P.deltas[l+1]}P.deltas[P.DIF_COUNT-1]=e;for(var h=0,_=0,c=P.DIF_COUNT;_<c;){var u=_++;h+=P.deltas[u]}t+=h/=P.DIF_COUNT}else t+=e;P.lastTime=t,P.stopped||(P.current=t);for(var d=0,f=P.pausedTimeTasks;d<f.length;){var g=f[d];++d,g.next+=e}if(P.stopped)for(var v=0,p=P.timeTasks;v<p.length;){var m=p[v];++v,m.next+=e}P.executeTimeTasks(t);for(var y=0,b=P.outdatedTimeTasks;y<b.length;){var w=b[y];++y,w.next<t-10&&P.timeTasksScratchpad.push(w)}for(var x=0,B=P.timeTasksScratchpad;x<B.length;){var S=B[x];++x,$.remove(P.outdatedTimeTasks,S)}for(;0<P.timeTasksScratchpad.length;)$.remove(P.timeTasksScratchpad,P.timeTasksScratchpad[0])}P.sortFrameTasks();for(var T=0,k=P.frameTasks;T<k.length;){var I=k[T];++T,P.stopped||I.paused||!I.active||I.task()||(I.active=!1)}for(var A=0,C=P.frameTasks;A<C.length;){var D=C[A];++A,D.active||P.toDeleteFrame.push(D)}for(;0<P.toDeleteFrame.length;)$.remove(P.frameTasks,P.toDeleteFrame.pop())},P.executeTimeTasks=function(e){for(;0<P.timeTasks.length&&(P.activeTimeTask=P.timeTasks[0],P.activeTimeTask.next<=e);)P.activeTimeTask.next+=P.activeTimeTask.period,$.remove(P.timeTasks,P.activeTimeTask),P.activeTimeTask.active&&P.activeTimeTask.task()?0<P.activeTimeTask.period&&(0==P.activeTimeTask.duration||P.activeTimeTask.duration>=P.activeTimeTask.start+P.activeTimeTask.next)?P.insertSorted(P.timeTasks,P.activeTimeTask):P.archiveTimeTask(P.activeTimeTask,e):(P.activeTimeTask.active=!1,P.archiveTimeTask(P.activeTimeTask,e));P.activeTimeTask=null},P.archiveTimeTask=function(e,t){},P.time=function(){return P.current},P.realTime=function(){return A.get_time()},P.resetTime=function(){var e=A.get_time(),t=e-P.startTime;P.startTime=e;for(var i=0,r=P.timeTasks;i<r.length;){var n=r[i];++i,n.start-=t,n.next-=t}for(var s=0,a=P.DIF_COUNT;s<a;){var o=s++;P.deltas[o]=0}P.current=0,P.lastTime=0},P.addBreakableFrameTask=function(e,t){return P.frameTasks.push(new tt(e,t,++P.currentFrameTaskId)),P.frame_tasks_sorted=!1,P.currentFrameTaskId},P.addFrameTask=function(e,t){return P.addBreakableFrameTask(function(){return e(),!0},t)},P.pauseFrameTask=function(e,t){for(var i=0,r=P.frameTasks;i<r.length;){var n=r[i];if(++i,n.id==e){n.paused=t;break}}},P.removeFrameTask=function(e){for(var t=0,i=P.frameTasks;t<i.length;){var r=i[t];if(++t,r.id==e){r.active=!1;break}}},P.generateGroupId=function(){return++P.currentGroupId},P.addBreakableTimeTaskToGroup=function(e,t,i,r,n){null==n&&(n=0),null==r&&(r=0);var s=new et;return s.active=!0,s.task=t,s.id=++P.currentTimeTaskId,s.groupId=e,s.start=P.current+i,(s.period=0)!=r&&(s.period=r),(s.duration=0)!=n&&(s.duration=s.start+n),s.next=s.start,P.insertSorted(P.timeTasks,s),s.id},P.addTimeTaskToGroup=function(e,t,i,r,n){return null==n&&(n=0),null==r&&(r=0),P.addBreakableTimeTaskToGroup(e,function(){return t(),!0},i,r,n)},P.addBreakableTimeTask=function(e,t,i,r){return null==r&&(r=0),null==i&&(i=0),P.addBreakableTimeTaskToGroup(0,e,t,i,r)},P.addTimeTask=function(e,t,i,r){return null==r&&(r=0),null==i&&(i=0),P.addTimeTaskToGroup(0,e,t,i,r)},P.getTimeTask=function(e){if(null!=P.activeTimeTask&&P.activeTimeTask.id==e)return P.activeTimeTask;for(var t=0,i=P.timeTasks;t<i.length;){var r=i[t];if(++t,r.id==e)return r}for(var n=0,s=P.pausedTimeTasks;n<s.length;){var a=s[n];if(++n,a.id==e)return a}return null},P.pauseTimeTask=function(e,t){var i=P.getTimeTask(e);null!=i&&P.pauseRunningTimeTask(i,t),null!=P.activeTimeTask&&P.activeTimeTask.id==e&&(P.activeTimeTask.paused=t)},P.pauseRunningTimeTask=function(e,t){(e.paused=t)?($.remove(P.timeTasks,e),P.pausedTimeTasks.push(e)):(P.insertSorted(P.timeTasks,e),$.remove(P.pausedTimeTasks,e))},P.pauseTimeTasks=function(e,t){for(var i=0,r=P.timeTasks;i<r.length;){var n=r[i];++i,n.groupId==e&&P.pauseRunningTimeTask(n,t)}null!=P.activeTimeTask&&P.activeTimeTask.groupId==e&&(P.activeTimeTask.paused=t)},P.removeTimeTask=function(e){var t=P.getTimeTask(e);null!=t&&(t.active=!1,$.remove(P.timeTasks,t))},P.removeTimeTasks=function(e){for(var t=0,i=P.timeTasks;t<i.length;){var r=i[t];++t,r.groupId==e&&(r.active=!1,P.timeTasksScratchpad.push(r))}for(var n=0,s=P.timeTasksScratchpad;n<s.length;){var a=s[n];++n,$.remove(P.timeTasks,a)}for(;0<P.timeTasksScratchpad.length;)$.remove(P.timeTasksScratchpad,P.timeTasksScratchpad[0]);null!=P.activeTimeTask&&P.activeTimeTask.groupId==e&&(P.activeTimeTask.active=!1)},P.numTasksInSchedule=function(){return P.timeTasks.length+P.frameTasks.length},P.insertSorted=function(e,t){for(var i=0,r=e.length;i<r;){var n=i++;if(e[n].next>t.next)return void e.splice(n,0,t)}e.push(t)},P.sortFrameTasks=function(){P.frame_tasks_sorted||(P.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),P.frame_tasks_sorted=!0)};var A=function(){};(i["kha.System"]=A).__name__=!0,A.__properties__={get_systemId:"get_systemId",get_refreshRate:"get_refreshRate",get_vsync:"get_vsync",get_screenRotation:"get_screenRotation",get_time:"get_time",get_title:"get_title"},A.init=function(e,t){null==e.title&&(e.title="Kha"),null==e.width&&(e.width=800),null==e.height&&(e.height=600),null==e.samplesPerPixel&&(e.samplesPerPixel=1),null==e.vSync&&(e.vSync=!0),null==e.windowMode&&(e.windowMode=ht.Window),null==e.resizable&&(e.resizable=!1),null==e.maximizable&&(e.maximizable=!1),null==e.minimizable&&(e.minimizable=!0),A.theTitle=e.title,D.init(e,t)},A.initEx=function(e,t,i,r){A.theTitle=e,D.initEx(e,t,i,r)},A.get_title=function(){return A.theTitle},A.notifyOnRender=function(e,t){for(null==t&&(t=0);t>=A.renderListeners.length;)A.renderListeners.push([]);A.renderListeners[t].push(e)},A.removeRenderListener=function(e,t){null==t&&(t=0),$.remove(A.renderListeners[t],e)},A.notifyOnApplicationState=function(e,t,i,r,n){null!=e&&A.foregroundListeners.push(e),null!=t&&A.resumeListeners.push(t),null!=i&&A.pauseListeners.push(i),null!=r&&A.backgroundListeners.push(r),null!=n&&A.shutdownListeners.push(n)},A.notifyOnDropFiles=function(e){A.dropFilesListeners.push(e)},A.notifyOnCutCopyPaste=function(e,t,i){A.cutListener=e,A.copyListener=t,A.pasteListener=i},A.render=function(e,t){if(0!=A.renderListeners.length)for(var i=0,r=A.renderListeners[e];i<r.length;){var n=r[i];++i,n(t)}},A.foreground=function(){for(var e=0,t=A.foregroundListeners;e<t.length;){var i=t[e];++e,i()}},A.resume=function(){for(var e=0,t=A.resumeListeners;e<t.length;){var i=t[e];++e,i()}},A.pause=function(){for(var e=0,t=A.pauseListeners;e<t.length;){var i=t[e];++e,i()}},A.background=function(){for(var e=0,t=A.backgroundListeners;e<t.length;){var i=t[e];++e,i()}},A.shutdown=function(){for(var e=0,t=A.shutdownListeners;e<t.length;){var i=t[e];++e,i()}},A.dropFiles=function(e){for(var t=0,i=A.dropFilesListeners;t<i.length;){var r=i[t];++t,r(e)}},A.get_time=function(){return D.getTime()},A.windowWidth=function(e){return null==e&&(e=0),D.windowWidth(e)},A.windowHeight=function(e){return null==e&&(e=0),D.windowHeight(e)},A.screenDpi=function(){return D.screenDpi()},A.get_screenRotation=function(){return D.getScreenRotation()},A.get_vsync=function(){return D.getVsync()},A.get_refreshRate=function(){return D.getRefreshRate()},A.get_systemId=function(){return D.getSystemId()},A.requestShutdown=function(){D.requestShutdown()},A.changeResolution=function(e,t){D.changeResolution(e,t)},A.loadUrl=function(e){D.loadUrl(e)},A.canSwitchFullscreen=function(){return D.canSwitchFullscreen()},A.isFullscreen=function(){return D.isFullscreen()},A.requestFullscreen=function(){D.requestFullscreen()},A.exitFullscreen=function(){D.exitFullscreen()},A.notifyOnFullscreenChange=function(e,t){D.notifyOfFullscreenChange(e,t)},A.removeFullscreenListener=function(e,t){D.removeFromFullscreenChange(e,t)};var D=function(){};(i["kha.SystemImpl"]=D).__name__=!0,D.errorHandler=function(e,t,i,r,n){return window.console.error(n.stack),!0},D.init=function(e,t){D.options=e,D.mobile=D.isMobile(),D.ios=D.isIOS(),D.chrome=D.isChrome(),D.firefox=D.isFirefox(),D.ie=D.isIE(),D.init2(),t()},D.initEx=function(e,t,i,r){me.trace("initEx is not supported on the html5 target, running init() with first window options",{fileName:"SystemImpl.hx",lineNumber:82,className:"kha.SystemImpl",methodName:"initEx"}),D.init({title:e,width:t[0].width,height:t[0].height},r),null!=i&&i(0)},D.isMobile=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("Android")||0<=e.indexOf("webOS")||0<=e.indexOf("BlackBerry")||0<=e.indexOf("Windows Phone")||!!D.isIOS()},D.isIOS=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("iPhone")||0<=e.indexOf("iPad")||0<=e.indexOf("iPod")},D.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},D.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},D.isIE=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")},D.windowWidth=function(e){return null==e&&(e=0),0==D.khanvas.width&&null!=D.options.width?D.options.width:D.khanvas.width},D.windowHeight=function(e){return null==e&&(e=0),0==D.khanvas.height&&null!=D.options.height?D.options.height:D.khanvas.height},D.screenDpi=function(){var e=window.document.createElement("div");e.style.position="absolute",e.style.width="1in",e.style.height="1in",e.style.left="-100%",e.style.top="-100%",window.document.body.appendChild(e);var t=e.offsetHeight;return e.remove(),t},D.setCanvas=function(e){D.khanvas=e},D.getScreenRotation=function(){return it.RotationNone},D.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},D.getVsync=function(){return!0},D.getRefreshRate=function(){return 60},D.getSystemId=function(){return"HTML5"},D.requestShutdown=function(){window.close()},D.init2=function(e){me.trace=Re.__trace,D.keyboard=new Qi,D.mouse=new Ji,D.surface=new er,D.gamepads=[],D.gamepadStates=[];for(var t=0;t<4;){var i=t++;D.gamepads[i]=new Ki(i),D.gamepadStates[i]=new at}if(window.addEventListener("gamepadconnected",function(e){Ki.sendConnectEvent(e.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(e){Ki.sendDisconnectEvent(e.gamepad.index)}),D.ie){D.pressedKeys=[];for(var r=0;r<256;){r++;D.pressedKeys.push(!1)}for(var n=0;n<256;){n++;D.pressedKeys.push(null)}}window.document.addEventListener("copy",function(e){var t=e;if(null!=A.copyListener){var i=A.copyListener();null!=i&&t.clipboardData.setData("text/plain",i),t.preventDefault()}}),window.document.addEventListener("cut",function(e){var t=e;if(null!=A.cutListener){var i=A.cutListener();null!=i&&t.clipboardData.setData("text/plain",i),t.preventDefault()}}),window.document.addEventListener("paste",function(e){var t=e;if(null!=A.pasteListener){var i=t.clipboardData.getData("text/plain");A.pasteListener(i),t.preventDefault()}}),He.init(),P.init(),D.loadFinished(),je.instance=new ar},D.getMouse=function(e){return 0!=e?null:D.mouse},D.getKeyboard=function(e){return 0!=e?null:D.keyboard},D.checkGamepad=function(e){for(var t=0,i=e.axes.length;t<i;){var r=t++;if(null!=e.axes[r]&&D.gamepadStates[e.index].axes[r]!=e.axes[r]){var n=e.axes[r];r%2==1&&(n=-n),D.gamepadStates[e.index].axes[r]=n,D.gamepads[e.index].sendAxisEvent(r,n)}}for(var s=0,a=e.buttons.length;s<a;){var o=s++;null!=e.buttons[o]&&D.gamepadStates[e.index].buttons[o]!=e.buttons[o].value&&(D.gamepadStates[e.index].buttons[o]=e.buttons[o].value,D.gamepads[e.index].sendButtonEvent(o,e.buttons[o].value))}e.axes.length<=4&&7<e.buttons.length&&(D.gamepadStates[e.index].axes[4]=e.buttons[6].value,D.gamepads[e.index].sendAxisEvent(4,e.buttons[6].value),D.gamepadStates[e.index].axes[5]=e.buttons[7].value,D.gamepads[e.index].sendAxisEvent(5,e.buttons[7].value))},D.loadFinished=function(){var l=D.khanvas;null==l&&(l=window.document.getElementById(Xe.canvas_id));var e=!(l.style.cursor="default");try{D.gl=l.getContext("webgl2",{alpha:!1,antialias:1<D.options.samplesPerPixel,stencil:!0,preserveDrawingBuffer:!0}),D.gl.pixelStorei(37441,1),D.halfFloat={HALF_FLOAT_OES:5131},D.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},D.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},D.elementIndexUint=!0,D.gl.getExtension("EXT_color_buffer_float"),D.gl.getExtension("OES_texture_float_linear"),D.gl.getExtension("OES_texture_half_float_linear"),D.anisotropicFilter=D.gl.getExtension("EXT_texture_filter_anisotropic"),null==D.anisotropicFilter&&(D.anisotropicFilter=D.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),e=!0,D.gl2=!0,nt.init()}catch(e){me.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"SystemImpl.hx",lineNumber:348,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!D.gl2)try{D.gl=l.getContext("experimental-webgl",{alpha:!1,antialias:1<D.options.samplesPerPixel,stencil:!0,preserveDrawingBuffer:!0}),null!=D.gl&&(D.gl.pixelStorei(37441,1),D.gl.getExtension("OES_texture_float"),D.gl.getExtension("OES_texture_float_linear"),D.halfFloat=D.gl.getExtension("OES_texture_half_float"),D.gl.getExtension("OES_texture_half_float_linear"),D.depthTexture=D.gl.getExtension("WEBGL_depth_texture"),D.gl.getExtension("EXT_shader_texture_lod"),D.gl.getExtension("OES_standard_derivatives"),D.anisotropicFilter=D.gl.getExtension("EXT_texture_filter_anisotropic"),null==D.anisotropicFilter&&(D.anisotropicFilter=D.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),D.drawBuffers=D.gl.getExtension("WEBGL_draw_buffers"),D.elementIndexUint=D.gl.getExtension("OES_element_index_uint"),e=!0,nt.init())}catch(e){me.trace("Could not initialize WebGL, falling back to Canvas.",{fileName:"SystemImpl.hx",lineNumber:372,className:"kha.SystemImpl",methodName:"loadFinished"})}if(D.setCanvas(l),e){var t=new gr;D.frame=new Ye(0,null,null,t),D.frame.init(new qt(D.frame),new vr(D.frame),t)}else{or.Kravur=Je,Je=or;var i=new nr(l.getContext("2d"));D.frame=new Ye(0,null,i,null),D.frame.init(new qt(D.frame),i,null)}!D.mobile&&yt._init()?(D._hasWebAudio=!0,bt._init()):D.mobile?(D._hasWebAudio=!1,lr._init(),bt=lr):(D._hasWebAudio=!1,rr._compile(),bt=rr),mr.instance=new yr,P.start();var r=window,h=r.requestAnimationFrame;null==h&&(h=r.mozRequestAnimationFrame),null==h&&(h=r.webkitRequestAnimationFrame),null==h&&(h=r.msRequestAnimationFrame);var _=null,n=_=function(e){var t=window;null==h?t.setTimeout(_,16.666666666666668):h(_);var i=D.getGamepads();if(null!=i)for(var r=0,n=i.length;r<n;){var s=i[r++];null!=s&&D.checkGamepad(s)}if(P.executeFrame(),l.getContext){var a=l.clientWidth,o=l.clientHeight;l.width==a&&l.height==o||(l.width=a,l.height=o),A.render(0,D.frame),null!=D.gl&&(D.gl.clearColor(1,1,1,1),D.gl.colorMask(!1,!1,!1,!0),D.gl.clear(16384),D.gl.colorMask(!0,!0,!0,!0))}};null==h?r.setTimeout(n,16.666666666666668):h(n),null==l.getAttribute("tabindex")&&l.setAttribute("tabindex","0"),l.focus(),l.oncontextmenu=function(e){e.stopPropagation(),e.preventDefault()},l.onmousedown=D.mouseDown,l.onmousemove=D.mouseMove,null!=D.keyboard&&(l.onkeydown=D.keyDown,l.onkeyup=D.keyUp,l.onkeypress=D.keyPress),l.onblur=D.onBlur,l.onfocus=D.onFocus,l.onmousewheel=l.onwheel=D.mouseWheel,l.onmouseleave=D.mouseLeave,l.addEventListener("wheel mousewheel",D.mouseWheel,!1),l.addEventListener("touchstart",D.touchDown,!1),l.addEventListener("touchend",D.touchUp,!1),l.addEventListener("touchmove",D.touchMove,!1),l.addEventListener("touchcancel",D.touchCancel,!1),window.addEventListener("unload",D.unload)},D.lockMouse=function(){Xr(Hr=D.khanvas,Hr.requestPointerLock)?D.khanvas.requestPointerLock():D.khanvas.mozRequestPointerLock?D.khanvas.mozRequestPointerLock():D.khanvas.webkitRequestPointerLock&&D.khanvas.webkitRequestPointerLock()},D.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},D.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},D.isMouseLocked=function(){return document.pointerLockElement===D.khanvas||document.mozPointerLockElement===D.khanvas||document.webkitPointerLockElement===D.khanvas},D.notifyOfMouseLockChange=function(e,t){window.document.addEventListener("pointerlockchange",e,!1),window.document.addEventListener("mozpointerlockchange",e,!1),window.document.addEventListener("webkitpointerlockchange",e,!1),window.document.addEventListener("pointerlockerror",t,!1),window.document.addEventListener("mozpointerlockerror",t,!1),window.document.addEventListener("webkitpointerlockerror",t,!1)},D.removeFromMouseLockChange=function(e,t){window.document.removeEventListener("pointerlockchange",e,!1),window.document.removeEventListener("mozpointerlockchange",e,!1),window.document.removeEventListener("webkitpointerlockchange",e,!1),window.document.removeEventListener("pointerlockerror",t,!1),window.document.removeEventListener("mozpointerlockerror",t,!1),window.document.removeEventListener("webkitpointerlockerror",t,!1)},D.unload=function(e){},D.setMouseXY=function(e){var t=D.khanvas.getBoundingClientRect(),i=D.khanvas.clientLeft,r=D.khanvas.clientTop;D.mouseX=(e.clientX-t.left-i)*D.khanvas.width/(t.width-2*i)|0,D.mouseY=(e.clientY-t.top-r)*D.khanvas.height/(t.height-2*r)|0},D.unlockSoundOnIOS=function(){if(D.ios&&!D.iosSoundEnabled){var e=lr._context.createBuffer(1,1,22050),t=lr._context.createBufferSource();t.buffer=e,t.connect(lr._context.destination),t.start(),t.stop(),D.iosSoundEnabled=!0}},D.mouseLeave=function(){D.mouse.sendLeaveEvent(0)},D.mouseWheel=function(e){return D.insideInputEvent=!0,D.unlockSoundOnIOS(),e.preventDefault(),0==e.deltaMode?e.deltaY<0?D.mouse.sendWheelEvent(0,-1):0<e.deltaY&&D.mouse.sendWheelEvent(0,1):1==e.deltaMode&&(D.minimumScroll=0|Math.min(D.minimumScroll,Math.abs(e.deltaY)),D.mouse.sendWheelEvent(0,e.deltaY/D.minimumScroll|0)),D.insideInputEvent=!1},D.mouseDown=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS(),D.setMouseXY(e),1==e.which?(e.ctrlKey?(D.leftMouseCtrlDown=!0,D.mouse.sendDownEvent(0,1,D.mouseX,D.mouseY)):(D.leftMouseCtrlDown=!1,D.mouse.sendDownEvent(0,0,D.mouseX,D.mouseY)),null!=Xr(Hr=D.khanvas,Hr.setCapture)?D.khanvas.setCapture():D.khanvas.ownerDocument.addEventListener("mousemove",D.documentMouseMove,!0),D.khanvas.ownerDocument.addEventListener("mouseup",D.mouseLeftUp)):2==e.which?(D.mouse.sendDownEvent(0,2,D.mouseX,D.mouseY),D.khanvas.ownerDocument.addEventListener("mouseup",D.mouseMiddleUp)):3==e.which&&(D.mouse.sendDownEvent(0,1,D.mouseX,D.mouseY),D.khanvas.ownerDocument.addEventListener("mouseup",D.mouseRightUp)),D.insideInputEvent=!1},D.mouseLeftUp=function(e){D.unlockSoundOnIOS(),1==e.which&&(D.insideInputEvent=!0,D.khanvas.ownerDocument.removeEventListener("mouseup",D.mouseLeftUp),null!=Xr(Hr=D.khanvas,Hr.releaseCapture)?D.khanvas.ownerDocument.releaseCapture():D.khanvas.ownerDocument.removeEventListener("mousemove",D.documentMouseMove,!0),D.leftMouseCtrlDown?D.mouse.sendUpEvent(0,1,D.mouseX,D.mouseY):D.mouse.sendUpEvent(0,0,D.mouseX,D.mouseY),D.leftMouseCtrlDown=!1,D.insideInputEvent=!1)},D.mouseMiddleUp=function(e){D.unlockSoundOnIOS(),2==e.which&&(D.insideInputEvent=!0,D.khanvas.ownerDocument.removeEventListener("mouseup",D.mouseMiddleUp),D.mouse.sendUpEvent(0,2,D.mouseX,D.mouseY),D.insideInputEvent=!1)},D.mouseRightUp=function(e){D.unlockSoundOnIOS(),3==e.which&&(D.insideInputEvent=!0,D.khanvas.ownerDocument.removeEventListener("mouseup",D.mouseRightUp),D.mouse.sendUpEvent(0,1,D.mouseX,D.mouseY),D.insideInputEvent=!1)},D.documentMouseMove=function(e){e.stopPropagation(),D.mouseMove(e)},D.mouseMove=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS();var t=D.mouseX,i=D.mouseY;D.setMouseXY(e);var r=e.movementX,n=e.movementY;null==e.movementX&&(r=null!=e.mozMovementX?e.mozMovementX:null!=e.webkitMovementX?e.webkitMovementX:D.mouseX-t,n=null!=e.mozMovementY?e.mozMovementY:null!=e.webkitMovementY?e.webkitMovementY:D.mouseY-i),D.firefox&&(r=r*window.devicePixelRatio|0,n=n*window.devicePixelRatio|0),D.mouse.sendMoveEvent(0,D.mouseX,D.mouseY,r,n),D.insideInputEvent=!1},D.setTouchXY=function(e){var t=D.khanvas.getBoundingClientRect(),i=D.khanvas.clientLeft,r=D.khanvas.clientTop;D.touchX=(e.clientX-t.left-i)*D.khanvas.width/(t.width-2*i)|0,D.touchY=(e.clientY-t.top-r)*D.khanvas.height/(t.height-2*r)|0},D.touchDown=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS(),e.stopPropagation(),e.preventDefault();for(var t=0,i=e.changedTouches;t<i.length;){var r=i[t];++t;var n=r.identifier;D.ios&&(-1==(n=D.iosTouchs.indexOf(-1))&&(n=D.iosTouchs.length),D.iosTouchs[n]=r.identifier),D.setTouchXY(r),D.mouse.sendDownEvent(0,0,D.touchX,D.touchY),D.surface.sendTouchStartEvent(n,D.touchX,D.touchY)}D.insideInputEvent=!1},D.touchUp=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS();for(var t=0,i=e.changedTouches;t<i.length;){var r=i[t];++t;var n=r.identifier;D.ios&&(n=D.iosTouchs.indexOf(n),D.iosTouchs[n]=-1),D.setTouchXY(r),D.mouse.sendUpEvent(0,0,D.touchX,D.touchY),D.surface.sendTouchEndEvent(n,D.touchX,D.touchY)}D.insideInputEvent=!1},D.touchMove=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS();for(var t=0,i=0,r=e.changedTouches;i<r.length;){var n=r[i];if(++i,D.setTouchXY(n),0==t){var s=D.touchX-D.lastFirstTouchX,a=D.touchY-D.lastFirstTouchY;D.lastFirstTouchX=D.touchX,D.lastFirstTouchY=D.touchY,D.mouse.sendMoveEvent(0,D.touchX,D.touchY,s,a)}var o=n.identifier;D.ios&&(o=D.iosTouchs.indexOf(o)),D.surface.sendMoveEvent(o,D.touchX,D.touchY),++t}D.insideInputEvent=!1},D.touchCancel=function(e){D.insideInputEvent=!0,D.unlockSoundOnIOS();for(var t=0,i=e.changedTouches;t<i.length;){var r=i[t];++t;var n=r.identifier;D.ios&&(n=D.iosTouchs.indexOf(n)),D.setTouchXY(r),D.mouse.sendUpEvent(0,0,D.touchX,D.touchY),D.surface.sendTouchEndEvent(n,D.touchX,D.touchY)}D.iosTouchs=[],D.insideInputEvent=!1},D.onBlur=function(){A.background()},D.onFocus=function(){A.foreground()},D.keycodeToChar=function(e,t,i){if(null!=e){if(1==e.length)return e;switch(e){case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-"}}switch(t){case 48:return i?"=":"0";case 49:return i?"!":"1";case 50:return i?'"':"2";case 51:return i?"":"3";case 52:return i?"$":"4";case 53:return i?"%":"5";case 54:return i?"&":"6";case 55:return i?"/":"7";case 56:return i?"(":"8";case 57:return i?")":"9";case 106:return"*";case 107:return"+";case 109:return"-";case 111:return"/";case 187:return i?"*":"+";case 188:return i?";":",";case 189:return i?"_":"-";case 190:return i?":":".";case 191:return i?"'":"#";case 212:return i?"`":"";case 219:return i?"?":"";case 226:return i?">":"<"}return 96<=t&&t<=105?String.fromCharCode(-48+t):65<=t&&t<=90?i?String.fromCharCode(t):String.fromCharCode(t-65+97):String.fromCharCode(t)},D.keyDown=function(e){if((e.keyCode<112||123<e.keyCode)&&null!=e.key&&1!=e.key.length&&e.preventDefault(),e.stopPropagation(),D.ie){if(D.pressedKeys[e.keyCode])return void e.preventDefault();D.pressedKeys[e.keyCode]=!0}else if(e.repeat)return void e.preventDefault();D.keyboard.sendDownEvent(e.keyCode)},D.keyUp=function(e){e.preventDefault(),e.stopPropagation(),D.ie&&(D.pressedKeys[e.keyCode]=!1),D.keyboard.sendUpEvent(e.keyCode)},D.keyPress=function(e){0!=e.which&&(e.preventDefault(),e.stopPropagation(),D.keyboard.sendPressEvent(String.fromCharCode(e.which)))},D.canSwitchFullscreen=function(){return"fullscreenElement "in document||"mozFullScreenElement"in document||"webkitFullscreenElement"in document||"msFullscreenElement"in document},D.isFullscreen=function(){return document.fullscreenElement===this.khanvas||document.mozFullScreenElement===this.khanvas||document.webkitFullscreenElement===this.khanvas||document.msFullscreenElement===this.khanvas},D.requestFullscreen=function(){Xr(Hr=D.khanvas,Hr.requestFullscreen)?D.khanvas.requestFullscreen():D.khanvas.msRequestFullscreen?D.khanvas.msRequestFullscreen():D.khanvas.mozRequestFullScreen?D.khanvas.mozRequestFullScreen():D.khanvas.webkitRequestFullscreen&&D.khanvas.webkitRequestFullscreen()},D.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},D.notifyOfFullscreenChange=function(e,t){window.document.addEventListener("fullscreenchange",e,!1),window.document.addEventListener("mozfullscreenchange",e,!1),window.document.addEventListener("webkitfullscreenchange",e,!1),window.document.addEventListener("MSFullscreenChange",e,!1),window.document.addEventListener("fullscreenerror",t,!1),window.document.addEventListener("mozfullscreenerror",t,!1),window.document.addEventListener("webkitfullscreenerror",t,!1),window.document.addEventListener("MSFullscreenError",t,!1)},D.removeFromFullscreenChange=function(e,t){window.document.removeEventListener("fullscreenchange",e,!1),window.document.removeEventListener("mozfullscreenchange",e,!1),window.document.removeEventListener("webkitfullscreenchange",e,!1),window.document.removeEventListener("MSFullscreenChange",e,!1),window.document.removeEventListener("fullscreenerror",t,!1),window.document.removeEventListener("mozfullscreenerror",t,!1),window.document.removeEventListener("webkitfullscreenerror",t,!1),window.document.removeEventListener("MSFullscreenError",t,!1)},D.changeResolution=function(e,t){},D.setKeepScreenOn=function(e){},D.loadUrl=function(e){window.open(e,"_blank")},D.getGamepadId=function(e){var t=D.getGamepads();return null!=t&&t[e]?t[e].id:"unkown"},D.getGamepads=function(){return D.chrome&&mr.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},D.getPen=function(e){return null};var N=function(){};(i["gecko.Time"]=N).__name__=!0,N.__properties__={get_realTime:"get_realTime",get_delta:"get_delta",get_fixedDelta:"get_fixedDelta"},N._tick=function(){var e=P.time(),t=P.realTime();N.fixedUnscaledDelta=e-N._lastFixedNow,N.unscaledDelta=t-N._lastNow,N.fixedUnscaledTime+=N.fixedUnscaledDelta,N.unscaledTime+=N.unscaledDelta,N.fixedTime+=N.fixedUnscaledDelta*N.scale,N.time+=N.unscaledDelta*N.scale,N._lastNow=t,N._lastFixedNow=e},N._clear=function(){N._lastNow=P.realTime(),N._lastFixedNow=P.time()},N.get_fixedDelta=function(){return N.fixedUnscaledDelta*N.scale},N.get_delta=function(){return N.unscaledDelta*N.scale},N.get_realTime=function(){return P.realTime()-N._initTime};var M=i["gecko.DepthMode"]={__ename__:!0,__constructs__:["DEFAULT","ENABLED","DISABLED"]};M.DEFAULT=["DEFAULT",0],M.DEFAULT.toString=r,(M.DEFAULT.__enum__=M).ENABLED=["ENABLED",1],M.ENABLED.toString=r,(M.ENABLED.__enum__=M).DISABLED=["DISABLED",2],M.DISABLED.toString=r,M.DISABLED.__enum__=M;var L=function(e){this._visibleOnCamera=[],this._fixedToCamera=!1,this._skewCache={cosX:0,cosY:0,sinX:0,sinY:0},this._dirtyPosition=!0,this._dirtyDepth=!1,this._dirtyScale=!0,this._dirtyAngle=!0,this._dirty=!0,this._worldMatrix=new C(1,0,0,0,1,0,0,0,1),this._localMatrix=new C(1,0,0,0,1,0,0,0,1),this._depth=0,this._depthMode=M.DEFAULT,this._localRotation=0,this._rotation=0,this._nextChild=null,this._branch=0,this._children=[],this._rootTransform=null,this.lastUpdateID=0,this.id=f.getUniqueID(),this.entity=e;this.onAddedToParent={handlers:[]};this.onRemovedFromParent={handlers:[]};this.onTransformChange={handlers:[]};this.onDepthChange={handlers:[]},this._flip=new X(!1,!1),this._flip.setObserver(Xr(this,this._vecDirty));var t=H.__pool__.get();t.init(0,0),t.isAlreadyDestroyed=!1,this._skew=t,this._skew.setObserver(Xr(this,this._onSetSkew));var i=H.__pool__.get();i.init(.5,.5),i.isAlreadyDestroyed=!1,this._pivot=i,this._pivot.setObserver(Xr(this,this._pointDirtyPosition));var r=H.__pool__.get();r.init(.5,.5),r.isAlreadyDestroyed=!1,this._anchor=r,this._anchor.setObserver(Xr(this,this._pointDirtyPosition));var n=H.__pool__.get();n.init(0,0),n.isAlreadyDestroyed=!1,this._size=n,this._size.setObserver(Xr(this,this._pointDirtyPosition));var s=H.__pool__.get();s.init(0,0),s.isAlreadyDestroyed=!1,this._position=s,this._position.setObserver(Xr(this,this._onSetPosition));var a=H.__pool__.get();a.init(0,0),a.isAlreadyDestroyed=!1,this._localPosition=a,this._localPosition.setObserver(Xr(this,this._pointDirtyPosition));var o=H.__pool__.get();o.init(1,1),o.isAlreadyDestroyed=!1,this._scale=o,this._scale.setObserver(Xr(this,this._onSetScale));var l=H.__pool__.get();l.init(1,1),l.isAlreadyDestroyed=!1,this._localScale=l,this._localScale.setObserver(Xr(this,this._onSetLocalScale));var h=H.__pool__.get();h.init(0,0),h.isAlreadyDestroyed=!1,this._tmpPoint1=h;var _=H.__pool__.get();_.init(0,0),_.isAlreadyDestroyed=!1,this._tmpPoint2=_,this._dirty=this._dirtyPosition=this._dirtyAngle=this._dirtyScale=!0};(i["gecko.Transform"]=L).__name__=!0,L.sortChildrenHandler=function(e,t){return e._depth<t._depth?-1:e._depth>t._depth?1:0},L.prototype={existsInCamera:function(e){return!(null!=e&&0<this._visibleOnCamera.length)||-1!=this._visibleOnCamera.indexOf(e.id)},addToCamera:function(e){this._visibleOnCamera.push(e.id)},removeFromCamera:function(e){$.remove(this._visibleOnCamera,e.id)},sortChildren:function(e){null==e&&(e=L.sortChildrenHandler),this._children.sort(e)},_reset:function(){for(this.set_parent(null);0<this._children.length;)this._children[0].set_parent(null);de.clear(this.onDepthChange),de.clear(this.onAddedToParent),de.clear(this.onRemovedFromParent),de.clear(this.onTransformChange);var e=this._position;e._vec2.x=e._x=0;var t=this._position;t._vec2.y=t._y=0;var i=this._localPosition;i._vec2.x=i._x=0;var r=this._localPosition;r._vec2.y=r._y=0;var n=this._scale;n._vec2.x=n._x=1;var s=this._scale;s._vec2.y=s._y=1;var a=this._localScale;a._vec2.x=a._x=1;var o=this._localScale;o._vec2.y=o._y=1;var l=this._skew;l._vec2.x=l._x=0;var h=this._skew;h._vec2.y=h._y=0;var _=this._pivot;_._vec2.x=_._x=.5;var c=this._pivot;c._vec2.y=c._y=.5;var u=this._anchor;u._vec2.x=u._x=.5;var d=this._anchor;d._vec2.y=d._y=.5;var f=this._size;f._vec2.x=f._x=0;var g=this._size;g._vec2.y=g._y=0,this._flip._x=!1,this._flip._y=!1,this._rotation=0,this._localRotation=0,this._skewCache.cosX=0,this._skewCache.sinX=0,this._skewCache.cosY=0,this._skewCache.sinY=0,this._depth=0,this._depthMode=M.DEFAULT,this._fixedToCamera=!1,this._visibleOnCamera.length=0,this._dirty=this._dirtyPosition=this._dirtyAngle=this._dirtyScale=!0},updateTransform:function(){if(this._dirty){this.lastUpdateID++,null!=this._parent?(this._parent.updateTransform(),null==this._parent._parent?this._rootTransform=this._parent:this._rootTransform=this._parent._rootTransform):this._rootTransform=this,this._dirtyAngle&&(this._skewCache.cosX=Math.cos(this._rotation+this._skew._x),this._skewCache.sinX=Math.sin(this._rotation+this._skew._x),this._skewCache.sinY=-Math.sin(this._rotation-this._skew._y),this._skewCache.cosY=Math.cos(this._rotation-this._skew._y));var e=this._localScale._x*(this._flip._x?-1:1),t=this._localScale._y*(this._flip._y?-1:1),i=this._flip._x?1-this._anchor._x:this._anchor._x,r=this._flip._y?1-this._anchor._y:this._anchor._y,n=this._flip._x?1-this._pivot._x:this._pivot._x,s=this._flip._y?1-this._pivot._y:this._pivot._y;this._localMatrix._00=this._skewCache.cosX*e,this._localMatrix._01=this._skewCache.sinX*e,this._localMatrix._10=this._skewCache.sinY*t,this._localMatrix._11=this._skewCache.cosY*t;var a=i*this._size._x,o=r*this._size._y,l=n*this._size._x,h=s*this._size._y;if(this._localMatrix._20=this._localPosition._x-a*e+l*e,this._localMatrix._21=this._localPosition._y-o*t+h*t,0==l&&0==h||(this._localMatrix._20-=l*this._localMatrix._00+h*this._localMatrix._10,this._localMatrix._21-=l*this._localMatrix._01+h*this._localMatrix._11),this._fixedToCamera||null==this._parent){var _=this._worldMatrix,c=this._localMatrix;if(_._00=c._00,_._10=c._10,_._20=c._20,_._01=c._01,_._11=c._11,_._21=c._21,_._02=c._02,_._12=c._12,_._22=c._22,this._dirtyScale){var u=this._scale;u._vec2.x=u._x=this._localScale._x;var d=this._scale;d._vec2.y=d._y=this._localScale._y}this._dirtyAngle&&(this._rotation=this._localRotation)}else{var f=this._worldMatrix,g=this._localMatrix,v=this._parent._worldMatrix;if(f._00=g._00*v._00+g._01*v._10,f._01=g._00*v._01+g._01*v._11,f._10=g._10*v._00+g._11*v._10,f._11=g._10*v._01+g._11*v._11,f._20=g._20*v._00+g._21*v._10+v._20,f._21=g._20*v._01+g._21*v._11+v._21,this._dirtyScale){var p=this._scale;p._vec2.x=p._x=this._localScale._x*this._parent._scale._x;var m=this._scale;m._vec2.y=m._y=this._localScale._y*this._parent._scale._y}this._dirtyAngle&&(this._rotation=this._localRotation+this._parent._rotation)}this._dirtyAngle=!1,this._dirtyScale=!1,this._dirty=!1;var y=this.onTransformChange.handlers;if(0!=y.length)for(var b=0;b<y.length;){var w=y[b];++b,w()}}},_onSetSkew:function(e){this._setDirty(!0,!1,!0)},_onSetScale:function(e){if(null!=this._parent){var t=this._localScale;t._vec2.x=t._x=this._scale._x/this._parent._scale._x;var i=this._localScale;i._vec2.y=i._y=this._scale._y/this._parent._scale._y}else{var r=this._localScale;r._vec2.x=r._x=this._scale._x;var n=this._localScale;n._vec2.y=n._y=this._scale._y}this._setDirty(!0,!0),this._dirtyPosition=!1,this._dirtyScale=!1},_onSetLocalScale:function(e){this._setDirty(!0,!0)},_onSetPosition:function(e){if(null==this._parent||this._fixedToCamera){var t=this._localPosition;t._vec2.x=t._x=e._x;var i=this._localPosition;i._vec2.y=i._y=e._y}else{var r=this._parent,n=this._tmpPoint2;n=this._rootTransform.localToScreen(e,n),r.screenToLocal(n,n);var s=this._localPosition;s._vec2.x=s._x=this._tmpPoint2._x;var a=this._localPosition;a._vec2.y=a._y=this._tmpPoint2._y}this._setDirty(!0),this._dirtyPosition=!1},_vecDirty:function(e){this._setDirty(!0),this._dirtyPosition=!1},_pointDirtyPosition:function(e){this._setDirty(!0)},_setDirty:function(e,t,i){if(null==i&&(i=!1),null==t&&(t=!1),null==e&&(e=!1),!this._dirty||this._dirtyAngle!=i||this._dirtyPosition!=e||this._dirtyScale!=t){this._dirty=!0,i&&!this._dirtyAngle&&(this._dirtyAngle=!0),e&&!this._dirtyPosition&&(this._dirtyPosition=!0),t&&!this._dirtyScale&&(this._dirtyScale=!0);for(var r=0,n=this._children;r<n.length;){var s=n[r];++r,s._setDirty(this._dirtyPosition,this._dirtyScale,this._dirtyAngle)}}},localToScreen:function(e,t){if(this._dirty||this.updateTransform(),null==t){var i=H.__pool__.get();i.init(0,0),i.isAlreadyDestroyed=!1,t=i}var r=e._x,n=e._y;return t.set_x(this._worldMatrix._00*r+this._worldMatrix._10*n+this._worldMatrix._20),t.set_y(this._worldMatrix._01*r+this._worldMatrix._11*n+this._worldMatrix._21),t},screenToLocal:function(e,t){if(this._dirty||this.updateTransform(),null==t){var i=H.__pool__.get();i.init(0,0),i.isAlreadyDestroyed=!1,t=i}var r=e._x,n=e._y,s=1/(this._worldMatrix._00*this._worldMatrix._11+this._worldMatrix._10*-this._worldMatrix._01);return t.set_x(this._worldMatrix._11*s*r+-this._worldMatrix._10*s*n+(this._worldMatrix._21*this._worldMatrix._10-this._worldMatrix._20*this._worldMatrix._11)*s),t.set_y(this._worldMatrix._00*s*n+-this._worldMatrix._01*s*r+(-this._worldMatrix._21*this._worldMatrix._00+this._worldMatrix._20*this._worldMatrix._01)*s),t},localToLocal:function(e,t,i){return i=e.localToScreen(t,i),this.screenToLocal(i,i)},getChildrenLength:function(){return this._children.length},getChild:function(e){return this._children[e]},toString:function(){return"Transform: hasParent -> "+E.string(null!=this._parent)+", position -> "+E.string(this.get_position())+", localPosition -> "+E.string(this.get_localPosition())+", scale -> "+E.string(this.get_scale())+", localScale -> "+E.string(this.get_localScale())+",  rotation -> "+this.get_rotation()+", localRotation -> "+this.get_localRotation()+" size -> "+E.string(this.get_size())+", anchor -> "+E.string(this.get_anchor())+" pivot -> "+E.string(this.get_pivot())+", flip -> "+E.string(this.get_flip())},get_parent:function(){return this._parent},set_parent:function(e){if(e==this._parent)return this._parent;if(null!=this._parent){$.remove(this._parent._children,this);var t=this.onRemovedFromParent.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this._parent)}}if(this._parent=e,null!=this._parent){this._parent._children.push(this),(this._parent._depthMode==M.ENABLED||this._parent._depthMode==M.DEFAULT&&L.isDepthEnabled)&&this._parent.sortChildren();var n=this.onAddedToParent.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(this._parent)}}return this._setDirty(!0,!0,!0),this._parent},get_localPosition:function(){return this._dirty&&this.updateTransform(),this._localPosition},get_position:function(){if(this._dirty&&this.updateTransform(),this._dirtyPosition){if(null==this._parent||this._fixedToCamera){var e=this._position;e._vec2.x=e._x=this._localPosition._x;var t=this._position;t._vec2.y=t._y=this._localPosition._y}else{this._rootTransform.get_worldMatrix();var i=this._rootTransform,r=this._tmpPoint1;r=this._parent.localToScreen(this._localPosition,r),i.screenToLocal(r,r);var n=this._position;n._vec2.x=n._x=this._tmpPoint1._x;var s=this._position;s._vec2.y=s._y=this._tmpPoint1._y}this._dirtyPosition=!1}return this._position},get_scale:function(){return this._dirty&&this.updateTransform(),this._scale},get_localScale:function(){return this._dirty&&this.updateTransform(),this._localScale},get_size:function(){return this._dirty&&this.updateTransform(),this._size},get_anchor:function(){return this._dirty&&this.updateTransform(),this._anchor},get_pivot:function(){return this._dirty&&this.updateTransform(),this._pivot},get_flip:function(){return this._dirty&&this.updateTransform(),this._flip},get_rotation:function(){return this._dirty&&this.updateTransform(),this._rotation},set_rotation:function(e){return e==this._rotation||(this._rotation=e,null!=this._parent?this._localRotation=this._rotation+this._parent._rotation:this._localRotation=this._rotation,this._setDirty(!0,!1,!0),this._dirtyPosition=!1),this._rotation},get_localRotation:function(){return this._dirty&&this.updateTransform(),this._localRotation},set_localRotation:function(e){return e==this._localRotation||(this._localRotation=e,this._setDirty(!0,!1,!0),this._dirtyPosition=!1),this._localRotation},get_width:function(){return this.get_scale()._x*this.get_size()._x},get_localWidth:function(){return this.get_localScale()._x*this.get_size()._x},set_width:function(e){return this.get_scale().set_x(e/this.get_size()._x)},set_localWidth:function(e){return this.get_localScale().set_x(e/this.get_size()._x)},get_height:function(){return this.get_scale()._y*this.get_size()._y},get_localHeight:function(){return this.get_localScale()._y*this.get_size()._y},set_height:function(e){return this.get_scale().set_y(e/this.get_size()._y)},set_localHeight:function(e){return this.get_localScale().set_y(e/this.get_size()._y)},get_top:function(){return this.get_position()._y-this.get_scale()._y*this.get_size()._y*this.get_anchor()._y},get_bottom:function(){return this.get_position()._y+this.get_scale()._y*this.get_size()._y*(1-this.get_anchor()._y)},get_left:function(){return this.get_position()._x-this.get_scale()._x*this.get_size()._x*this.get_anchor()._x},get_right:function(){return this.get_position()._x+this.get_scale()._x*this.get_size()._x*(1-this.get_anchor()._x)},get_localTop:function(){return this.get_localPosition()._y-this.get_localScale()._y*this.get_size()._y*this.get_anchor()._y},get_localBottom:function(){return this.get_localPosition()._y+this.get_localScale()._y*this.get_size()._y*(1-this.get_anchor()._y)},get_localLeft:function(){return this.get_localPosition()._x-this.get_localScale()._x*this.get_size()._x*this.get_anchor()._x},get_localRight:function(){return this.get_localPosition()._x+this.get_localScale()._x*this.get_size()._x*(1-this.get_anchor()._x)},get_localMatrix:function(){return this._dirty&&this.updateTransform(),this._localMatrix},set_localMatrix:function(e){return this._localMatrix=e},get_worldMatrix:function(){return this._dirty&&this.updateTransform(),this._worldMatrix},set_worldMatrix:function(e){return this._worldMatrix=e},get_depth:function(){return this._depth},set_depth:function(e){if(e==this._depth)return this._depth;this._depth=e,null!=this._parent&&(this._parent._depthMode==M.ENABLED||this._parent._depthMode==M.DEFAULT&&L.isDepthEnabled)&&this._parent.sortChildren();var t=this.onDepthChange.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this)}return this._depth},set_depthMode:function(e){return e==this._depthMode||(this._depthMode=e,(this._depthMode==M.ENABLED||this._depthMode==M.DEFAULT&&L.isDepthEnabled)&&this.sortChildren()),this._depthMode},get_depthMode:function(){return this._depthMode},set_fixedToCamera:function(e){return e==this._fixedToCamera||(this._fixedToCamera=e,this._dirty=!0),this._fixedToCamera},get_fixedToCamera:function(){return this._fixedToCamera},__class__:L,__properties__:{set_fixedToCamera:"set_fixedToCamera",get_fixedToCamera:"get_fixedToCamera",set_worldMatrix:"set_worldMatrix",get_worldMatrix:"get_worldMatrix",set_localMatrix:"set_localMatrix",get_localMatrix:"get_localMatrix",set_depth:"set_depth",get_depth:"get_depth",set_depthMode:"set_depthMode",get_depthMode:"get_depthMode",get_localRight:"get_localRight",get_right:"get_right",get_localLeft:"get_localLeft",get_left:"get_left",get_localBottom:"get_localBottom",get_bottom:"get_bottom",get_localTop:"get_localTop",get_top:"get_top",set_localRotation:"set_localRotation",get_localRotation:"get_localRotation",set_rotation:"set_rotation",get_rotation:"get_rotation",get_flip:"get_flip",get_size:"get_size",get_anchor:"get_anchor",get_pivot:"get_pivot",get_localScale:"get_localScale",get_scale:"get_scale",get_position:"get_position",get_localPosition:"get_localPosition",set_localHeight:"set_localHeight",get_localHeight:"get_localHeight",set_height:"set_height",get_height:"get_height",set_localWidth:"set_localWidth",get_localWidth:"get_localWidth",set_width:"set_width",get_width:"get_width",set_parent:"set_parent",get_parent:"get_parent"}};var R=function(){this._destroyCurrentScene=!1,this.currentScene=B.createWithDrawSystem();this.onSceneChanged={handlers:[]}};(i["gecko.World"]=R).__name__=!0,R.prototype={changeScene:function(e,t){null==t&&(t=!1),this._destroyCurrentScene=t,this._nextScene=e},update:function(e){if(null!=this._nextScene){var t=this.currentScene;this.currentScene=this._nextScene,this._nextScene=null;var i=this.onSceneChanged.handlers;if(0!=i.length)for(var r=0;r<i.length;){var n=i[r];++r,n(t,this.currentScene)}this._destroyCurrentScene&&t.destroy()}this.currentScene.process(e)},draw:function(e){this.currentScene.draw(e)},__class__:R};var V=function(){this._name="",this._entity=null,g.call(this);this.onAddedToEntity={handlers:[]};this.onRemovedFromEntity={handlers:[]}};(i["gecko.components.Component"]=V).__name__=!0,V.getName=function(e){return F.fromComponent(e).__componentName__},V.getBaseTypes=function(e){return F.fromComponent(e).__componentTypes__},V._toClass=function(e){return F.fromComponent(e)},V.create=function(){var e=V.__pool__.get();return e.isAlreadyDestroyed=!1,e},V.getPool=function(){return V.__pool__},V.__super__=g,V.prototype=n(g.prototype,{beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this._entity&&this._entity.removeComponent(this.get___type__()),de.clear(this.onAddedToEntity),de.clear(this.onRemovedFromEntity)},toString:function(){return"Component: "+(""==this._name?this.get___typeName__():this._name)},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_entity:function(){return this._entity},set_entity:function(e){if(this._entity==e)return this._entity;if(null!=this._entity){var t=this.onRemovedFromEntity.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this._entity)}}if(this._entity=e,null!=this._entity){var n=this.onAddedToEntity.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(this._entity)}}return this._entity},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),V.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),V.__pool__.safePut(this))},get___type__:function(){return V},get___typeName__:function(){return"gecko.components.Component"},__class__:V,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name",set_entity:"set_entity",get_entity:"get_entity"}});var F={};(i["gecko.components._Component.ComponentClass_Impl_"]=F).__name__=!0,F.__properties__={get___componentTypes__:"get___componentTypes__",get___componentName__:"get___componentName__"},F.get___componentName__=function(e){return e.__componentName__},F.get___componentTypes__=function(e){return e.__componentTypes__},F.fromComponent=function(e){return e};var G=function(){this._dirtyAlpha=!0,this._alpha=1,this._localAlpha=1,this.color=16777215,this.visible=!0,V.call(this)};(i["gecko.components.draw.DrawComponent"]=G).__name__=!0,G.__interfaces__=[v,x],G.create=function(){var e=G.__pool__.get();return e.isAlreadyDestroyed=!1,e},G.getPool=function(){return G.__pool__},G.__super__=V,G.prototype=n(V.prototype,{update:function(e){},preDraw:function(e){},draw:function(e){},postDraw:function(e){},generateTexture:function(e){if(null==this._entity)return me.trace("DrawComponent.generateTexture() needs a entity to work.",{fileName:"DrawComponent.hx",lineNumber:32,className:"gecko.components.draw.DrawComponent",methodName:"generateTexture"}),null;null==e&&(e=f.graphics);var t=ze.createRenderTarget(0|this._entity.transform.get_size()._x,0|this._entity.transform.get_size()._y),i=e.isRendering,r=e.buffer;return i&&e.end(),e.setRenderTarget(t),e.begin(),e.end(),e.setRenderTarget(r),i&&e.begin(),new Q(t)},beforeDestroy:function(){V.prototype.beforeDestroy.call(this),this.visible=!0,this.color=16777215,this._alpha=1,this._localAlpha=1,this._dirtyAlpha=!0},get_isVisible:function(){return!!this.visible&&0<this.get_alpha()},get_localAlpha:function(){return this._localAlpha},set_localAlpha:function(e){return e==this._localAlpha?this._localAlpha:(this._dirtyAlpha=!0,this._localAlpha=e)},get_alpha:function(){if(this._dirtyAlpha)if(null!=this._entity&&null!=this._entity.transform._parent){var e=this._entity.transform._parent.entity._renderer;this._alpha=e.get_alpha()*this._localAlpha,this._dirtyAlpha=!1}else this._alpha=this._localAlpha,this._entity._isRoot&&(this._dirtyAlpha=!1);return this._alpha},set_alpha:function(e){if(e==this._alpha)return this._alpha;if(null!=this._entity&&null!=this._entity.transform._parent){var t=this._entity.transform._parent.entity._renderer;this._localAlpha=t.get_alpha()*e}else this._localAlpha=e;return this._alpha=e},get___typeName__:function(){return"gecko.components.draw.DrawComponent"},get___type__:function(){return G},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),G.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),G.__pool__.safePut(this))},__class__:G,__properties__:n(V.prototype.__properties__,{get_isVisible:"get_isVisible",set_alpha:"set_alpha",get_alpha:"get_alpha",set_localAlpha:"set_localAlpha",get_localAlpha:"get_localAlpha"})});var O=function(){this.diameter=4,this.segments=0,this.strength=2,this.fill=!1,this._radius=1,G.call(this)};(i["gecko.components.draw.CircleComponent"]=O).__name__=!0,O.create=function(e,t,i,r){null==r&&(r=0),null==i&&(i=2),null==t&&(t=1);var n=O.__pool__.get();return n.init(e,t,i,r),n.isAlreadyDestroyed=!1,n},O.getPool=function(){return O.__pool__},O.__super__=G,O.prototype=n(G.prototype,{init:function(e,t,i,r){null==r&&(r=0),null==i&&(i=2),null==t&&(t=1),this.set_radius(t),this.fill=e,this.strength=i,this.segments=r,this.onAddedToEntity.handlers.push(Xr(this,this._setTransformSize))},draw:function(e){if(this.fill){var t=this._radius,i=this._radius,r=this._radius;Jt.fillCircle(e.buffer.get_g2(),t,i,r,null)}else{var n=this._radius,s=this._radius,a=this._radius,o=this.strength,l=this.segments;Jt.drawCircle(e.buffer.get_g2(),n,s,a,o,l)}},beforeDestroy:function(){G.prototype.beforeDestroy.call(this),$.remove(this.onAddedToEntity.handlers,Xr(this,this._setTransformSize)),this.set_radius(1),this.fill=!1,this.strength=2},_setTransformSize:function(e){null!=e.transform&&e.transform.get_size().set(this.diameter,this.diameter)},get_radius:function(){return this._radius},set_radius:function(e){return e==this._radius||(this._radius=e,this.diameter=2*this._radius,null!=this._entity&&null!=this._entity.transform&&this._entity.transform.get_size().set(this.diameter,this.diameter)),this._radius},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),O.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),O.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.CircleComponent"},get___type__:function(){return O},__class__:O,__properties__:n(G.prototype.__properties__,{set_radius:"set_radius",get_radius:"get_radius"})});var W=function(){this._height=0,this._width=0,this.strength=2,this.fill=!1,G.call(this)};(i["gecko.components.draw.PolygonComponent"]=W).__name__=!0,W.create=function(e,t,i){null==i&&(i=2);var r=W.__pool__.get();return r.init(e,t,i),r.isAlreadyDestroyed=!1,r},W.getPool=function(){return W.__pool__},W.__super__=G,W.prototype=n(G.prototype,{init:function(e,t,i){null==i&&(i=2),this.fill=e,this.strength=i,this.setPoints(t),this.onAddedToEntity.handlers.push(Xr(this,this._setTransformSize))},setPoints:function(e){this._points=e,this.checkBounds()},checkBounds:function(){for(var e=1/0,t=1/0,i=-1/0,r=-1/0,n=0,s=this._points;n<s.length;){var a=s[n];++n,a._x<e&&(e=a._x),a._x>i&&(i=a._x),a._y<t&&(t=a._y),a._y>r&&(r=a._y)}this._width=i-e,this._height=r-t,null!=this._entity&&this._setTransformSize(this._entity)},getPoints:function(){return this._points},draw:function(e){if(this.fill){var t=w._pointsToVec2(this._points);Jt.fillPolygon(e.buffer.get_g2(),0,0,t)}else{var i=this.strength,r=w._pointsToVec2(this._points);Jt.drawPolygon(e.buffer.get_g2(),0,0,r,i)}},beforeDestroy:function(){for(G.prototype.beforeDestroy.call(this),$.remove(this.onAddedToEntity.handlers,Xr(this,this._setTransformSize)),this.fill=!1;0<this._points.length;)this._points.pop().destroy()},_setTransformSize:function(e){null!=e.transform&&e.transform.get_size().set(this._width,this._height)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),W.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),W.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.PolygonComponent"},get___type__:function(){return W},__class__:W});var z=function(){this.fill=!1,this.strength=2,this._height=0,this._width=0,G.call(this)};(i["gecko.components.draw.RectangleComponent"]=z).__name__=!0,z.create=function(e,t,i,r){null==r&&(r=2);var n=z.__pool__.get();return n.init(e,t,i,r),n.isAlreadyDestroyed=!1,n},z.getPool=function(){return z.__pool__},z.__super__=G,z.prototype=n(G.prototype,{init:function(e,t,i,r){null==r&&(r=2),this.set_width(t),this.set_height(i),this.fill=e,this.strength=r,this.onAddedToEntity.handlers.push(Xr(this,this._setTransformSize))},draw:function(e){if(this.fill){var t=this._width,i=this._height;e.buffer.get_g2().fillRect(0,0,t,i)}else{var r=this._width,n=this._height,s=this.strength;e.buffer.get_g2().drawRect(0,0,r,n,s)}},_setTransformSize:function(e){null!=e.transform&&e.transform.get_size().set(this._width,this._height)},beforeDestroy:function(){G.prototype.beforeDestroy.call(this),this.set_width(0),this.set_height(0),this.fill=!1,this.strength=2,$.remove(this.onAddedToEntity.handlers,Xr(this,this._setTransformSize))},get_width:function(){return this._width},get_height:function(){return this._height},set_width:function(e){return e==this._width||(this._width=e,null!=this._entity&&null!=this._entity.transform&&this._entity.transform.get_size().set_x(this._width)),this._width},set_height:function(e){return e==this._height||(this._height=e,null!=this._entity&&null!=this._entity.transform&&this._entity.transform.get_size().set_y(this._height)),this._height},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),z.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),z.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.RectangleComponent"},get___type__:function(){return z},__class__:z,__properties__:n(G.prototype.__properties__,{set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"})});var H=function(){this._y=0,this._x=0,this._vec2=new T,g.call(this)};(i["gecko.math.Point"]=H).__name__=!0,H.create=function(e,t){null==t&&(t=0),null==e&&(e=0);var i=H.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},H.getPool=function(){return H.__pool__},H.__super__=g,H.prototype=n(g.prototype,{init:function(e,t){null==t&&(t=0),null==e&&(e=0),this.set(e,t)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this._observer=null,this.isObserved=!1,this._vec2.x=this._x=0,this._vec2.y=this._y=0},_setX:function(e){this._vec2.x=this._x=e},_setY:function(e){this._vec2.y=this._y=e},getVec2:function(){return this._vec2},setObserver:function(e){this.isObserved=!0,this._observer=e},removeObserver:function(){this.isObserved=!1},set:function(e,t){e==this._x&&t==this._y||(this._vec2.x=this._x=e,this._vec2.y=this._y=t,this.isObserved&&this._observer(this))},setFloor:function(e,t){this.set(Math.floor(e),Math.floor(t))},setCeil:function(e,t){this.set(Math.ceil(e),Math.ceil(t))},setRound:function(e,t){this.set(Math.round(e),Math.round(t))},floor:function(){this.set(Math.floor(this._x),Math.floor(this._y))},ceil:function(){this.set(Math.ceil(this._x),Math.ceil(this._y))},round:function(){this.set(Math.round(this._x),Math.round(this._y))},clone:function(){var e=this._x,t=this._y,i=H.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},copy:function(e){this.set(e._x,e._y)},isEqual:function(e){return this._x==e._x&&this._y==e._y},add:function(e){this.set(this._x+e._x,this._y+e._y)},sub:function(e){this.set(this._x-e._x,this._y-e._y)},mult:function(e){this.set(this._x*e,this._y*e)},div:function(e){var t=1/e;this.set(this._x*t,this._y*t)},dot:function(e){return this._x*e._x+this._y*e._y},toString:function(){return"Point("+this._x+", "+this._y+")"},get_x:function(){return this._x},set_x:function(e){return e==this._x?this._x:(this._vec2.x=this._x=e,this.isObserved&&this._observer(this),e)},get_y:function(){return this._y},set_y:function(e){return e==this._y?this._y:(this._vec2.y=this._y=e,this.isObserved&&this._observer(this),e)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),H.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),H.__pool__.safePut(this))},__class__:H,__properties__:{set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}});var Z=function(){this.height=0,this.width=0,this.y=0,this.x=0,g.call(this)};(i["gecko.math.Rect"]=Z).__name__=!0,Z.fromSquare=function(e){var t=Z.__pool__.get();return t.init(0,0,e,e),t.isAlreadyDestroyed=!1,t},Z.fromRectangle=function(e,t){var i=Z.__pool__.get();return i.init(0,0,e,t),i.isAlreadyDestroyed=!1,i},Z.create=function(e,t,i,r){null==r&&(r=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var n=Z.__pool__.get();return n.init(e,t,i,r),n.isAlreadyDestroyed=!1,n},Z.getPool=function(){return Z.__pool__},Z.__super__=g,Z.prototype=n(g.prototype,{init:function(e,t,i,r){null==r&&(r=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.set(e,t,i,r)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this.clear()},set:function(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r},clear:function(){this.x=0,this.y=0,this.width=0,this.height=0},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},clone:function(){var e=this.x,t=this.y,i=this.width,r=this.height,n=Z.__pool__.get();return n.init(e,t,i,r),n.isAlreadyDestroyed=!1,n},contains:function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},containsPoint:function(e){return this.contains(e._x,e._y)},containsRect:function(e){return!!(this.contains(e.x,e.y)&&this.contains(e.x,e.y+e.height)&&this.contains(e.x+e.width,e.y))&&this.contains(e.x+e.width,e.y+e.height)},intersect:function(e){return!!(this.contains(e.x,e.y)||this.contains(e.x,e.y+e.height)||this.contains(e.x+e.width,e.y))||this.contains(e.x+e.width,e.y+e.height)},get_top:function(){return this.y},get_bottom:function(){return this.y+this.height},get_left:function(){return this.x},get_right:function(){return this.x+this.width},get_centerX:function(){return this.x+this.width/2},get_centerY:function(){return this.y+this.height/2},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Z.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Z.__pool__.safePut(this))},__class__:Z,__properties__:{get_centerY:"get_centerY",get_centerX:"get_centerX",get_right:"get_right",get_left:"get_left",get_bottom:"get_bottom",get_top:"get_top"}});var X=function(e,t){e==this._x&&t==this._y||(this._x=e,this._y=t,this.isObserved&&this._observer(this))};(i["gecko.math.Vector2g"]=X).__name__=!0,X.prototype={setObserver:function(e){this.isObserved=!0,this._observer=e},removeObserver:function(){this.isObserved=!1},set:function(e,t){e==this._x&&t==this._y||(this._x=e,this._y=t,this.isObserved&&this._observer(this))},_setX:function(e){this._x=e},_setY:function(e){this._y=e},clone:function(e){return new X(this._x,this._y)},copy:function(e){var t=e._x,i=e._y;t==this._x&&i==this._y||(this._x=t,this._y=i,this.isObserved&&this._observer(this))},isEqual:function(e){return this._x==e._x&&this._y==e._y},get_x:function(){return this._x},set_x:function(e){return e==this._x?this._x:(this._x=e,this.isObserved&&this._observer(this),e)},set_y:function(e){return e==this._y?this._y:(this._y=e,this.isObserved&&this._observer(this),e)},get_y:function(){return this._y},toString:function(){return"Vector2g("+E.string(this._x)+", "+E.string(this._y)+")"},__class__:X,__properties__:{set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var j=i["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"]};j.Add=["Add",0],j.Add.toString=r,(j.Add.__enum__=j).Subtract=["Subtract",1],j.Subtract.toString=r,(j.Subtract.__enum__=j).ReverseSubtract=["ReverseSubtract",2],j.ReverseSubtract.toString=r,(j.ReverseSubtract.__enum__=j).Min=["Min",3],j.Min.toString=r,(j.Min.__enum__=j).Max=["Max",4],j.Max.toString=r,j.Max.__enum__=j;var K=i["kha.graphics4.BlendingFactor"]={__ename__:!0,__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"]};K.Undefined=["Undefined",0],K.Undefined.toString=r,(K.Undefined.__enum__=K).BlendOne=["BlendOne",1],K.BlendOne.toString=r,(K.BlendOne.__enum__=K).BlendZero=["BlendZero",2],K.BlendZero.toString=r,(K.BlendZero.__enum__=K).SourceAlpha=["SourceAlpha",3],K.SourceAlpha.toString=r,(K.SourceAlpha.__enum__=K).DestinationAlpha=["DestinationAlpha",4],K.DestinationAlpha.toString=r,(K.DestinationAlpha.__enum__=K).InverseSourceAlpha=["InverseSourceAlpha",5],K.InverseSourceAlpha.toString=r,(K.InverseSourceAlpha.__enum__=K).InverseDestinationAlpha=["InverseDestinationAlpha",6],K.InverseDestinationAlpha.toString=r,(K.InverseDestinationAlpha.__enum__=K).SourceColor=["SourceColor",7],K.SourceColor.toString=r,(K.SourceColor.__enum__=K).DestinationColor=["DestinationColor",8],K.DestinationColor.toString=r,(K.DestinationColor.__enum__=K).InverseSourceColor=["InverseSourceColor",9],K.InverseSourceColor.toString=r,(K.InverseSourceColor.__enum__=K).InverseDestinationColor=["InverseDestinationColor",10],K.InverseDestinationColor.toString=r,K.InverseDestinationColor.__enum__=K;var Y=function(e,t,i){this._compiled=!1,this.source=e,this.destination=t,this.operation=i,this._compile()};(i["gecko.render.BlendMode"]=Y).__name__=!0,Y.Create=function(e,t,i){return new Y(e,t,null!=i?i:j.Add)},Y.prototype={getPipeline:function(){return this._blendPipeline},_compile:function(){if(!this._compiled)if(f.isIniaited){this._blendPipeline=new Ni;var e=new ji;e.add("vertexPosition",Hi.Float3),e.add("texPosition",Hi.Float2),e.add("vertexColor",Hi.Float4),this._blendPipeline.inputLayout=[e],this._blendPipeline.fragmentShader=nt.painter_image_frag,this._blendPipeline.vertexShader=nt.painter_image_vert,this._blendPipeline.blendSource=this.source,this._blendPipeline.blendDestination=this.destination,this._blendPipeline.blendOperation=this.operation,this._blendPipeline.compile(),this._compiled=!0}else f.addOnKhaInitCallback(Xr(this,this._compile))},__class__:Y};var Q=function(e,t,i,r,n){if(this.rotated=!1,this.image=e,null!=t)this.frame=t;else{var s=this.image.get_width(),a=this.image.get_height(),o=Z.__pool__.get();o.init(0,0,s,a),o.isAlreadyDestroyed=!1,this.frame=o}null!=n&&(this.trim=n),this._width=null!=i?i:this.image.get_width(),this._height=null!=r?r:this.image.get_height()};(i["gecko.resources.Texture"]=Q).__name__=!0,Q.fromTexturePacker=function(e,t){var i=null,r=null;if(t.rotated){var n=t.frame.x,s=t.frame.y,a=t.frame.h,o=t.frame.w,l=Z.__pool__.get();l.init(n,s,a,o),l.isAlreadyDestroyed=!1,i=l}else{var h=t.frame.x,_=t.frame.y,c=t.frame.w,u=t.frame.h,d=Z.__pool__.get();d.init(h,_,c,u),d.isAlreadyDestroyed=!1,i=d}if(t.trimmed){var f=t.spriteSourceSize.x,g=t.spriteSourceSize.y,v=t.spriteSourceSize.w,p=t.spriteSourceSize.h,m=Z.__pool__.get();m.init(f,g,v,p),m.isAlreadyDestroyed=!1,r=m}var y=new Q(e,i,t.sourceSize.w,t.sourceSize.h,r);y.rotated=t.rotated;var b=t.pivot.x,w=t.pivot.y,x=H.__pool__.get();return x.init(b,w),x.isAlreadyDestroyed=!1,y.pivot=x,y},Q.prototype={unload:function(){this.image.unload()},get_trimmed:function(){return null!=this.trim},get_width:function(){return this._width},get_height:function(){return this._height},__class__:Q,__properties__:{get_height:"get_height",get_width:"get_width",get_trimmed:"get_trimmed"}};var q=function(){this.clear()};(i["gecko.systems.Filter"]=q).__name__=!0,q.prototype={clear:function(){return this._query={is:null,equal:null,base:[],baseAll:[],any:[],all:[],not:[]},this},is:function(e){return this._query.is=e,this},equal:function(e){return this._query.equal=e,this},base:function(e){return this._query.base=e,this},baseAll:function(e){return this._query.base=e,this},any:function(e){return this._query.any=e,this},addAny:function(e){return-1==this._query.any.indexOf(e)&&this._query.any.push(e),this},all:function(e){return this._query.all=e,this},addAll:function(e){return-1==this._query.all.indexOf(e)&&this._query.all.push(e),this},addBase:function(e){return-1==this._query.base.indexOf(e)&&this._query.base.push(e),this},_isEmptyQuery:function(){return null==this._query.is&&null==this._query.equal&&0==this._query.any.length&&0==this._query.all.length&&0==this._query.base.length},testEntity:function(e){if(null==this._query.is&&null==this._query.equal&&0==this._query.any.length&&0==this._query.all.length&&0==this._query.base.length)return!1;var t=e._componentsList;if(0!=t.length){if(null!=this._query.is){for(var i=!1,r=0;r<t.length;){var n=t[r];if(++r,Re.__instanceof(n,this._query.is)){i=!0;break}}if(!i)return!1}if(null!=this._query.equal){var s=e._components.h,a=F.fromComponent(this._query.equal).__componentName__;if(!s.hasOwnProperty(a))return!1}if(0!=this._query.any.length){for(var o=!1,l=0,h=this._query.any;l<h.length;){var _=h[l];++l;var c=e._components.h,u=F.fromComponent(_).__componentName__;if(c.hasOwnProperty(u)){o=!0;break}}if(!o)return!1}if(0!=this._query.all.length){for(var d=!0,f=0,g=this._query.all;f<g.length;){var v=g[f];++f;var p=e._components.h,m=F.fromComponent(v).__componentName__;if(!p.hasOwnProperty(m)){d=!1;break}}if(!d)return!1}if(0!=this._query.base.length){for(var y=!1,b=0,w=this._query.base;b<w.length;){var x=w[b];if(++b,e._componentTypes.exists(F.fromComponent(x).__componentName__)){y=!0;break}}if(!y)return!1}if(0!=this._query.baseAll.length){for(var B=!0,S=0,T=this._query.base;S<T.length;){var k=T[S];if(++S,!e._componentTypes.exists(F.fromComponent(k).__componentName__)){B=!1;break}}if(!B)return!1}return!0}return!1},__class__:q};var J=function(){this.filter=new q,this._entities=new Be,this._entitiesList=[],this.requiredComponents=[],this.priority=0,this._name="",this._scene=null,this.enabled=!0,g.call(this);this.onEntityAdded={handlers:[]};this.onEntityRemoved={handlers:[]};this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]}};(i["gecko.systems.System"]=J).__name__=!0,J.getName=function(e){return ie.fromSystem(e).__systemName__},J._toClass=function(e){return ie.fromSystem(e)},J.create=function(){var e=J.__pool__.get();return e.isAlreadyDestroyed=!1,e},J.getPool=function(){return J.__pool__},J.__super__=g,J.prototype=n(g.prototype,{process:function(e){this.update(e)},update:function(e){},draw:function(e){},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this.removeAllEntities(),this.set_scene(null),this.filter.clear(),de.clear(this.onEntityAdded),de.clear(this.onEntityRemoved),de.clear(this.onAddedToScene),de.clear(this.onRemovedFromScene)},eachEntity:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var r=i[t];++t,r.enabled&&e(r)}},getEntities:function(){return this._entitiesList},getEntitiesWithComponent:function(r){return c.array(this._entitiesList.filter(function(e){var t=e._components.h,i=F.fromComponent(r).__componentName__;return t.hasOwnProperty(i)}))},isValidEntity:function(e){return this.filter.testEntity(e)},removeAllEntities:function(){for(var e=0,t=this._entitiesList;e<t.length;){var i=t[e];++e,this._removeEntity(i)}},hasEntity:function(e){return this._entities.h.hasOwnProperty(e.id)},_registerEntity:function(e){if(this.isValidEntity(e)){this._entitiesList.push(e),(this._entities.h[e.id]=e).onComponentRemoved.handlers.push(Xr(this,this._onEntityRemoveComponent));var t=this.onEntityAdded.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}}},_onEntityRemoveComponent:function(e,t){this.isValidEntity(e)||this._removeEntity(e)},_removeEntity:function(e){$.remove(e.onComponentRemoved.handlers,Xr(this,this._onEntityRemoveComponent)),$.remove(this._entitiesList,e),this._entities.remove(e.id);var t=this.onEntityRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}},_removeAllEntities:function(){for(var e=0,t=this._entitiesList;e<t.length;){var i=t[e];++e,this._removeEntity(i)}},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;if(null!=this._scene){var t=this.onRemovedFromScene.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this._scene)}}if(this._scene=e,null!=this._scene){var n=this.onAddedToScene.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(this._scene)}}return this._scene},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),J.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),J.__pool__.safePut(this))},get___type__:function(){return J},get___typeName__:function(){return"gecko.systems.System"},__class__:J,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name",set_scene:"set_scene",get_scene:"get_scene"}});var ie={};(i["gecko.systems._System.SystemClass_Impl_"]=ie).__name__=!0,ie.__properties__={get___systemName__:"get___systemName__"},ie.get___systemName__=function(e){return e.__systemName__},ie.fromSystem=function(e){return e};var re=function(){this._drawingFixedOnCamera=!1,this._fixedToCamera=[],J.call(this)};(i["gecko.systems.draw.DrawSystem"]=re).__name__=!0,re.__interfaces__=[v,x],re.create=function(){var e=re.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},re.getPool=function(){return re.__pool__},re.__super__=J,re.prototype=n(J.prototype,{init:function(){this.filter.is(G),this.priority=5},beforeDestroy:function(){J.prototype.beforeDestroy.call(this),this.priority=5,this._fixedToCamera.length=0},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var r=i[t];++t,r.enabled&&r._renderer.update(e)}},draw:function(e){for(this._drawingFixedOnCamera=!1,this._draw(e,this._scene.rootEntity.transform,this._scene.rootEntity._renderer),this._drawingFixedOnCamera=!0;0<this._fixedToCamera.length;){var t=this._fixedToCamera.shift();this._draw(e,t._entity.transform,t)}},_draw:function(e,t,i){var r;if(!this._drawingFixedOnCamera&&t._fixedToCamera){var n=this._scene.currentCameraRendering;r=!(null!=n&&0<t._visibleOnCamera.length)||-1!=t._visibleOnCamera.indexOf(n.id)}else r=!1;if(r)this._fixedToCamera.push(i);else if(i.visible&&0<i.get_alpha()){e.apply(t.get_worldMatrix(),i.color,i.get_alpha()),i.preDraw(e),i.draw(e);for(var s=0,a=t._children;s<a.length;){var o=a[s];++s;var l=o.entity;null!=l&&this._entities.h.hasOwnProperty(l.id)&&i.visible&&0<i.get_alpha()&&this._draw(e,o,l._renderer)}e.apply(t.get_worldMatrix(),i.color,i.get_alpha()),i.postDraw(e)}},_canBeRendered:function(e){return null!=e._renderer&&e._renderer.visible},get___typeName__:function(){return"gecko.systems.draw.DrawSystem"},get___type__:function(){return re},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),re.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),re.__pool__.safePut(this))},__class__:re});var ne=function(){this._repeat=0,this._delayTime=0,this.elapsedTime=0,this.isPaused=!1,this.isEnded=!1,this.isStarted=!1,this.isActive=!1,this.delay=0,this.loop=!1,this.repeat=0,this.destroyOnEnd=!1,this.time=0,g.call(this);this.onStart={handlers:[]};this.onStop={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]};this.onInit={handlers:[]};this.onEnd={handlers:[]};this.onRepeat={handlers:[]};this.onUpdate={handlers:[]}};(i["gecko.timer.Timer"]=ne).__name__=!0,ne.create=function(e,t,i,r,n){null==r&&(r=0),null==i&&(i=!1),null==t&&(t=0);var s=ne.__pool__.get();return s.init(e,t,i,r,n),s.isAlreadyDestroyed=!1,s},ne.getPool=function(){return ne.__pool__},ne.__super__=g,ne.prototype=n(g.prototype,{init:function(e,t,i,r,n){null==r&&(r=0),null==i&&(i=!1),null==t&&(t=0),this.time=e,this.delay=t,this.loop=i,this.repeat=r,this.manager=null!=n?n:f.timerManager,this.manager.timers.push(this)},update:function(e){if(!(this.time<=0||!this.isActive||this.isPaused))if(this.delay>this._delayTime)this._delayTime+=e;else{if(!this.isStarted){this.isStarted=!0;var t=this.onInit.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r()}}if(this.time>this.elapsedTime){var n=this.elapsedTime+e,s=n>=this.time;this.elapsedTime=s?this.time:n;var a=this.onUpdate.handlers;if(0!=a.length)for(var o=0;o<a.length;){var l=a[o];++o,l(this.elapsedTime,e)}if(s){if(this.loop||this.repeat>this._repeat){this._repeat++,this.elapsedTime=0;var h=this.onRepeat.handlers;if(0!=h.length)for(var _=0;_<h.length;){var c=h[_];++_,c(this._repeat)}return}this.isEnded=!0,this.isActive=!1;var u=this.onEnd.handlers;if(0!=u.length)for(var d=0;d<u.length;){var f=u[d];++d,f()}}}}},start:function(){if(!this.isActive){this.isActive=!0;var e=this.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},stop:function(){if(this.isActive){this.isActive=!1,this.reset();var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},pause:function(){if(this.isActive&&!this.isPaused){this.isPaused=!0;var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},resume:function(){if(this.isActive&&this.isPaused){this.isPaused=!1;var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},reset:function(){this._repeat=0,this._delayTime=0,this.elapsedTime=0,this.isStarted=!1,this.isEnded=!1},clear:function(){this.time=0,this.isActive=!1,this.destroyOnEnd=!1,this.repeat=0,this.loop=!1,this.delay=0,this.isStarted=!1,this.isEnded=!1,this.isPaused=!1,this.elapsedTime=0,this._delayTime=0,this._repeat=0},remove:function(){if(null!=this.manager){var e=this.manager;e._isProcessing?e._timersToDelete.push(this):$.remove(e.timers,this)}},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this.manager&&this.remove(),this.clear(),de.clear(this.onInit),de.clear(this.onStart),de.clear(this.onStop),de.clear(this.onResume),de.clear(this.onPause),de.clear(this.onEnd),de.clear(this.onRepeat),de.clear(this.onUpdate)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ne.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ne.__pool__.safePut(this))},__class__:ne});var se=function(){this._unsubscribeAll=[],this._isParallelActive=!1,this.isPaused=!1,this.isActive=!1,this._repeat=0,this.loop=!1,this.repeat=0,this.timers=[],g.call(this);this.onProgress={handlers:[]};this.onRepeat={handlers:[]};this.onEnd={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.timer.TimerGroup"]=se).__name__=!0,se.create=function(e){var t=se.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},se.getPool=function(){return se.__pool__},se.__super__=g,se.prototype=n(g.prototype,{init:function(e){this.timers=e},addTimer:function(e){if(this.isActive)throw new dt("Timers can't be added after the group start.");if(e.isActive)throw new dt("Timers can't be active before added to a group");this.timers.push(e)},start:function(e){null==e&&(e=!1),this.isActive||this._start(e)},stop:function(e){null==e&&(e=!1),this.isActive&&this._stop()},pause:function(){if(this.isActive&&!this.isPaused){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.pause()}this.isPaused=!0;var r=this.onPause.handlers;if(0!=r.length)for(var n=0;n<r.length;){var s=r[n];++n,s()}}},resume:function(){if(this.isActive&&this.isPaused){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.resume()}var r=this.onResume.handlers;if(0!=r.length)for(var n=0;n<r.length;){var s=r[n];++n,s()}}},_start:function(e){var i=this;if(this.isActive=!0,this._isParallelActive=e,this._unsubscribeAll=[],e){ue.each_gecko_timer_Timer(this.timers,Xr(this,this._timerEndCallback),Xr(this,this._onEnd));for(var t=0,r=this.timers;t<r.length;){var n=r[t];++t,n.reset(),n.start()}}else ue.eachSeries_gecko_timer_Timer(this.timers,function(e,t){i._timerEndCallback(e,t),e.reset(),e.start()},Xr(this,this._onEnd))},_stop:function(e){null==e&&(e=!1);for(var t=0,i=this.timers;t<i.length;){var r=i[t];++t,r.stop(),r.reset()}this.isActive=!1,e&&(this._repeat=0);for(var n=0,s=this._unsubscribeAll;n<s.length;){var a=s[n];++n,a()}},_onProgress:function(e){var t=this.onProgress.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(e)}},_timerEndCallback:function(e,t){var i=this,r=null,n=r=function(){$.remove(e.onEnd.handlers,r),i._onProgress(e),t()};this._unsubscribeAll.push(function(){$.remove(e.onEnd.handlers,n)}),e.onEnd.handlers.push(n)},_onEnd:function(e){if(null!=e)throw new dt(e);if(this.loop||this.repeat>this._repeat){this._repeat++,this._stop(),this.start(this._isParallelActive);var t=this.onRepeat.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r(this._repeat)}}else{this._stop(!0);var n=this.onEnd.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a()}}},beforeDestroy:function(){g.prototype.beforeDestroy.call(this);for(var e=this.timers.pop();null!=e;)e.destroy(),e=this.timers.pop();for(;null!=this._unsubscribeAll.pop(););this.isActive=!1,this.isPaused=!1,this.repeat=0,this.loop=!1,this._repeat=0,de.clear(this.onProgress),de.clear(this.onRepeat),de.clear(this.onEnd),de.clear(this.onPause),de.clear(this.onResume)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),se.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),se.__pool__.safePut(this))},__class__:se});var ae=function(){this._isProcessing=!1,this._timersToDelete=[],this.timers=[],g.call(this)};(i["gecko.timer.TimerManager"]=ae).__name__=!0,ae.create=function(){var e=ae.__pool__.get();return e.isAlreadyDestroyed=!1,e},ae.getPool=function(){return ae.__pool__},ae.__super__=g,ae.prototype=n(g.prototype,{tick:function(e){this._isProcessing=!0;for(var t=0,i=this.timers;t<i.length;){var r=i[t];++t,r.isActive&&(r.update(e),r.isEnded&&r.destroyOnEnd&&r.destroy())}for(;0<this._timersToDelete.length;){var n=this._timersToDelete.shift();$.remove(this.timers,n)}this._isProcessing=!1},createTimer:function(e,t,i,r){null==r&&(r=0),null==i&&(i=!1),null==t&&(t=0);var n=ne.__pool__.get();return n.init(e,t,i,r,this),n.isAlreadyDestroyed=!1,n},createGroup:function(e){var t=se.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},removeTimer:function(e){this._isProcessing?this._timersToDelete.push(e):$.remove(this.timers,e)},clear:function(){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.clear()}},cleanTimers:function(){for(;0<this.timers.length;){this.timers.shift().destroy()}for(;0<this._timersToDelete.length;){this._timersToDelete.shift().destroy()}},_remove:function(e){$.remove(this.timers,e)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this.cleanTimers(),this._isProcessing=!1},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ae.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ae.__pool__.safePut(this))},__class__:ae});var oe=function(){};(i["gecko.tween.Easing"]=oe).__name__=!0,oe.linear=function(e){return e},oe.inQuad=function(e){return e*e},oe.outQuad=function(e){return e*(2-e)},oe.inOutQuad=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},oe.inCubic=function(e){return e*e*e},oe.outCubic=function(e){return--e*e*e+1},oe.inOutCubic=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},oe.inQuart=function(e){return e*e*e*e},oe.outQuart=function(e){return 1- --e*e*e*e},oe.inOutQuart=function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},oe.inQuint=function(e){return e*e*e*e*e},oe.outQuint=function(e){return--e*e*e*e*e+1},oe.inOutQuint=function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},oe.inSine=function(e){return 1-Math.cos(e*Math.PI/2)},oe.outSine=function(e){return Math.sin(e*Math.PI/2)},oe.inOutSine=function(e){return.5*(1-Math.cos(Math.PI*e))},oe.inExpo=function(e){return 0==e?0:Math.pow(1024,e-1)},oe.outExpo=function(e){return 1==e?1:1-Math.pow(2,-10*e)},oe.inOutExpo=function(e){return 0==e?0:1==e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},oe.inCirc=function(e){return 1-Math.sqrt(1-e*e)},oe.outCirc=function(e){return Math.sqrt(1- --e*e)},oe.inOutCirc=function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-2)*(e-2))+1)},oe.inElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<=1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)},oe.outElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<=1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1},oe.inOutElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)*.5+1},oe.inBack=function(e){return e*e*(2.70158*e-1.70158)},oe.outBack=function(e){return--e*e*(2.70158*e+1.70158)+1},oe.inOutBack=function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-2)*(e-2)*((t+1)*(e-2)+t)+2)},oe.inBounce=function(e){return 1-oe.outBounce(1-e)},oe.outBounce=function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},oe.inOutBounce=function(e){return e<.5?.5*(1-oe.outBounce(1-2*e)):.5*oe.outBounce(2*e-1)+.5};var le=function(){this._subtarget=[],this._subtargetFrom=[],this._subtargetTo=[],this._from={},this._to={},this._elapsedTime=0,this._delayTime=0,this._yoyo=!1,this.yoyo=!1,this._repeat=0,this.repeat=0,this.time=0,this.delay=0,this.loop=!1,this.easing=oe.linear,this.destroyOnEnd=!1,this.isPaused=!1,this.isStarted=!1,this.isEnded=!1,this.isActive=!1,g.call(this);this.onStart={handlers:[]};this.onStop={handlers:[]};this.onInit={handlers:[]};this.onEnd={handlers:[]};this.onUpdate={handlers:[]};this.onYoyo={handlers:[]};this.onRepeat={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.tween.Tween"]=le).__name__=!0,le.interpolate=function(e,t,i,r,n){return e+(t-e)*n(r/i)},le.create=function(e,t,i,r,n){var s=le.__pool__.get();return s.init(e,t,i,r,n),s.isAlreadyDestroyed=!1,s},le.getPool=function(){return le.__pool__},le.__super__=g,le.prototype=n(g.prototype,{init:function(e,t,i,r,n){this.target=e,this.easing=null!=r?r:oe.linear,this.manager=null!=n?n:f.tweenManager,this.manager.tweens.push(this),this.time=i,this._to=t},start:function(){if(!this.isActive){this.isActive=!0,this.reset();var e=this.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},stop:function(){if(this.isActive){this.isActive=!1,this.reset();var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},pause:function(){if(this.isActive&&!this.isPaused){this.isPaused=!0;var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},resume:function(){if(this.isActive&&this.isPaused){this.isPaused=!1;var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},_swapFromTo:function(){var e=this._subtargetTo,t=this._subtargetFrom;this._subtargetFrom=e,this._subtargetTo=t},setTo:function(e){this._to=e},setFrom:function(e){this._from=e},remove:function(){if(null!=this.manager){var e=this.manager;e._isProcessing?e._tweensToDelete.push(this):$.remove(e.tweens,this)}},reset:function(){if(this._elapsedTime=0,this._repeat=0,this._delayTime=0,this.isStarted=!1,this.isPaused=!1,this.isEnded=!1,this.yoyo&&this._yoyo){var e=this._subtargetTo,t=this._subtargetFrom;this._subtargetFrom=e,this._subtargetTo=t,this._yoyo=!1}},_canUpdate:function(){return!(!(0<this.time&&this.isActive)||this.isPaused)&&null!=this.target},update:function(e){if(0<this.time&&this.isActive&&!this.isPaused&&null!=this.target)if(this.delay>this._delayTime)this._delayTime+=e;else{if(!this.isStarted){this._parseTweenData(),this.isStarted=!0;var t=this.onInit.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r()}}if(this._subtarget.length<=0)return this.stop(),void this.reset();var n=this.yoyo?this.time/2:this.time;if(n>this._elapsedTime){var s=this._elapsedTime+e,a=n<=s;this._elapsedTime=a?n:s;for(var o=0,l=this._subtarget.length;o<l;){var h=o++;this._apply(this._subtargetTo[h],this._subtargetFrom[h],n,this._subtarget[h])}var _=this._yoyo?n+this._elapsedTime:this._elapsedTime,c=this.onUpdate.handlers;if(0!=c.length)for(var u=0;u<c.length;){var d=c[u];++u,d(_)}if(a){if(this.yoyo&&!this._yoyo){this._yoyo=!0;var f=this._subtargetTo,g=this._subtargetFrom;this._subtargetFrom=f,this._subtargetTo=g;var v=this.onYoyo.handlers;if(0!=v.length)for(var p=0;p<v.length;){var m=v[p];++p,m()}return void(this._elapsedTime=0)}if(this.loop||this.repeat>this._repeat){this._repeat++;var y=this.onRepeat.handlers;if(0!=y.length)for(var b=0;b<y.length;){var w=y[b];++b,w(this._repeat)}if(this._elapsedTime=0,this.yoyo&&this._yoyo){var x=this._subtargetTo,B=this._subtargetFrom;this._subtargetFrom=x,this._subtargetTo=B,this._yoyo=!1}return}this.isEnded=!0,this.isActive=!1;var S=this.onEnd.handlers;if(0!=S.length)for(var T=0;T<S.length;){var k=S[T];++T,k()}}}else;}},_parseTweenData:function(){this.isStarted||this._parse(this._to,this._from,this.target)},_parse:function(e,t,i){for(var r=null,n=null,s=null,a=0,o=U.fields(e);a<o.length;){var l=o[a];++a;var h=U.getProperty(e,l),_=U.getProperty(t,l),c=U.getProperty(i,l);if(U.isObject(h))this._parse(h,_,c);else{null==r&&(r=i,n=new Ie,s=new Ie),null!=$r[l]?n.setReserved(l,h):n.h[l]=h;var u=null==_?c:_;null!=$r[l]?s.setReserved(l,u):s.h[l]=u}}null!=r&&(this._subtarget.push(r),this._subtargetTo.push(n),this._subtargetFrom.push(s))},_apply:function(e,t,i,r){for(var n=e.keys();n.hasNext();){var s=n.next(),a=null!=$r[s]?t.getReserved(s):t.h[s],o=(null!=$r[s]?e.getReserved(s):e.h[s])-a,l=i,h=this._elapsedTime/l;U.setProperty(r,s,a+o*this.easing(h))}},clear:function(){this.target=null,this.time=0,this.isActive=!1,this.easing=oe.linear,this.destroyOnEnd=!1,this.repeat=0,this.loop=!1,this.delay=0,this.yoyo=!1,this.isStarted=!1,this.isPaused=!1,this.isEnded=!1,this._to=null,this._from=null,this._delayTime=0,this._elapsedTime=0,this._repeat=0,this._yoyo=!1,this._subtarget.length=0,this._subtargetFrom.length=0,this._subtargetTo.length=0},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this.manager&&this.remove(),this.clear(),de.clear(this.onInit),de.clear(this.onStart),de.clear(this.onStop),de.clear(this.onResume),de.clear(this.onPause),de.clear(this.onEnd),de.clear(this.onRepeat),de.clear(this.onUpdate),de.clear(this.onYoyo)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),le.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),le.__pool__.safePut(this))},__class__:le});var he=function(){this._unsubscribeAll=[],this.isParallelActive=!1,this.isPaused=!1,this.isActive=!1,this._yoyo=!1,this._repeat=0,this.loop=!1,this.repeat=0,this.yoyo=!1,this.tweens=[],g.call(this);this.onProgress={handlers:[]};this.onRepeat={handlers:[]};this.onYoyo={handlers:[]};this.onEnd={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.tween.TweenGroup"]=he).__name__=!0,he.create=function(e){var t=he.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},he.getPool=function(){return he.__pool__},he.__super__=g,he.prototype=n(g.prototype,{init:function(e){this.tweens=e},addTween:function(e){if(this.isActive)throw new dt("Error: tweens can't be added after the group start.");if(e.isActive)throw new dt("Error: tweens can't be active before added to a group");this.tweens.push(e)},start:function(e){null==e&&(e=!1),this.isActive||this._start(e)},_start:function(e,t){null==t&&(t=!1);var i=this;this.isActive=!0,this.isParallelActive=e,this._unsubscribeAll=[];var r=t?this.tweens.slice():this.tweens;if(t&&r.reverse(),e){ue.each_gecko_tween_Tween(r,Xr(this,this._tweenEndCallback),Xr(this,this._onEnd));for(var n=0;n<r.length;){var s=r[n];++n,s.reset(),s.start()}}else ue.eachSeries_gecko_tween_Tween(r,function(e,t){i._tweenEndCallback(e,t),e.reset(),e.start()},Xr(this,this._onEnd))},stop:function(){this.isActive&&this._stop()},_stop:function(e){null==e&&(e=!1);for(var t=0,i=this.tweens;t<i.length;){var r=i[t];++t,r.stop(),r.reset()}this.isActive=!1,e&&(this._repeat=0,this._yoyo=!1);for(var n=0,s=this._unsubscribeAll;n<s.length;){var a=s[n];++n,a()}},pause:function(){if(this.isActive&&!this.isPaused){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.pause()}this.isPaused=!0;var r=this.onPause.handlers;if(0!=r.length)for(var n=0;n<r.length;){var s=r[n];++n,s()}}},resume:function(){if(this.isActive&&this.isPaused){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.resume()}this.isPaused=!1;var r=this.onResume.handlers;if(0!=r.length)for(var n=0;n<r.length;){var s=r[n];++n,s()}}},_tweenEndCallback:function(r,n){var s=this,e=function(){var e=s.onProgress.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(r)}n()};this._unsubscribeAll.push(function(){$.remove(r.onEnd.handlers,e)}),r.onEnd.handlers.push(e)},_onEnd:function(e){if(null!=e)throw new dt(e);if(this.yoyo&&!this._yoyo){this._yoyo=!0,this._stop(),this._start(this.isParallelActive,!0);var t=this.onYoyo.handlers;if(0!=t.length)for(var i=0;i<t.length;){var r=t[i];++i,r()}}else if(this.loop||this.repeat>this._repeat){this._repeat++,this._yoyo=!1,this._stop(),this.start(this.isParallelActive);var n=this.onRepeat.handlers;if(0!=n.length)for(var s=0;s<n.length;){var a=n[s];++s,a(this._repeat)}}else{this._stop(!0);var o=this.onEnd.handlers;if(0!=o.length)for(var l=0;l<o.length;){var h=o[l];++l,h()}}},beforeDestroy:function(){g.prototype.beforeDestroy.call(this);for(var e=this.tweens.pop();null!=e;)e.destroy(),e=this.tweens.pop();for(;null!=this._unsubscribeAll.pop(););this.isActive=!1,this.isPaused=!1,this.isParallelActive=!1,this.yoyo=!1,this.repeat=0,this.loop=!1,this._repeat=0,this._yoyo=!1,de.clear(this.onEnd),de.clear(this.onRepeat),de.clear(this.onProgress),de.clear(this.onPause),de.clear(this.onYoyo),de.clear(this.onResume)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),he.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),he.__pool__.safePut(this))},__class__:he});var _e=function(){this._isProcessing=!1,this._tweensToDelete=[],this.tweens=[],g.call(this)};(i["gecko.tween.TweenManager"]=_e).__name__=!0,_e.create=function(){var e=_e.__pool__.get();return e.isAlreadyDestroyed=!1,e},_e.getPool=function(){return _e.__pool__},_e.__super__=g,_e.prototype=n(g.prototype,{tick:function(e){this._isProcessing=!0;for(var t=0,i=this.tweens;t<i.length;){var r=i[t];++t,r.isActive&&(r.update(e),r.isEnded&&r.destroyOnEnd&&r.destroy())}for(;0<this._tweensToDelete.length;){var n=this._tweensToDelete.shift();$.remove(this.tweens,n)}this._isProcessing=!1},createTween:function(e,t,i,r){var n=le.__pool__.get();return n.init(e,t,i,r,this),n.isAlreadyDestroyed=!1,n},createGroup:function(e){var t=he.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},removeTween:function(e){this._isProcessing?this._tweensToDelete.push(e):$.remove(this.tweens,e)},clear:function(){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.clear()}},cleanTweens:function(){for(;0<this.tweens.length;){this.tweens.shift().destroy()}for(;0<this._tweensToDelete.length;){this._tweensToDelete.shift().destroy()}},_remove:function(e){$.remove(this.tweens,e)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this.cleanTweens(),this._isProcessing=!1},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void f._destroyCallbacks.push(Xr(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),_e.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),_e.__pool__.safePut(this))},__class__:_e});var ce=function(){};(i["gecko.utils.ArrayHelper"]=ce).__name__=!0,ce.clear=function(e){e.length=0},ce.has=function(e,t){return-1!=e.indexOf(t)};var ue=function(){};(i["gecko.utils.Chain"]=ue).__name__=!0,ue.eachSeries_gecko_timer_Timer=function(e,n,s){var t=function(){s()},i=e.slice();i.reverse();for(var r=0,a=i.length;r<a;){t=function(i,r){return function(){var t,e=(t=i,function(e){null==e?t[0]():s(e)});n(r[0],e)}}([t],[i[r++]])}t()},ue.each_gecko_timer_Timer=function(t,e,i){for(var r=0,n=!1,s=0,a=t.length;s<a;){var o=s++;if(n)break;e(t[o],function(e){if(!n){if(null!=e&&""!=e)return n=!0,void i(e);(r+=1)==t.length&&i()}})}},ue.eachSeries_gecko_tween_Tween=function(e,n,s){var t=function(){s()},i=e.slice();i.reverse();for(var r=0,a=i.length;r<a;){t=function(i,r){return function(){var t,e=(t=i,function(e){null==e?t[0]():s(e)});n(r[0],e)}}([t],[i[r++]])}t()},ue.each_gecko_tween_Tween=function(t,e,i){for(var r=0,n=!1,s=0,a=t.length;s<a;){var o=s++;if(n)break;e(t[o],function(e){if(!n){if(null!=e&&""!=e)return n=!0,void i(e);(r+=1)==t.length&&i()}})}};var de={};(i["gecko.utils._Event.Event_Impl_"]=de).__name__=!0,de.__properties__={get_handlers:"get_handlers"},de.get_handlers=function(e){return e.handlers},de.create=function(){return{handlers:[]}},de._new=function(e){return e},de.clear=function(e){0!=e.handlers.length&&(e.handlers=[])},de.on=function(e,t){e.handlers.push(t)},de.off=function(e,t){$.remove(e.handlers,t)};var fe=function(e){null==e&&(e=!1),this.isFixed=!1,this._last=0,this._elapsed=0,this._frames=0,this.timeToMeasure=1,this.ms=0,this.fps=0,this.delta=0,this.isFixed=e,this._last=e?P.time():P.realTime()};(i["gecko.utils.FPSCounter"]=fe).__name__=!0,fe.prototype={tick:function(){var e=this.isFixed?P.time():P.realTime();this._frames++,this.delta=e-this._last,this._elapsed+=this.delta,this._last=e,this._elapsed>=this.timeToMeasure&&(this.fps=Math.round(this._frames/this._elapsed*100)/100,this.ms=Math.round(this._elapsed/this._frames*1e3),this._frames=0,this._elapsed=0)},clear:function(){this._frames=0,this._elapsed=0,this._last=this.isFixed?P.time():P.realTime()},__class__:fe};var ge=function(){};(i["gecko.utils.MathHelper"]=ge).__name__=!0,ge.toDegrees=function(e){return e*ge._rad2deg},ge.toRadians=function(e){return e*ge._deg2rad},ge.clamp=function(e,t,i){return e<t?t:i<e?i:e},ge.clampInt=function(e,t,i){return e<t?t:i<e?i:e},ge.lerp=function(e,t,i){return(1-e)*t+e*i},ge.inverseLerp=function(e,t,i){return(e-t)/(i-t)},ge.inheritTransform=function(e,t,i){e._00=t._00*i._00+t._01*i._10,e._01=t._00*i._01+t._01*i._11,e._10=t._10*i._00+t._11*i._10,e._11=t._10*i._01+t._11*i._11,e._20=t._20*i._00+t._21*i._10+i._20,e._21=t._20*i._01+t._21*i._11+i._21};var ve=function(){};(i["haxe.IMap"]=ve).__name__=!0,ve.prototype={__class__:ve};var pe=function(e,t){this.high=e,this.low=t};(i["haxe._Int64.___Int64"]=pe).__name__=!0,pe.prototype={__class__:pe};var me=function(){};(i["haxe.Log"]=me).__name__=!0,me.trace=function(e,t){Re.__trace(e,t)};var ye=function(){};(i["haxe._Unserializer.DefaultResolver"]=ye).__name__=!0,ye.prototype={resolveClass:function(e){return te.resolveClass(e)},resolveEnum:function(e){return te.resolveEnum(e)},__class__:ye};var be=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=be.DEFAULT_RESOLVER;null==t&&(t=new ye,be.DEFAULT_RESOLVER=t),this.resolver=t};(i["haxe.Unserializer"]=be).__name__=!0,be.initCodes=function(){for(var e=[],t=0,i=be.BASE64.length;t<i;){var r=t++;e[be.BASE64.charCodeAt(r)]=r}return e},be.run=function(e){return new be(e).unserialize()},be.prototype={readDigits:function(){for(var e=0,t=!1,i=this.pos;;){var r=this.buf.charCodeAt(this.pos);if(r!=r)break;if(45!=r){if(r<48||57<r)break;e=10*e+(r-48),this.pos++}else{if(this.pos!=i)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return parseFloat($.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new dt("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new dt("Invalid object key");var i=this.unserialize();e[t]=i}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new dt("Invalid enum format");var i=this.readDigits();if(0==i)return te.createEnum(e,t);for(var r=[];0<i--;)r.push(this.unserialize());return te.createEnum(e,t,r)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new dt("Class not found "+e);return t;case 66:var i=this.unserialize(),r=this.resolver.resolveEnum(i);if(null==r)throw new dt("Enum not found "+i);return r;case 67:var n=this.unserialize(),s=this.resolver.resolveClass(n);if(null==s)throw new dt("Class not found "+n);var a=te.createEmptyInstance(s);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new dt("Invalid custom data");return a;case 77:var o=new Se;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw new dt("Invalid string reference");return this.scache[h];case 97:this.buf;var _=[];for(this.cache.push(_);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var u=this.readDigits();_[_.length+u-1]=null}else _.push(this.unserialize())}return _;case 98:var d=new Ie;this.cache.push(d);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var f=this.unserialize(),g=this.unserialize();null!=$r[f]?d.setReserved(f,g):d.h[f]=g}return this.pos++,d;case 99:var v=this.unserialize(),p=this.resolver.resolveClass(v);if(null==p)throw new dt("Class not found "+v);var m=te.createEmptyInstance(p);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var y=this.unserialize(),b=this.resolver.resolveEnum(y);if(null==b)throw new dt("Enum not found "+y);this.pos++;var w=this.readDigits(),x=b.__constructs__.slice()[w];if(null==x)throw new dt("Unknown enum index "+y+"@"+w);var B=this.unserializeEnum(b,x);return this.cache.push(B),B;case 107:return NaN;case 108:var S=new ee;this.cache.push(S);for(this.buf;104!=this.buf.charCodeAt(this.pos);)S.add(this.unserialize());return this.pos++,S;case 109:return-1/0;case 110:return null;case 111:var T={};return this.cache.push(T),this.unserializeObject(T),T;case 112:return 1/0;case 113:var k=new Be;this.cache.push(k);this.buf;for(var I=this.buf.charCodeAt(this.pos++);58==I;){var A=this.readDigits(),C=this.unserialize();k.h[A]=C,I=this.buf.charCodeAt(this.pos++)}if(104!=I)throw new dt("Invalid IntMap format");return k;case 114:var D=this.readDigits();if(D<0||D>=this.cache.length)throw new dt("Invalid reference");return this.cache[D];case 115:var P=this.readDigits(),E=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<P)throw new dt("Invalid bytes length");var N=be.CODES;null==N&&(N=be.initCodes(),be.CODES=N);for(var M=this.pos,L=3&P,R=M+(P-L),V=new Te(new en(3*(P>>2)+(2<=L?L-1:0))),F=0;M<R;){var G=N[E.charCodeAt(M++)],U=N[E.charCodeAt(M++)];V.b[F++]=255&(G<<2|U>>4);var O=N[E.charCodeAt(M++)];V.b[F++]=255&(U<<4|O>>2);var W=N[E.charCodeAt(M++)];V.b[F++]=255&(O<<6|W)}if(2<=L){var z=N[E.charCodeAt(M++)],H=N[E.charCodeAt(M++)];if(V.b[F++]=255&(z<<2|H>>4),3==L){var Z=N[E.charCodeAt(M++)];V.b[F++]=255&(H<<4|Z>>2)}}return this.pos+=P,this.cache.push(V),V;case 116:return!0;case 118:var X;if(48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))X=$.strDate($.substr(this.buf,this.pos,19)),this.pos+=19;else{var j=this.readFloat();X=new Date(j)}return this.cache.push(X),X;case 119:var K=this.unserialize(),Y=this.resolver.resolveEnum(K);if(null==Y)throw new dt("Enum not found "+K);var Q=this.unserializeEnum(Y,this.unserialize());return this.cache.push(Q),Q;case 120:throw dt.wrap(this.unserialize());case 121:var q=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<q)throw new dt("Invalid string length");var J=$.substr(this.buf,this.pos,q);return this.pos+=q,J=decodeURIComponent(J.split("+").join(" ")),this.scache.push(J),J;case 122:return 0}throw this.pos--,new dt("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:be};var Te=function(e){this.length=e.byteLength,this.b=new sn(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(i["haxe.io.Bytes"]=Te).__name__=!0,Te.ofString=function(e){for(var t=[],i=0;i<e.length;){var r=e.charCodeAt(i++);55296<=r&&r<=56319&&(r=r-55232<<10|1023&e.charCodeAt(i++)),r<=127?t.push(r):(r<=2047?t.push(192|r>>6):(r<=65535?t.push(224|r>>12):(t.push(240|r>>18),t.push(128|r>>12&63)),t.push(128|r>>6&63)),t.push(128|63&r))}return new Te(new sn(t).buffer)},Te.ofData=function(e){var t=e.hxBytes;return null!=t?t:new Te(e)},Te.prototype={blit:function(e,t,i,r){if(e<0||i<0||r<0||e+r>this.length||i+r>t.length)throw new dt(Me.OutsideBounds);0==i&&r==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(i,i+r),e)},sub:function(e,t){if(e<0||t<0||e+t>this.length)throw new dt(Me.OutsideBounds);return new Te(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))},getDouble:function(e){return null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(e,!0)},getFloat:function(e){return null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},setDouble:function(e,t){null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(e,t,!0)},setFloat:function(e,t){null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(e,t,!0)},getUInt16:function(e){return null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(e,!0)},getInt32:function(e){return null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new rn(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new dt(Me.OutsideBounds);for(var i="",r=this.b,n=String.fromCharCode,s=e,a=e+t;s<a;){var o=r[s++];if(o<128){if(0==o)break;i+=n(o)}else if(o<224)i+=n((63&o)<<6|127&r[s++]);else if(o<240){i+=n((31&o)<<12|(127&r[s++])<<6|127&r[s++])}else{var l=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];i+=n(55232+(l>>10)),i+=n(1023&l|56320)}}return i},toString:function(){return this.getString(0,this.length)},__class__:Te};var we=function(){};(i["haxe.crypto.Base64"]=we).__name__=!0,we.encode=function(e,t){null==t&&(t=!0);var i=new xe(we.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:i+="==";break;case 2:i+="="}return i};var xe=function(e){for(var t=e.length,i=1;1<<i<t;)++i;if(8<i||t!=1<<i)throw new dt("BaseCode : base length must be a power of two.");this.base=e,this.nbits=i};(i["haxe.crypto.BaseCode"]=xe).__name__=!0,xe.prototype={encodeBytes:function(e){for(var t=this.nbits,i=this.base,r=8*e.length/t|0,n=new Te(new en(r+(8*e.length%t==0?0:1))),s=0,a=0,o=(1<<t)-1,l=0,h=0;h<r;){for(;a<t;)a+=8,s<<=8,s|=e.b[l++];a-=t,n.b[h++]=255&i.b[s>>a&o]}return 0<a&&(n.b[h++]=255&i.b[s<<t-a&o]),n},__class__:xe};var Be=function(){this.h={}};(i["haxe.ds.IntMap"]=Be).__name__=!0,Be.__interfaces__=[ve],Be.prototype={get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return $.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e]}}},__class__:Be};var Se=function(){this.h={__keys__:{}}};(i["haxe.ds.ObjectMap"]=Se).__name__=!0,Se.__interfaces__=[ve],Se.prototype={set:function(e,t){var i=e.__id__||(e.__id__=++Se.count);this.h[i]=t,this.h.__keys__[i]=e},get:function(e){return this.h[e.__id__]},exists:function(e){return null!=this.h.__keys__[e.__id__]},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return $.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e.__id__]}}},__class__:Se};var ke=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};(i["haxe.ds._StringMap.StringMapIterator"]=ke).__name__=!0,ke.prototype={hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=$r[t]?e.getReserved(t):e.h[t]},__class__:ke};var Ie=function(){this.h={}};(i["haxe.ds.StringMap"]=Ie).__name__=!0,Ie.__interfaces__=[ve],Ie.prototype={get:function(e){return null!=$r[e]?this.getReserved(e):this.h[e]},exists:function(e){return null!=$r[e]?this.existsReserved(e):this.h.hasOwnProperty(e)},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=$r[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return $.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new ke(this,this.arrayKeys())},__class__:Ie};var Ae=function(){this.b=[]};(i["haxe.io.BytesBuffer"]=Ae).__name__=!0,Ae.prototype={getBytes:function(){var e=new Te(new sn(this.b).buffer);return this.b=null,e},__class__:Ae};var Ce=function(){};(i["haxe.io.Input"]=Ce).__name__=!0,Ce.prototype={readByte:function(){throw new dt("Not implemented")},readBytes:function(e,t,i){var r=i,n=e.b;if(t<0||i<0||t+i>e.length)throw new dt(Me.OutsideBounds);try{for(;0<r;)n[t]=this.readByte(),++t,--r}catch(e){if(e instanceof dt&&(e=e.val),!Re.__instanceof(e,Ne))throw e}return i-r},readFullBytes:function(e,t,i){for(;0<i;){var r=this.readBytes(e,t,i);if(0==r)throw new dt(Me.Blocked);t+=r,i-=r}},read:function(e){for(var t=new Te(new en(e)),i=0;0<e;){var r=this.readBytes(t,i,e);if(0==r)throw new dt(Me.Blocked);i+=r,e-=r}return t},readInt32:function(){var e=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte();return this.bigEndian?r|i<<8|t<<16|e<<24:e|t<<8|i<<16|r<<24},readString:function(e){var t=new Te(new en(e));return this.readFullBytes(t,0,e),t.toString()},__class__:Ce};var De=function(e,t,i){if(null==t&&(t=0),null==i&&(i=e.length-t),t<0||i<0||t+i>e.length)throw new dt(Me.OutsideBounds);this.b=e.b,this.pos=t,this.len=i,this.totlen=i};(i["haxe.io.BytesInput"]=De).__name__=!0,De.__super__=Ce,De.prototype=n(Ce.prototype,{set_position:function(e){return e<0?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(0==this.len)throw new dt(new Ne);return this.len--,this.b[this.pos++]},readBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new dt(Me.OutsideBounds);if(0==this.len&&0<i)throw new dt(new Ne);this.len<i&&(i=this.len);for(var r=this.b,n=e.b,s=0,a=i;s<a;){var o=s++;n[t+o]=r[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:De,__properties__:{set_position:"set_position"}});var Pe=function(){};(i["haxe.io.Output"]=Pe).__name__=!0,Pe.prototype={writeByte:function(e){throw new dt("Not implemented")},writeBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new dt(Me.OutsideBounds);for(var r=e.b,n=i;0<n;)this.writeByte(r[t]),++t,--n;return i},write:function(e){for(var t=e.length,i=0;0<t;){var r=this.writeBytes(e,i,t);if(0==r)throw new dt(Me.Blocked);i+=r,t-=r}},writeFloat:function(e){this.writeInt32(Le.floatToI32(e))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:Pe};var Ee=function(){this.b=new Ae};(i["haxe.io.BytesOutput"]=Ee).__name__=!0,Ee.__super__=Pe,Ee.prototype=n(Pe.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,i){var r=this.b;if(t<0||i<0||t+i>e.length)throw new dt(Me.OutsideBounds);r.b;for(var n=e.b,s=t,a=t+i;s<a;){var o=s++;r.b.push(n[o])}return i},getBytes:function(){return this.b.getBytes()},__class__:Ee});var Ne=function(){};(i["haxe.io.Eof"]=Ne).__name__=!0,Ne.prototype={toString:function(){return"Eof"},__class__:Ne};var Me=i["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Me.Blocked=["Blocked",0],Me.Blocked.toString=r,(Me.Blocked.__enum__=Me).Overflow=["Overflow",1],Me.Overflow.toString=r,(Me.Overflow.__enum__=Me).OutsideBounds=["OutsideBounds",2],Me.OutsideBounds.toString=r,(Me.OutsideBounds.__enum__=Me).Custom=function(e){var t=["Custom",3,e];return t.__enum__=Me,t.toString=r,t};var Le=function(){};(i["haxe.io.FPHelper"]=Le).__name__=!0,Le.i32ToFloat=function(e){var t=e>>>23&255,i=8388607&e;return 0==i&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*i)*Math.pow(2,t-127)},Le.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,i=Math.floor(Math.log(t)/.6931471805599453);i<-127?i=-127:128<i&&(i=128);var r=Math.round(8388608*(t/Math.pow(2,i)-1));return 8388608==r&&i<128&&(r=0,++i),(e<0?-2147483648:0)|i+127<<23|r},Le.i64ToDouble=function(e,t){var i=(t>>20&2047)-1023,r=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==r&&-1023==i?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*r)*Math.pow(2,i)},Le.doubleToI64=function(e){var t=Le.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var i=e<0?-e:e,r=Math.floor(Math.log(i)/.6931471805599453),n=Math.round(4503599627370496*(i/Math.pow(2,r)-1)),s=0|n,a=n/4294967296|0;t.low=s,t.high=(e<0?-2147483648:0)|r+1023<<20|a}else 0<e?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var dt=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,dt)};(i["js._Boot.HaxeError"]=dt).__name__=!0,dt.wrap=function(e){return e instanceof Error?e:new dt(e)},dt.__super__=Error,dt.prototype=n(Error.prototype,{__class__:dt});var Re=function(){};(i["js.Boot"]=Re).__name__=!0,Re.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},Re.__trace=function(e,t){var i,r=null!=t?t.fileName+":"+t.lineNumber+": ":"";if(r+=Re.__string_rec(e,""),null!=t&&null!=t.customParams)for(var n=0,s=t.customParams;n<s.length;){var a=s[n];++n,r+=","+Re.__string_rec(a,"")}"undefined"!=typeof document&&null!=(i=document.getElementById("haxe:trace"))?i.innerHTML+=Re.__unhtml(r)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(r)},Re.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var i=Re.__nativeClassName(e);return null!=i?Re.__resolveNativeClass(i):null},Re.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var r=e[0]+"(";t+="\t";for(var n=2,s=e.length;n<s;){var a=n++;r+=2!=a?","+Re.__string_rec(e[a],t):Re.__string_rec(e[a],t)}return r+")"}var o="[";t+="\t";for(var l=0,h=e.length;l<h;){var _=l++;o+=(0<_?",":"")+Re.__string_rec(e[_],t)}return o+="]"}var c;try{c=e.toString}catch(e){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var u=e.toString();if("[object Object]"!=u)return u}var d=null,f="{\n";t+="\t";var g=null!=e.hasOwnProperty;for(var d in e)g&&!e.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=f.length&&(f+=", \n"),f+=t+d+" : "+Re.__string_rec(e[d],t));return f+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},Re.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var i=e.__interfaces__;if(null!=i)for(var r=0,n=i.length;r<n;){var s=i[r++];if(s==t||Re.__interfLoop(s,t))return!0}return Re.__interfLoop(e.__super__,t)},Re.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case Qr:return"boolean"==typeof e;case Kr:return!0;case Yr:return"number"==typeof e;case jr:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(Re.__interfLoop(Re.getClass(e),t))return!0}else if("object"==typeof t&&Re.__isNativeObj(t)&&e instanceof t)return!0;return t==qr&&null!=e.__name__||(t==Jr&&null!=e.__ename__||e.__enum__==t)}},Re.__cast=function(e,t){if(Re.__instanceof(e,t))return e;throw new dt("Cannot cast "+E.string(e)+" to "+E.string(t))},Re.__nativeClassName=function(e){var t=Re.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},Re.__isNativeObj=function(e){return null!=Re.__nativeClassName(e)},Re.__resolveNativeClass=function(e){return t[e]};var Ve=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var i=0,r=t;i<r;){var n=i++;this.a[n]=0}this.byteLength=t}};(i["js.html.compat.ArrayBuffer"]=Ve).__name__=!0,Ve.sliceImpl=function(e,t){var i=new sn(this,e,null==t?null:t-e),r=new en(i.byteLength);return new sn(r).set(i),r},Ve.prototype={slice:function(e,t){return new Ve(this.a.slice(e,t))},__class__:Ve};var Fe=function(e,t,i){if(this.buf=e,this.offset=null==t?0:t,this.length=null==i?e.byteLength-this.offset:i,this.offset<0||this.length<0||this.offset+this.length>e.byteLength)throw new dt(Me.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};(i["js.html.compat.DataView"]=Fe).__name__=!0,Fe.prototype={getInt8:function(e){var t=this.buf.a[this.offset+e];return 128<=t?t-256:t},getUint8:function(e){return this.buf.a[this.offset+e]},getInt16:function(e,t){var i=this.getUint16(e,t);return 32768<=i?i-65536:i},getUint16:function(e,t){return t?this.buf.a[this.offset+e]|this.buf.a[this.offset+e+1]<<8:this.buf.a[this.offset+e]<<8|this.buf.a[this.offset+e+1]},getInt32:function(e,t){var i=this.offset+e,r=this.buf.a[i++],n=this.buf.a[i++],s=this.buf.a[i++],a=this.buf.a[i++];return t?r|n<<8|s<<16|a<<24:a|s<<8|n<<16|r<<24},getUint32:function(e,t){var i=this.getInt32(e,t);return i<0?i+4294967296:i},getFloat32:function(e,t){return Le.i32ToFloat(this.getInt32(e,t))},getFloat64:function(e,t){var i=this.getInt32(e,t),r=this.getInt32(e+4,t);return Le.i64ToDouble(t?i:r,t?r:i)},setInt8:function(e,t){this.buf.a[e+this.offset]=t<0?t+128&255:255&t},setUint8:function(e,t){this.buf.a[e+this.offset]=255&t},setInt16:function(e,t,i){this.setUint16(e,t<0?t+65536:t,i)},setUint16:function(e,t,i){var r=e+this.offset;i?(this.buf.a[r]=255&t,this.buf.a[r++]=t>>8&255):(this.buf.a[r++]=t>>8&255,this.buf.a[r]=255&t)},setInt32:function(e,t,i){this.setUint32(e,t,i)},setUint32:function(e,t,i){var r=e+this.offset;i?(this.buf.a[r++]=255&t,this.buf.a[r++]=t>>8&255,this.buf.a[r++]=t>>16&255,this.buf.a[r++]=t>>>24):(this.buf.a[r++]=t>>>24,this.buf.a[r++]=t>>16&255,this.buf.a[r++]=t>>8&255,this.buf.a[r++]=255&t)},setFloat32:function(e,t,i){this.setUint32(e,Le.floatToI32(t),i)},setFloat64:function(e,t,i){var r=Le.doubleToI64(t);i?(this.setUint32(e,r.low),this.setUint32(e,r.high)):(this.setUint32(e,r.high),this.setUint32(e,r.low))},__class__:Fe};var Ge=function(){};(i["js.html.compat.Float32Array"]=Ge).__name__=!0,Ge._new=function(e,t,i){var r;if("number"==typeof e){r=[];for(var n=0,s=e;n<s;){r[n++]=0}r.byteLength=r.length<<2;for(var a=[],o=r.byteOffset=0,l=r.length<<2;o<l;){o++;a.push(0)}r.buffer=new Ve(a)}else if(Re.__instanceof(e,Ve)){var h=e;null==t&&(t=0),null==i&&(i=h.byteLength-t>>2),r=[];for(var _=0,c=i;_<c;){_++;var u=h.a[t++]|h.a[t++]<<8|h.a[t++]<<16|h.a[t++]<<24;r.push(Le.i32ToFloat(u))}r.byteLength=r.length<<2,r.byteOffset=t,r.buffer=h}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO "+E.string(e));r=e.slice();for(var d=[],f=0;f<r.length;){var g=r[f];++f;var v=Le.floatToI32(g);d.push(255&v),d.push(v>>8&255),d.push(v>>16&255),d.push(v>>>24)}r.byteLength=r.length<<2,r.byteOffset=0,r.buffer=new Ve(d)}return r.subarray=Ge._subarray,r.set=Ge._set,r},Ge._set=function(e,t){if(Re.__instanceof(e.buffer,Ve)){var i=e;if(e.byteLength+t>this.byteLength)throw new dt("set() outside of range");for(var r=0,n=e.byteLength;r<n;){var s=r++;this[s+t]=i[s]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO");var a=e;if(a.length+t>this.byteLength)throw new dt("set() outside of range");for(var o=0,l=a.length;o<l;){var h=o++;this[h+t]=a[h]}}},Ge._subarray=function(e,t){var i=Ge._new(this.slice(e,t));return i.byteOffset=4*e,i};var Ue=function(){};(i["js.html.compat.Uint8Array"]=Ue).__name__=!0,Ue._new=function(e,t,i){var r;if("number"==typeof e){r=[];for(var n=0,s=e;n<s;){r[n++]=0}r.byteLength=r.length,r.byteOffset=0,r.buffer=new Ve(r)}else if(Re.__instanceof(e,Ve)){var a=e;null==t&&(t=0),null==i&&(i=a.byteLength-t),(r=0==t?a.a:a.a.slice(t,t+i)).byteLength=r.length,r.byteOffset=t,r.buffer=a}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO "+E.string(e));(r=e.slice()).byteLength=r.length,r.byteOffset=0,r.buffer=new Ve(r)}return r.subarray=Ue._subarray,r.set=Ue._set,r},Ue._set=function(e,t){if(Re.__instanceof(e.buffer,Ve)){var i=e;if(e.byteLength+t>this.byteLength)throw new dt("set() outside of range");for(var r=0,n=e.byteLength;r<n;){var s=r++;this[s+t]=i[s]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO");var a=e;if(a.length+t>this.byteLength)throw new dt("set() outside of range");for(var o=0,l=a.length;o<l;){var h=o++;this[h+t]=a[h]}}},Ue._subarray=function(e,t){var i=Ue._new(this.slice(e,t));return i.byteOffset=e,i};var Oe=function(){};(i["kha.Canvas"]=Oe).__name__=!0,Oe.prototype={__class__:Oe,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var We=function(){};(i["kha.Resource"]=We).__name__=!0,We.prototype={__class__:We};var ze=function(){};(i["kha.Image"]=ze).__name__=!0,ze.__interfaces__=[We,Oe],ze.__properties__={get_nonPow2Supported:"get_nonPow2Supported",get_maxSize:"get_maxSize"},ze.create=function(e,t,i,r){return null==i&&(i=Ui.RGBA32),null==r&&(r=Wi.StaticUsage),null==D.gl?new He(e,t,i,!1):new lt(e,t,i,!1,0,1)},ze.create3D=function(e,t,i,r,n){return null},ze.createRenderTarget=function(e,t,i,r,n,s){return null==s&&(s=0),null==n&&(n=1),null==r&&(r=0),null==i&&(i=Ui.RGBA32),null==D.gl?new He(e,t,i,!0):new lt(e,t,i,!0,r,n)},ze.fromImage=function(e,t){if(null==D.gl){var i=new He(e.width,e.height,Ui.RGBA32,!1);return i.image=e,i.createTexture(),i}var r=new lt(e.width,e.height,Ui.RGBA32,!1,0,1);return r.image=e,r.createTexture(),r},ze.fromBytes=function(e,t,i,r,n){if(null==r&&(r=Ui.RGBA32),null==n&&(n=Wi.StaticUsage),null!=D.gl){var s=new lt(t,i,r,!1,0,1);return s.image=s.bytesToArray(e),s.createTexture(),s}return null},ze.fromBytes3D=function(e,t,i,r,n,s){return null},ze.fromEncodedBytes=function(e,t,i,r,n){null==n&&(n=!1);var s="data:image;base64,"+we.encode(e),a=Re.__cast(window.document.createElement("img"),HTMLImageElement);a.onload=function(){var e=ze.fromImage(a,n);i(e)},a.onerror=function(){r("Image was not created")},a.src=s},ze.fromVideo=function(e){if(null==D.gl){var t=new He(e.element.videoWidth,e.element.videoHeight,Ui.RGBA32,!1);return t.video=e.element,t.createTexture(),t}var i=new lt(e.element.videoWidth,e.element.videoHeight,Ui.RGBA32,!1,0,1);return i.video=e.element,i.createTexture(),i},ze.get_maxSize=function(){return null==D.gl?8192:D.gl.getParameter(3379)},ze.get_nonPow2Supported=function(){return null!=D.gl},ze.prototype={isOpaque:function(e,t){return!1},at:function(e,t){return-16777216},unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},getPixels:function(){return null},generateMipmaps:function(e){},setMipmaps:function(e){},setDepthStencilFrom:function(e){},clear:function(e,t,i,r,n,s,a){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g1:function(){return null},get_g2:function(){return null},get_g4:function(){return null},__class__:ze,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var He=function(e,t,i,r){this.g2canvas=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=r,this.image=null,this.video=null,r&&this.createTexture()};(i["kha.CanvasImage"]=He).__name__=!0,He.init=function(){var e=window.document.createElement("canvas");null!=e&&(He.context=e.getContext("2d"),e.width=2048,e.height=2048,He.context.globalCompositeOperation="copy")},He.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},He.__super__=ze,He.prototype=n(ze.prototype,{get_g1:function(){return null==this.graphics1&&(this.graphics1=new qt(this)),this.graphics1},get_g2:function(){if(null==this.g2canvas){var e=window.document.createElement("canvas"),t=(this.image=e).getContext("2d");e.width=this.get_width(),e.height=this.get_height(),this.g2canvas=new nr(t)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},isOpaque:function(e,t){if(null==this.data){if(null==He.context)return!0;this.createImageData()}return 0!=this.data.data[t*(0|this.image.width)*4+4*e+3]},at:function(e,t){if(null==this.data){if(null==He.context)return-16777216;this.createImageData()}return Ze._new(this.data.data[t*(0|this.image.width)*4+4*e])},createImageData:function(){He.context.strokeStyle="rgba(0,0,0,0)",He.context.fillStyle="rgba(0,0,0,0)",He.context.fillRect(0,0,this.image.width,this.image.height),He.context.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.image.width,this.image.height),this.data=He.context.getImageData(0,0,this.image.width,this.image.height)},createTexture:function(){null!=D.gl&&(this.texture=D.gl.createTexture(),D.gl.bindTexture(3553,this.texture),D.gl.texParameteri(3553,10240,9729),D.gl.texParameteri(3553,10241,9729),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=D.gl.createFramebuffer(),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),D.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),D.gl.bindFramebuffer(36160,null)):null!=this.video?D.gl.texImage2D(3553,0,6408,6408,5121,this.video):D.gl.texImage2D(3553,0,6408,6408,5121,this.image),D.gl.bindTexture(3553,null))},set:function(e){D.gl.activeTexture(33984+e),D.gl.bindTexture(3553,this.texture),null!=this.video&&D.gl.texImage2D(3553,0,6408,6408,5121,this.video)},lock:function(e){return null==e&&(e=0),this.bytes=new Te(new en(this.format==Ui.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=D.gl){if(this.texture=D.gl.createTexture(),D.gl.bindTexture(3553,this.texture),D.gl.texParameteri(3553,10240,9729),D.gl.texParameteri(3553,10241,9729),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),D.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new sn(this.bytes.b.bufferValue)),1282==D.gl.getError()){for(var e=new Te(new en(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var r=t++,n=0,s=this.get_width();n<s;){var a=n++,o=this.bytes,l=r*this.get_width()+a,h=o.b[l],_=r*this.get_width()*4+4*a;e.b[_]=255&h;var c=r*this.get_width()*4+4*a+1;e.b[c]=255&h;var u=r*this.get_width()*4+4*a+2;e.b[u]=255&h;var d=r*this.get_width()*4+4*a+3;e.b[d]=255}D.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new sn(e.b.bufferValue))}D.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:He});var Ze=e.kha._Color.Color_Impl_={};(i["kha._Color.Color_Impl_"]=Ze).__name__=!0,Ze.__properties__={set_value:"set_value",get_value:"get_value",set_A:"set_A",get_A:"get_A",set_B:"set_B",get_B:"get_B",set_G:"set_G",get_G:"get_G",set_R:"set_R",get_R:"get_R",set_Ab:"set_Ab",get_Ab:"get_Ab",set_Bb:"set_Bb",get_Bb:"get_Bb",set_Gb:"set_Gb",get_Gb:"get_Gb",set_Rb:"set_Rb",get_Rb:"get_Rb"},Ze.fromValue=function(e){return Ze._new(e)},Ze.fromBytes=function(e,t,i,r){return null==r&&(r=255),Ze._new(r<<24|e<<16|t<<8|i)},Ze.fromFloats=function(e,t,i,r){return null==r&&(r=1),Ze._new((255*r|0)<<24|(255*e|0)<<16|(255*t|0)<<8|255*i|0)},Ze.fromString=function(e){if(7!=e.length&&9!=e.length||35!=e.charCodeAt(0))throw new dt("Invalid Color string: '"+e+"'");var t=E.parseInt("0x"+$.substr(e,1,null));return 7==e.length&&(t+=-16777216),Ze._new(t)},Ze._new=function(e){return e},Ze.get_value=function(e){return e},Ze.set_value=function(e,t){return t},Ze.get_Rb=function(e){return(16711680&e)>>>16},Ze.get_Gb=function(e){return(65280&e)>>>8},Ze.get_Bb=function(e){return 255&e},Ze.get_Ab=function(e){return e>>>24},Ze.set_Rb=function(e,t){return e=e>>>24<<24|t<<16|(65280&e)>>>8<<8|255&e,t},Ze.set_Gb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|t<<8|255&e,t},Ze.set_Bb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},Ze.set_Ab=function(e,t){return e=t<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|255&e,t},Ze.get_R=function(e){return.00392156862745098*((16711680&e)>>>16)},Ze.get_G=function(e){return.00392156862745098*((65280&e)>>>8)},Ze.get_B=function(e){return.00392156862745098*(255&e)},Ze.get_A=function(e){return.00392156862745098*(e>>>24)},Ze.set_R=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(255*t|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t},Ze.set_G=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(255*t|0)<<8|.00392156862745098*(255&e)*255|0,t},Ze.set_B=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|255*t|0,t},Ze.set_A=function(e,t){return e=(255*t|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t};var Xe=function(){};(i["kha.CompilerDefines"]=Xe).__name__=!0;var je=function(){};(i["kha.EnvironmentVariables"]=je).__name__=!0,je.prototype={getVariable:function(e){return""},__class__:je};var Ke=function(e,t,i){this.bold=e,this.italic=t,this.underlined=i};(i["kha.FontStyle"]=Ke).__name__=!0,Ke.prototype={getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:Ke};var Ye=function(e,t,i,r){this.windowId=e,this.graphics1=t,this.graphics2=i,this.graphics4=r};(i["kha.Framebuffer"]=Ye).__name__=!0,Ye.__interfaces__=[Oe],Ye.prototype={init:function(e,t,i){this.graphics1=e,this.graphics2=t,this.graphics4=i},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return A.windowWidth(this.windowId)},get_height:function(){return A.windowHeight(this.windowId)},__class__:Ye,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1"}};var Qe=function(){};(i["kha.AlignedQuad"]=Qe).__name__=!0,Qe.prototype={__class__:Qe};var qe=function(e,t,i,r,n,s,a,o){this.mySize=e,this.width=n,this.height=s,this.chars=a,this.baseline=t;for(var l=0;l<a.length;){var h=a[l];++l,h.yoff+=this.baseline}this.texture=ze.create(n,s,Ui.L8);for(var _=this.texture.lock(),c=0,u=0,d=s;u<d;){u++;for(var f=0,g=n;f<g;){f++;var v=o.readU8(c);_.b[c]=255&v,++c}}this.texture.unlock()};(i["kha.KravurImage"]=qe).__name__=!0,qe.prototype={getTexture:function(){return this.texture},getBakedQuad:function(e,t,i,r){if(t>=this.chars.length)return null;var n=1/this.width,s=1/this.height,a=this.chars[t];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(r+a.yoff);return e.x0=o,e.y0=l,e.x1=o+a.x1-a.x0,e.y1=l+a.y1-a.y0,e.s0=a.x0*n,e.t0=a.y0*s,e.s1=a.x1*n,e.t1=a.y1*s,e.xadvance=a.xadvance,e},getCharWidth:function(e){if(0==this.chars.length)return 0;var t=qe.gaps[0];if(e<t)return this.chars[0].xadvance;for(var i=1,r=qe.gaps.length/2|0;i<r;){var n=i++,s=qe.gaps[2*n-1],a=qe.gaps[2*n];a-1<e&&(t+=a-1-s)}return e-t>=this.chars.length?this.chars[0].xadvance:this.chars[e-t].xadvance},getHeight:function(){return this.mySize},stringWidth:function(e){for(var t=new String(e),i=0,r=0,n=t.length;r<n;){var s=r++;i+=this.getCharWidth($.cca(t,s))}return i},charactersWidth:function(e,t,i){for(var r=0,n=t,s=t+i;n<s;){var a=n++;r+=this.getCharWidth(e[a])}return r},getBaselinePosition:function(){return this.baseline},__class__:qe};var Je=function(e){this.images=new Be,this.blob=e};(i["kha.Kravur"]=Je).__name__=!0,Je.__interfaces__=[We],Je.fromBytes=function(e){return new Je(tr.fromBytes(e))},Je.prototype={_get:function(e,t){if(null==t&&(t=Qt._glyphs),t!=this.oldGlyphs){this.oldGlyphs=t;for(var i=(qe.gaps=[t[0]])[0]+1,r=1,n=t.length;r<n;){var s=r++;t[s]!=i?(qe.gaps.push(t[s-1]),qe.gaps.push(t[s]),i=t[s]+1):++i}qe.gaps.push(t[t.length-1])}var a=null==t?e:1e4*e+t.length;if(!this.images.h.hasOwnProperty(a)){for(var o=64,l=32,h=t.length,_=new Array(h),c=0,u=_.length;c<u;){_[c++]=new oi}for(var d=null,f=-1;f<0;)l<o?l*=2:o*=2,d=tr.alloc(o*l),f=mi.stbtt_BakeFontBitmap(this.blob,0,e,d,o,l,t,_);var g=new ui;mi.stbtt_InitFont(g,this.blob,0);var v=mi.stbtt_GetFontVMetrics(g),p=mi.stbtt_ScaleForPixelHeight(g,e),m=Math.round(v.ascent*p),y=Math.round(v.descent*p),b=Math.round(v.lineGap*p),w=new qe(0|e,m,y,b,o,l,_,d);return this.images.h[a]=w}return this.images.h[a]},height:function(e){return this._get(e).getHeight()},width:function(e,t){return this._get(e).stringWidth(t)},widthOfCharacters:function(e,t,i,r){return this._get(e).charactersWidth(t,i,r)},baseline:function(e){return this._get(e).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:Je};var $e=function(e,t){this.center=e,this.angle=t};(i["kha.Rotation"]=$e).__name__=!0,$e.prototype={__class__:$e};var et=function(){};(i["kha.TimeTask"]=et).__name__=!0,et.prototype={__class__:et};var tt=function(e,t,i){this.task=e,this.priority=t,this.id=i,this.active=!0,this.paused=!1};(i["kha.FrameTask"]=tt).__name__=!0,tt.prototype={__class__:tt};var it=i["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"]};it.RotationNone=["RotationNone",0],it.RotationNone.toString=r,(it.RotationNone.__enum__=it).Rotation90=["Rotation90",1],it.Rotation90.toString=r,(it.Rotation90.__enum__=it).Rotation180=["Rotation180",2],it.Rotation180.toString=r,(it.Rotation180.__enum__=it).Rotation270=["Rotation270",3],it.Rotation270.toString=r,it.Rotation270.__enum__=it;var nt=function(){};(i["kha.Shaders"]=nt).__name__=!0,nt.init=function(){for(var e=[],t=0;t<3;){var i=t++,r=U.field(nt,"painter_colored_fragData"+i),n=be.run(r);e.push(tr.fromBytes(n))}nt.painter_colored_frag=new Bi(e,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);for(var s=[],a=0;a<3;){var o=a++,l=U.field(nt,"painter_colored_vertData"+o),h=be.run(l);s.push(tr.fromBytes(h))}nt.painter_colored_vert=new Xi(s,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);for(var _=[],c=0;c<3;){var u=c++,d=U.field(nt,"painter_image_fragData"+u),f=be.run(d);_.push(tr.fromBytes(f))}nt.painter_image_frag=new Bi(_,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);for(var g=[],v=0;v<3;){var p=v++,m=U.field(nt,"painter_image_vertData"+p),y=be.run(m);g.push(tr.fromBytes(y))}nt.painter_image_vert=new Xi(g,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);for(var b=[],w=0;w<3;){var x=w++,B=U.field(nt,"painter_text_fragData"+x),S=be.run(B);b.push(tr.fromBytes(S))}nt.painter_text_frag=new Bi(b,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);for(var T=[],k=0;k<3;){var I=k++,A=U.field(nt,"painter_text_vertData"+I),C=be.run(A);T.push(tr.fromBytes(C))}nt.painter_text_vert=new Xi(T,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);for(var D=[],P=0;P<3;){var E=P++,N=U.field(nt,"painter_video_fragData"+E),M=be.run(N);D.push(tr.fromBytes(M))}nt.painter_video_frag=new Bi(D,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);for(var L=[],R=0;R<3;){var V=R++,F=U.field(nt,"painter_video_vertData"+V),G=be.run(F);L.push(tr.fromBytes(G))}nt.painter_video_vert=new Xi(L,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"])};var st=function(){};(i["kha.Sound"]=st).__name__=!0,st.__interfaces__=[We],st.prototype={uncompress:function(e){if(null==this.uncompressedData){var t=new Ee,i=It.readAll(this.compressedData,t,!0),r=t.getBytes(),n=r.length/4|0;if(1==i.channel){var s=new nn(2*n);this.uncompressedData=s;for(var a=0,o=n;a<o;){var l=a++;this.uncompressedData[2*l]=r.getFloat(4*l),this.uncompressedData[2*l+1]=r.getFloat(4*l)}}else{var h=new nn(n);this.uncompressedData=h;for(var _=0,c=n;_<c;){var u=_++;this.uncompressedData[u]=r.getFloat(4*u)}}this.compressedData=null,e()}else e()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:st};var at=function(){this.axes=[],this.buttons=[]};(i["kha.GamepadStates"]=at).__name__=!0,at.prototype={__class__:at};var ot=function(){};(i["kha.Video"]=ot).__name__=!0,ot.__interfaces__=[We],ot.prototype={width:function(){return 100},height:function(){return 100},play:function(e){null==e&&(e=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(e){return 0},getVolume:function(){return 1},setVolume:function(e){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:ot,__properties__:{set_position:"set_position",get_position:"get_position"}};var lt=function(e,t,i,r,n,s){this.pixels=null,this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=r,this.samples=s,this.image=null,this.video=null,this.depthStencilFormat=n,lt.init(),r&&this.createTexture()};(i["kha.WebGLImage"]=lt).__name__=!0,lt.init=function(){null==lt.context&&(lt.canvas=window.document.createElement("canvas"),null!=lt.canvas&&(lt.context=lt.canvas.getContext("2d"),lt.canvas.width=4096,lt.canvas.height=4096,lt.context.globalCompositeOperation="copy"))},lt.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},lt.formatByteSize=function(e){switch(e[1]){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},lt.__super__=ze,lt.prototype=n(ze.prototype,{get_g1:function(){return null==this.graphics1&&(this.graphics1=new qt(this)),this.graphics1},get_g2:function(){return null==this.graphics2&&(this.graphics2=new vr(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new gr(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},isOpaque:function(e,t){if(null==this.data){if(null==lt.context)return!0;this.createImageData()}return 0!=this.data.data[t*(0|this.image.width)*4+4*e+3]},at:function(e,t){if(null==this.data){if(null==lt.context)return-16777216;this.createImageData()}var i=this.data.data[t*(0|this.image.width)*4+4*e],r=this.data.data[t*(0|this.image.width)*4+4*e+1],n=this.data.data[t*(0|this.image.width)*4+4*e+2],s=this.data.data[t*(0|this.image.width)*4+4*e+3];return Ze._new(s<<24|i<<16|r<<8|n)},createImageData:function(){if(Re.__instanceof(this.image,sn))this.data=new ImageData(new Uint8ClampedArray(this.image.buffer),this.get_width(),this.get_height());else{if(this.get_width()>lt.canvas.width||this.get_height()>lt.canvas.height){for(var e=lt.canvas.width,t=lt.canvas.height;this.get_width()>e||this.get_height()>t;)e*=2,t*=2;lt.canvas.width=e,lt.canvas.height=t}lt.context.strokeStyle="rgba(0,0,0,0)",lt.context.fillStyle="rgba(0,0,0,0)",lt.context.fillRect(0,0,this.image.width,this.image.height),lt.context.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.image.width,this.image.height),this.data=lt.context.getImageData(0,0,this.image.width,this.image.height)}},createTexture:function(){if(null!=D.gl){if(this.texture=D.gl.createTexture(),D.gl.bindTexture(3553,this.texture),D.gl.texParameteri(3553,10240,9729),D.gl.texParameteri(3553,10241,9729),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=D.gl.createFramebuffer(),D.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:D.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:D.gl.texImage2D(3553,0,D.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:D.gl.texImage2D(3553,0,D.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:D.gl.texImage2D(3553,0,D.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,D.halfFloat.HALF_FLOAT_OES,null);break;case 5:D.gl.texImage2D(3553,0,D.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,D.gl2?6403:6406,5126,null);break;case 6:D.gl.texImage2D(3553,0,D.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,D.gl2?6403:6406,D.halfFloat.HALF_FLOAT_OES,null);break;default:D.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==Ui.DEPTH16){if(D.gl.texParameteri(3553,10240,9728),D.gl.texParameteri(3553,10241,9728),D.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!D.gl2){var e=D.gl.createTexture();D.gl.bindTexture(3553,e),D.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),D.gl.framebufferTexture2D(36160,36064,3553,e,0),D.gl.bindTexture(3553,this.texture)}}else D.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=D.gl.checkFramebufferStatus(36160)&&me.trace("WebGL error: Framebuffer incomplete",{fileName:"WebGLImage.hx",lineNumber:226,className:"kha.WebGLImage",methodName:"createTexture"}),D.gl.bindRenderbuffer(36161,null),D.gl.bindFramebuffer(36160,null)}else if(null!=this.video)D.gl.texImage2D(3553,0,6408,6408,5121,this.video);else{switch(this.format[1]){case 0:Re.__instanceof(this.image,sn)?D.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):D.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 2:D.gl.texImage2D(3553,0,D.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:D.gl.texImage2D(3553,0,D.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,D.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:D.gl.texImage2D(3553,0,D.gl2?33326:6406,this.myWidth,this.myHeight,0,D.gl2?6403:6406,5126,this.image);break;case 6:D.gl.texImage2D(3553,0,D.gl2?33325:6406,this.myWidth,this.myHeight,0,D.gl2?6403:6406,D.halfFloat.HALF_FLOAT_OES,this.image);break;default:D.gl.texImage2D(3553,0,6408,6408,5121,this.image)}}D.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:null==D.depthTexture?(this.renderBuffer=D.gl.createRenderbuffer(),D.gl.bindRenderbuffer(36161,this.renderBuffer),D.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),D.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=D.gl.createTexture(),D.gl.bindTexture(3553,this.depthTexture),1==e?D.gl.texImage2D(3553,0,D.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):D.gl.texImage2D(3553,0,D.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),D.gl.texParameteri(3553,10240,9728),D.gl.texParameteri(3553,10241,9728),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==D.depthTexture?(this.renderBuffer=D.gl.createRenderbuffer(),D.gl.bindRenderbuffer(36161,this.renderBuffer),D.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),D.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=D.gl.createTexture(),D.gl.bindTexture(3553,this.depthTexture),D.gl.texImage2D(3553,0,D.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,D.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),D.gl.texParameteri(3553,10240,9728),D.gl.texParameteri(3553,10241,9728),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(e){D.gl.activeTexture(33984+e),D.gl.bindTexture(3553,this.texture),null!=this.video&&D.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(e){D.gl.activeTexture(33984+e),D.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(e){D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.framebufferTexture2D(36160,36096,3553,Re.__cast(e,lt).depthTexture,0)},bytesToArray:function(e){switch(this.format[1]){case 0:case 1:return new sn(e.b.bufferValue);case 2:case 4:case 5:case 6:return new nn(e.b.bufferValue);default:return new sn(e.b.bufferValue)}},lock:function(e){return null==e&&(e=0),this.bytes=new Te(new en(lt.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=D.gl){switch(this.texture=D.gl.createTexture(),D.gl.bindTexture(3553,this.texture),D.gl.texParameteri(3553,10240,9729),D.gl.texParameteri(3553,10241,9729),D.gl.texParameteri(3553,10242,33071),D.gl.texParameteri(3553,10243,33071),this.format[1]){case 0:D.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(D.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==D.gl.getError()){for(var e=new Te(new en(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var r=t++,n=0,s=this.get_width();n<s;){var a=n++,o=this.bytes,l=r*this.get_width()+a,h=o.b[l],_=r*this.get_width()*4+4*a;e.b[_]=255&h;var c=r*this.get_width()*4+4*a+1;e.b[c]=255&h;var u=r*this.get_width()*4+4*a+2;e.b[u]=255&h;var d=r*this.get_width()*4+4*a+3;e.b[d]=255}D.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(e))}break;case 2:D.gl.texImage2D(3553,0,D.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:D.gl.texImage2D(3553,0,D.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,D.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:D.gl.texImage2D(3553,0,D.gl2?33326:6406,this.get_width(),this.get_height(),0,D.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:D.gl.texImage2D(3553,0,D.gl2?33325:6406,this.get_width(),this.get_height(),0,D.gl2?6403:6406,D.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:D.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}D.gl.bindTexture(3553,null),this.bytes=null}},getPixels:function(){return null==this.frameBuffer?null:(null==this.pixels&&(this.pixels=new sn(lt.formatByteSize(this.format)*this.get_width()*this.get_height())),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.readPixels(0,0,this.myWidth,this.myHeight,6408,5121,this.pixels),Te.ofData(this.pixels.buffer))},unload:function(){null!=this.texture&&D.gl.deleteTexture(this.texture),null!=this.depthTexture&&D.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&D.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&D.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(e){D.gl.bindTexture(3553,this.texture),D.gl.generateMipmap(3553)},setMipmaps:function(e){if(D.gl.bindTexture(3553,this.texture),this.format==Ui.RGBA128)for(var t=0,i=e.length;t<i;){var r=t++;D.gl.texImage2D(3553,r+1,D.gl2?34836:6408,e[r].get_width(),e[r].get_height(),0,6408,5126,Re.__cast(e[r],lt).image)}else if(this.format==Ui.RGBA64)for(var n=0,s=e.length;n<s;){var a=n++;D.gl.texImage2D(3553,a+1,D.gl2?34842:6408,e[a].get_width(),e[a].get_height(),0,6408,D.halfFloat.HALF_FLOAT_OES,Re.__cast(e[a],lt).image)}else for(var o=0,l=e.length;o<l;){var h=o++;D.gl.texImage2D(3553,h+1,6408,6408,5121,Re.__cast(e[h],lt).image)}},__class__:lt});var ht=i["kha.WindowMode"]={__ename__:!0,__constructs__:["Window","BorderlessWindow","Fullscreen"]};ht.Window=["Window",0],ht.Window.toString=r,(ht.Window.__enum__=ht).BorderlessWindow=["BorderlessWindow",1],ht.BorderlessWindow.toString=r,(ht.BorderlessWindow.__enum__=ht).Fullscreen=["Fullscreen",2],ht.Fullscreen.toString=r,ht.Fullscreen.__enum__=ht;var _t=i["kha.Position"]={__ename__:!0,__constructs__:["Center","Fixed"]};_t.Center=["Center",0],_t.Center.toString=r,(_t.Center.__enum__=_t).Fixed=function(e){var t=["Fixed",1,e];return t.__enum__=_t,t.toString=r,t};var ct=i["kha.TargetDisplay"]={__ename__:!0,__constructs__:["Primary","ById"]};ct.Primary=["Primary",0],ct.Primary.toString=r,(ct.Primary.__enum__=ct).ById=function(e){var t=["ById",1,e];return t.__enum__=ct,t.toString=r,t};var ut=function(e,t,i){this.textureFormat=e,this.depthStencilFormat=t,this.samplesPerPixel=i};(i["kha.RendererOptions"]=ut).__name__=!0,ut.prototype={__class__:ut};var ft=function(e,t,i){this.minimizable=e,this.maximizable=t,this.resizable=i};(i["kha.WindowedModeOptions"]=ft).__name__=!0,ft.prototype={__class__:ft};var gt=function(e,t,i,r,n,s,a,o,l){this.width=e,this.height=t,this.mode=i,this.title=r,this.x=n,this.y=s,this.targetDisplay=a,this.rendererOptions=o,this.windowedModeOptions=l};(i["kha.WindowOptions"]=gt).__name__=!0,gt.prototype={__class__:gt};var vt={};(i["kha.arrays._Float32Array.Float32Array_Impl_"]=vt).__name__=!0,vt.__properties__={get_length:"get_length"},vt._new=function(e){return new nn(e)},vt.get_length=function(e){return e.length},vt.set=function(e,t,i){return e[t]=i},vt.get=function(e,t){return e[t]},vt.data=function(e){return e},vt.arrayRead=function(e,t){return e[t]},vt.arrayWrite=function(e,t,i){return e[t]=i},vt.subarray=function(e,t,i){return e.subarray(t,i)};var pt={};(i["kha.arrays._Uint32Array.Uint32Array_Impl_"]=pt).__name__=!0,pt.__properties__={get_length:"get_length"},pt._new=function(e){return new Uint32Array(e)},pt.get_length=function(e){return e.length},pt.set=function(e,t,i){return e[t]=i},pt.get=function(e,t){return e[t]},pt.data=function(e){return e},pt.arrayRead=function(e,t){return e[t]},pt.arrayWrite=function(e,t,i){return e[t]=i},pt.subarray=function(e,t,i){return e.subarray(t,i)};var mt=function(){};(i["kha.audio1.AudioChannel"]=mt).__name__=!0,mt.prototype={__class__:mt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var yt=function(){};(i["kha.audio2.Audio"]=yt).__name__=!0,yt.initContext=function(){try{return void(yt._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},yt._init=function(){if(yt.initContext(),null==yt._context)return!1;return yt.buffer=new xt(8192,2,0|yt._context.sampleRate),yt.processingNode=yt._context.createScriptProcessor(2048,0,2),yt.processingNode.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(1);if(null!=yt.audioCallback){yt.audioCallback(2*e.outputBuffer.length,yt.buffer);for(var r=0,n=e.outputBuffer.length;r<n;){var s=r++;t[s]=yt.buffer.data[yt.buffer.readLocation],yt.buffer.readLocation+=1,i[s]=yt.buffer.data[yt.buffer.readLocation],yt.buffer.readLocation+=1,yt.buffer.readLocation>=yt.buffer.size&&(yt.buffer.readLocation=0)}}else for(var a=0,o=e.outputBuffer.length;a<o;){var l=a++;t[l]=0,i[l]=0}},yt.processingNode.connect(yt._context.destination),!0},yt.stream=function(e,t){null==t&&(t=!1);var i=window.document.createElement("audio"),r=new Blob([e.compressedData.b.bufferValue],{type:"audio/mp4"});i.src=URL.createObjectURL(r),i.loop=t;var n=new ir(i);return n.play(),n};var bt=function(){};(i["kha.audio2.Audio1"]=bt).__name__=!0,bt._init=function(){var e=new Array(16);bt.soundChannels=e;var t=new Array(16);bt.streamChannels=t;var i=new Array(16);bt.internalSoundChannels=i;var r=new Array(16);bt.internalStreamChannels=r;var n=new nn(512);bt.sampleCache1=n;var s=new nn(512);bt.sampleCache2=s,yt.audioCallback=bt.mix},bt.max=function(e,t){return t<e?e:t},bt.min=function(e,t){return e<t?e:t},bt.mix=function(e,t){if(bt.sampleCache1.length<e){var i=new nn(e);bt.sampleCache1=i;var r=new nn(e);bt.sampleCache2=r}for(var n=0,s=e;n<s;){var a=n++;bt.sampleCache2[a]=0}for(var o=0;o<16;){var l=o++;bt.internalSoundChannels[l]=bt.soundChannels[l]}for(var h=0;h<16;){var _=h++;bt.internalStreamChannels[_]=bt.streamChannels[_]}for(var c=0,u=bt.internalSoundChannels;c<u.length;){var d=u[c];if(++c,null!=d&&!d.get_finished()){d.nextSamples(bt.sampleCache1,e,t.samplesPerSecond);for(var f=0,g=e;f<g;){var v=f++,p=v;bt.sampleCache2[p]+=bt.sampleCache1[v]*d.get_volume()}}}for(var m=0,y=bt.internalStreamChannels;m<y.length;){var b=y[m];if(++m,null!=b&&!b.get_finished()){b.nextSamples(bt.sampleCache1,e,t.samplesPerSecond);for(var w=0,x=e;w<x;){var B=w++,S=B;bt.sampleCache2[S]+=bt.sampleCache1[B]*b.get_volume()}}}for(var T=0,k=e;T<k;){var I=T++,A=bt.sampleCache2[I],C=A<1?A:1;t.data[t.writeLocation]=-1<C?C:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}},bt.play=function(e,t){null==t&&(t=!1);for(var i=null,r=0;r<16;){var n=r++;if(null==bt.soundChannels[n]||bt.soundChannels[n].get_finished()){(i=new wt(t)).data=e.uncompressedData,bt.soundChannels[n]=i;break}}return i},bt._playAgain=function(e){for(var t=0;t<16;){var i=t++;if(null==bt.soundChannels[i]||bt.soundChannels[i].get_finished()||bt.soundChannels[i]==e){bt.soundChannels[i]=e;break}}},bt.stream=function(e,t){null==t&&(t=!1);var i=yt.stream(e,t);if(null!=i)return i;for(var r=null,n=0;n<16;){var s=n++;if(null==bt.streamChannels[s]||bt.streamChannels[s].get_finished()){r=new Bt(e.compressedData,t),bt.streamChannels[s]=r;break}}return r};var wt=function(e){this.paused=!1,this.looping=e,this.myVolume=1,this.myPosition=0};(i["kha.audio2.AudioChannel"]=wt).__name__=!0,wt.__interfaces__=[mt],wt.prototype={nextSamples:function(e,t,i){if(this.paused)for(var r=0,n=t;r<n;){e[r++]=0}else{for(var s=0,a=0;s<t;){for(var o=this.data.length-this.myPosition,l=o<t-s?o:t-s;a<l;)e[s]=this.data[this.myPosition],++this.myPosition,++a,++s;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;s<t;)e[s]=0,++s}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,bt._playAgain(this))},pause:function(){this.paused=!0},stop:function(){this.myPosition=this.data.length},get_length:function(){return this.data.length/44100/2},get_position:function(){return this.myPosition/44100/2},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},get_finished:function(){return this.myPosition>=this.data.length},__class__:wt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var xt=function(e,t,i){this.size=e;var r=new nn(e);this.data=r,this.channels=t,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(i["kha.audio2.Buffer"]=xt).__name__=!0,xt.prototype={__class__:xt};var Bt=function(e,t){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=t,this.reader=It.openFromBytes(e)};(i["kha.audio2.StreamChannel"]=Bt).__name__=!0,Bt.__interfaces__=[mt],Bt.prototype={nextSamples:function(e,t,i){if(this.paused)for(var r=0,n=t;r<n;){e[r++]=0}else{var s=2*this.reader.read(e,t/2|0,2,i,!0);if(s<t){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=s,o=t;a<o;){e[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},get_finished:function(){return this.atend},__class__:Bt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var St=function(){};(i["kha.audio2.ogg.tools.Crc32"]=St).__name__=!0,St.init=function(){if(null==St.table){var e=new Array(256);St.table=e;for(var t=0;t<256;){for(var i=t++,r=i<<24,n=0;n<8;){n++;r=r<<1^(rt.gte(r,1<<31)?79764919:0)}St.table[i]=r}}},St.update=function(e,t){return e<<8^St.table[t^e>>>24]};var Tt=function(){};(i["kha.audio2.ogg.tools.MathTools"]=Tt).__name__=!0,Tt.ilog=function(e){var t=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return e<16384?e<16?t[e]:e<512?5+t[e>>5]:10+t[e>>10]:e<16777216?e<524288?15+t[e>>15]:20+t[e>>20]:e<536870912?25+t[e>>25]:e<-2147483648?30+t[e>>30]:0};var kt=function(){};(i["kha.audio2.ogg.tools.Mdct"]=kt).__name__=!0,kt.inverseTransform=function(e,t,i,r,n,s){for(var a=t>>1,o=t>>2,l=t>>3,h=new Array(a),_=a-2,c=0,u=0,d=a;u!=d;)h[_+1]=e[u]*i[c]-e[u+2]*i[c+1],h[_]=e[u]*i[c+1]+e[u+2]*i[c],_-=2,c+=2,u+=4;for(u=a-3;0<=_;)h[_+1]=-e[u+2]*i[c]- -e[u]*i[c+1],h[_]=-e[u+2]*i[c+1]+-e[u]*i[c],_-=2,c+=2,u-=4;for(var f=e,g=h,v=a-8,p=o,m=0,y=o,b=0;0<=v;){var w=g[p+1]-g[m+1],x=g[p]-g[m];f[y+1]=g[p+1]+g[m+1],f[y]=g[p]+g[m],f[b+1]=w*i[v+4]-x*i[v+5],f[b]=x*i[v+4]+w*i[v+5],w=g[p+3]-g[m+3],x=g[p+2]-g[m+2],f[y+3]=g[p+3]+g[m+3],f[y+2]=g[p+2]+g[m+2],f[b+3]=w*i[v]-x*i[v+1],f[b+2]=x*i[v]+w*i[v+1],v-=8,y+=4,b+=4,p+=4,m+=4}for(var B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],S=(t<16384?t<16?B[t]:t<512?5+B[t>>5]:10+B[t>>10]:t<16777216?t<524288?15+B[t>>15]:20+B[t>>20]:t<536870912?25+B[t>>25]:t<-2147483648?30+B[t>>30]:0)-1,T=a-1-0*o,k=T,I=T+-(t>>3),A=0,C=1+(t>>4>>2);0<--C;){var D=f[k]-f[I],P=f[k+-1]-f[I+-1],E=k,N=f;N[E]=N[E]+f[I];var M=k+-1,L=f;L[M]=L[M]+f[I+-1],f[I]=D*i[A]-P*i[A+1],f[I+-1]=P*i[A]+D*i[A+1],A+=8,D=f[k+-2]-f[I+-2],P=f[k+-3]-f[I+-3];var R=k+-2,V=f;V[R]=V[R]+f[I+-2];var F=k+-3,G=f;G[F]=G[F]+f[I+-3],f[I+-2]=D*i[A]-P*i[A+1],f[I+-3]=P*i[A]+D*i[A+1],A+=8,D=f[k+-4]-f[I+-4],P=f[k+-5]-f[I+-5];var U=k+-4,O=f;O[U]=O[U]+f[I+-4];var W=k+-5,z=f;z[W]=z[W]+f[I+-5],f[I+-4]=D*i[A]-P*i[A+1],f[I+-5]=P*i[A]+D*i[A+1],A+=8,D=f[k+-6]-f[I+-6],P=f[k+-7]-f[I+-7];var H=k+-6,Z=f;Z[H]=Z[H]+f[I+-6];var X=k+-7,j=f;j[X]=j[X]+f[I+-7],f[I+-6]=D*i[A]-P*i[A+1],f[I+-7]=P*i[A]+D*i[A+1],A+=8,k-=8,I-=8}for(var K=a-1-o,Y=K,Q=K+-(t>>3),q=0,J=1+(t>>4>>2);0<--J;){var $=f[Y]-f[Q],ee=f[Y+-1]-f[Q+-1],te=Y,ie=f;ie[te]=ie[te]+f[Q];var re=Y+-1,ne=f;ne[re]=ne[re]+f[Q+-1],f[Q]=$*i[q]-ee*i[q+1],f[Q+-1]=ee*i[q]+$*i[q+1],q+=8,$=f[Y+-2]-f[Q+-2],ee=f[Y+-3]-f[Q+-3];var se=Y+-2,ae=f;ae[se]=ae[se]+f[Q+-2];var oe=Y+-3,le=f;le[oe]=le[oe]+f[Q+-3],f[Q+-2]=$*i[q]-ee*i[q+1],f[Q+-3]=ee*i[q]+$*i[q+1],q+=8,$=f[Y+-4]-f[Q+-4],ee=f[Y+-5]-f[Q+-5];var he=Y+-4,_e=f;_e[he]=_e[he]+f[Q+-4];var ce=Y+-5,ue=f;ue[ce]=ue[ce]+f[Q+-5],f[Q+-4]=$*i[q]-ee*i[q+1],f[Q+-5]=ee*i[q]+$*i[q+1],q+=8,$=f[Y+-6]-f[Q+-6],ee=f[Y+-7]-f[Q+-7];var de=Y+-6,fe=f;fe[de]=fe[de]+f[Q+-6];var ge=Y+-7,ve=f;ve[ge]=ve[ge]+f[Q+-7],f[Q+-6]=$*i[q]-ee*i[q+1],f[Q+-7]=ee*i[q]+$*i[q+1],q+=8,Y-=8,Q-=8}for(var pe=a-1-0*l,me=0,ye=pe,be=pe+-(t>>4),we=1+(t>>5>>2);0<--we;){var xe=f[ye]-f[be],Be=f[ye+-1]-f[be+-1],Se=ye,Te=f;Te[Se]=Te[Se]+f[be];var ke=ye+-1,Ie=f;Ie[ke]=Ie[ke]+f[be+-1],f[be]=xe*i[me]-Be*i[me+1],f[be+-1]=Be*i[me]+xe*i[me+1],me+=16,xe=f[ye+-2]-f[be+-2],Be=f[ye+-3]-f[be+-3];var Ae=ye+-2,Ce=f;Ce[Ae]=Ce[Ae]+f[be+-2];var De=ye+-3,Pe=f;Pe[De]=Pe[De]+f[be+-3],f[be+-2]=xe*i[me]-Be*i[me+1],f[be+-3]=Be*i[me]+xe*i[me+1],me+=16,xe=f[ye+-4]-f[be+-4],Be=f[ye+-5]-f[be+-5];var Ee=ye+-4,Ne=f;Ne[Ee]=Ne[Ee]+f[be+-4];var Me=ye+-5,Le=f;Le[Me]=Le[Me]+f[be+-5],f[be+-4]=xe*i[me]-Be*i[me+1],f[be+-5]=Be*i[me]+xe*i[me+1],me+=16,xe=f[ye+-6]-f[be+-6],Be=f[ye+-7]-f[be+-7];var Re=ye+-6,Ve=f;Ve[Re]=Ve[Re]+f[be+-6];var Fe=ye+-7,Ge=f;Ge[Fe]=Ge[Fe]+f[be+-7],f[be+-6]=xe*i[me]-Be*i[me+1],f[be+-7]=Be*i[me]+xe*i[me+1],ye-=8,be-=8,me+=16}for(var Ue=a-1-l,Oe=0,We=Ue,ze=Ue+-(t>>4),He=1+(t>>5>>2);0<--He;){var Ze=f[We]-f[ze],Xe=f[We+-1]-f[ze+-1],je=We,Ke=f;Ke[je]=Ke[je]+f[ze];var Ye=We+-1,Qe=f;Qe[Ye]=Qe[Ye]+f[ze+-1],f[ze]=Ze*i[Oe]-Xe*i[Oe+1],f[ze+-1]=Xe*i[Oe]+Ze*i[Oe+1],Oe+=16,Ze=f[We+-2]-f[ze+-2],Xe=f[We+-3]-f[ze+-3];var qe=We+-2,Je=f;Je[qe]=Je[qe]+f[ze+-2];var $e=We+-3,et=f;et[$e]=et[$e]+f[ze+-3],f[ze+-2]=Ze*i[Oe]-Xe*i[Oe+1],f[ze+-3]=Xe*i[Oe]+Ze*i[Oe+1],Oe+=16,Ze=f[We+-4]-f[ze+-4],Xe=f[We+-5]-f[ze+-5];var tt=We+-4,it=f;it[tt]=it[tt]+f[ze+-4];var rt=We+-5,nt=f;nt[rt]=nt[rt]+f[ze+-5],f[ze+-4]=Ze*i[Oe]-Xe*i[Oe+1],f[ze+-5]=Xe*i[Oe]+Ze*i[Oe+1],Oe+=16,Ze=f[We+-6]-f[ze+-6],Xe=f[We+-7]-f[ze+-7];var st=We+-6,at=f;at[st]=at[st]+f[ze+-6];var ot=We+-7,lt=f;lt[ot]=lt[ot]+f[ze+-7],f[ze+-6]=Ze*i[Oe]-Xe*i[Oe+1],f[ze+-7]=Xe*i[Oe]+Ze*i[Oe+1],We-=8,ze-=8,Oe+=16}for(var ht=a-1-2*l,_t=0,ct=ht,ut=ht+-(t>>4),dt=1+(t>>5>>2);0<--dt;){var ft=f[ct]-f[ut],gt=f[ct+-1]-f[ut+-1],vt=ct,pt=f;pt[vt]=pt[vt]+f[ut];var mt=ct+-1,yt=f;yt[mt]=yt[mt]+f[ut+-1],f[ut]=ft*i[_t]-gt*i[_t+1],f[ut+-1]=gt*i[_t]+ft*i[_t+1],_t+=16,ft=f[ct+-2]-f[ut+-2],gt=f[ct+-3]-f[ut+-3];var bt=ct+-2,wt=f;wt[bt]=wt[bt]+f[ut+-2];var xt=ct+-3,Bt=f;Bt[xt]=Bt[xt]+f[ut+-3],f[ut+-2]=ft*i[_t]-gt*i[_t+1],f[ut+-3]=gt*i[_t]+ft*i[_t+1],_t+=16,ft=f[ct+-4]-f[ut+-4],gt=f[ct+-5]-f[ut+-5];var St=ct+-4,Tt=f;Tt[St]=Tt[St]+f[ut+-4];var kt=ct+-5,It=f;It[kt]=It[kt]+f[ut+-5],f[ut+-4]=ft*i[_t]-gt*i[_t+1],f[ut+-5]=gt*i[_t]+ft*i[_t+1],_t+=16,ft=f[ct+-6]-f[ut+-6],gt=f[ct+-7]-f[ut+-7];var At=ct+-6,Ct=f;Ct[At]=Ct[At]+f[ut+-6];var Dt=ct+-7,Pt=f;Pt[Dt]=Pt[Dt]+f[ut+-7],f[ut+-6]=ft*i[_t]-gt*i[_t+1],f[ut+-7]=gt*i[_t]+ft*i[_t+1],ct-=8,ut-=8,_t+=16}for(var Et=a-1-3*l,Nt=0,Mt=Et,Lt=Et+-(t>>4),Rt=1+(t>>5>>2);0<--Rt;){var Vt=f[Mt]-f[Lt],Ft=f[Mt+-1]-f[Lt+-1],Gt=Mt,Ut=f;Ut[Gt]=Ut[Gt]+f[Lt];var Ot=Mt+-1,Wt=f;Wt[Ot]=Wt[Ot]+f[Lt+-1],f[Lt]=Vt*i[Nt]-Ft*i[Nt+1],f[Lt+-1]=Ft*i[Nt]+Vt*i[Nt+1],Nt+=16,Vt=f[Mt+-2]-f[Lt+-2],Ft=f[Mt+-3]-f[Lt+-3];var zt=Mt+-2,Ht=f;Ht[zt]=Ht[zt]+f[Lt+-2];var Zt=Mt+-3,Xt=f;Xt[Zt]=Xt[Zt]+f[Lt+-3],f[Lt+-2]=Vt*i[Nt]-Ft*i[Nt+1],f[Lt+-3]=Ft*i[Nt]+Vt*i[Nt+1],Nt+=16,Vt=f[Mt+-4]-f[Lt+-4],Ft=f[Mt+-5]-f[Lt+-5];var jt=Mt+-4,Kt=f;Kt[jt]=Kt[jt]+f[Lt+-4];var Yt=Mt+-5,Qt=f;Qt[Yt]=Qt[Yt]+f[Lt+-5],f[Lt+-4]=Vt*i[Nt]-Ft*i[Nt+1],f[Lt+-5]=Ft*i[Nt]+Vt*i[Nt+1],Nt+=16,Vt=f[Mt+-6]-f[Lt+-6],Ft=f[Mt+-7]-f[Lt+-7];var qt=Mt+-6,Jt=f;Jt[qt]=Jt[qt]+f[Lt+-6];var $t=Mt+-7,ei=f;ei[$t]=ei[$t]+f[Lt+-7],f[Lt+-6]=Vt*i[Nt]-Ft*i[Nt+1],f[Lt+-7]=Ft*i[Nt]+Vt*i[Nt+1],Mt-=8,Lt-=8,Nt+=16}for(var ti=2,ii=S-3>>1;ti<ii;)for(var ri=ti++,ni=t>>ri+2,si=ni>>1,ai=0,oi=1<<ri+1;ai<oi;)for(var li=a-1-ni*ai++,hi=1<<ri+3,_i=0,ci=li,ui=li+-si,di=1+(t>>ri+4>>2);0<--di;){var fi=f[ci]-f[ui],gi=f[ci+-1]-f[ui+-1],vi=ci,pi=f;pi[vi]=pi[vi]+f[ui];var mi=ci+-1,yi=f;yi[mi]=yi[mi]+f[ui+-1],f[ui]=fi*i[_i]-gi*i[_i+1],f[ui+-1]=gi*i[_i]+fi*i[_i+1],_i+=hi,fi=f[ci+-2]-f[ui+-2],gi=f[ci+-3]-f[ui+-3];var bi=ci+-2,wi=f;wi[bi]=wi[bi]+f[ui+-2];var xi=ci+-3,Bi=f;Bi[xi]=Bi[xi]+f[ui+-3],f[ui+-2]=fi*i[_i]-gi*i[_i+1],f[ui+-3]=gi*i[_i]+fi*i[_i+1],_i+=hi,fi=f[ci+-4]-f[ui+-4],gi=f[ci+-5]-f[ui+-5];var Si=ci+-4,Ti=f;Ti[Si]=Ti[Si]+f[ui+-4];var ki=ci+-5,Ii=f;Ii[ki]=Ii[ki]+f[ui+-5],f[ui+-4]=fi*i[_i]-gi*i[_i+1],f[ui+-5]=gi*i[_i]+fi*i[_i+1],_i+=hi,fi=f[ci+-6]-f[ui+-6],gi=f[ci+-7]-f[ui+-7];var Ai=ci+-6,Ci=f;Ci[Ai]=Ci[Ai]+f[ui+-6];var Di=ci+-7,Pi=f;Pi[Di]=Pi[Di]+f[ui+-7],f[ui+-6]=fi*i[_i]-gi*i[_i+1],f[ui+-7]=gi*i[_i]+fi*i[_i+1],ci-=8,ui-=8,_i+=hi}for(var Ei=S-3>>1,Ni=S-6;Ei<Ni;)for(var Mi=Ei++,Li=t>>Mi+2,Ri=1<<Mi+3,Vi=Li>>1,Fi=1<<Mi+1,Gi=0,Ui=a-1,Oi=(t>>Mi+6)+1;0<--Oi;){for(var Wi=i[Gi],zi=i[Gi+1],Hi=i[Gi+Ri],Zi=i[Gi+Ri+1],Xi=i[Gi+2*Ri],ji=i[Gi+2*Ri+1],Ki=i[Gi+3*Ri],Yi=i[Gi+3*Ri+1],Qi=Ui,qi=Ui+-Vi,Ji=Fi+1;0<--Ji;){var $i=f[Qi]-f[qi],er=f[Qi+-1]-f[qi+-1];f[Qi]=f[Qi]+f[qi],f[Qi+-1]=f[Qi+-1]+f[qi+-1],f[qi]=$i*Wi-er*zi,f[qi+-1]=er*Wi+$i*zi,$i=f[Qi+-2]-f[qi+-2],er=f[Qi+-3]-f[qi+-3],f[Qi+-2]=f[Qi+-2]+f[qi+-2],f[Qi+-3]=f[Qi+-3]+f[qi+-3],f[qi+-2]=$i*Hi-er*Zi,f[qi+-3]=er*Hi+$i*Zi,$i=f[Qi+-4]-f[qi+-4],er=f[Qi+-5]-f[qi+-5],f[Qi+-4]=f[Qi+-4]+f[qi+-4],f[Qi+-5]=f[Qi+-5]+f[qi+-5],f[qi+-4]=$i*Xi-er*ji,f[qi+-5]=er*Xi+$i*ji,$i=f[Qi+-6]-f[qi+-6],er=f[Qi+-7]-f[qi+-7],f[Qi+-6]=f[Qi+-6]+f[qi+-6],f[Qi+-7]=f[Qi+-7]+f[qi+-7],f[qi+-6]=$i*Ki-er*Yi,f[qi+-7]=er*Ki+$i*Yi,Qi-=Li,qi-=Li}Gi+=4*Ri,Ui-=8}for(var tr=a-1,ir=i[t>>3],rr=tr,nr=tr-16*(t>>5);nr<rr;){var sr=f[rr],ar=f[rr+-8];f[rr+-8]=sr-ar,f[rr]=sr+ar,sr=f[rr+-1],ar=f[rr+-9],f[rr+-9]=sr-ar,f[rr+-1]=sr+ar;var or=(sr=f[rr+-2])-(ar=f[rr+-10]);f[rr+-2]=sr+ar;var lr=(sr=f[rr+-3])-(ar=f[rr+-11]);f[rr+-3]=sr+ar,f[rr+-10]=(or+lr)*ir,f[rr+-11]=(lr-or)*ir,sr=f[rr+-4],or=(ar=f[rr+-12])-sr,f[rr+-4]=sr+ar,lr=(sr=f[rr+-5])-(ar=f[rr+-13]),f[rr+-5]=sr+ar,f[rr+-12]=lr,f[rr+-13]=or,sr=f[rr+-6],or=(ar=f[rr+-14])-sr,f[rr+-6]=sr+ar,lr=(sr=f[rr+-7])-(ar=f[rr+-15]),f[rr+-7]=sr+ar,f[rr+-14]=(or+lr)*ir,f[rr+-15]=(or-lr)*ir;var hr=f[rr],_r=f[rr+-4],cr=hr-_r,ur=hr+_r,dr=(hr=f[rr+-2])+(_r=f[rr+-6]),fr=hr-_r;f[rr]=ur+dr,f[rr+-2]=ur-dr;var gr=f[rr+-3]-f[rr+-7];f[rr+-4]=cr+gr,f[rr+-6]=cr-gr;var vr=(hr=f[rr+-1])-(_r=f[rr+-5]),pr=hr+_r,mr=f[rr+-3]+f[rr+-7];f[rr+-1]=pr+mr,f[rr+-3]=pr-mr,f[rr+-5]=vr-fr,f[rr+-7]=vr+fr;var yr=rr-8,br=f[yr],wr=f[yr+-4],xr=br-wr,Br=br+wr,Sr=(br=f[yr+-2])+(wr=f[yr+-6]),Tr=br-wr;f[yr]=Br+Sr,f[yr+-2]=Br-Sr;var kr=f[yr+-3]-f[yr+-7];f[yr+-4]=xr+kr,f[yr+-6]=xr-kr;var Ir=(br=f[yr+-1])-(wr=f[yr+-5]),Ar=br+wr,Cr=f[yr+-3]+f[yr+-7];f[yr+-1]=Ar+Cr,f[yr+-3]=Ar-Cr,f[yr+-5]=Ir-Tr,f[yr+-7]=Ir+Tr,rr-=16}for(var Dr=0,Pr=o-4,Er=a-4;0<=Pr;){var Nr=s[Dr];g[Er+3]=f[Nr],g[Er+2]=f[Nr+1],g[Pr+3]=f[Nr+2],g[Pr+2]=f[Nr+3],Nr=s[Dr+1],g[Er+1]=f[Nr],g[Er]=f[Nr+1],g[Pr+1]=f[Nr+2],g[Pr]=f[Nr+3],Pr-=4,Er-=4,Dr+=2}for(var Mr=0,Lr=0,Rr=a-4;Lr<Rr;){var Vr=g[Lr]-g[Rr+2],Fr=g[Lr+1]+g[Rr+3],Gr=n[Mr+1]*Vr+n[Mr]*Fr,Ur=n[Mr+1]*Fr-n[Mr]*Vr,Or=g[Lr]+g[Rr+2],Wr=g[Lr+1]-g[Rr+3];g[Lr]=Or+Gr,g[Lr+1]=Wr+Ur,g[Rr+2]=Or-Gr,g[Rr+3]=Ur-Wr,Vr=g[Lr+2]-g[Rr],Fr=g[Lr+3]+g[Rr+1],Gr=n[Mr+3]*Vr+n[Mr+2]*Fr,Ur=n[Mr+3]*Fr-n[Mr+2]*Vr,Or=g[Lr+2]+g[Rr],Wr=g[Lr+3]-g[Rr+1],g[Lr+2]=Or+Gr,g[Lr+3]=Wr+Ur,g[Rr]=Or-Gr,g[Rr+1]=Ur-Wr,Mr+=4,Lr+=4,Rr-=4}for(var zr=a-8,Hr=a-8,Zr=0,Xr=a-4,jr=a,Kr=t-4;0<=Hr;){var Yr=h[Hr+6]*r[zr+7]-h[Hr+7]*r[zr+6],Qr=-h[Hr+6]*r[zr+6]-h[Hr+7]*r[zr+7];e[Zr]=Yr,e[Xr+3]=-Yr,e[jr]=Qr,e[Kr+3]=Qr;var qr=h[Hr+4]*r[zr+5]-h[Hr+5]*r[zr+4],Jr=-h[Hr+4]*r[zr+4]-h[Hr+5]*r[zr+5];e[Zr+1]=qr,e[Xr+2]=-qr,e[jr+1]=Jr,e[Kr+2]=Jr,Yr=h[Hr+2]*r[zr+3]-h[Hr+3]*r[zr+2],Qr=-h[Hr+2]*r[zr+2]-h[Hr+3]*r[zr+3],e[Zr+2]=Yr,e[Xr+1]=-Yr,e[jr+2]=Qr,e[Kr+1]=Qr,qr=h[Hr]*r[zr+1]-h[Hr+1]*r[zr],Jr=-h[Hr]*r[zr]-h[Hr+1]*r[zr+1],e[Zr+3]=qr,e[Xr]=-qr,e[jr+3]=Jr,e[Kr]=Jr,zr-=8,Hr-=8,Zr+=4,jr+=4,Xr-=4,Kr-=4}},kt.step3Iter0Loop=function(e,t,i,r,n){for(var s=i,a=i+r,o=0,l=1+(e>>2);0<--l;){var h=t[s]-t[a],_=t[s+-1]-t[a+-1],c=s,u=t;u[c]=u[c]+t[a];var d=s+-1,f=t;f[d]=f[d]+t[a+-1],t[a]=h*n[o]-_*n[o+1],t[a+-1]=_*n[o]+h*n[o+1],o+=8,h=t[s+-2]-t[a+-2],_=t[s+-3]-t[a+-3];var g=s+-2,v=t;v[g]=v[g]+t[a+-2];var p=s+-3,m=t;m[p]=m[p]+t[a+-3],t[a+-2]=h*n[o]-_*n[o+1],t[a+-3]=_*n[o]+h*n[o+1],o+=8,h=t[s+-4]-t[a+-4],_=t[s+-5]-t[a+-5];var y=s+-4,b=t;b[y]=b[y]+t[a+-4];var w=s+-5,x=t;x[w]=x[w]+t[a+-5],t[a+-4]=h*n[o]-_*n[o+1],t[a+-5]=_*n[o]+h*n[o+1],o+=8,h=t[s+-6]-t[a+-6],_=t[s+-7]-t[a+-7];var B=s+-6,S=t;S[B]=S[B]+t[a+-6];var T=s+-7,k=t;k[T]=k[T]+t[a+-7],t[a+-6]=h*n[o]-_*n[o+1],t[a+-7]=_*n[o]+h*n[o+1],o+=8,s-=8,a-=8}},kt.step3InnerRLoop=function(e,t,i,r,n,s){for(var a=0,o=i,l=i+r,h=1+(e>>2);0<--h;){var _=t[o]-t[l],c=t[o+-1]-t[l+-1],u=o,d=t;d[u]=d[u]+t[l];var f=o+-1,g=t;g[f]=g[f]+t[l+-1],t[l]=_*n[a]-c*n[a+1],t[l+-1]=c*n[a]+_*n[a+1],a+=s,_=t[o+-2]-t[l+-2],c=t[o+-3]-t[l+-3];var v=o+-2,p=t;p[v]=p[v]+t[l+-2];var m=o+-3,y=t;y[m]=y[m]+t[l+-3],t[l+-2]=_*n[a]-c*n[a+1],t[l+-3]=c*n[a]+_*n[a+1],a+=s,_=t[o+-4]-t[l+-4],c=t[o+-5]-t[l+-5];var b=o+-4,w=t;w[b]=w[b]+t[l+-4];var x=o+-5,B=t;B[x]=B[x]+t[l+-5],t[l+-4]=_*n[a]-c*n[a+1],t[l+-5]=c*n[a]+_*n[a+1],a+=s,_=t[o+-6]-t[l+-6],c=t[o+-7]-t[l+-7];var S=o+-6,T=t;T[S]=T[S]+t[l+-6];var k=o+-7,I=t;I[k]=I[k]+t[l+-7],t[l+-6]=_*n[a]-c*n[a+1],t[l+-7]=c*n[a]+_*n[a+1],o-=8,l-=8,a+=s}},kt.step3InnerSLoop=function(e,t,i,r,n,s,a,o){for(var l=n[s],h=n[s+1],_=n[s+a],c=n[s+a+1],u=n[s+2*a],d=n[s+2*a+1],f=n[s+3*a],g=n[s+3*a+1],v=i,p=i+r,m=e+1;0<--m;){var y=t[v]-t[p],b=t[v+-1]-t[p+-1];t[v]=t[v]+t[p],t[v+-1]=t[v+-1]+t[p+-1],t[p]=y*l-b*h,t[p+-1]=b*l+y*h,y=t[v+-2]-t[p+-2],b=t[v+-3]-t[p+-3],t[v+-2]=t[v+-2]+t[p+-2],t[v+-3]=t[v+-3]+t[p+-3],t[p+-2]=y*_-b*c,t[p+-3]=b*_+y*c,y=t[v+-4]-t[p+-4],b=t[v+-5]-t[p+-5],t[v+-4]=t[v+-4]+t[p+-4],t[v+-5]=t[v+-5]+t[p+-5],t[p+-4]=y*u-b*d,t[p+-5]=b*u+y*d,y=t[v+-6]-t[p+-6],b=t[v+-7]-t[p+-7],t[v+-6]=t[v+-6]+t[p+-6],t[v+-7]=t[v+-7]+t[p+-7],t[p+-6]=y*f-b*g,t[p+-7]=b*f+y*g,v-=o,p-=o}},kt.iter54=function(e,t){var i=e[t],r=e[t+-4],n=i-r,s=i+r,a=(i=e[t+-2])+(r=e[t+-6]),o=i-r;e[t]=s+a,e[t+-2]=s-a;var l=e[t+-3]-e[t+-7];e[t+-4]=n+l,e[t+-6]=n-l;var h=(i=e[t+-1])-(r=e[t+-5]),_=i+r,c=e[t+-3]+e[t+-7];e[t+-1]=_+c,e[t+-3]=_-c,e[t+-5]=h-o,e[t+-7]=h+o},kt.step3InnerSLoopLd654=function(e,t,i,r,n){for(var s=r[n>>3],a=i,o=i-16*e;o<a;){var l=t[a],h=t[a+-8];t[a+-8]=l-h,t[a]=l+h,l=t[a+-1],h=t[a+-9],t[a+-9]=l-h,t[a+-1]=l+h;var _=(l=t[a+-2])-(h=t[a+-10]);t[a+-2]=l+h;var c=(l=t[a+-3])-(h=t[a+-11]);t[a+-3]=l+h,t[a+-10]=(_+c)*s,t[a+-11]=(c-_)*s,l=t[a+-4],_=(h=t[a+-12])-l,t[a+-4]=l+h,c=(l=t[a+-5])-(h=t[a+-13]),t[a+-5]=l+h,t[a+-12]=c,t[a+-13]=_,l=t[a+-6],_=(h=t[a+-14])-l,t[a+-6]=l+h,c=(l=t[a+-7])-(h=t[a+-15]),t[a+-7]=l+h,t[a+-14]=(_+c)*s,t[a+-15]=(_-c)*s;var u=t[a],d=t[a+-4],f=u-d,g=u+d,v=(u=t[a+-2])+(d=t[a+-6]),p=u-d;t[a]=g+v,t[a+-2]=g-v;var m=t[a+-3]-t[a+-7];t[a+-4]=f+m,t[a+-6]=f-m;var y=(u=t[a+-1])-(d=t[a+-5]),b=u+d,w=t[a+-3]+t[a+-7];t[a+-1]=b+w,t[a+-3]=b-w,t[a+-5]=y-p,t[a+-7]=y+p;var x=a-8,B=t[x],S=t[x+-4],T=B-S,k=B+S,I=(B=t[x+-2])+(S=t[x+-6]),A=B-S;t[x]=k+I,t[x+-2]=k-I;var C=t[x+-3]-t[x+-7];t[x+-4]=T+C,t[x+-6]=T-C;var D=(B=t[x+-1])-(S=t[x+-5]),P=B+S,E=t[x+-3]+t[x+-7];t[x+-1]=P+E,t[x+-3]=P-E,t[x+-5]=D-A,t[x+-7]=D+A,a-=16}};var It=function(e,t,i){this.seekFunc=t,this.inputLength=i,this.decoder=Dt.start(e),this.decoder.setupSampleNumber(t,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(i["kha.audio2.ogg.vorbis.Reader"]=It).__name__=!0,It.openFromBytes=function(e){var t=new De(e),i=t;return new It(t,function(e){It.seekBytes(i,e)},e.length)},It.seekBytes=function(e,t){e.set_position(t)},It.readAll=function(e,t,i){null==i&&(i=!1);var r=new De(e),n=Dt.start(r),s=r;n.setupSampleNumber(function(e){It.seekBytes(s,e)},e.length);for(var a=n.header,o=new nn(4096*a.channel);;){for(var l=n.read(o,4096,a.channel,a.sampleRate,i),h=0,_=l*a.channel;h<_;){var c=h++;t.writeFloat(o[c])}if(0==l)break;l}return n.header},It.prototype={get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var e=this.decoder.totalSample,t=this.get_header().sampleRate;return rt.toFloat(e)/rt.toFloat(t)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(e){return this.decoder.seek(this.seekFunc,this.inputLength,e),this.decoder.currentSample},get_currentMillisecond:function(){var e=this.get_currentSample(),t=this.get_header().sampleRate;return rt.toFloat(e)/rt.toFloat(t)*1e3},set_currentMillisecond:function(e){var t=e/1e3,i=this.get_header().sampleRate;return this.set_currentSample(Math.floor(rt.toFloat(i)*t)),this.get_currentMillisecond()},read:function(e,t,i,r,n){return null==n&&(n=!1),this.decoder.ensurePosition(this.seekFunc),null==t&&(t=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==r&&(r=this.get_header().sampleRate),this.decoder.read(e,t,i,r,n)},clone:function(){var e=te.createEmptyInstance(It);return e.seekFunc=this.seekFunc,e.inputLength=this.inputLength,e.decoder=this.decoder.clone(this.seekFunc),e.loopStart=this.loopStart,e.loopLength=this.loopLength,e},sampleToMillisecond:function(e){var t=this.get_header().sampleRate;return rt.toFloat(e)/rt.toFloat(t)*1e3},millisecondToSample:function(e){var t=e/1e3,i=this.get_header().sampleRate;return Math.floor(rt.toFloat(i)*t)},__class__:It,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_totalMillisecond:"get_totalMillisecond",get_totalSample:"get_totalSample",get_header:"get_header"}};var At=function(e){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=e,this.inputPosition=0,this.page=new Wt,St.init()};(i["kha.audio2.ogg.vorbis.VorbisDecodeState"]=At).__name__=!0,At.prototype={setup:function(e,t){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var r=new Array(i),n=0,s=i;n<s;){r[n++]=this.input.readByte()}if(this.segments=r,this.endSegWithKnownLoc=-2,-1!=e||-1!=t)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=e),--a;if(this.firstDecode){for(var o=0,l=new Ht,h=0,_=i;h<_;){var c=h++;o+=this.segments[c]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=e,this.pFirst=l}this.nextSeg=0},clone:function(e){var t=te.createEmptyInstance(At);return e(this.inputPosition),t.input=this.input,t.eof=this.eof,t.validBits=this.validBits,t.discardSamplesDeferred=this.discardSamplesDeferred,t.firstDecode=this.firstDecode,t.nextSeg=this.nextSeg,t.bytesInSeg=this.bytesInSeg,t.acc=t.acc,t.lastSeg=this.lastSeg,t.lastSegWhich=this.lastSegWhich,t.currentLoc=this.currentLoc,t.currentLocValid=this.currentLocValid,t.inputPosition=this.inputPosition,t.firstAudioPageOffset=this.firstAudioPageOffset,t.error=this.error,t.segments=this.segments,t.pFirst=this.pFirst,t.pLast=this.pLast,t.page=this.page.clone(),t},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(e){if(e instanceof dt&&(e=e.val),Re.__instanceof(e,Zt))return this.lastSeg=!0,this.error=e,0;throw e}if(0==(1&this.page.flag))throw new dt(new Zt(Xt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var e=this.segments[this.nextSeg++];e<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1);this.bytesInSeg;return this.bytesInSeg=e},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new dt(new Zt(Xt.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var t,e,i,r,n=!1;try{this.inputPosition+=1,t=this.input.readByte()}catch(e){if(e instanceof dt&&(e=e.val),!Re.__instanceof(e,Ne))throw e;n=!0,t=0}if(n)return!1;if(79==t?(this.inputPosition+=1,r=103!=this.input.readByte()):r=!0,r?i=!0:(this.inputPosition+=1,i=103!=this.input.readByte()),i?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new dt(new Zt(Xt.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(e){if(this.validBits<0)return 0;if(this.validBits<e){if(24<e)return this.readBits(24)+(this.readBits(e-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<e))break}if(this.validBits<0)return 0;var t=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,t}var i=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var e;return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,e=this.input.readByte()):e=-1,this.validBits=0,e},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){for(var e=new Te(new en(6)),t=0;t<6;){var i,r=t++;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,i=this.input.readByte()):i=-1,this.validBits=0,e.b[r]=255&i}if("vorbis"!=e.toString())throw new dt(new Zt(Xt.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"VorbisDecodeState.hx",lineNumber:307,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"VorbisDecodeState.hx",lineNumber:310,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){var e,t,i;if(this.inputPosition+=1,79==this.input.readByte()?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?t=!0:(this.inputPosition+=1,t=103!=this.input.readByte()),t?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new dt(new Zt(Xt.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(e){this.inputPosition+=e;for(var t=new Array(e),i=0,r=e;i<r;){t[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(e){this.validBits<10&&this.prepHuffman();var t,i=e.fastHuffman[1023&this.acc];if(0<=i){var r=e.codewordLengths[i];this.acc=this.acc>>>r,this.validBits-=r,this.validBits<0?(this.validBits=0,t=-1):t=i}else t=this.decodeScalarRaw(e);return e.sparse&&(t=e.sortedValues[t]),t},decodeRaw:function(e){this.validBits<10&&this.prepHuffman();var t=e.fastHuffman[1023&this.acc];if(0<=t){var i=e.codewordLengths[t];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):t}return this.decodeScalarRaw(e)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(e,t,i){var r=i.left.start,n=!1,s=t>>1;if(this.firstDecode)this.currentLoc=-s,this.discardSamplesDeferred=t-i.right.end,n=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,r=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(n&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(t-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:r,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(s-i.left.start),n=!0}return n&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:r,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(e){this.inputPosition+=e;for(var t=new Array(e),i=0,r=e;i<r;){t[i++]=this.input.readByte()}return t},readBytes:function(e){return this.inputPosition+=e,this.input.read(e)},readString:function(e){return this.inputPosition+=e,this.input.readString(e)},getSampleNumber:function(e,t){var i=this.inputPosition,r=rt.gte(t,65536)&&rt.gte(t-65536,this.firstAudioPageOffset)?t-65536:this.firstAudioPageOffset;e(this.inputPosition=r);var n=0,s=!1,a=this.findPage(e,t);switch(a[1]){case 0:var o=a[3];n=a[2],s=o;break;case 1:throw new dt(new Zt(Xt.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:518,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;try{for(;!s;){e(this.inputPosition=n);var h=this.findPage(e,t);switch(h[1]){case 0:var _=h[3];n=h[2],s=_;break;case 1:throw"__break__"}r=l+1,l=this.inputPosition}}catch(e){if("__break__"!=e)throw e}e(this.inputPosition=l),this.inputPosition+=6;for(var c=new Array(6),u=0;u<6;){c[u++]=this.input.readByte()}this.inputPosition+=4;var d=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==d&&-1==f||0<f)throw new dt(new Zt(Xt.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:552,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Ht,this.pLast.pageStart=l,this.pLast.pageEnd=n,this.pLast.lastDecodedSample=d,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=r,e(this.inputPosition=i),d},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(e,t){e(this.inputPosition=t)},findPage:function(e,t){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i,r,n=this.inputPosition;if(t<n-25)return Ct.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,r=103!=this.input.readByte()):r=!0,r?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)continue;var s=new Array(27);s[0]=79,s[1]=103,s[2]=103,s[3]=83;for(var a=4;a<27;){var o=a++;this.inputPosition+=1,s[o]=this.input.readByte()}if(0!=s[4]){e(this.inputPosition=n);continue}for(var l=s[22]+(s[23]<<8)+(s[24]<<16)+(s[25]<<24),h=22;h<26;){s[h++]=0}for(var _=0,c=0;c<27;){var u=c++;_=_<<8^St.table[s[u]^_>>>24]}var d=0;try{for(var f=0,g=s[26];f<g;){f++;this.inputPosition+=1;var v=this.input.readByte();_=_<<8^St.table[v^_>>>24],d+=v}for(var p=0,m=d;p<m;){p++;this.inputPosition+=1;var y=this.input.readByte();_=_<<8^St.table[y^_>>>24]}}catch(e){if(e instanceof dt&&(e=e.val),Re.__instanceof(e,Ne))return Ct.NotFound;throw e}if(_==l){var b=this.inputPosition;return e(this.inputPosition=n-1),Ct.Found(b,0!=(4&s[5]))}}}}catch(e){if(e instanceof dt&&(e=e.val),Re.__instanceof(e,Ne))return Ct.NotFound;throw e}},analyzePage:function(e,t){var i=new Ht,r=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var n=new Array(27),s=0;s<27;){n[s++]=this.input.readByte()}var a=n,o=a[26];this.inputPosition+=o;for(var l=new Array(o),h=0,_=o;h<_;){l[h++]=this.input.readByte()}for(var c=l,u=0,d=0,f=a[26];d<f;){u+=c[d++]}if(i.pageEnd=i.pageStart+27+a[26]+u,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,e(this.inputPosition=i.pageStart),i;for(var g=0,v=0==(1&a[5]),p=t.modes.length,m=0,y=a[26];m<y;){var b=m++;if(v){if(0==c[b])return e(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var w=this.input.readByte();if(0!=(1&w))return e(this.inputPosition=i.pageStart),null;w>>=1;var x=p-1,B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(p<=(w&=(1<<(x<16384?x<16?B[x]:x<512?5+B[x>>5]:10+B[x>>10]:x<16777216?x<524288?15+B[x>>15]:20+B[x>>20]:x<536870912?25+B[x>>25]:x<-2147483648?30+B[x>>30]:0))-1))return e(this.inputPosition=i.pageStart),null;r[g++]=t.modes[w].blockflag;var S=c[b]-1;this.inputPosition+=S;for(var T=new Array(S),k=0,I=S;k<I;){T[k++]=this.input.readByte()}}else{var A=c[b];this.inputPosition+=A;for(var C=new Array(A),D=0,P=A;D<P;){C[D++]=this.input.readByte()}}v=c[b]<255}var E=0;1<g&&(E+=r[g-1]?t.blocksize1:t.blocksize0);for(var N=g-2;1<=N;)r[--N]?r[N+1]?E+=t.blocksize1>>1:E+=(t.blocksize1-t.blocksize0>>2)+(t.blocksize0>>1):E+=t.blocksize0>>1,--N;return i.firstDecodedSample=i.lastDecodedSample-E,e(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(e){this.prepHuffman();null!=e.sortedCodewords||e.codewords;var t=e.codewordLengths,i=e.codewords,r=e.sortedCodewords;if(8<e.entries?null!=r:null!=i){for(var n=this.acc,s=(n=(-16711936&(n=(-252645136&(n=(-858993460&(n=(-1431655766&n)>>>1|(1431655765&n)<<1))>>>2|(858993459&n)<<2))>>>4|(252645135&n)<<4))>>>8|(16711935&n)<<8)>>>16|n<<16,a=0,o=e.sortedEntries;1<o;){var l=a+(o>>1);rt.gte(s,r[l])?(a=l,o-=o>>1):o>>=1}e.sparse||(a=e.sortedValues[a]);var h=t[a];return this.validBits>=h?(this.acc=this.acc>>>h,this.validBits-=h,a):(this.validBits=0,-1)}e.sparse;for(var _=0,c=e.entries;_<c;){var u=_++,d=t[u];if(255!=d&&i[u]==(this.acc&(1<<d)-1))return this.validBits>=d?(this.acc=this.acc>>>d,this.validBits-=d,u):(this.validBits=0,-1)}return this.error=new Zt(Xt.INVALID_STREAM,null,{fileName:"VorbisDecodeState.hx",lineNumber:846,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:At};var Ct=i["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"]};Ct.Found=function(e,t){var i=["Found",0,e,t];return i.__enum__=Ct,i.toString=r,i},Ct.NotFound=["NotFound",1],Ct.NotFound.toString=r,Ct.NotFound.__enum__=Ct;var Dt=function(e,t){this.header=e,this.decodeState=t,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=e.channel,r=new Array(i);this.channelBuffers=r;var n=e.channel,s=new Array(n);this.previousWindow=s;var a=e.channel,o=new Array(a);this.finalY=o;for(var l=0,h=e.channel;l<h;){var _=l++,c=this.channelBuffers,u=e.blocksize1,d=new Array(u);c[_]=d;var f=this.previousWindow,g=e.blocksize1/2|0,v=new Array(g);f[_]=v,this.finalY[_]=[]}var p=new Array(2);this.a=p;var m=new Array(2);this.b=m;var y=new Array(2);this.c=y;var b=new Array(2);this.window=b;var w=new Array(2);this.bitReverseData=w,this.initBlocksize(0,e.blocksize0),this.initBlocksize(1,e.blocksize1)};(i["kha.audio2.ogg.vorbis.VorbisDecoder"]=Dt).__name__=!0,Dt.start=function(e){var t=new At(e),i=Vt.read(t),r=new Dt(i,t);return t.startFirstDecode(),r.pumpFirstFrame(),r},Dt.prototype={read:function(e,t,i,r,n){var s=this.header.sampleRate;if(0!=(rt.toFloat(r)%rt.toFloat(s)|0))throw new dt("Unsupported sampleRate : can't convert "+E.string(rt.toFloat(this.header.sampleRate))+" to "+r);if(i%this.header.channel!=0)throw new dt("Unsupported channels : can't convert "+this.header.channel+" to "+i);var a=this.header.sampleRate,o=rt.toFloat(r)/rt.toFloat(a)|0,l=i/this.header.channel|0,h=0,_=Math.floor(t/o);null!=this.totalSample&&_>this.totalSample-this.currentSample&&(_=this.totalSample-this.currentSample);for(var c=0;h<_;){var u=this.channelBufferEnd-this.channelBufferStart;_-h<=u&&(u=_-h);for(var d=this.channelBufferStart,f=this.channelBufferStart+u;d<f;)for(var g=d++,v=0,p=o;v<p;){v++;for(var m=0,y=this.header.channel;m<y;)for(var b=m++,w=0,x=l;w<x;){w++;var B=this.channelBuffers[b][g];1<B?B=1:B<-1&&(B=-1),n&&(e[c]=B,++c)}}if(h+=u,this.channelBufferStart+=u,h==_||0==this.getFrameFloat())break}for(var S=h,T=_;S<T;){S++;for(var k=0,I=o;k<I;){k++;for(var A=0,C=this.header.channel;A<C;){A++;for(var D=0,P=l;D<P;){D++;n&&(e[c]=0,++c)}}}}return this.currentSample+=_,_*o},skipSamples:function(e){var t=0;for(null!=this.totalSample&&e>this.totalSample-this.currentSample&&(e=this.totalSample-this.currentSample);t<e;){var i=this.channelBufferEnd-this.channelBufferStart;if(e-t<=i&&(i=e-t),t+=i,this.channelBufferStart+=i,t==e||0==this.getFrameFloat())break}return this.currentSample+=e,e},setupSampleNumber:function(e,t){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(e,t))},seek:function(e,t,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(e,t),0==this.totalSample))throw new dt(new Zt(Xt.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var r=this.decodeState.pFirst,n=this.decodeState.pLast;if(i>=n.lastDecodedSample&&(i=n.lastDecodedSample-1),i<r.lastDecodedSample)this.seekFrameFromPage(e,r.pageStart,0,i);else{for(var s=0;r.pageEnd<n.pageStart;){var a=r.pageEnd,o=n.afterPreviousPageStart,l=r.lastDecodedSample,h=n.lastDecodedSample;if(null==l||null==h)throw new dt(new Zt(Xt.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));rt.gt(o,a+4e3)&&(o-=4e3);var _=a+Math.floor(rt.toFloat(o-a)/rt.toFloat(h-l)*(i-l));if(4<=s){var c=a+(o-a>>>1);8<=s?_=c:rt.gt(c,_)?_+=c-_>>>1:_=c+(_-c>>>1)}switch(++s,e(this.decodeState.inputPosition=_),this.decodeState.findPage(e,t)[1]){case 0:break;case 1:throw new dt(new Zt(Xt.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var u=this.decodeState.analyzePage(e,this.header);if(null==u)throw new dt(new Zt(Xt.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));u.afterPreviousPageStart=_,u.pageStart!=n.pageStart?i<u.lastDecodedSample?n=u:r=u:n=u}if(!(r.lastDecodedSample<=i&&i<n.lastDecodedSample))throw new dt(new Zt(Xt.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(e,n.pageStart,r.lastDecodedSample,i)}}},seekFrameFromPage:function(e,t,i,r){var n=0,s=i;e(this.decodeState.inputPosition=t),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,h=null;;){l=h,h=this.decodeState.clone(e);var _=this.decodeInitial();if(null==_){h=l;break}o=_.left.start,a=_.left.end;var c=0==n?a:o;if(r<s+_.right.start-c)break;for(var u=this.decodeState;0!=u.bytesInSeg||!u.lastSeg&&0!=u.next();)u.bytesInSeg--,u.inputPosition+=1,u.input.readByte();s+=_.right.start-c,++n}this.decodeState=h,e(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=s,this.skipSamples(r-s)},clone:function(e){var t=te.createEmptyInstance(Dt);t.currentSample=this.currentSample,t.totalSample=this.totalSample,t.previousLength=this.previousLength,t.channelBufferStart=this.channelBufferStart,t.channelBufferEnd=this.channelBufferEnd,t.a=this.a,t.b=this.b,t.c=this.c,t.window=this.window,t.bitReverseData=this.bitReverseData,t.header=this.header,t.decodeState=this.decodeState.clone(e);var i=this.header.channel,r=new Array(i);t.channelBuffers=r;var n=this.header.channel,s=new Array(n);t.previousWindow=s;var a=this.header.channel,o=new Array(a);t.finalY=o;for(var l=0,h=this.header.channel;l<h;){var _=l++;t.channelBuffers[_]=Pt.copyVector(this.channelBuffers[_]),t.previousWindow[_]=Pt.copyVector(this.previousWindow[_]),t.finalY[_]=c.array(this.finalY[_])}return t},ensurePosition:function(e){e(this.decodeState.inputPosition)},getFrameFloat:function(){var e=this.decodePacket();if(null==e)return this.channelBufferStart=this.channelBufferEnd=0,0;var t=this.finishFrame(e);return this.channelBufferStart=e.left,this.channelBufferEnd=e.left+t,t},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(e){var t=e.len,i=e.right,r=e.left;if(0!=this.previousLength)for(var n=this.previousLength,s=this.getWindow(n),a=0,o=this.header.channel;a<o;)for(var l=a++,h=this.channelBuffers[l],_=this.previousWindow[l],c=0,u=n;c<u;){var d=c++;h[r+d]=h[r+d]*s[d]+_[d]*s[n-1-d]}var f=this.previousLength;this.previousLength=t-i;for(var g=0,v=this.header.channel;g<v;)for(var p=g++,m=this.previousWindow[p],y=this.channelBuffers[p],b=0,w=t-i;b<w;){var x=b++;m[x]=y[i+x]}return 0==f?0:(t<i&&(i=t),i-r)},getWindow:function(e){return(e<<=1)==this.header.blocksize0?this.window[0]:e==this.header.blocksize1?this.window[1]:null},initBlocksize:function(e,t){var i=t>>1,r=t>>2,n=t>>3,s=this.a,a=new Array(i);s[e]=a;var o=this.b,l=new Array(i);o[e]=l;var h=this.c,_=new Array(r);h[e]=_;var c=this.window,u=new Array(i);c[e]=u;var d=this.bitReverseData,f=new Array(n);d[e]=f,Pt.computeTwiddleFactors(t,this.a[e],this.b[e],this.c[e]),Pt.computeWindow(t,this.window[e]),Pt.computeBitReverse(t,this.bitReverseData[e])},inverseMdct:function(e,t,i){for(var r=i?1:0,n=this.a[r],s=this.b[r],a=this.c[r],o=this.bitReverseData[r],l=t>>1,h=t>>2,_=t>>3,c=new Array(l),u=l-2,d=0,f=0,g=l;f!=g;)c[u+1]=e[f]*n[d]-e[f+2]*n[d+1],c[u]=e[f]*n[d+1]+e[f+2]*n[d],u-=2,d+=2,f+=4;for(f=l-3;0<=u;)c[u+1]=-e[f+2]*n[d]- -e[f]*n[d+1],c[u]=-e[f+2]*n[d+1]+-e[f]*n[d],u-=2,d+=2,f-=4;for(var v=e,p=c,m=l-8,y=h,b=0,w=h,x=0;0<=m;){var B=p[y+1]-p[b+1],S=p[y]-p[b];v[w+1]=p[y+1]+p[b+1],v[w]=p[y]+p[b],v[x+1]=B*n[m+4]-S*n[m+5],v[x]=S*n[m+4]+B*n[m+5],B=p[y+3]-p[b+3],S=p[y+2]-p[b+2],v[w+3]=p[y+3]+p[b+3],v[w+2]=p[y+2]+p[b+2],v[x+3]=B*n[m]-S*n[m+1],v[x+2]=S*n[m]+B*n[m+1],m-=8,w+=4,x+=4,y+=4,b+=4}for(var T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(t<16384?t<16?T[t]:t<512?5+T[t>>5]:10+T[t>>10]:t<16777216?t<524288?15+T[t>>15]:20+T[t>>20]:t<536870912?25+T[t>>25]:t<-2147483648?30+T[t>>30]:0)-1,I=l-1-0*h,A=I,C=I+-(t>>3),D=0,P=1+(t>>4>>2);0<--P;){var E=v[A]-v[C],N=v[A+-1]-v[C+-1],M=A,L=v;L[M]=L[M]+v[C];var R=A+-1,V=v;V[R]=V[R]+v[C+-1],v[C]=E*n[D]-N*n[D+1],v[C+-1]=N*n[D]+E*n[D+1],D+=8,E=v[A+-2]-v[C+-2],N=v[A+-3]-v[C+-3];var F=A+-2,G=v;G[F]=G[F]+v[C+-2];var U=A+-3,O=v;O[U]=O[U]+v[C+-3],v[C+-2]=E*n[D]-N*n[D+1],v[C+-3]=N*n[D]+E*n[D+1],D+=8,E=v[A+-4]-v[C+-4],N=v[A+-5]-v[C+-5];var W=A+-4,z=v;z[W]=z[W]+v[C+-4];var H=A+-5,Z=v;Z[H]=Z[H]+v[C+-5],v[C+-4]=E*n[D]-N*n[D+1],v[C+-5]=N*n[D]+E*n[D+1],D+=8,E=v[A+-6]-v[C+-6],N=v[A+-7]-v[C+-7];var X=A+-6,j=v;j[X]=j[X]+v[C+-6];var K=A+-7,Y=v;Y[K]=Y[K]+v[C+-7],v[C+-6]=E*n[D]-N*n[D+1],v[C+-7]=N*n[D]+E*n[D+1],D+=8,A-=8,C-=8}for(var Q=l-1-h,q=Q,J=Q+-(t>>3),$=0,ee=1+(t>>4>>2);0<--ee;){var te=v[q]-v[J],ie=v[q+-1]-v[J+-1],re=q,ne=v;ne[re]=ne[re]+v[J];var se=q+-1,ae=v;ae[se]=ae[se]+v[J+-1],v[J]=te*n[$]-ie*n[$+1],v[J+-1]=ie*n[$]+te*n[$+1],$+=8,te=v[q+-2]-v[J+-2],ie=v[q+-3]-v[J+-3];var oe=q+-2,le=v;le[oe]=le[oe]+v[J+-2];var he=q+-3,_e=v;_e[he]=_e[he]+v[J+-3],v[J+-2]=te*n[$]-ie*n[$+1],v[J+-3]=ie*n[$]+te*n[$+1],$+=8,te=v[q+-4]-v[J+-4],ie=v[q+-5]-v[J+-5];var ce=q+-4,ue=v;ue[ce]=ue[ce]+v[J+-4];var de=q+-5,fe=v;fe[de]=fe[de]+v[J+-5],v[J+-4]=te*n[$]-ie*n[$+1],v[J+-5]=ie*n[$]+te*n[$+1],$+=8,te=v[q+-6]-v[J+-6],ie=v[q+-7]-v[J+-7];var ge=q+-6,ve=v;ve[ge]=ve[ge]+v[J+-6];var pe=q+-7,me=v;me[pe]=me[pe]+v[J+-7],v[J+-6]=te*n[$]-ie*n[$+1],v[J+-7]=ie*n[$]+te*n[$+1],$+=8,q-=8,J-=8}for(var ye=l-1-0*_,be=0,we=ye,xe=ye+-(t>>4),Be=1+(t>>5>>2);0<--Be;){var Se=v[we]-v[xe],Te=v[we+-1]-v[xe+-1],ke=we,Ie=v;Ie[ke]=Ie[ke]+v[xe];var Ae=we+-1,Ce=v;Ce[Ae]=Ce[Ae]+v[xe+-1],v[xe]=Se*n[be]-Te*n[be+1],v[xe+-1]=Te*n[be]+Se*n[be+1],be+=16,Se=v[we+-2]-v[xe+-2],Te=v[we+-3]-v[xe+-3];var De=we+-2,Pe=v;Pe[De]=Pe[De]+v[xe+-2];var Ee=we+-3,Ne=v;Ne[Ee]=Ne[Ee]+v[xe+-3],v[xe+-2]=Se*n[be]-Te*n[be+1],v[xe+-3]=Te*n[be]+Se*n[be+1],be+=16,Se=v[we+-4]-v[xe+-4],Te=v[we+-5]-v[xe+-5];var Me=we+-4,Le=v;Le[Me]=Le[Me]+v[xe+-4];var Re=we+-5,Ve=v;Ve[Re]=Ve[Re]+v[xe+-5],v[xe+-4]=Se*n[be]-Te*n[be+1],v[xe+-5]=Te*n[be]+Se*n[be+1],be+=16,Se=v[we+-6]-v[xe+-6],Te=v[we+-7]-v[xe+-7];var Fe=we+-6,Ge=v;Ge[Fe]=Ge[Fe]+v[xe+-6];var Ue=we+-7,Oe=v;Oe[Ue]=Oe[Ue]+v[xe+-7],v[xe+-6]=Se*n[be]-Te*n[be+1],v[xe+-7]=Te*n[be]+Se*n[be+1],we-=8,xe-=8,be+=16}for(var We=l-1-_,ze=0,He=We,Ze=We+-(t>>4),Xe=1+(t>>5>>2);0<--Xe;){var je=v[He]-v[Ze],Ke=v[He+-1]-v[Ze+-1],Ye=He,Qe=v;Qe[Ye]=Qe[Ye]+v[Ze];var qe=He+-1,Je=v;Je[qe]=Je[qe]+v[Ze+-1],v[Ze]=je*n[ze]-Ke*n[ze+1],v[Ze+-1]=Ke*n[ze]+je*n[ze+1],ze+=16,je=v[He+-2]-v[Ze+-2],Ke=v[He+-3]-v[Ze+-3];var $e=He+-2,et=v;et[$e]=et[$e]+v[Ze+-2];var tt=He+-3,it=v;it[tt]=it[tt]+v[Ze+-3],v[Ze+-2]=je*n[ze]-Ke*n[ze+1],v[Ze+-3]=Ke*n[ze]+je*n[ze+1],ze+=16,je=v[He+-4]-v[Ze+-4],Ke=v[He+-5]-v[Ze+-5];var rt=He+-4,nt=v;nt[rt]=nt[rt]+v[Ze+-4];var st=He+-5,at=v;at[st]=at[st]+v[Ze+-5],v[Ze+-4]=je*n[ze]-Ke*n[ze+1],v[Ze+-5]=Ke*n[ze]+je*n[ze+1],ze+=16,je=v[He+-6]-v[Ze+-6],Ke=v[He+-7]-v[Ze+-7];var ot=He+-6,lt=v;lt[ot]=lt[ot]+v[Ze+-6];var ht=He+-7,_t=v;_t[ht]=_t[ht]+v[Ze+-7],v[Ze+-6]=je*n[ze]-Ke*n[ze+1],v[Ze+-7]=Ke*n[ze]+je*n[ze+1],He-=8,Ze-=8,ze+=16}for(var ct=l-1-2*_,ut=0,dt=ct,ft=ct+-(t>>4),gt=1+(t>>5>>2);0<--gt;){var vt=v[dt]-v[ft],pt=v[dt+-1]-v[ft+-1],mt=dt,yt=v;yt[mt]=yt[mt]+v[ft];var bt=dt+-1,wt=v;wt[bt]=wt[bt]+v[ft+-1],v[ft]=vt*n[ut]-pt*n[ut+1],v[ft+-1]=pt*n[ut]+vt*n[ut+1],ut+=16,vt=v[dt+-2]-v[ft+-2],pt=v[dt+-3]-v[ft+-3];var xt=dt+-2,Bt=v;Bt[xt]=Bt[xt]+v[ft+-2];var St=dt+-3,Tt=v;Tt[St]=Tt[St]+v[ft+-3],v[ft+-2]=vt*n[ut]-pt*n[ut+1],v[ft+-3]=pt*n[ut]+vt*n[ut+1],ut+=16,vt=v[dt+-4]-v[ft+-4],pt=v[dt+-5]-v[ft+-5];var kt=dt+-4,It=v;It[kt]=It[kt]+v[ft+-4];var At=dt+-5,Ct=v;Ct[At]=Ct[At]+v[ft+-5],v[ft+-4]=vt*n[ut]-pt*n[ut+1],v[ft+-5]=pt*n[ut]+vt*n[ut+1],ut+=16,vt=v[dt+-6]-v[ft+-6],pt=v[dt+-7]-v[ft+-7];var Dt=dt+-6,Pt=v;Pt[Dt]=Pt[Dt]+v[ft+-6];var Et=dt+-7,Nt=v;Nt[Et]=Nt[Et]+v[ft+-7],v[ft+-6]=vt*n[ut]-pt*n[ut+1],v[ft+-7]=pt*n[ut]+vt*n[ut+1],dt-=8,ft-=8,ut+=16}for(var Mt=l-1-3*_,Lt=0,Rt=Mt,Vt=Mt+-(t>>4),Ft=1+(t>>5>>2);0<--Ft;){var Gt=v[Rt]-v[Vt],Ut=v[Rt+-1]-v[Vt+-1],Ot=Rt,Wt=v;Wt[Ot]=Wt[Ot]+v[Vt];var zt=Rt+-1,Ht=v;Ht[zt]=Ht[zt]+v[Vt+-1],v[Vt]=Gt*n[Lt]-Ut*n[Lt+1],v[Vt+-1]=Ut*n[Lt]+Gt*n[Lt+1],Lt+=16,Gt=v[Rt+-2]-v[Vt+-2],Ut=v[Rt+-3]-v[Vt+-3];var Zt=Rt+-2,Xt=v;Xt[Zt]=Xt[Zt]+v[Vt+-2];var jt=Rt+-3,Kt=v;Kt[jt]=Kt[jt]+v[Vt+-3],v[Vt+-2]=Gt*n[Lt]-Ut*n[Lt+1],v[Vt+-3]=Ut*n[Lt]+Gt*n[Lt+1],Lt+=16,Gt=v[Rt+-4]-v[Vt+-4],Ut=v[Rt+-5]-v[Vt+-5];var Yt=Rt+-4,Qt=v;Qt[Yt]=Qt[Yt]+v[Vt+-4];var qt=Rt+-5,Jt=v;Jt[qt]=Jt[qt]+v[Vt+-5],v[Vt+-4]=Gt*n[Lt]-Ut*n[Lt+1],v[Vt+-5]=Ut*n[Lt]+Gt*n[Lt+1],Lt+=16,Gt=v[Rt+-6]-v[Vt+-6],Ut=v[Rt+-7]-v[Vt+-7];var $t=Rt+-6,ei=v;ei[$t]=ei[$t]+v[Vt+-6];var ti=Rt+-7,ii=v;ii[ti]=ii[ti]+v[Vt+-7],v[Vt+-6]=Gt*n[Lt]-Ut*n[Lt+1],v[Vt+-7]=Ut*n[Lt]+Gt*n[Lt+1],Rt-=8,Vt-=8,Lt+=16}for(var ri=2,ni=k-3>>1;ri<ni;)for(var si=ri++,ai=t>>si+2,oi=ai>>1,li=0,hi=1<<si+1;li<hi;)for(var _i=l-1-ai*li++,ci=1<<si+3,ui=0,di=_i,fi=_i+-oi,gi=1+(t>>si+4>>2);0<--gi;){var vi=v[di]-v[fi],pi=v[di+-1]-v[fi+-1],mi=di,yi=v;yi[mi]=yi[mi]+v[fi];var bi=di+-1,wi=v;wi[bi]=wi[bi]+v[fi+-1],v[fi]=vi*n[ui]-pi*n[ui+1],v[fi+-1]=pi*n[ui]+vi*n[ui+1],ui+=ci,vi=v[di+-2]-v[fi+-2],pi=v[di+-3]-v[fi+-3];var xi=di+-2,Bi=v;Bi[xi]=Bi[xi]+v[fi+-2];var Si=di+-3,Ti=v;Ti[Si]=Ti[Si]+v[fi+-3],v[fi+-2]=vi*n[ui]-pi*n[ui+1],v[fi+-3]=pi*n[ui]+vi*n[ui+1],ui+=ci,vi=v[di+-4]-v[fi+-4],pi=v[di+-5]-v[fi+-5];var ki=di+-4,Ii=v;Ii[ki]=Ii[ki]+v[fi+-4];var Ai=di+-5,Ci=v;Ci[Ai]=Ci[Ai]+v[fi+-5],v[fi+-4]=vi*n[ui]-pi*n[ui+1],v[fi+-5]=pi*n[ui]+vi*n[ui+1],ui+=ci,vi=v[di+-6]-v[fi+-6],pi=v[di+-7]-v[fi+-7];var Di=di+-6,Pi=v;Pi[Di]=Pi[Di]+v[fi+-6];var Ei=di+-7,Ni=v;Ni[Ei]=Ni[Ei]+v[fi+-7],v[fi+-6]=vi*n[ui]-pi*n[ui+1],v[fi+-7]=pi*n[ui]+vi*n[ui+1],di-=8,fi-=8,ui+=ci}for(var Mi=k-3>>1,Li=k-6;Mi<Li;)for(var Ri=Mi++,Vi=t>>Ri+2,Fi=1<<Ri+3,Gi=Vi>>1,Ui=1<<Ri+1,Oi=0,Wi=l-1,zi=(t>>Ri+6)+1;0<--zi;){for(var Hi=n[Oi],Zi=n[Oi+1],Xi=n[Oi+Fi],ji=n[Oi+Fi+1],Ki=n[Oi+2*Fi],Yi=n[Oi+2*Fi+1],Qi=n[Oi+3*Fi],qi=n[Oi+3*Fi+1],Ji=Wi,$i=Wi+-Gi,er=Ui+1;0<--er;){var tr=v[Ji]-v[$i],ir=v[Ji+-1]-v[$i+-1];v[Ji]=v[Ji]+v[$i],v[Ji+-1]=v[Ji+-1]+v[$i+-1],v[$i]=tr*Hi-ir*Zi,v[$i+-1]=ir*Hi+tr*Zi,tr=v[Ji+-2]-v[$i+-2],ir=v[Ji+-3]-v[$i+-3],v[Ji+-2]=v[Ji+-2]+v[$i+-2],v[Ji+-3]=v[Ji+-3]+v[$i+-3],v[$i+-2]=tr*Xi-ir*ji,v[$i+-3]=ir*Xi+tr*ji,tr=v[Ji+-4]-v[$i+-4],ir=v[Ji+-5]-v[$i+-5],v[Ji+-4]=v[Ji+-4]+v[$i+-4],v[Ji+-5]=v[Ji+-5]+v[$i+-5],v[$i+-4]=tr*Ki-ir*Yi,v[$i+-5]=ir*Ki+tr*Yi,tr=v[Ji+-6]-v[$i+-6],ir=v[Ji+-7]-v[$i+-7],v[Ji+-6]=v[Ji+-6]+v[$i+-6],v[Ji+-7]=v[Ji+-7]+v[$i+-7],v[$i+-6]=tr*Qi-ir*qi,v[$i+-7]=ir*Qi+tr*qi,Ji-=Vi,$i-=Vi}Oi+=4*Fi,Wi-=8}for(var rr=l-1,nr=n[t>>3],sr=rr,ar=rr-16*(t>>5);ar<sr;){var or=v[sr],lr=v[sr+-8];v[sr+-8]=or-lr,v[sr]=or+lr,or=v[sr+-1],lr=v[sr+-9],v[sr+-9]=or-lr,v[sr+-1]=or+lr;var hr=(or=v[sr+-2])-(lr=v[sr+-10]);v[sr+-2]=or+lr;var _r=(or=v[sr+-3])-(lr=v[sr+-11]);v[sr+-3]=or+lr,v[sr+-10]=(hr+_r)*nr,v[sr+-11]=(_r-hr)*nr,or=v[sr+-4],hr=(lr=v[sr+-12])-or,v[sr+-4]=or+lr,_r=(or=v[sr+-5])-(lr=v[sr+-13]),v[sr+-5]=or+lr,v[sr+-12]=_r,v[sr+-13]=hr,or=v[sr+-6],hr=(lr=v[sr+-14])-or,v[sr+-6]=or+lr,_r=(or=v[sr+-7])-(lr=v[sr+-15]),v[sr+-7]=or+lr,v[sr+-14]=(hr+_r)*nr,v[sr+-15]=(hr-_r)*nr;var cr=v[sr],ur=v[sr+-4],dr=cr-ur,fr=cr+ur,gr=(cr=v[sr+-2])+(ur=v[sr+-6]),vr=cr-ur;v[sr]=fr+gr,v[sr+-2]=fr-gr;var pr=v[sr+-3]-v[sr+-7];v[sr+-4]=dr+pr,v[sr+-6]=dr-pr;var mr=(cr=v[sr+-1])-(ur=v[sr+-5]),yr=cr+ur,br=v[sr+-3]+v[sr+-7];v[sr+-1]=yr+br,v[sr+-3]=yr-br,v[sr+-5]=mr-vr,v[sr+-7]=mr+vr;var wr=sr-8,xr=v[wr],Br=v[wr+-4],Sr=xr-Br,Tr=xr+Br,kr=(xr=v[wr+-2])+(Br=v[wr+-6]),Ir=xr-Br;v[wr]=Tr+kr,v[wr+-2]=Tr-kr;var Ar=v[wr+-3]-v[wr+-7];v[wr+-4]=Sr+Ar,v[wr+-6]=Sr-Ar;var Cr=(xr=v[wr+-1])-(Br=v[wr+-5]),Dr=xr+Br,Pr=v[wr+-3]+v[wr+-7];v[wr+-1]=Dr+Pr,v[wr+-3]=Dr-Pr,v[wr+-5]=Cr-Ir,v[wr+-7]=Cr+Ir,sr-=16}for(var Er=0,Nr=h-4,Mr=l-4;0<=Nr;){var Lr=o[Er];p[Mr+3]=v[Lr],p[Mr+2]=v[Lr+1],p[Nr+3]=v[Lr+2],p[Nr+2]=v[Lr+3],Lr=o[Er+1],p[Mr+1]=v[Lr],p[Mr]=v[Lr+1],p[Nr+1]=v[Lr+2],p[Nr]=v[Lr+3],Nr-=4,Mr-=4,Er+=2}for(var Rr=0,Vr=0,Fr=l-4;Vr<Fr;){var Gr=p[Vr]-p[Fr+2],Ur=p[Vr+1]+p[Fr+3],Or=a[Rr+1]*Gr+a[Rr]*Ur,Wr=a[Rr+1]*Ur-a[Rr]*Gr,zr=p[Vr]+p[Fr+2],Hr=p[Vr+1]-p[Fr+3];p[Vr]=zr+Or,p[Vr+1]=Hr+Wr,p[Fr+2]=zr-Or,p[Fr+3]=Wr-Hr,Gr=p[Vr+2]-p[Fr],Ur=p[Vr+3]+p[Fr+1],Or=a[Rr+3]*Gr+a[Rr+2]*Ur,Wr=a[Rr+3]*Ur-a[Rr+2]*Gr,zr=p[Vr+2]+p[Fr],Hr=p[Vr+3]-p[Fr+1],p[Vr+2]=zr+Or,p[Vr+3]=Hr+Wr,p[Fr]=zr-Or,p[Fr+1]=Wr-Hr,Rr+=4,Vr+=4,Fr-=4}for(var Zr=l-8,Xr=l-8,jr=0,Kr=l-4,Yr=l,Qr=t-4;0<=Xr;){var qr=c[Xr+6]*s[Zr+7]-c[Xr+7]*s[Zr+6],Jr=-c[Xr+6]*s[Zr+6]-c[Xr+7]*s[Zr+7];e[jr]=qr,e[Kr+3]=-qr,e[Yr]=Jr,e[Qr+3]=Jr;var $r=c[Xr+4]*s[Zr+5]-c[Xr+5]*s[Zr+4],en=-c[Xr+4]*s[Zr+4]-c[Xr+5]*s[Zr+5];e[jr+1]=$r,e[Kr+2]=-$r,e[Yr+1]=en,e[Qr+2]=en,qr=c[Xr+2]*s[Zr+3]-c[Xr+3]*s[Zr+2],Jr=-c[Xr+2]*s[Zr+2]-c[Xr+3]*s[Zr+3],e[jr+2]=qr,e[Kr+1]=-qr,e[Yr+2]=Jr,e[Qr+1]=Jr,$r=c[Xr]*s[Zr+1]-c[Xr+1]*s[Zr],en=-c[Xr]*s[Zr]-c[Xr+1]*s[Zr+1],e[jr+3]=$r,e[Kr]=-$r,e[Yr+3]=en,e[Qr]=en,Zr-=8,Xr-=8,jr+=4,Yr+=4,Kr-=4,Qr-=4}},decodePacket:function(){var e=this.decodeInitial();return null==e?null:this.decodePacketRest(e)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;var e,t=this.decodeState;if(t.validBits<0)e=0;else if(t.validBits<1){for(0==t.validBits&&(t.acc=0);;){if(0==t.bytesInSeg&&(t.lastSeg||0==t.next())){t.validBits=-1;break}if(t.bytesInSeg--,t.inputPosition+=1,t.acc=t.acc+(t.input.readByte()<<t.validBits),t.validBits+=8,!(t.validBits<1))break}if(t.validBits<0)e=0;else{var i=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=i}}else{var r=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=r}if(0==e)break;for(;;){var n,s=this.decodeState;if(0!=s.bytesInSeg||!s.lastSeg&&0!=s.next()?(s.bytesInSeg--,s.inputPosition+=1,n=s.input.readByte()):n=-1,s.validBits=0,-1==n)break}}var a,o=this.decodeState,l=this.header.modes.length-1,h=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],_=l<16384?l<16?h[l]:l<512?5+h[l>>5]:10+h[l>>10]:l<16777216?l<524288?15+h[l>>15]:20+h[l>>20]:l<536870912?25+h[l>>25]:l<-2147483648?30+h[l>>30]:0;if(o.validBits<0)a=0;else if(o.validBits<_)if(24<_)a=o.readBits(24)+(o.readBits(_-24)<<24);else{for(0==o.validBits&&(o.acc=0);;){if(0==o.bytesInSeg&&(o.lastSeg||0==o.next())){o.validBits=-1;break}if(o.bytesInSeg--,o.inputPosition+=1,o.acc=o.acc+(o.input.readByte()<<o.validBits),o.validBits+=8,!(o.validBits<_))break}if(o.validBits<0)a=0;else{var c=o.acc&(1<<_)-1;o.acc=o.acc>>>_,o.validBits-=_,a=c}}else{var u=o.acc&(1<<_)-1;o.acc=o.acc>>>_,o.validBits-=_,a=u}if(-1==a||a>=this.header.modes.length)throw new dt(new Zt(Xt.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var d,f,g,v=this.header.modes[a];if(v.blockflag){d=this.header.blocksize1;var p=this.decodeState;if(p.validBits<0)f=0;else if(p.validBits<1){for(0==p.validBits&&(p.acc=0);;){if(0==p.bytesInSeg&&(p.lastSeg||0==p.next())){p.validBits=-1;break}if(p.bytesInSeg--,p.inputPosition+=1,p.acc=p.acc+(p.input.readByte()<<p.validBits),p.validBits+=8,!(p.validBits<1))break}if(p.validBits<0)f=0;else{var m=1&p.acc;p.acc=p.acc>>>1,p.validBits-=1,f=m}}else{var y=1&p.acc;p.acc=p.acc>>>1,p.validBits-=1,f=y}var b=this.decodeState;if(b.validBits<0)g=0;else if(b.validBits<1){for(0==b.validBits&&(b.acc=0);;){if(0==b.bytesInSeg&&(b.lastSeg||0==b.next())){b.validBits=-1;break}if(b.bytesInSeg--,b.inputPosition+=1,b.acc=b.acc+(b.input.readByte()<<b.validBits),b.validBits+=8,!(b.validBits<1))break}if(b.validBits<0)g=0;else{var w=1&b.acc;b.acc=b.acc>>>1,b.validBits-=1,g=w}}else{var x=1&b.acc;b.acc=b.acc>>>1,b.validBits-=1,g=x}}else f=g=0,d=this.header.blocksize0;var B=d>>1;return{mode:a,left:v.blockflag&&0==f?{start:d-this.header.blocksize0>>2,end:d+this.header.blocksize0>>2}:{start:0,end:B},right:v.blockflag&&0==g?{start:3*d-this.header.blocksize0>>2,end:3*d+this.header.blocksize0>>2}:{start:B,end:d}}},decodePacketRest:function(e){for(var t=this.header.modes[e.mode],i=new Array(256),r=new Array(256),n=t.blockflag?this.header.blocksize1:this.header.blocksize0,s=this.header.mapping[t.mapping],a=n>>1,o=[256,128,86,64],l=this.header.codebooks,h=0,_=this.header.channel;h<_;){var c=h++,u=s.chan[c].mux;i[c]=!1;var d=this.header.floorConfig[s.submapFloor[u]];if(0==d.type)throw new dt(new Zt(Xt.INVALID_STREAM,null,{fileName:"VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f,g=d.floor1,v=this.decodeState;if(v.validBits<0)f=0;else if(v.validBits<1){for(0==v.validBits&&(v.acc=0);;){if(0==v.bytesInSeg&&(v.lastSeg||0==v.next())){v.validBits=-1;break}if(v.bytesInSeg--,v.inputPosition+=1,v.acc=v.acc+(v.input.readByte()<<v.validBits),v.validBits+=8,!(v.validBits<1))break}if(v.validBits<0)f=0;else{var p=1&v.acc;v.acc=v.acc>>>1,v.validBits-=1,f=p}}else{var m=1&v.acc;v.acc=v.acc>>>1,v.validBits-=1,f=m}if(0!=f){var y=[],b=new Array(256),w=o[g.floor1Multiplier-1],x=2;y=this.finalY[c];var B,S=this.decodeState,T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(w<16384?w<16?T[w]:w<512?5+T[w>>5]:10+T[w>>10]:w<16777216?w<524288?15+T[w>>15]:20+T[w>>20]:w<536870912?25+T[w>>25]:w<-2147483648?30+T[w>>30]:0)-1;if(S.validBits<0)B=0;else if(S.validBits<k)if(24<k)B=S.readBits(24)+(S.readBits(k-24)<<24);else{for(0==S.validBits&&(S.acc=0);;){if(0==S.bytesInSeg&&(S.lastSeg||0==S.next())){S.validBits=-1;break}if(S.bytesInSeg--,S.inputPosition+=1,S.acc=S.acc+(S.input.readByte()<<S.validBits),S.validBits+=8,!(S.validBits<k))break}if(S.validBits<0)B=0;else{var I=S.acc&(1<<k)-1;S.acc=S.acc>>>k,S.validBits-=k,B=I}}else{var A=S.acc&(1<<k)-1;S.acc=S.acc>>>k,S.validBits-=k,B=A}y[0]=B;var C,D=this.decodeState,P=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],E=(w<16384?w<16?P[w]:w<512?5+P[w>>5]:10+P[w>>10]:w<16777216?w<524288?15+P[w>>15]:20+P[w>>20]:w<536870912?25+P[w>>25]:w<-2147483648?30+P[w>>30]:0)-1;if(D.validBits<0)C=0;else if(D.validBits<E)if(24<E)C=D.readBits(24)+(D.readBits(E-24)<<24);else{for(0==D.validBits&&(D.acc=0);;){if(0==D.bytesInSeg&&(D.lastSeg||0==D.next())){D.validBits=-1;break}if(D.bytesInSeg--,D.inputPosition+=1,D.acc=D.acc+(D.input.readByte()<<D.validBits),D.validBits+=8,!(D.validBits<E))break}if(D.validBits<0)C=0;else{var N=D.acc&(1<<E)-1;D.acc=D.acc>>>E,D.validBits-=E,C=N}}else{var M=D.acc&(1<<E)-1;D.acc=D.acc>>>E,D.validBits-=E,C=M}y[1]=C;for(var L=0,R=g.partitions;L<R;){var V=L++,F=g.partitionClassList[V],G=g.classDimensions[F],U=g.classSubclasses[F],O=(1<<U)-1,W=0;if(0!=U){var z=l[g.classMasterbooks[F]],H=this.decodeState;H.validBits<10&&H.prepHuffman();var Z,X=z.fastHuffman[1023&H.acc];if(0<=X){var j=z.codewordLengths[X];H.acc=H.acc>>>j,H.validBits-=j,H.validBits<0?(H.validBits=0,Z=-1):Z=X}else Z=H.decodeScalarRaw(z);z.sparse&&(Z=z.sortedValues[Z]),W=Z}for(var K=g.subclassBooks[F],Y=0,Q=G;Y<Q;){Y++;var q=K[W&O];W>>=U;var J,$=x++;if(0<=q){var ee=this.decodeState,te=l[q];ee.validBits<10&&ee.prepHuffman();var ie,re=te.fastHuffman[1023&ee.acc];if(0<=re){var ne=te.codewordLengths[re];ee.acc=ee.acc>>>ne,ee.validBits-=ne,ee.validBits<0?(ee.validBits=0,ie=-1):ie=re}else ie=ee.decodeScalarRaw(te);te.sparse&&(ie=te.sortedValues[ie]),J=ie}else J=0;y[$]=J}}if(-1==this.decodeState.validBits){i[c]=!0;continue}b[0]=b[1]=!0;for(var se=g.neighbors,ae=g.xlist,oe=2,le=g.values;oe<le;){var he=oe++,_e=se[he][0],ce=se[he][1],ue=ae[_e],de=y[_e],fe=y[ce]-de,ge=ae[ce]-ue,ve=Math.abs(fe)*(ae[he]-ue)/ge|0,pe=fe<0?de-ve:de+ve,me=y[he],ye=w-pe,be=ye<pe?2*ye:2*pe;0!=me?(b[_e]=b[ce]=!0,b[he]=!0,y[he]=be<=me?pe<ye?me-pe+pe:pe-me+ye-1:0!=(1&me)?pe-(me+1>>1):pe+(me>>1)):(b[he]=!1,y[he]=pe)}for(var we=0,xe=g.values;we<xe;){var Be=we++;b[Be]||(y[Be]=-1)}}else i[c]=!0}for(var Se=0,Te=this.header.channel;Se<Te;){var ke=Se++;r[ke]=i[ke]}for(var Ie=0,Ae=s.couplingSteps;Ie<Ae;){var Ce=Ie++;i[s.chan[Ce].magnitude]&&i[s.chan[Ce].angle]||(i[s.chan[Ce].magnitude]=i[s.chan[Ce].angle]=!1)}for(var De=0,Pe=s.submaps;De<Pe;){for(var Ee=De++,Ne=this.header.channel,Me=new Array(Ne),Le=new Array(256),Re=0,Ve=0,Fe=this.header.channel;Ve<Fe;){var Ge=Ve++;s.chan[Ge].mux==Ee&&(i[Ge]?(Le[Re]=!0,Me[Re]=null):(Le[Re]=!1,Me[Re]=this.channelBuffers[Ge]),++Re)}var Ue=s.submapResidue[Ee];this.header.residueConfig[Ue].decode(this.decodeState,this.header,Me,Re,a,Le,this.channelBuffers)}for(var Oe=s.couplingSteps,We=n>>1;0<=--Oe;)for(var ze=this.channelBuffers[s.chan[Oe].magnitude],He=this.channelBuffers[s.chan[Oe].angle],Ze=0,Xe=We;Ze<Xe;){var je,Ke,Ye=Ze++;0<ze[Ye]?0<He[Ye]?(Ke=ze[Ye],je=ze[Ye]-He[Ye]):(je=ze[Ye],Ke=ze[Ye]+He[Ye]):0<He[Ye]?(Ke=ze[Ye],je=ze[Ye]+He[Ye]):(je=ze[Ye],Ke=ze[Ye]-He[Ye]),ze[Ye]=Ke,He[Ye]=je}for(var Qe=0,qe=this.header.channel;Qe<qe;){var Je=Qe++;if(r[Je])for(var $e=0,et=We;$e<et;){var tt=$e++;this.channelBuffers[Je][tt]=0}else s.doFloor(this.header.floorConfig,Je,n,this.channelBuffers[Je],this.finalY[Je],null)}for(var it=0,rt=this.header.channel;it<rt;){var nt=it++;this.inverseMdct(this.channelBuffers[nt],n,t.blockflag)}for(var st=this.decodeState;0!=st.bytesInSeg||!st.lastSeg&&0!=st.next();)st.bytesInSeg--,st.inputPosition+=1,st.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,n,e)},__class__:Dt};var Pt=function(){};(i["kha.audio2.ogg.vorbis.VorbisTools"]=Pt).__name__=!0,Pt.assert=function(e,t){},Pt.neighbors=function(e,t){for(var i=-1,r=65536,n=0,s=0,a=0,o=t;a<o;){var l=a++;e[l]>i&&e[l]<e[t]&&(i=e[n=l]),e[l]<r&&e[l]>e[t]&&(r=e[s=l])}return{low:n,high:s}},Pt.floatUnpack=function(e){var t=rt.toFloat(2097151&e),i=(2145386496&e)>>>21;return(0!=(-2147483648&e)?-t:t)*Math.pow(2,i-788)},Pt.bitReverse=function(e){return(e=(-16711936&(e=(-252645136&(e=(-858993460&(e=(-1431655766&e)>>>1|(1431655765&e)<<1))>>>2|(858993459&e)<<2))>>>4|(252645135&e)<<4))>>>8|(16711935&e)<<8)>>>16|e<<16},Pt.pointCompare=function(e,t){return e.x<t.x?-1:e.x>t.x?1:0},Pt.uintAsc=function(e,t){return rt.gt(t,e)?-1:e==t?0:1},Pt.lookup1Values=function(e,t){var i=0|Math.exp(Math.log(e)/t);(0|Math.pow(i+1,t))<=e&&++i;Math.pow(i+1,t),Math.pow(i,t);return i},Pt.computeWindow=function(e,t){for(var i=e>>1,r=0,n=i;r<n;){var s=r++;t[s]=Math.sin(1.5707963267948966*Pt.square(Math.sin((s+.5)/i*.5*3.141592653589793)))}},Pt.square=function(e){return e*e},Pt.computeBitReverse=function(e,t){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],r=(e<16384?e<16?i[e]:e<512?5+i[e>>5]:10+i[e>>10]:e<16777216?e<524288?15+i[e>>15]:20+i[e>>20]:e<536870912?25+i[e>>25]:e<-2147483648?30+i[e>>30]:0)-1,n=0,s=e>>3;n<s;){var a=n++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,t[a]=(o>>>16|o<<16)>>>32-r+3<<2}},Pt.computeTwiddleFactors=function(e,t,i,r){for(var n=e>>3,s=0,a=0,o=e>>2;a<o;){var l=a++;t[s]=Math.cos(4*l*3.141592653589793/e),t[s+1]=-Math.sin(4*l*3.141592653589793/e),i[s]=.5*Math.cos(3.141592653589793*(s+1)/e/2),i[s+1]=.5*Math.sin(3.141592653589793*(s+1)/e/2),s+=2}for(var h=0,_=0,c=n;_<c;){_++;r[h]=Math.cos(2*(h+1)*3.141592653589793/e),r[h+1]=-Math.sin(2*(h+1)*3.141592653589793/e),h+=2}},Pt.drawLine=function(e,t,i,r,n,s){if(null==Pt.integerDivideTable){var a=new Array(32);Pt.integerDivideTable=a;for(var o=0;o<32;){var l=o++,h=Pt.integerDivideTable,_=new Array(64);h[l]=_;for(var c=1;c<64;){var u=c++;Pt.integerDivideTable[l][u]=l/u|0}}}var d,f,g=n-i,v=r-t,p=g<0?-g:g,m=t,y=i,b=0;v<64&&p<32?f=g<0?(d=-Pt.integerDivideTable[p][v])-1:(d=Pt.integerDivideTable[p][v])+1:(d=g/v|0,f=g<0?d-1:d+1),p-=(d<0?-d:d)*v,s<r&&(r=s);var w=m,x=e;x[w]=x[w]*Pt.INVERSE_DB_TABLE[y];for(var B=m+1,S=r;B<S;){v<=(b+=p)?(b-=v,y+=f):y+=d;var T=B++,k=e;k[T]=k[T]*Pt.INVERSE_DB_TABLE[y]}},Pt.predictPoint=function(e,t,i,r,n){var s=n-r,a=i-t,o=Math.abs(s)*(e-t)/a|0;return s<0?r-o:r+o},Pt.emptyFloatVector=function(e){return new Array(e)},Pt.copyVector=function(e){for(var t=e.length,i=new Array(t),r=0,n=e.length;r<n;){var s=r++;i[s]=e[s]}return i};var Et=function(){};(i["kha.audio2.ogg.vorbis.data.Codebook"]=Et).__name__=!0,Et.read=function(e){var t,i,r,n,s,a,o,l,h,_,c=new Et;if(e.validBits<0)r=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)r=0;else{var u=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=u}}else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=d}if(66==r){var f;if(e.validBits<0)f=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)f=0;else{var g=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=g}}else{var v=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=v}i=67!=f}else i=!0;if(i)t=!0;else{var p;if(e.validBits<0)p=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)p=0;else{var m=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,p=m}}else{var y=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,p=y}t=86!=p}if(t)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(e.validBits<0)n=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)n=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=b}}else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=w}if(e.validBits<0)s=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)s=0;else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=x}}else{var B=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=B}if(c.dimensions=(s<<8)+n,e.validBits<0)a=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)a=0;else{var S=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=S}}else{var T=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=T}if(e.validBits<0)o=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)o=0;else{var k=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=k}}else{var I=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=I}if(e.validBits<0)l=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)l=0;else{var A=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=A}}else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=C}if(c.entries=(l<<16)+(o<<8)+a,e.validBits<0)h=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)h=0;else{var D=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,h=D}}else{var P=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,h=P}if(0!=h)_=!1;else{var E;if(e.validBits<0)E=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)E=0;else{var N=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,E=N}}else{var M=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,E=M}_=0!=E}c.sparse=_;var L=c.entries,R=new Array(L);c.sparse||(c.codewordLengths=R);var V,F=0;if(0!=h){var G,U=0;if(e.validBits<0)G=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)G=0;else{var O=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,G=O}}else{var W=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,G=W}for(var z=G+1;U<c.entries;){var H,Z=c.entries-U,X=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],j=Z<16384?Z<16?X[Z]:Z<512?5+X[Z>>5]:10+X[Z>>10]:Z<16777216?Z<524288?15+X[Z>>15]:20+X[Z>>20]:Z<536870912?25+X[Z>>25]:Z<-2147483648?30+X[Z>>30]:0;if(e.validBits<0)H=0;else if(e.validBits<j)if(24<j)H=e.readBits(24)+(e.readBits(j-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<j))break}if(e.validBits<0)H=0;else{var K=e.acc&(1<<j)-1;e.acc=e.acc>>>j,e.validBits-=j,H=K}}else{var Y=e.acc&(1<<j)-1;e.acc=e.acc>>>j,e.validBits-=j,H=Y}if(U+H>c.entries)throw new dt(new Zt(Xt.INVALID_SETUP,"codebook entrys",{fileName:"Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var Q=0,q=H;Q<q;){R[U+Q++]=z}U+=H,++z}}else for(var J=0,$=c.entries;J<$;){var ee,te=J++;if(c.sparse)if(e.validBits<0)ee=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)ee=0;else{var ie=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,ee=ie}}else{var re=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,ee=re}else ee=1;if(0!=ee){var ne;if(e.validBits<0)ne=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)ne=0;else{var se=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,ne=se}}else{var ae=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,ne=ae}R[te]=ne+1,++F}else R[te]=255}if(c.sparse&&F>=c.entries>>2&&(c.codewordLengths=R,c.sparse=!1),c.sparse)V=F;else{for(var oe=0,le=0,he=c.entries;le<he;){var _e=R[le++];10<_e&&255!=_e&&++oe}V=oe}c.sortedEntries=V;var ce,ue=null;if(c.sparse){if(0!=c.sortedEntries){var de=c.sortedEntries,fe=new Array(de);c.codewordLengths=fe;var ge=c.entries,ve=new Array(ge);c.codewords=ve;var pe=c.entries;ue=new Array(pe)}c.entries,c.sortedEntries}else{var me=c.entries,ye=new Array(me);c.codewords=ye}if(!c.computeCodewords(R,c.entries,ue))throw new dt(new Zt(Xt.INVALID_SETUP,"compute codewords",{fileName:"Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=c.sortedEntries){c.sortedCodewords=[];var be=c.sortedEntries,we=new Array(be);c.sortedValues=we,c.computeSortedHuffman(R,ue)}if(c.sparse&&(ue=null,R=c.codewords=null),c.computeAcceleratedHuffman(),e.validBits<0)ce=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)ce=0;else{var xe=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ce=xe}}else{var Be=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ce=Be}if(c.lookupType=ce,2<c.lookupType)throw new dt(new Zt(Xt.INVALID_SETUP,"codebook lookup type",{fileName:"Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<c.lookupType){var Se;if(e.validBits<0)Se=0;else if(e.validBits<32)Se=e.readBits(24)+(e.readBits(8)<<24);else{var Te=-1&e.acc;e.acc=e.acc>>>32,e.validBits-=32,Se=Te}var ke,Ie=rt.toFloat(2097151&Se),Ae=(2145386496&Se)>>>21,Ce=0!=(-2147483648&Se)?-Ie:Ie;if(c.minimumValue=Ce*Math.pow(2,Ae-788),e.validBits<0)ke=0;else if(e.validBits<32)ke=e.readBits(24)+(e.readBits(8)<<24);else{var De=-1&e.acc;e.acc=e.acc>>>32,e.validBits-=32,ke=De}var Pe,Ee,Ne=rt.toFloat(2097151&ke),Me=(2145386496&ke)>>>21,Le=0!=(-2147483648&ke)?-Ne:Ne;if(c.deltaValue=Le*Math.pow(2,Me-788),e.validBits<0)Pe=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)Pe=0;else{var Re=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,Pe=Re}}else{var Ve=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,Pe=Ve}if(c.valueBits=Pe+1,e.validBits<0)Ee=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)Ee=0;else{var Fe=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ee=Fe}}else{var Ge=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ee=Ge}c.sequenceP=0!=Ee,1==c.lookupType?c.lookupValues=Pt.lookup1Values(c.entries,c.dimensions):c.lookupValues=c.entries*c.dimensions;for(var Ue=c.lookupValues,Oe=new Array(Ue),We=0,ze=c.lookupValues;We<ze;){var He,Ze=We++,Xe=c.valueBits;if(e.validBits<0)He=0;else if(e.validBits<Xe)if(24<Xe)He=e.readBits(24)+(e.readBits(Xe-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<Xe))break}if(e.validBits<0)He=0;else{var je=e.acc&(1<<Xe)-1;e.acc=e.acc>>>Xe,e.validBits-=Xe,He=je}}else{var Ke=e.acc&(1<<Xe)-1;e.acc=e.acc>>>Xe,e.validBits-=Xe,He=Ke}if(-1==He)throw new dt(new Zt(Xt.INVALID_SETUP,"fail lookup",{fileName:"Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));Oe[Ze]=He}var Ye=c.lookupValues,Qe=new Array(Ye);c.multiplicands=Qe;for(var qe=0,Je=c.lookupValues;qe<Je;){var $e=qe++;c.multiplicands[$e]=Oe[$e]*c.deltaValue+c.minimumValue}if(2==c.lookupType&&c.sequenceP){for(var et=1,tt=c.lookupValues;et<tt;){var it=et++;c.multiplicands[it]=c.multiplicands[it-1]}c.sequenceP=!1}}return c},Et.prototype={addEntry:function(e,t,i,r,n){this.sparse?(this.codewords[i]=e,this.codewordLengths[i]=r,n[i]=t):this.codewords[t]=e},includeInSort:function(e){return!!this.sparse||255!=e&&10<e},computeCodewords:function(e,t,i){for(var r=new Array(32),n=0;n<32;){r[n++]=0}for(var s=0;s<t&&!(e[s]<255);)++s;if(s==t){this.sortedEntries;return!0}var a=0,o=a++;this.sparse?(this.codewords[o]=0,this.codewordLengths[o]=e[s],i[o]=s):this.codewords[s]=0;for(var l=0;++l<=e[s];)r[l]=1<<32-l;for(l=s;++l<t;){var h=e[l];if(255!=h){for(;0<h&&0==r[h];)--h;if(0==h)return!1;var _=r[h];r[h]=0;var c=_,u=(c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8)>>>16|c<<16,d=a++;if(this.sparse?(this.codewords[d]=u,this.codewordLengths[d]=e[l],i[d]=l):this.codewords[l]=u,h!=e[l])for(var f=e[l];h<f;)r[f]=_+(1<<32-f),--f}}return!0},computeSortedHuffman:function(e,t){if(this.sparse)for(var i=0,r=this.sortedEntries;i<r;){var n=i++,s=this.codewords[n];s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,this.sortedCodewords[n]=s>>>16|s<<16}else{for(var a=0,o=0,l=this.entries;o<l;){var h=o++,_=e[h];if(this.sparse||255!=_&&10<_){var c=this.codewords[h];c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,this.sortedCodewords[a++]=c>>>16|c<<16}}this.sortedEntries}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Pt.uintAsc);for(var u=0,d=this.sparse?this.sortedEntries:this.entries;u<d;){var f=u++,g=this.sparse?e[t[f]]:e[f];if(this.sparse||255!=g&&10<g){for(var v=this.codewords[f],p=(v=(-16711936&(v=(-252645136&(v=(-858993460&(v=(-1431655766&v)>>>1|(1431655765&v)<<1))>>>2|(858993459&v)<<2))>>>4|(252645135&v)<<4))>>>8|(16711935&v)<<8)>>>16|v<<16,m=0,y=this.sortedEntries;1<y;){var b=m+(y>>1);rt.gte(p,this.sortedCodewords[b])?(m=b,y-=y>>1):y>>=1}this.sparse?(this.sortedValues[m]=t[f],this.codewordLengths[m]=g):this.sortedValues[m]=f}}},computeAcceleratedHuffman:function(){var e=new Array(1024);this.fastHuffman=e,this.fastHuffman[0]=-1;for(var t=0;t<1024;){var i=t++;this.fastHuffman[i]=-1}for(var r=0,n=this.sparse?this.sortedEntries:this.entries;r<n;){var s=r++;if(this.codewordLengths[s]<=10){var a;if(this.sparse){var o=this.sortedCodewords[s];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[s];for(;a<1024;)this.fastHuffman[a]=s,a+=1<<this.codewordLengths[s]}}},codebookDecode:function(e,t,i,r){e.validBits<10&&e.prepHuffman();var n,s=this.fastHuffman[1023&e.acc];if(0<=s){var a=this.codewordLengths[s];e.acc=e.acc>>>a,e.validBits-=a,e.validBits<0?(e.validBits=0,n=-1):n=s}else n=e.decodeScalarRaw(this);this.sparse&&(n=this.sortedValues[n]);var o=n,l=this.lookupValues,h=this.sequenceP,_=this.multiplicands,c=this.minimumValue;if(o<0)return!1;if(r>this.dimensions&&(r=this.dimensions),1==this.lookupType){for(var u=1,d=0,f=0,g=r;f<g;){var v=f++,p=_[rt.toFloat(o/u|0)%rt.toFloat(l)|0]+d,m=i+v,y=t;y[m]=y[m]+p,h&&(d=p+c),u*=l}return!0}if(o*=this.dimensions,h)for(var b=0,w=0,x=r;w<x;){var B=w++,S=_[o+B]+b,T=i+B,k=t;k[T]=k[T]+S,b=S+c}else for(var I=0,A=r;I<A;){var C=I++,D=i+C,P=t;P[D]=P[D]+(_[o+C]+0)}return!0},codebookDecodeStep:function(e,t,i,r,n){e.validBits<10&&e.prepHuffman();var s,a=this.fastHuffman[1023&e.acc];if(0<=a){var o=this.codewordLengths[a];e.acc=e.acc>>>o,e.validBits-=o,e.validBits<0?(e.validBits=0,s=-1):s=a}else s=e.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,h=0;if(l<0)return!1;r>this.dimensions&&(r=this.dimensions);var _=this.lookupValues,c=this.sequenceP,u=this.multiplicands;if(1==this.lookupType){for(var d=1,f=0,g=r;f<g;){var v=f++,p=u[rt.toFloat(l/d|0)%rt.toFloat(_)|0]+h,m=i+v*n,y=t;y[m]=y[m]+p,c&&(h=p),d*=_}return!0}l*=this.dimensions;for(var b=0,w=r;b<w;){var x=b++,B=u[l+x]+h,S=i+x*n,T=t;T[S]=T[S]+B,c&&(h=B)}return!0},decodeStart:function(e){e.validBits<10&&e.prepHuffman();var t,i=this.fastHuffman[1023&e.acc];if(0<=i){var r=this.codewordLengths[i];e.acc=e.acc>>>r,e.validBits-=r,e.validBits<0?(e.validBits=0,t=-1):t=i}else t=e.decodeScalarRaw(this);return this.sparse&&(t=this.sortedValues[t]),t},decodeDeinterleaveRepeat:function(e,t,i,r,n,s,a){var o=this.dimensions;if(0==this.lookupType)throw new dt(new Zt(Xt.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,h=this.sequenceP,_=this.lookupValues;0<a;){var c=0;e.validBits<10&&e.prepHuffman();var u,d=this.fastHuffman[1023&e.acc];if(0<=d){var f=this.codewordLengths[d];e.acc=e.acc>>>f,e.validBits-=f,e.validBits<0?(e.validBits=0,u=-1):u=d}else u=e.decodeScalarRaw(this);this.sparse&&(u=this.sortedValues[u]);var g=u;if(g<0){if(0==e.bytesInSeg&&e.lastSeg)return null;throw new dt(new Zt(Xt.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(s*i<r+n*i+o&&(o=s*i-(n*i-r)),1==this.lookupType){var v=1;if(h)for(var p=0,m=o;p<m;){p++;var y=l[rt.toFloat(g/v|0)%rt.toFloat(_)|0]+c,b=n,w=t[r];w[b]=w[b]+y,++r==i&&(r=0,++n),c=y,v*=_}else for(var x=0,B=o;x<B;){x++;var S=l[rt.toFloat(g/v|0)%rt.toFloat(_)|0]+c,T=n,k=t[r];k[T]=k[T]+S,++r==i&&(r=0,++n),v*=_}}else if(g*=this.dimensions,h)for(var I=0,A=o;I<A;){var C=l[g+I++]+c,D=n,P=t[r];P[D]=P[D]+C,++r==i&&(r=0,++n),c=C}else for(var E=0,N=o;E<N;){var M=l[g+E++]+c,L=n,R=t[r];R[L]=R[L]+M,++r==i&&(r=0,++n)}a-=o}return{cInter:r,pInter:n}},residueDecode:function(e,t,i,r,n){if(0==n)for(var s=r/this.dimensions|0,a=0,o=s;a<o;){var l=a++;if(!this.codebookDecodeStep(e,t,i+l,r-i-l,s))return!1}else for(var h=0;h<r;){if(!this.codebookDecode(e,t,i,r-h))return!1;h+=this.dimensions,i+=this.dimensions}return!0},__class__:Et};var Nt=function(){this.data=new Ie};(i["kha.audio2.ogg.vorbis.data.Comment"]=Nt).__name__=!0,Nt.prototype={get_title:function(){return this.getString("title")},get_loopStart:function(){return E.parseInt(this.getString("loopstart"))},get_loopLength:function(){return E.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(e,t){e=e.toLowerCase();var i=this.data;if(null!=$r[e]?i.existsReserved(e):i.h.hasOwnProperty(e)){var r=this.data;(null!=$r[e]?r.getReserved(e):r.h[e]).push(t)}else{var n=[t],s=this.data;null!=$r[e]?s.setReserved(e,n):s.h[e]=n}},getString:function(e){e=e.toLowerCase();var t=this.data;if(null!=$r[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var i=this.data;return(null!=$r[e]?i.getReserved(e):i.h[e])[0]}return null},getArray:function(e){e=e.toLowerCase();var t=this.data;if(null!=$r[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var i=this.data;return null!=$r[e]?i.getReserved(e):i.h[e]}return null},__class__:Nt,__properties__:{get_artists:"get_artists",get_isrc:"get_isrc",get_contact:"get_contact",get_location:"get_location",get_date:"get_date",get_genre:"get_genre",get_description:"get_description",get_artist:"get_artist",get_license:"get_license",get_copyright:"get_copyright",get_performer:"get_performer",get_tracknumber:"get_tracknumber",get_organization:"get_organization",get_album:"get_album",get_version:"get_version",get_loopLength:"get_loopLength",get_loopStart:"get_loopStart",get_title:"get_title"}};var Mt=function(){};(i["kha.audio2.ogg.vorbis.data.Floor"]=Mt).__name__=!0,Mt.read=function(e,t){var i,r=new Mt;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var n=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=n}}else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}if(r.type=i,1<r.type)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==r.type){var a,o,l,h,_,c,u=r.floor0=new Lt;if(e.validBits<0)a=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)a=0;else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=d}}else{var f=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=f}if(u.order=a,e.validBits<0)o=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)o=0;else{var g=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=g}}else{var v=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=v}if(u.rate=o,e.validBits<0)l=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)l=0;else{var p=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=p}}else{var m=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=m}if(u.barkMapSize=l,e.validBits<0)h=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)h=0;else{var y=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=y}}else{var b=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=b}if(u.amplitudeBits=h,e.validBits<0)_=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)_=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_=x}if(u.amplitudeOffset=_,e.validBits<0)c=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)c=0;else{var B=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,c=B}}else{var S=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,c=S}u.numberOfBooks=c+1;for(var T=0,k=u.numberOfBooks;T<k;){var I,A=T++,C=u.bookList;if(e.validBits<0)I=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)I=0;else{var D=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=D}}else{var P=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=P}C[A]=I}throw new dt(new Zt(Xt.FEATURE_NOT_SUPPORTED,null,{fileName:"Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var E,N=[],M=r.floor1=new Rt,L=-1;if(e.validBits<0)E=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)E=0;else{var R=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,E=R}}else{var V=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,E=V}M.partitions=E;var F=M.partitions,G=new Array(F);M.partitionClassList=G;for(var U=0,O=M.partitions;U<O;){var W,z=U++,H=M.partitionClassList;if(e.validBits<0)W=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)W=0;else{var Z=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,W=Z}}else{var X=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,W=X}H[z]=W,M.partitionClassList[z]>L&&(L=M.partitionClassList[z])}var j=new Array(L+1);M.classDimensions=j;var K=new Array(L+1);M.classMasterbooks=K;var Y=new Array(L+1);M.classSubclasses=Y;var Q=new Array(L+1);M.subclassBooks=Q;for(var q,J,$=0,ee=L+1;$<ee;){var te,ie=$++,re=M.classDimensions;if(e.validBits<0)te=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)te=0;else{var ne=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=ne}}else{var se=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=se}re[ie]=te+1;var ae,oe=M.classSubclasses;if(e.validBits<0)ae=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)ae=0;else{var le=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ae=le}}else{var he=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ae=he}if(oe[ie]=ae,0!=M.classSubclasses[ie]){var _e,ce=M.classMasterbooks;if(e.validBits<0)_e=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)_e=0;else{var ue=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_e=ue}}else{var de=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_e=de}if(ce[ie]=_e,M.classMasterbooks[ie]>=t.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var fe=1<<M.classSubclasses[ie],ge=M.subclassBooks,ve=new Array(fe);ge[ie]=ve;for(var pe=0,me=fe;pe<me;){var ye,be=pe++,we=M.subclassBooks[ie];if(e.validBits<0)ye=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)ye=0;else{var xe=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ye=xe}}else{var Be=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ye=Be}if(we[be]=ye-1,M.subclassBooks[ie][be]>=t.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}if(e.validBits<0)q=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)q=0;else{var Se=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,q=Se}}else{var Te=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,q=Te}if(M.floor1Multiplier=q+1,e.validBits<0)J=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)J=0;else{var ke=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,J=ke}}else{var Ie=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,J=Ie}M.rangebits=J;var Ae=new Array(250);M.xlist=Ae,M.xlist[0]=0,M.xlist[1]=1<<M.rangebits,M.values=2;for(var Ce=0,De=M.partitions;Ce<De;)for(var Pe=Ce++,Ee=M.partitionClassList[Pe],Ne=0,Me=M.classDimensions[Ee];Ne<Me;){Ne++;var Le,Re=M.xlist,Ve=M.values,Fe=M.rangebits;if(e.validBits<0)Le=0;else if(e.validBits<Fe)if(24<Fe)Le=e.readBits(24)+(e.readBits(Fe-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<Fe))break}if(e.validBits<0)Le=0;else{var Ge=e.acc&(1<<Fe)-1;e.acc=e.acc>>>Fe,e.validBits-=Fe,Le=Ge}}else{var Ue=e.acc&(1<<Fe)-1;e.acc=e.acc>>>Fe,e.validBits-=Fe,Le=Ue}Re[Ve]=Le,M.values++}for(var Oe=0,We=M.values;Oe<We;){var ze=Oe++;N.push(new Ft),N[ze].x=M.xlist[ze],N[ze].y=ze}N.sort(Pt.pointCompare);var He=M.values,Ze=new Array(He);M.sortedOrder=Ze;for(var Xe=0,je=M.values;Xe<je;){var Ke=Xe++;M.sortedOrder[Ke]=N[Ke].y}var Ye=M.values,Qe=new Array(Ye);M.neighbors=Qe;for(var qe=2,Je=M.values;qe<Je;){for(var $e,et,tt=qe++,it=M.xlist,rt=-1,nt=65536,st=0,at=0,ot=0,lt=tt;ot<lt;){var ht=ot++;it[ht]>rt&&it[ht]<it[tt]&&(rt=it[st=ht]),it[ht]<nt&&it[ht]>it[tt]&&(nt=it[at=ht])}$e=st,et=at;var _t=M.neighbors,ct=M.values,ut=new Array(ct);_t[tt]=ut,M.neighbors[tt][0]=$e,M.neighbors[tt][1]=et}return r},Mt.prototype={__class__:Mt};var Lt=function(){};(i["kha.audio2.ogg.vorbis.data.Floor0"]=Lt).__name__=!0,Lt.prototype={__class__:Lt};var Rt=function(){};(i["kha.audio2.ogg.vorbis.data.Floor1"]=Rt).__name__=!0,Rt.prototype={__class__:Rt};var Vt=function(){};(i["kha.audio2.ogg.vorbis.data.Header"]=Vt).__name__=!0,Vt.read=function(e){var t=e.page;if(t.start(e),0==(2&t.flag))throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&t.flag))throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"lastPage",{fileName:"Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&t.flag))throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.firstPageValidate(),e.inputPosition+=1,1!=e.input.readByte())throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var i=new Te(new en(6)),r=0;r<6;){var n,s=r++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,n=e.input.readByte()):n=-1,e.validBits=0,i.b[s]=255&n}if("vorbis"!=i.toString())throw new dt(new Zt(Xt.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));e.inputPosition+=4;var a=e.input.readInt32();if(0!=a)throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"vorbis version : "+a,{fileName:"Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var o=new Vt;if(e.inputPosition+=1,o.channel=e.input.readByte(),0==o.channel)throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"no channel",{fileName:"Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<o.channel)throw new dt(new Zt(Xt.TOO_MANY_CHANNELS,"too many channels",{fileName:"Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.inputPosition+=4,o.sampleRate=e.input.readInt32(),0==o.sampleRate)throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=4,o.maximumBitRate=e.input.readInt32(),e.inputPosition+=4,o.nominalBitRate=e.input.readInt32(),e.inputPosition+=4,o.minimumBitRate=e.input.readInt32(),e.inputPosition+=1;var l=e.input.readByte(),h=15&l,_=l>>4;if(o.blocksize0=1<<h,o.blocksize1=1<<_,h<6||13<h)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<6||13<_)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<h)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=1;var c=e.input.readByte();if(0==(1&c))throw new dt(new Zt(Xt.INVALID_FIRST_PAGE,null,{fileName:"Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.page.start(e),e.startPacket();for(var u=0,d=new Ee;0!=(u=e.next());)e.inputPosition+=u,d.write(e.input.read(u)),e.bytesInSeg=0;var f=new De(d.getBytes());f.readByte(),f.read(6);var g,v=f.readInt32();o.vendor=f.readString(v),o.comment=new Nt;for(var p=0,m=f.readInt32();p<m;){p++;var y=f.readInt32(),b=f.readString(y),w=b.indexOf("=");-1!=w&&o.comment.add(b.substring(0,w),b.substring(w+1))}if(0==(1&f.readByte()))throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.startPacket(),0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,g=e.input.readByte()):g=-1,e.validBits=0,5!=g)throw new dt(new Zt(Xt.INVALID_SETUP,"setup packet",{fileName:"Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var x,B=new Te(new en(6)),S=0;S<6;){var T,k=S++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,T=e.input.readByte()):T=-1,e.validBits=0,B.b[k]=255&T}if("vorbis"!=B.toString())throw new dt(new Zt(Xt.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));if(e.validBits<0)x=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)x=0;else{var I=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,x=I}}else{var A=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,x=A}var C=x+1,D=new Array(C);o.codebooks=D;for(var P,E=0,N=C;E<N;){var M=E++;o.codebooks[M]=Et.read(e)}if(e.validBits<0)P=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)P=0;else{var L=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,P=L}}else{var R=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,P=R}for(var V,F=0,G=c=P+1;F<G;){var U;F++;if(e.validBits<0)U=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)U=0;else{var O=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,U=O}}else{var W=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,U=W}if(0!=U)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}if(e.validBits<0)V=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)V=0;else{var z=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,V=z}}else{var H=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,V=H}var Z=V+1,X=new Array(Z);o.floorConfig=X;for(var j,K=0,Y=Z;K<Y;){var Q=K++;o.floorConfig[Q]=Mt.read(e,o.codebooks)}if(e.validBits<0)j=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)j=0;else{var q=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,j=q}}else{var J=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,j=J}var $=j+1,ee=new Array($);o.residueConfig=ee;for(var te,ie=0,re=$;ie<re;){var ne=ie++;o.residueConfig[ne]=jt.read(e,o.codebooks)}if(e.validBits<0)te=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)te=0;else{var se=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,te=se}}else{var ae=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,te=ae}var oe=te+1,le=new Array(oe);o.mapping=le;for(var he,_e=0,ce=oe;_e<ce;)for(var ue=_e++,de=Gt.read(e,o.channel),fe=0,ge=(o.mapping[ue]=de).submaps;fe<ge;){var ve=fe++;if(de.submapFloor[ve]>=o.floorConfig.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(de.submapResidue[ve]>=o.residueConfig.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}if(e.validBits<0)he=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)he=0;else{var pe=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,he=pe}}else{var me=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,he=me}var ye=he+1,be=new Array(ye);o.modes=be;for(var we=0,xe=ye;we<xe;){var Be=we++,Se=Ot.read(e);if((o.modes[Be]=Se).mapping>=o.mapping.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next();)e.bytesInSeg--,e.inputPosition+=1,e.input.readByte();return o},Vt.prototype={__class__:Vt};var Ft=function(){};(i["kha.audio2.ogg.vorbis.data.IntPoint"]=Ft).__name__=!0,Ft.prototype={__class__:Ft};var Gt=function(){};(i["kha.audio2.ogg.vorbis.data.Mapping"]=Gt).__name__=!0,Gt.read=function(e,t){var i,r=new Gt;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var n=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=n}}else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}if(0!=i)throw new dt(new Zt(Xt.INVALID_SETUP,"mapping type "+i,{fileName:"Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var a=new Array(t);r.chan=a;for(var o,l,h,_=0,c=t;_<c;){var u=_++;r.chan[u]=new Ut}if(e.validBits<0)o=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)o=0;else{var d=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=d}}else{var f=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=f}if(0!=o){var g;if(e.validBits<0)g=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)g=0;else{var v=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,g=v}}else{var p=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,g=p}r.submaps=g+1}else r.submaps=1;if(e.validBits<0)l=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)l=0;else{var m=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=m}}else{var y=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=y}if(0!=l){var b;if(e.validBits<0)b=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)b=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,b=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,b=x}r.couplingSteps=b+1;for(var B=0,S=r.couplingSteps;B<S;){var T,k=B++,I=r.chan[k],A=t-1,C=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],D=A<16384?A<16?C[A]:A<512?5+C[A>>5]:10+C[A>>10]:A<16777216?A<524288?15+C[A>>15]:20+C[A>>20]:A<536870912?25+C[A>>25]:A<-2147483648?30+C[A>>30]:0;if(e.validBits<0)T=0;else if(e.validBits<D)if(24<D)T=e.readBits(24)+(e.readBits(D-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<D))break}if(e.validBits<0)T=0;else{var P=e.acc&(1<<D)-1;e.acc=e.acc>>>D,e.validBits-=D,T=P}}else{var E=e.acc&(1<<D)-1;e.acc=e.acc>>>D,e.validBits-=D,T=E}I.magnitude=T;var N,M=r.chan[k],L=t-1,R=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],V=L<16384?L<16?R[L]:L<512?5+R[L>>5]:10+R[L>>10]:L<16777216?L<524288?15+R[L>>15]:20+R[L>>20]:L<536870912?25+R[L>>25]:L<-2147483648?30+R[L>>30]:0;if(e.validBits<0)N=0;else if(e.validBits<V)if(24<V)N=e.readBits(24)+(e.readBits(V-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<V))break}if(e.validBits<0)N=0;else{var F=e.acc&(1<<V)-1;e.acc=e.acc>>>V,e.validBits-=V,N=F}}else{var G=e.acc&(1<<V)-1;e.acc=e.acc>>>V,e.validBits-=V,N=G}if(M.angle=N,r.chan[k].magnitude>=t)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(r.chan[k].angle>=t)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(r.chan[k].magnitude==r.chan[k].angle)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else r.couplingSteps=0;if(e.validBits<0)h=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)h=0;else{var U=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,h=U}}else{var O=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,h=O}if(0!=h)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<r.submaps)for(var W=0,z=t;W<z;){var H,Z=W++,X=r.chan[Z];if(e.validBits<0)H=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)H=0;else{var j=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,H=j}}else{var K=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,H=K}if(X.mux=H,r.chan[Z].mux>=r.submaps)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var Y=0,Q=t;Y<Q;){var q=Y++;r.chan[q].mux=0}var J=r.submaps,$=new Array(J);r.submapFloor=$;var ee=r.submaps,te=new Array(ee);r.submapResidue=te;for(var ie=0,re=r.submaps;ie<re;){var ne=ie++;if(0<=e.validBits)if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(0<=e.validBits){e.acc;e.acc=e.acc>>>8,e.validBits-=8}}else{e.acc;e.acc=e.acc>>>8,e.validBits-=8}var se,ae=r.submapFloor;if(e.validBits<0)se=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)se=0;else{var oe=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,se=oe}}else{var le=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,se=le}ae[ne]=se;var he,_e=r.submapResidue;if(e.validBits<0)he=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)he=0;else{var ce=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=ce}}else{var ue=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=ue}_e[ne]=he}return r},Gt.prototype={doFloor:function(e,t,i,r,n,s){var a=i>>1,o=this.chan[t].mux,l=e[this.submapFloor[o]];if(0==l.type)throw new dt(new Zt(Xt.INVALID_STREAM,null,{fileName:"Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var h=l.floor1,_=0,c=n[0]*h.floor1Multiplier,u=1,d=h.values;u<d;){var f=u++,g=h.sortedOrder[f];if(0<=n[g]){var v=n[g]*h.floor1Multiplier,p=h.xlist[g];Pt.drawLine(r,_,c,p,v,a),_=p,c=v}}if(_<a)for(var m=_,y=a;m<y;){var b=m++,w=r;w[b]=w[b]*Pt.INVERSE_DB_TABLE[c]}},__class__:Gt};var Ut=function(){};(i["kha.audio2.ogg.vorbis.data.MappingChannel"]=Ut).__name__=!0,Ut.prototype={__class__:Ut};var Ot=function(){};(i["kha.audio2.ogg.vorbis.data.Mode"]=Ot).__name__=!0,Ot.read=function(e){var t,i,r,n,s=new Ot;if(e.validBits<0)t=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)t=0;else{var a=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=a}}else{var o=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=o}if(s.blockflag=0!=t,e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var l=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=l}}else{var h=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=h}if(s.windowtype=i,e.validBits<0)r=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)r=0;else{var _=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,r=_}}else{var c=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,r=c}if(s.transformtype=r,e.validBits<0)n=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)n=0;else{var u=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=u}}else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=d}if(s.mapping=n,0!=s.windowtype)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=s.transformtype)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return s},Ot.prototype={__class__:Ot};var Wt=function(){};(i["kha.audio2.ogg.vorbis.data.Page"]=Wt).__name__=!0,Wt.prototype={clone:function(){var e=new Wt;return e.flag=this.flag,e},start:function(e){var t,i,r;if(e.inputPosition+=1,79==e.input.readByte()?(e.inputPosition+=1,r=103!=e.input.readByte()):r=!0,r?i=!0:(e.inputPosition+=1,i=103!=e.input.readByte()),i?t=!0:(e.inputPosition+=1,t=83!=e.input.readByte()),t)throw new dt(new Zt(Xt.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(e)},startWithoutCapturePattern:function(e){e.inputPosition+=1;var t=e.input.readByte();if(0!=t)throw new dt(new Zt(Xt.INVALID_STREAM_STRUCTURE_VERSION,""+t,{fileName:"Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));e.inputPosition+=1,this.flag=e.input.readByte(),e.inputPosition+=4;var i=e.input.readInt32();e.inputPosition+=4;var r=e.input.readInt32();e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.setup(i,r)},__class__:Wt};var zt=function(){};(i["kha.audio2.ogg.vorbis.data.PageFlag"]=zt).__name__=!0;var Ht=function(){};(i["kha.audio2.ogg.vorbis.data.ProbedPage"]=Ht).__name__=!0,Ht.prototype={__class__:Ht};var Zt=function(e,t,i){null==t&&(t=""),this.type=e,this.message=t,this.posInfos=i};(i["kha.audio2.ogg.vorbis.data.ReaderError"]=Zt).__name__=!0,Zt.prototype={__class__:Zt};var Xt=i["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"]};Xt.NEED_MORE_DATA=["NEED_MORE_DATA",0],Xt.NEED_MORE_DATA.toString=r,(Xt.NEED_MORE_DATA.__enum__=Xt).INVALID_API_MIXING=["INVALID_API_MIXING",1],Xt.INVALID_API_MIXING.toString=r,(Xt.INVALID_API_MIXING.__enum__=Xt).OUTOFMEM=["OUTOFMEM",2],Xt.OUTOFMEM.toString=r,(Xt.OUTOFMEM.__enum__=Xt).FEATURE_NOT_SUPPORTED=["FEATURE_NOT_SUPPORTED",3],Xt.FEATURE_NOT_SUPPORTED.toString=r,(Xt.FEATURE_NOT_SUPPORTED.__enum__=Xt).TOO_MANY_CHANNELS=["TOO_MANY_CHANNELS",4],Xt.TOO_MANY_CHANNELS.toString=r,(Xt.TOO_MANY_CHANNELS.__enum__=Xt).FILE_OPEN_FAILURE=["FILE_OPEN_FAILURE",5],Xt.FILE_OPEN_FAILURE.toString=r,(Xt.FILE_OPEN_FAILURE.__enum__=Xt).SEEK_WITHOUT_LENGTH=["SEEK_WITHOUT_LENGTH",6],Xt.SEEK_WITHOUT_LENGTH.toString=r,(Xt.SEEK_WITHOUT_LENGTH.__enum__=Xt).UNEXPECTED_EOF=["UNEXPECTED_EOF",7],Xt.UNEXPECTED_EOF.toString=r,(Xt.UNEXPECTED_EOF.__enum__=Xt).SEEK_INVALID=["SEEK_INVALID",8],Xt.SEEK_INVALID.toString=r,(Xt.SEEK_INVALID.__enum__=Xt).INVALID_SETUP=["INVALID_SETUP",9],Xt.INVALID_SETUP.toString=r,(Xt.INVALID_SETUP.__enum__=Xt).INVALID_STREAM=["INVALID_STREAM",10],Xt.INVALID_STREAM.toString=r,(Xt.INVALID_STREAM.__enum__=Xt).MISSING_CAPTURE_PATTERN=["MISSING_CAPTURE_PATTERN",11],Xt.MISSING_CAPTURE_PATTERN.toString=r,(Xt.MISSING_CAPTURE_PATTERN.__enum__=Xt).INVALID_STREAM_STRUCTURE_VERSION=["INVALID_STREAM_STRUCTURE_VERSION",12],Xt.INVALID_STREAM_STRUCTURE_VERSION.toString=r,(Xt.INVALID_STREAM_STRUCTURE_VERSION.__enum__=Xt).CONTINUED_PACKET_FLAG_INVALID=["CONTINUED_PACKET_FLAG_INVALID",13],Xt.CONTINUED_PACKET_FLAG_INVALID.toString=r,(Xt.CONTINUED_PACKET_FLAG_INVALID.__enum__=Xt).INCORRECT_STREAM_SERIAL_NUMBER=["INCORRECT_STREAM_SERIAL_NUMBER",14],Xt.INCORRECT_STREAM_SERIAL_NUMBER.toString=r,(Xt.INCORRECT_STREAM_SERIAL_NUMBER.__enum__=Xt).INVALID_FIRST_PAGE=["INVALID_FIRST_PAGE",15],Xt.INVALID_FIRST_PAGE.toString=r,(Xt.INVALID_FIRST_PAGE.__enum__=Xt).BAD_PACKET_TYPE=["BAD_PACKET_TYPE",16],Xt.BAD_PACKET_TYPE.toString=r,(Xt.BAD_PACKET_TYPE.__enum__=Xt).CANT_FIND_LAST_PAGE=["CANT_FIND_LAST_PAGE",17],Xt.CANT_FIND_LAST_PAGE.toString=r,(Xt.CANT_FIND_LAST_PAGE.__enum__=Xt).SEEK_FAILED=["SEEK_FAILED",18],Xt.SEEK_FAILED.toString=r,(Xt.SEEK_FAILED.__enum__=Xt).OTHER=["OTHER",19],Xt.OTHER.toString=r,Xt.OTHER.__enum__=Xt;var jt=function(){};(i["kha.audio2.ogg.vorbis.data.Residue"]=jt).__name__=!0,jt.read=function(e,t){var i,r=new jt;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var n=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=n}}else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}if(r.type=i,2<r.type)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var a,o,l,h,_=new Array(64);if(e.validBits<0)a=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)a=0;else{var c=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,a=c}}else{var u=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,a=u}if(r.begin=a,e.validBits<0)o=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)o=0;else{var d=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=d}}else{var f=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=f}if(r.end=o,e.validBits<0)l=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)l=0;else{var g=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=g}}else{var v=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=v}if(r.partSize=l+1,e.validBits<0)h=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)h=0;else{var p=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=p}}else{var m=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=m}var y,b=r.classifications=h+1;if(e.validBits<0)y=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)y=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,y=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,y=x}r.classbook=y;for(var B=0,S=r.classifications;B<S;){var T,k,I=B++,A=0;if(e.validBits<0)T=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)T=0;else{var C=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,T=C}}else{var D=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,T=D}if(e.validBits<0)k=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)k=0;else{var P=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,k=P}}else{var E=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,k=E}if(0!=k)if(e.validBits<0)A=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)A=0;else{var N=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,A=N}}else{var M=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,A=M}_[I]=8*A+T}var L=r.classifications,R=new Array(L);r.residueBooks=R;for(var V=0,F=r.classifications;V<F;){var G=V++,U=r.residueBooks,O=new Array(8);U[G]=O;for(var W=0;W<8;){var z=W++;if(0!=(_[G]&1<<z)){var H,Z=r.residueBooks[G];if(e.validBits<0)H=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)H=0;else{var X=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,H=X}}else{var j=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,H=j}if(Z[z]=H,r.residueBooks[G][z]>=t.length)throw new dt(new Zt(Xt.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else r.residueBooks[G][z]=-1}}var K=t[r.classbook].entries,Y=t[r.classbook].dimensions,Q=new Array(K);r.classdata=Q;for(var q=0,J=K;q<J;)for(var $=q++,ee=$,te=Y,ie=r.classdata,re=new Array(Y),ne=ie[$]=re;0<=--te;)ne[te]=ee%b,ee=ee/b|0;return r},jt.prototype={decode:function(e,t,i,r,n,s,a){for(var o=t.codebooks,l=o[this.classbook].dimensions,h=this.end-this.begin,_=this.partSize,c=rt.toFloat(h)/rt.toFloat(_)|0,u=t.channel*c+1,d=new Array(u),f=0,g=r;f<g;){var v=f++;if(!s[v])for(var p=i[v],m=0,y=p.length;m<y;){p[m++]=0}}if(2!=this.type||1==r)for(var b=0;b<8;)for(var w=b++,x=0;x<c;){if(0==w)for(var B=0,S=r;B<S;){var T=B++;if(!s[T]){var k=o[this.classbook];e.validBits<10&&e.prepHuffman();var I,A=k.fastHuffman[1023&e.acc];if(0<=A){var C=k.codewordLengths[A];e.acc=e.acc>>>C,e.validBits-=C,e.validBits<0?(e.validBits=0,I=-1):I=A}else I=e.decodeScalarRaw(k);k.sparse&&(I=k.sortedValues[I]);var D=I;if(-1==D)return;for(var P=l;0<=--P;)d[T*c+P+x]=D%this.classifications,D=D/this.classifications|0}}for(var E=0,N=l;E<N;){E++;if(c<=x)break;for(var M=0,L=r;M<L;){var R=M++;if(!s[R]){var V=d[R*c+x],F=this.residueBooks[V][w];if(0<=F){var G=i[R],U=this.begin+x*_,O=_;if(!o[F].residueDecode(e,G,U,O,this.type))return}}}++x}}else{for(var W=0,z=r;W<z;){var H=W++;if(!s[H])break;if(H==r-1)return}for(var Z=0;Z<8;){var X=Z++,j=0;if(2==r)for(;j<c;){var K=this.begin+j*_,Y=1&K,Q=K>>>1;if(0==X){var q=o[this.classbook];e.validBits<10&&e.prepHuffman();var J,$=q.fastHuffman[1023&e.acc];if(0<=$){var ee=q.codewordLengths[$];e.acc=e.acc>>>ee,e.validBits-=ee,e.validBits<0?(e.validBits=0,J=-1):J=$}else J=e.decodeScalarRaw(q);q.sparse&&(J=q.sortedValues[J]);var te=J;if(-1==te)return;for(var ie=l;0<=--ie;)d[ie+j]=te%this.classifications,te=te/this.classifications|0}for(var re=0,ne=l;re<ne;){re++;if(c<=j)break;var se=this.begin+j*_,ae=d[j],oe=this.residueBooks[ae][X];if(0<=oe){var le=o[oe].decodeDeinterleaveRepeat(e,i,r,Y,Q,n,_);if(null==le)return;Y=le.cInter,Q=le.pInter}else Y=1&(se+=_),Q=se>>>1;++j}}else if(1==r)for(;j<c;){var he=0,_e=this.begin+j*_;if(0==X){var ce=o[this.classbook];e.validBits<10&&e.prepHuffman();var ue,de=ce.fastHuffman[1023&e.acc];if(0<=de){var fe=ce.codewordLengths[de];e.acc=e.acc>>>fe,e.validBits-=fe,e.validBits<0?(e.validBits=0,ue=-1):ue=de}else ue=e.decodeScalarRaw(ce);ce.sparse&&(ue=ce.sortedValues[ue]);var ge=ue;if(-1==ge)return;for(var ve=l;0<=--ve;)d[ve+j]=ge%this.classifications,ge=ge/this.classifications|0}for(var pe=0,me=l;pe<me;){pe++;if(c<=j)break;var ye=this.begin+j*_,be=this.residueBooks[d[j]][X];if(0<=be){var we=o[be].decodeDeinterleaveRepeat(e,i,r,he,_e,n,_);if(null==we)return;he=we.cInter,_e=we.pInter}else he=0,_e=ye+=_;++j}}else for(;j<c;){var xe=this.begin+j*_,Be=rt.toFloat(xe)%rt.toFloat(r)|0,Se=rt.toFloat(xe)/rt.toFloat(r)|0;if(0==X){var Te=o[this.classbook];e.validBits<10&&e.prepHuffman();var ke,Ie=Te.fastHuffman[1023&e.acc];if(0<=Ie){var Ae=Te.codewordLengths[Ie];e.acc=e.acc>>>Ae,e.validBits-=Ae,e.validBits<0?(e.validBits=0,ke=-1):ke=Ie}else ke=e.decodeScalarRaw(Te);Te.sparse&&(ke=Te.sortedValues[ke]);var Ce=ke;if(-1==Ce)return;for(var De=l;0<=--De;)d[De+j]=Ce%this.classifications,Ce=Ce/this.classifications|0}for(var Pe=0,Ee=l;Pe<Ee;){Pe++;if(c<=j)break;var Ne=this.begin+j*_,Me=this.residueBooks[d[j]][X];if(0<=Me){var Le=o[Me].decodeDeinterleaveRepeat(e,i,r,Be,Se,n,_);if(null==Le)return;Be=Le.cInter,Se=Le.pInter}else Ne+=_,Be=rt.toFloat(Ne)%rt.toFloat(r)|0,Se=rt.toFloat(Ne)/rt.toFloat(r)|0;++j}}}}},__class__:jt};var Kt=function(){};(i["kha.audio2.ogg.vorbis.data.Setting"]=Kt).__name__=!0;var Yt=function(){};(i["kha.graphics1.Graphics"]=Yt).__name__=!0,Yt.prototype={__class__:Yt};var Qt=function(){this.transformations=[],this.transformations.push(new C(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(i["kha.graphics2.Graphics"]=Qt).__name__=!0,Qt.prototype={begin:function(e,t){null==e&&(e=!0)},end:function(){},flush:function(){},clear:function(e){},drawImage:function(e,t,i){this.drawSubImage(e,t,i,0,0,e.get_width(),e.get_height())},drawSubImage:function(e,t,i,r,n,s,a){this.drawScaledSubImage(e,r,n,s,a,t,i,s,a)},drawScaledImage:function(e,t,i,r,n){this.drawScaledSubImage(e,0,0,e.get_width(),e.get_height(),t,i,r,n)},drawScaledSubImage:function(e,t,i,r,n,s,a,o,l){},drawRect:function(e,t,i,r,n){null==n&&(n=1)},fillRect:function(e,t,i,r){},drawString:function(e,t,i){},drawCharacters:function(e,t,i,r,n){},drawLine:function(e,t,i,r,n){null==n&&(n=1)},drawVideo:function(e,t,i,r,n){},fillTriangle:function(e,t,i,r,n,s){},get_imageScaleQuality:function(){return ei.Low},set_imageScaleQuality:function(e){return ei.High},get_mipmapScaleQuality:function(){return ei.Low},set_mipmapScaleQuality:function(e){return ei.High},get_color:function(){return-16777216},set_color:function(e){return-16777216},get_font:function(){return null},set_font:function(e){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(e){return this.myFontSize=e},get_fontGlyphs:function(){return Qt._glyphs},set_fontGlyphs:function(e){return Qt._glyphs=e},pushTransformation:function(e){var t=new C(1,0,0,0,1,0,0,0,1);t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,this.setTransformation(t),this.transformations.push(t)},popTransformation:function(){var e=this.transformations.pop();return this.setTransformation(this.transformations[this.transformations.length-1]),e},get_transformation:function(){return this.transformations[this.transformations.length-1]},set_transformation:function(e){this.setTransformation(e);var t=this.transformations[this.transformations.length-1];return t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,e},translation:function(e,t){var i,r;r=e,i=t;var n=this.transformations[this.transformations.length-1];return new C(1*n._00+0*n._01+r*n._02,1*n._10+0*n._11+r*n._12,1*n._20+0*n._21+r*n._22,0*n._00+1*n._01+i*n._02,0*n._10+1*n._11+i*n._12,0*n._20+1*n._21+i*n._22,0*n._00+0*n._01+1*n._02,0*n._10+0*n._11+1*n._12,0*n._20+0*n._21+1*n._22)},translate:function(e,t){var i,r;r=e,i=t;var n=this.transformations[this.transformations.length-1],s=new C(1*n._00+0*n._01+r*n._02,1*n._10+0*n._11+r*n._12,1*n._20+0*n._21+r*n._22,0*n._00+1*n._01+i*n._02,0*n._10+1*n._11+i*n._12,0*n._20+1*n._21+i*n._22,0*n._00+0*n._01+1*n._02,0*n._10+0*n._11+1*n._12,0*n._20+0*n._21+1*n._22);this.setTransformation(s);var a=this.transformations[this.transformations.length-1];a._00=s._00,a._10=s._10,a._20=s._20,a._01=s._01,a._11=s._11,a._21=s._21,a._02=s._02,a._12=s._12,a._22=s._22},pushTranslation:function(e,t){var i,r;r=e,i=t;var n=this.transformations[this.transformations.length-1];this.pushTransformation(new C(1*n._00+0*n._01+r*n._02,1*n._10+0*n._11+r*n._12,1*n._20+0*n._21+r*n._22,0*n._00+1*n._01+i*n._02,0*n._10+1*n._11+i*n._12,0*n._20+1*n._21+i*n._22,0*n._00+0*n._01+1*n._02,0*n._10+0*n._11+1*n._12,0*n._20+0*n._21+1*n._22))},rotation:function(e,t,i){var r,n,s,a,o,l,h,_,c,u,d,f,g,v,p,m,y,b,w,x,B,S;w=t,b=i;var T,k,I=Math.cos(e);B=-Math.sin(e);c=1*(y=1*I+0*(S=Math.sin(e))+0*w)+0*(v=1*B+0*(x=Math.cos(e))+0*w)+0*(d=0+1*w),l=0*y+1*v+0*d,s=y*(k=-t)+v*(T=-i)+1*d,_=1*(m=0*I+1*S+0*b)+0*(g=0*B+1*x+0*b)+0*(u=0+1*b),o=0*m+1*g+0*u,n=m*k+g*T+1*u,h=1*(p=0*I+0*S+0)+0*(f=0*B+0*x+0)+0,a=0*p+1*f+0,r=p*k+f*T+1;var A=this.transformations[this.transformations.length-1];return new C(c*A._00+l*A._01+s*A._02,c*A._10+l*A._11+s*A._12,c*A._20+l*A._21+s*A._22,_*A._00+o*A._01+n*A._02,_*A._10+o*A._11+n*A._12,_*A._20+o*A._21+n*A._22,h*A._00+a*A._01+r*A._02,h*A._10+a*A._11+r*A._12,h*A._20+a*A._21+r*A._22)},rotate:function(e,t,i){var r,n,s,a,o,l,h,_,c,u,d,f,g,v,p,m,y,b,w,x,B,S,T,k,I,A,C,D,P,E,N;D=t,C=i;var M,L,R=Math.cos(e);E=-Math.sin(e);b=1*(A=1*R+0*(N=Math.sin(e))+0*D)+0*(T=1*E+0*(P=Math.cos(e))+0*D)+0*(x=0+1*D),p=0*A+1*T+0*x,f=A*(L=-t)+T*(M=-i)+1*x,y=1*(I=0*R+1*N+0*C)+0*(S=0*E+1*P+0*C)+0*(w=0+1*C),v=0*I+1*S+0*w,d=I*L+S*M+1*w,m=1*(k=0*R+0*N+0)+0*(B=0*E+0*P+0)+0,g=0*k+1*B+0,u=k*L+B*M+1;var V=this.transformations[this.transformations.length-1];c=b*V._00+p*V._01+f*V._02,l=b*V._10+p*V._11+f*V._12,s=b*V._20+p*V._21+f*V._22,_=y*V._00+v*V._01+d*V._02,o=y*V._10+v*V._11+d*V._12,n=y*V._20+v*V._21+d*V._22,h=m*V._00+g*V._01+u*V._02,a=m*V._10+g*V._11+u*V._12,r=m*V._20+g*V._21+u*V._22,this.transformations[this.transformations.length-1]._00=c,this.transformations[this.transformations.length-1]._01=_,this.transformations[this.transformations.length-1]._02=h,this.transformations[this.transformations.length-1]._10=l,this.transformations[this.transformations.length-1]._11=o,this.transformations[this.transformations.length-1]._12=a,this.transformations[this.transformations.length-1]._20=s,this.transformations[this.transformations.length-1]._21=n,this.transformations[this.transformations.length-1]._22=r},pushRotation:function(e,t,i){var r,n,s,a,o,l,h,_,c,u,d,f,g,v,p,m,y,b,w,x,B,S;w=t,b=i;var T,k,I=Math.cos(e);B=-Math.sin(e);c=1*(y=1*I+0*(S=Math.sin(e))+0*w)+0*(v=1*B+0*(x=Math.cos(e))+0*w)+0*(d=0+1*w),l=0*y+1*v+0*d,s=y*(k=-t)+v*(T=-i)+1*d,_=1*(m=0*I+1*S+0*b)+0*(g=0*B+1*x+0*b)+0*(u=0+1*b),o=0*m+1*g+0*u,n=m*k+g*T+1*u,h=1*(p=0*I+0*S+0)+0*(f=0*B+0*x+0)+0,a=0*p+1*f+0,r=p*k+f*T+1;var A=this.transformations[this.transformations.length-1];this.pushTransformation(new C(c*A._00+l*A._01+s*A._02,c*A._10+l*A._11+s*A._12,c*A._20+l*A._21+s*A._22,_*A._00+o*A._01+n*A._02,_*A._10+o*A._11+n*A._12,_*A._20+o*A._21+n*A._22,h*A._00+a*A._01+r*A._02,h*A._10+a*A._11+r*A._12,h*A._20+a*A._21+r*A._22))},pushOpacity:function(e){this.setOpacity(e),this.opacities.push(e)},popOpacity:function(){var e=this.opacities.pop();return this.setOpacity(this.get_opacity()),e},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(e){return this.setOpacity(e),this.opacities[this.opacities.length-1]=e},scissor:function(e,t,i,r){},disableScissor:function(){},get_pipeline:function(){return this.pipe},set_pipeline:function(e){return this.setPipeline(e),this.pipe=e},setTransformation:function(e){},setOpacity:function(e){},setPipeline:function(e){},__class__:Qt,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline",set_opacity:"set_opacity",get_opacity:"get_opacity",set_transformation:"set_transformation",get_transformation:"get_transformation",set_fontGlyphs:"set_fontGlyphs",get_fontGlyphs:"get_fontGlyphs",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_mipmapScaleQuality:"set_mipmapScaleQuality",get_mipmapScaleQuality:"get_mipmapScaleQuality",set_imageScaleQuality:"set_imageScaleQuality",get_imageScaleQuality:"get_imageScaleQuality"}};var qt=function(e){this.canvas=e};(i["kha.graphics2.Graphics1"]=qt).__name__=!0,qt.__interfaces__=[Yt],qt.prototype={begin:function(){null==this.texture&&(this.texture=ze.create(this.canvas.get_width(),this.canvas.get_height(),Ui.RGBA32,Wi.ReadableUsage)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(e,t,i){this.pixels.setInt32(t*this.texture.get_realWidth()*4+4*e,Ze.fromBytes(255&i,(65280&i)>>>8,(16711680&i)>>>16,i>>>24))},__class__:qt};var Jt=function(){};(i["kha.graphics2.GraphicsExtension"]=Jt).__name__=!0,Jt.drawArc=function(e,t,i,r,n,s,a,o,l){if(null==l&&(l=0),null==o&&(o=!1),null==a&&(a=1),null==D.gl)return r-=a/2,void e.drawArc(t,i,r,n,s,a,o);n%=2*Math.PI,s%=2*Math.PI,o?n<s&&(s-=2*Math.PI):s<n&&(s+=2*Math.PI),l<=0&&(l=Math.floor(10*Math.sqrt(r)));for(var h=(s-n)/l,_=Math.cos(h),c=Math.sin(h),u=Math.cos(n)*r,d=Math.sin(n)*r,f=0,g=l;f<g;){f++;var v=u+t,p=d+i,m=u;u=_*u-c*d,d=_*d+c*m,e.drawLine(v,p,u+t,d+i,a)}},Jt.fillArc=function(e,t,i,r,n,s,a,o){if(null==o&&(o=0),null==a&&(a=!1),null!=D.gl){n%=2*Math.PI,s%=2*Math.PI,a?n<s&&(s-=2*Math.PI):s<n&&(s+=2*Math.PI),o<=0&&(o=Math.floor(10*Math.sqrt(r)));for(var l=(s-n)/o,h=Math.cos(l),_=Math.sin(l),c=Math.cos(n)*r,u=Math.sin(n)*r,d=c+t,f=u+i,g=0,v=o;g<v;){g++;var p=c+t,m=u+i,y=c;c=h*c-_*u,u=h*u+_*y,e.fillTriangle(p,m,c+t,u+i,d,f)}}else{e.fillArc(t,i,r,n,s,a)}},Jt.drawCircle=function(e,t,i,r,n,s){if(null==s&&(s=0),null==n&&(n=1),null==D.gl)return r-=n/2,void e.drawCircle(t,i,r,n);s<=0&&(s=Math.floor(10*Math.sqrt(r)));for(var a=2*Math.PI/s,o=Math.cos(a),l=Math.sin(a),h=r,_=0,c=0,u=s;c<u;){c++;var d=h+t,f=_+i,g=h;h=o*h-l*_,_=o*_+l*g,e.drawLine(d,f,h+t,_+i,n)}},Jt.fillCircle=function(e,t,i,r,n){if(null==n&&(n=0),null!=D.gl){n<=0&&(n=Math.floor(10*Math.sqrt(r)));for(var s=2*Math.PI/n,a=Math.cos(s),o=Math.sin(s),l=r,h=0,_=0,c=n;_<c;){_++;var u=l+t,d=h+i,f=l;l=a*l-o*h,h=a*h+o*f,e.fillTriangle(u,d,l+t,h+i,t,i)}}else{e.fillCircle(t,i,r)}},Jt.drawPolygon=function(e,t,i,r,n){null==n&&(n=1);for(var s=$.iter(r),a=s.next(),o=a;s.hasNext();){var l=s.next();e.drawLine(o.x+t,o.y+i,l.x+t,l.y+i,n),o=l}e.drawLine(o.x+t,o.y+i,a.x+t,a.y+i,n)},Jt.fillPolygon=function(e,t,i,r){var n=$.iter(r);if(n.hasNext()){var s=n.next();if(n.hasNext())for(var a=n.next();n.hasNext();){var o=n.next();e.fillTriangle(s.x+t,s.y+i,a.x+t,a.y+i,o.x+t,o.y+i),a=o}}},Jt.drawCubicBezier=function(e,t,i,r,n){var s;null==n&&(n=1),null==r&&(r=20);for(var a,o=Jt.calculateCubicBezierPoint(0,t,i),l=1,h=r+1;l<h;){s=l++/r,a=Jt.calculateCubicBezierPoint(s,t,i),e.drawLine(o[0],o[1],a[0],a[1],n),o=a}},Jt.drawCubicBezierPath=function(e,t,i,r,n){null==n&&(n=1),null==r&&(r=20);for(var s,a=0,o=null,l=null;a<t.length-3;){0==a&&(o=Jt.calculateCubicBezierPoint(0,[t[a],t[a+1],t[a+2],t[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]));for(var h=1,_=r+1;h<_;){s=h++/r,l=Jt.calculateCubicBezierPoint(s,[t[a],t[a+1],t[a+2],t[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]),e.drawLine(o[0],o[1],l[0],l[1],n),o=l}a+=3}},Jt.calculateCubicBezierPoint=function(e,t,i){var r=1-e,n=e*e,s=r*r,a=s*r,o=n*e,l=[a*t[0],a*i[0]];return l[0]+=3*s*e*t[1],l[1]+=3*s*e*i[1],l[0]+=3*r*n*t[2],l[1]+=3*r*n*i[2],l[0]+=o*t[3],l[1]+=o*i[3],l},Jt.drawAlignedString=function(e,t,i,r,n,s){var a=Re.__cast(e.get_font(),Je)._get(e.get_fontSize(),e.get_fontGlyphs()),o=0;if(n==$t.TextCenter||n==$t.TextRight){var l=a.stringWidth(t);o=n==$t.TextCenter?.5*-l:-l}var h=0;if(s==ti.TextMiddle||s==ti.TextBottom){var _=a.getHeight();h=s==ti.TextMiddle?.5*-_:-_}e.drawString(t,i+o,r+h)},Jt.drawAlignedCharacters=function(e,t,i,r,n,s,a,o){var l=Re.__cast(e.get_font(),Je)._get(e.get_fontSize(),e.get_fontGlyphs()),h=0;if(a==$t.TextCenter||a==$t.TextRight){var _=l.charactersWidth(t,i,r);h=a==$t.TextCenter?.5*-_:-_}var c=0;if(o==ti.TextMiddle||o==ti.TextBottom){var u=l.getHeight();c=o==ti.TextMiddle?.5*-u:-u}e.drawCharacters(t,i,r,n+h,s+c)};var $t=i["kha.graphics2.HorTextAlignment"]={__ename__:!0,__constructs__:["TextLeft","TextCenter","TextRight"]};$t.TextLeft=["TextLeft",0],$t.TextLeft.toString=r,($t.TextLeft.__enum__=$t).TextCenter=["TextCenter",1],$t.TextCenter.toString=r,($t.TextCenter.__enum__=$t).TextRight=["TextRight",2],$t.TextRight.toString=r,$t.TextRight.__enum__=$t;var ei=i["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"]};ei.Low=["Low",0],ei.Low.toString=r,(ei.Low.__enum__=ei).High=["High",1],ei.High.toString=r,ei.High.__enum__=ei;var ti=i["kha.graphics2.VerTextAlignment"]={__ename__:!0,__constructs__:["TextTop","TextMiddle","TextBottom"]};ti.TextTop=["TextTop",0],ti.TextTop.toString=r,(ti.TextTop.__enum__=ti).TextMiddle=["TextMiddle",1],ti.TextMiddle.toString=r,(ti.TextMiddle.__enum__=ti).TextBottom=["TextBottom",2],ti.TextBottom.toString=r,ti.TextBottom.__enum__=ti;var ii=function(){};(i["kha.graphics2.truetype.VectorOfIntPointer"]=ii).__name__=!0,ii.prototype={__class__:ii};var ri=function(){};(i["kha.graphics2.truetype.Stbtt_temp_rect"]=ri).__name__=!0,ri.prototype={__class__:ri};var ni=function(){};(i["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=ni).__name__=!0,ni.prototype={__class__:ni};var si=function(){};(i["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=si).__name__=!0,si.prototype={__class__:si};var ai=function(){};(i["kha.graphics2.truetype.Stbtt_temp_region"]=ai).__name__=!0,ai.prototype={__class__:ai};var oi=function(){};(i["kha.graphics2.truetype.Stbtt_bakedchar"]=oi).__name__=!0,oi.prototype={__class__:oi};var li=function(){};(i["kha.graphics2.truetype.Stbtt_aligned_quad"]=li).__name__=!0,li.prototype={__class__:li};var hi=function(){};(i["kha.graphics2.truetype.Stbtt_packedchar"]=hi).__name__=!0,hi.prototype={__class__:hi};var _i=function(){};(i["kha.graphics2.truetype.Stbtt_pack_range"]=_i).__name__=!0,_i.prototype={__class__:_i};var ci=function(){};(i["kha.graphics2.truetype.Stbtt_pack_context"]=ci).__name__=!0,ci.prototype={__class__:ci};var ui=function(){};(i["kha.graphics2.truetype.Stbtt_fontinfo"]=ui).__name__=!0,ui.prototype={__class__:ui};var di=function(){};(i["kha.graphics2.truetype.Stbtt_vertex"]=di).__name__=!0,di.prototype={__class__:di};var fi=function(){};(i["kha.graphics2.truetype.Stbtt__bitmap"]=fi).__name__=!0,fi.prototype={__class__:fi};var gi=function(){};(i["kha.graphics2.truetype.Stbtt__edge"]=gi).__name__=!0,gi.prototype={__class__:gi};var vi=function(){};(i["kha.graphics2.truetype.Stbtt__active_edge"]=vi).__name__=!0,vi.prototype={__class__:vi};var pi=function(){};(i["kha.graphics2.truetype.Stbtt__point"]=pi).__name__=!0,pi.prototype={__class__:pi};var mi=function(){};(i["kha.graphics2.truetype.StbTruetype"]=mi).__name__=!0,mi.STBTT_assert=function(e){if(!e)throw new dt("Error")},mi.STBTT_POINT_SIZE=function(e){return-e},mi.ttBYTE=function(e,t){return null==t&&(t=0),e.readU8(t)},mi.ttCHAR=function(e,t){null==t&&(t=0);var i=e.readU8(t);return 128<=i?i-256:i},mi.ttUSHORT=function(e,t){null==t&&(t=0);var i=e.readU8(t);return e.readU8(t+1)|i<<8},mi.ttSHORT=function(e,t){null==t&&(t=0);var i=e.readU8(t),r=e.readU8(t+1)|i<<8;return 0!=(32768&r)?r-65536:r},mi.ttULONG=function(e,t){null==t&&(t=0);var i=e.readU8(t),r=e.readU8(t+1),n=e.readU8(t+2);return e.readU8(t+3)|n<<8|r<<16|i<<24},mi.ttLONG=function(e,t){null==t&&(t=0);var i=e.readU8(t),r=e.readU8(t+1),n=e.readU8(t+2);return e.readU8(t+3)|n<<8|r<<16|i<<24},mi.ttFixed=function(e,t){null==t&&(t=0);var i=e.readU8(t),r=e.readU8(t+1),n=e.readU8(t+2);return e.readU8(t+3)|n<<8|r<<16|i<<24},mi.stbtt_tag4=function(e,t,i,r,n,s){return e.readU8(t)==i&&e.readU8(t+1)==r&&e.readU8(t+2)==n&&e.readU8(t+3)==s},mi.stbtt_tag=function(e,t,i){var r=$.cca(i,0),n=$.cca(i,1),s=$.cca(i,2),a=$.cca(i,3);return e.readU8(t)==r&&e.readU8(t+1)==n&&e.readU8(t+2)==s&&e.readU8(t+3)==a},mi.stbtt__isfont=function(e){var t=$.cca("1",0);if(e.readU8(0)==t&&0==e.readU8(1)&&0==e.readU8(2)&&0==e.readU8(3))return!0;var i=$.cca("typ1",0),r=$.cca("typ1",1),n=$.cca("typ1",2),s=$.cca("typ1",3);if(e.readU8(0)==i&&e.readU8(1)==r&&e.readU8(2)==n&&e.readU8(3)==s)return!0;var a=$.cca("OTTO",0),o=$.cca("OTTO",1),l=$.cca("OTTO",2),h=$.cca("OTTO",3);return e.readU8(0)==a&&e.readU8(1)==o&&e.readU8(2)==l&&e.readU8(3)==h||0==e.readU8(0)&&1==e.readU8(1)&&0==e.readU8(2)&&0==e.readU8(3)},mi.stbtt__find_table=function(e,t,i){for(var r=t+4,n=e.readU8(r),s=t+12,a=0,o=e.readU8(r+1)|n<<8;a<o;){var l=s+16*a++,h=$.cca(i,0),_=$.cca(i,1),c=$.cca(i,2),u=$.cca(i,3);if(e.readU8(l)==h&&e.readU8(l+1)==_&&e.readU8(l+2)==c&&e.readU8(l+3)==u){var d=l+8,f=e.readU8(d),g=e.readU8(d+1),v=e.readU8(d+2);return e.readU8(d+3)|v<<8|g<<16|f<<24}}return 0},mi.stbtt_GetFontOffsetForIndex=function(e,t){if(mi.stbtt__isfont(e))return 0==t?0:-1;var i=$.cca("ttcf",0),r=$.cca("ttcf",1),n=$.cca("ttcf",2),s=$.cca("ttcf",3);if(e.readU8(0)==i&&e.readU8(1)==r&&e.readU8(2)==n&&e.readU8(3)==s){var a,o=e.readU8(4),l=e.readU8(5),h=e.readU8(6);if(65536!=(e.readU8(7)|h<<8|l<<16|o<<24)){var _=e.readU8(4),c=e.readU8(5),u=e.readU8(6);a=131072==(e.readU8(7)|u<<8|c<<16|_<<24)}else a=!0;if(a){var d=e.readU8(8),f=e.readU8(9),g=e.readU8(10);if((e.readU8(11)|g<<8|f<<16|d<<24)<=t)return-1;var v=12+4*t,p=e.readU8(v),m=e.readU8(v+1),y=e.readU8(v+2);return e.readU8(v+3)|y<<8|m<<16|p<<24}}return-1},mi.stbtt_InitFont=function(e,t,i){var r,n,s;if(e.data=t,e.fontstart=i,r=mi.stbtt__find_table(t,i,"cmap"),e.loca=mi.stbtt__find_table(t,i,"loca"),e.head=mi.stbtt__find_table(t,i,"head"),e.glyf=mi.stbtt__find_table(t,i,"glyf"),e.hhea=mi.stbtt__find_table(t,i,"hhea"),e.hmtx=mi.stbtt__find_table(t,i,"hmtx"),e.kern=mi.stbtt__find_table(t,i,"kern"),0==r||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;if(0!=(n=mi.stbtt__find_table(t,i,"maxp"))){var a=n+4,o=t.readU8(a),l=t.readU8(a+1);e.numGlyphs=l|o<<8}else e.numGlyphs=65535;var h=r+2,_=t.readU8(h);s=t.readU8(h+1)|_<<8;for(var c=e.index_map=0,u=s;c<u;){var d=r+4+8*c++,f=t.readU8(d);switch(t.readU8(d+1)|f<<8){case 0:var g=d+4,v=t.readU8(g),p=t.readU8(g+1),m=t.readU8(g+2),y=t.readU8(g+3);e.index_map=r+(y|m<<8|p<<16|v<<24);break;case 3:var b=d+2,w=t.readU8(b);switch(t.readU8(b+1)|w<<8){case 1:case 10:var x=d+4,B=t.readU8(x),S=t.readU8(x+1),T=t.readU8(x+2),k=t.readU8(x+3);e.index_map=r+(k|T<<8|S<<16|B<<24)}}}if(0==e.index_map)return!1;var I=e.head+50,A=t.readU8(I),C=t.readU8(I+1);return e.indexToLocFormat=C|A<<8,!0},mi.stbtt_FindGlyphIndex=function(e,t){var i=e.data,r=e.index_map,n=i.readU8(r),s=i.readU8(r+1)|n<<8;if(0==s){var a=r+2,o=i.readU8(a);return t<(i.readU8(a+1)|o<<8)-6?i.readU8(r+6+t):0}if(6==s){var l=r+6,h=i.readU8(l),_=i.readU8(l+1)|h<<8,c=r+8,u=i.readU8(c),d=i.readU8(c+1);if(_<=t&&t<_+(d|u<<8)){var f=r+10+2*(t-_),g=i.readU8(f);return i.readU8(f+1)|g<<8}return 0}if(2==s)throw new dt("Error");if(4==s){var v=r+6,p=i.readU8(v),m=(i.readU8(v+1)|p<<8)>>1,y=r+8,b=i.readU8(y),w=(i.readU8(y+1)|b<<8)>>1,x=r+10,B=i.readU8(x),S=i.readU8(x+1)|B<<8,T=r+12,k=i.readU8(T),I=(i.readU8(T+1)|k<<8)>>1,A=r+14,C=A;if(65535<t)return 0;var D,P,E=C+2*I,N=i.readU8(E);for((i.readU8(E+1)|N<<8)<=t&&(C+=2*I),C-=2;0!=S;){var M=C+2*(w>>=1),L=i.readU8(M);(i.readU8(M+1)|L<<8)<t&&(C+=2*w),--S}var R=(C+=2)-A>>1,V=A+2*R,F=i.readU8(V);if((i.readU8(V+1)|F<<8)<t)throw new dt("Error");var G=r+14+2*m+2+2*R,U=i.readU8(G);if(t<(P=i.readU8(G+1)|U<<8))return 0;var O=r+14+6*m+2+2*R,W=i.readU8(O);if(0==(D=i.readU8(O+1)|W<<8)){var z=r+14+4*m+2+2*R,H=i.readU8(z),Z=i.readU8(z+1)|H<<8;return t+(0!=(32768&Z)?Z-65536:Z)}var X=D+2*(t-P)+r+14+6*m+2+2*R,j=i.readU8(X);return i.readU8(X+1)|j<<8}if(12==s||13==s){var K,Y,Q=r+12,q=i.readU8(Q),J=i.readU8(Q+1),$=i.readU8(Q+2);for(K=0,Y=i.readU8(Q+3)|$<<8|J<<16|q<<24;K<Y;){var ee=K+(Y-K>>1),te=r+16+12*ee,ie=i.readU8(te),re=i.readU8(te+1),ne=i.readU8(te+2),se=i.readU8(te+3)|ne<<8|re<<16|ie<<24,ae=r+16+12*ee+4,oe=i.readU8(ae),le=i.readU8(ae+1),he=i.readU8(ae+2),_e=i.readU8(ae+3);if(t<se)Y=ee;else{if(!((_e|he<<8|le<<16|oe<<24)<t)){var ce=r+16+12*ee+8,ue=i.readU8(ce),de=i.readU8(ce+1),fe=i.readU8(ce+2),ge=i.readU8(ce+3)|fe<<8|de<<16|ue<<24;return 12==s?ge+t-se:ge}K=ee+1}}return 0}throw new dt("Error")},mi.stbtt_GetCodepointShape=function(e,t){return mi.stbtt_GetGlyphShape(e,mi.stbtt_FindGlyphIndex(e,t))},mi.stbtt_setvertex=function(e,t,i,r,n,s){e.type=t,e.x=i,e.y=r,e.cx=n,e.cy=s},mi.stbtt__GetGlyfOffset=function(e,t){var i,r;if(t>=e.numGlyphs)return-1;if(2<=e.indexToLocFormat)return-1;if(0==e.indexToLocFormat){var n=e.glyf,s=e.data,a=e.loca+2*t,o=s.readU8(a);i=n+2*(s.readU8(a+1)|o<<8);var l=e.glyf,h=e.data,_=e.loca+2*t+2,c=h.readU8(_);r=l+2*(h.readU8(_+1)|c<<8)}else{var u=e.glyf,d=e.data,f=e.loca+4*t,g=d.readU8(f),v=d.readU8(f+1),p=d.readU8(f+2);i=u+(d.readU8(f+3)|p<<8|v<<16|g<<24);var m=e.glyf,y=e.data,b=e.loca+4*t+4,w=y.readU8(b),x=y.readU8(b+1),B=y.readU8(b+2);r=m+(y.readU8(b+3)|B<<8|x<<16|w<<24)}return i==r?-1:i},mi.stbtt_GetGlyphBox=function(e,t,i){var r=mi.stbtt__GetGlyfOffset(e,t);if(r<0)return!1;var n=e.data,s=r+2,a=n.readU8(s),o=n.readU8(s+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=e.data,h=r+4,_=l.readU8(h),c=l.readU8(h+1)|_<<8;i.y0=0!=(32768&c)?c-65536:c;var u=e.data,d=r+6,f=u.readU8(d),g=u.readU8(d+1)|f<<8;i.x1=0!=(32768&g)?g-65536:g;var v=e.data,p=r+8,m=v.readU8(p),y=v.readU8(p+1)|m<<8;return i.y1=0!=(32768&y)?y-65536:y,!0},mi.stbtt_GetCodepointBox=function(e,t,i){return mi.stbtt_GetGlyphBox(e,mi.stbtt_FindGlyphIndex(e,t),i)},mi.stbtt_IsGlyphEmpty=function(e,t){var i=mi.stbtt__GetGlyfOffset(e,t);if(i<0)return!0;var r=e.data,n=r.readU8(i),s=r.readU8(i+1)|n<<8;return 0==(0!=(32768&s)?s-65536:s)},mi.stbtt__close_shape=function(e,t,i,r,n,s,a,o,l,h){return r?(i&&mi.stbtt_setvertex(e[t++],3,l+a>>1,h+o>>1,l,h),mi.stbtt_setvertex(e[t++],3,n,s,a,o)):i?mi.stbtt_setvertex(e[t++],3,n,s,l,h):mi.stbtt_setvertex(e[t++],2,n,s,0,0),t},mi.copyVertices=function(e,t,i,r){for(var n=0,s=r;n<s;){var a=n++;t[i+a]=e[a]}},mi.stbtt_GetGlyphShape=function(e,t){var i,r,n=e.data,s=null,a=0,o=mi.stbtt__GetGlyfOffset(e,t);if(o<0)return null;var l=n.readU8(o),h=n.readU8(o+1)|l<<8;if(0<(i=0!=(32768&h)?h-65536:h)){var _,c,u,d,f,g,v,p,m,y,b,w,x,B,S=0,T=0,k=0,I=!1,A=!1,C=0;r=n.sub(o+10,n.get_length()-(o+10));var D=o+10+2*i,P=n.readU8(D);c=n.readU8(D+1)|P<<8,B=n.sub(o+10+2*i+2+c,n.get_length()-(o+10+2*i+2+c));var E=2*i-2,N=r.readU8(E);if(u=(d=1+(r.readU8(E+1)|N<<8))+2*i,null==(s=new Array(u)))return null;for(var M=0,L=s.length;M<L;){s[M++]=new di}f=u-d;for(var R=_=k=0,V=d;R<V;){var F=R++;0==_?0!=(8&(S=B.readU8(C++)))&&(_=B.readU8(C++)):--_,s[f+F].type=S}for(var G=g=0,U=d;G<U;){var O=G++;if(0!=(2&(S=s[f+O].type))){var W=B.readU8(C++);g+=0!=(16&S)?W:-W}else if(0==(16&S)){var z=B.readU8(C),H=B.readU8(C+1)|z<<8;g+=0!=(32768&H)?H-65536:H,C+=2}s[f+O].x=g}for(var Z=v=0,X=d;Z<X;){var j=Z++;if(0!=(4&(S=s[f+j].type))){var K=B.readU8(C++);v+=0!=(32&S)?K:-K}else if(0==(32&S)){var Y=B.readU8(C),Q=B.readU8(C+1)|Y<<8;v+=0!=(32768&Q)?Q-65536:Q,C+=2}s[f+j].y=v}y=b=p=m=w=x=a=0;for(var q=0;q<d;){if(S=s[f+q].type,g=s[f+q].x,v=s[f+q].y,k==q){0!=q&&(a=mi.stbtt__close_shape(s,a,I,A,y,b,w,x,p,m)),(A=0==(1&S))?(w=g,x=v,0==(1&s[f+q+1].type)?(y=g+s[f+q+1].x>>1,b=v+s[f+q+1].y>>1):(y=s[f+q+1].x,b=s[f+q+1].y,++q)):(y=g,b=v),mi.stbtt_setvertex(s[a++],1,y,b,0,0),I=!1;var J=2*T,$=r.readU8(J);k=1+(r.readU8(J+1)|$<<8),++T}else 0==(1&S)?(I&&mi.stbtt_setvertex(s[a++],3,p+g>>1,m+v>>1,p,m),p=g,m=v,I=!0):(I?mi.stbtt_setvertex(s[a++],3,g,v,p,m):mi.stbtt_setvertex(s[a++],2,g,v,0,0),I=!1);++q}a=mi.stbtt__close_shape(s,a,I,A,y,b,w,x,p,m)}else if(-1==i){var ee=1,te=n.sub(o+10,n.get_length()-(o+10)),ie=0;for(a=0,s=null;0!=ee;){var re,ne,se,ae,oe,le=0,he=null,_e=1,ce=0,ue=0,de=1,fe=0,ge=0,ve=te.readU8(ie),pe=te.readU8(ie+1)|ve<<8;re=0!=(32768&pe)?pe-65536:pe,ie+=2;var me=te.readU8(ie),ye=te.readU8(ie+1)|me<<8;if(ne=0!=(32768&ye)?ye-65536:ye,ie+=2,0==(2&re))throw new dt("Error");if(0!=(1&re)){var be=te.readU8(ie),we=te.readU8(ie+1)|be<<8;fe=0!=(32768&we)?we-65536:we,ie+=2;var xe=te.readU8(ie),Be=te.readU8(ie+1)|xe<<8;ge=0!=(32768&Be)?Be-65536:Be,ie+=2}else{var Se=te.readU8(ie);fe=128<=Se?Se-256:Se,++ie;var Te=te.readU8(ie);ge=128<=Te?Te-256:Te,++ie}if(0!=(8&re)){var ke=te.readU8(ie),Ie=te.readU8(ie+1)|ke<<8;_e=de=(0!=(32768&Ie)?Ie-65536:Ie)/16384,ie+=2,ce=ue=0}else if(0!=(64&re)){var Ae=te.readU8(ie),Ce=te.readU8(ie+1)|Ae<<8;_e=(0!=(32768&Ce)?Ce-65536:Ce)/16384,ie+=2,ce=ue=0;var De=te.readU8(ie),Pe=te.readU8(ie+1)|De<<8;de=(0!=(32768&Pe)?Pe-65536:Pe)/16384,ie+=2}else if(0!=(128&re)){var Ee=te.readU8(ie),Ne=te.readU8(ie+1)|Ee<<8;_e=(0!=(32768&Ne)?Ne-65536:Ne)/16384,ie+=2;var Me=te.readU8(ie),Le=te.readU8(ie+1)|Me<<8;ce=(0!=(32768&Le)?Le-65536:Le)/16384,ie+=2;var Re=te.readU8(ie),Ve=te.readU8(ie+1)|Re<<8;ue=(0!=(32768&Ve)?Ve-65536:Ve)/16384,ie+=2;var Fe=te.readU8(ie),Ge=te.readU8(ie+1)|Fe<<8;de=(0!=(32768&Ge)?Ge-65536:Ge)/16384,ie+=2}if(ae=Math.sqrt(_e*_e+ce*ce),oe=Math.sqrt(ue*ue+de*de),0<(le=null==(se=mi.stbtt_GetGlyphShape(e,ne))?0:se.length)){for(var Ue=0,Oe=le;Ue<Oe;){var We,ze,He=se[Ue++];We=He.x,ze=He.y,He.x=ae*(_e*We+ue*ze+fe)|0,He.y=oe*(ce*We+de*ze+ge)|0,We=He.cx,ze=He.cy,He.cx=ae*(_e*We+ue*ze+fe)|0,He.cy=oe*(ce*We+de*ze+ge)|0}if(null==(he=new Array(a+le)))return null;0<a&&mi.copyVertices(s,he,0,a),mi.copyVertices(se,he,a,le),s=he,a+=le}ee=32&re}}else if(i<0)throw new dt("Error");if(null==s)return null;if(s.length<a)throw new dt("Error");if(a<s.length){var Ze=new Array(a);return mi.copyVertices(s,Ze,0,a),Ze}return s},mi.stbtt_GetGlyphHMetrics=function(e,t){var i=e.data,r=e.hhea+34,n=i.readU8(r),s=i.readU8(r+1)|n<<8,a=new ni;if(t<s){var o=e.data,l=e.hmtx+4*t,h=o.readU8(l),_=o.readU8(l+1)|h<<8;a.advanceWidth=0!=(32768&_)?_-65536:_;var c=e.data,u=e.hmtx+4*t+2,d=c.readU8(u),f=c.readU8(u+1)|d<<8;a.leftSideBearing=0!=(32768&f)?f-65536:f}else{var g=e.data,v=e.hmtx+4*(s-1),p=g.readU8(v),m=g.readU8(v+1)|p<<8;a.advanceWidth=0!=(32768&m)?m-65536:m;var y=e.data,b=e.hmtx+4*s+2*(t-s),w=y.readU8(b),x=y.readU8(b+1)|w<<8;a.leftSideBearing=0!=(32768&x)?x-65536:x}return a},mi.stbtt_GetGlyphKernAdvance=function(e,t,i){var r,n,s,a,o,l=e.data.sub(e.kern,e.data.get_length()-e.kern);if(0==e.kern)return 0;var h=l.readU8(2);if((l.readU8(3)|h<<8)<1)return 0;var _=l.readU8(8);if(1!=(l.readU8(9)|_<<8))return 0;s=0;var c=l.readU8(10);for(a=(l.readU8(11)|c<<8)-1,r=t<<16|i;s<=a;){var u=18+6*(o=s+a>>1),d=l.readU8(u),f=l.readU8(u+1),g=l.readU8(u+2);if(r<(n=l.readU8(u+3)|g<<8|f<<16|d<<24))a=o-1;else{if(!(n<r)){var v=22+6*o,p=l.readU8(v),m=l.readU8(v+1)|p<<8;return 0!=(32768&m)?m-65536:m}s=o+1}}return 0},mi.stbtt_GetCodepointKernAdvance=function(e,t,i){return 0==e.kern?0:mi.stbtt_GetGlyphKernAdvance(e,mi.stbtt_FindGlyphIndex(e,t),mi.stbtt_FindGlyphIndex(e,i))},mi.stbtt_GetCodepointHMetrics=function(e,t){return mi.stbtt_GetGlyphHMetrics(e,mi.stbtt_FindGlyphIndex(e,t))},mi.stbtt_GetFontVMetrics=function(e){var t=new si,i=e.data,r=e.hhea+4,n=i.readU8(r),s=i.readU8(r+1)|n<<8;t.ascent=0!=(32768&s)?s-65536:s;var a=e.data,o=e.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;t.descent=0!=(32768&h)?h-65536:h;var _=e.data,c=e.hhea+8,u=_.readU8(c),d=_.readU8(c+1)|u<<8;return t.lineGap=0!=(32768&d)?d-65536:d,t},mi.stbtt_GetFontBoundingBox=function(e){var t=new ri,i=e.data,r=e.head+36,n=i.readU8(r),s=i.readU8(r+1)|n<<8;t.x0=0!=(32768&s)?s-65536:s;var a=e.data,o=e.head+38,l=a.readU8(o),h=a.readU8(o+1)|l<<8;t.y0=0!=(32768&h)?h-65536:h;var _=e.data,c=e.head+40,u=_.readU8(c),d=_.readU8(c+1)|u<<8;t.x1=0!=(32768&d)?d-65536:d;var f=e.data,g=e.head+42,v=f.readU8(g),p=f.readU8(g+1)|v<<8;return t.y1=0!=(32768&p)?p-65536:p,t},mi.stbtt_ScaleForPixelHeight=function(e,t){var i=e.data,r=e.hhea+4,n=i.readU8(r),s=i.readU8(r+1)|n<<8,a=e.data,o=e.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;return t/((0!=(32768&s)?s-65536:s)-(0!=(32768&h)?h-65536:h))},mi.stbtt_ScaleForMappingEmToPixels=function(e,t){var i=e.data,r=e.head+18,n=i.readU8(r);return t/(i.readU8(r+1)|n<<8)},mi.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,i,r,n,s){var a=new ri;if(mi.stbtt_GetGlyphBox(e,t,a)){var o=a.x0,l=a.x1,h=a.y0,_=a.y1;a.x0=Math.floor(o*i+n),a.y0=Math.floor(-_*r+s),a.x1=Math.ceil(l*i+n),a.y1=Math.ceil(-h*r+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},mi.stbtt_GetGlyphBitmapBox=function(e,t,i,r){return mi.stbtt_GetGlyphBitmapBoxSubpixel(e,t,i,r,0,0)},mi.stbtt_GetCodepointBitmapBoxSubpixel=function(e,t,i,r,n,s){return mi.stbtt_GetGlyphBitmapBoxSubpixel(e,mi.stbtt_FindGlyphIndex(e,t),i,r,n,s)},mi.stbtt_GetCodepointBitmapBox=function(e,t,i,r){return mi.stbtt_GetCodepointBitmapBoxSubpixel(e,t,i,r,0,0)},mi.stbtt__new_active=function(e,t,i,r){var n=new vi,s=(e[t].x1-e[t].x0)/(e[t].y1-e[t].y0);return null==n||(n.fdx=s,n.fdy=0!=s?1/s:0,n.fx=e[t].x0+s*(r-e[t].y0),n.fx-=i,n.direction=e[t].invert?1:-1,n.sy=e[t].y0,n.ey=e[t].y1,n.next=null),n},mi.stbtt__handle_clipped_edge=function(e,t,i,r,n,s,a,o){if(s!=o){if(!(s<o))throw new dt("Error");if(!(r.sy<=r.ey))throw new dt("Error");if(!(s>r.ey||o<r.sy)){if(s<r.sy&&(n+=(a-n)*(r.sy-s)/(o-s),s=r.sy),o>r.ey&&(a+=(a-n)*(r.ey-o)/(o-s),o=r.ey),n==i){if(!(a<=i+1))throw new dt("Error")}else if(n==i+1){if(!(i<=a))throw new dt("Error")}else if(n<=i){if(!(a<=i))throw new dt("Error")}else if(i+1<=n){if(!(i+1<=a))throw new dt("Error")}else if(!(i<=a&&a<=i+1))throw new dt("Error");if(n<=i&&a<=i){var l=t+i,h=e;h[l]=h[l]+r.direction*(o-s)}else if(!(i+1<=n&&i+1<=a)){if(!(i<=n&&n<=i+1&&i<=a&&a<=i+1))throw new dt("Error");var _=t+i,c=e;c[_]=c[_]+r.direction*(o-s)*(1-(n-i+(a-i))/2)}}}},mi.stbtt__fill_active_edges_new=function(e,t,i,r,n,s){for(var a=s+1;null!=n;){if(!(n.ey>=s))throw new dt("Error");if(0==n.fdx){var o=n.fx;o<r&&(0<=o?(mi.stbtt__handle_clipped_edge(e,0,0|o,n,o,s,o,a),mi.stbtt__handle_clipped_edge(t,i-1,o+1|0,n,o,s,o,a)):mi.stbtt__handle_clipped_edge(t,i-1,0,n,o,s,o,a))}else{var l,h,_,c,u=n.fx,d=n.fdx,f=u+d,g=n.fdy;if(!(n.sy<=a&&n.ey>=s))throw new dt("Error");if(n.sy>s?(l=u+d*(n.sy-s),_=n.sy):(l=u,_=s),n.ey<a?(h=u+d*(n.ey-s),c=n.ey):(h=f,c=a),0<=l&&0<=h&&l<r&&h<r)if((0|l)==(0|h)){var v,p=0|l;if(v=c-_,!(0<=p&&p<r))throw new dt("Error");var m=p,y=e;y[m]=y[m]+n.direction*(1-(l-p+(h-p))/2)*v;var b=i+p,w=t;w[b]=w[b]+n.direction*v}else{var x,B,S,T,k,I,A;if(h<l)A=_=a-(_-s),_=c=a-(c-s),c=A,A=h,h=l,l=A,d=-d,g=-g,A=u,u=f,f=A;B=0|h,S=((x=0|l)+1-u)*g+s,I=(k=n.direction)*(S-_);var C=x,D=e;D[C]=D[C]+I*(1-(l-x+(x+1-x))/2),T=k*g;for(var P=x+1,E=B;P<E;){var N=P++,M=e;M[N]=M[N]+(I+T/2),I+=T}if(S+=g*(B-(x+1)),!(Math.abs(I)<=1.01))throw new dt("Error");var L=B,R=e;R[L]=R[L]+(I+k*(1-(B-B+(h-B))/2)*(c-S));var V=i+B,F=t;F[V]=F[V]+k*(c-_)}else for(var G=0,U=r;G<U;){var O,W,z=G++,H=s,Z=z,X=z+1,j=f,K=a;O=(z-u)/d+s,W=(z+1-u)/d+s,u<Z&&X<j?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,Z,O),mi.stbtt__handle_clipped_edge(e,0,z,n,Z,O,X,W),mi.stbtt__handle_clipped_edge(e,0,z,n,X,W,j,K)):j<Z&&X<u?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,X,W),mi.stbtt__handle_clipped_edge(e,0,z,n,X,W,Z,O),mi.stbtt__handle_clipped_edge(e,0,z,n,Z,O,j,K)):u<Z&&Z<j?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,Z,O),mi.stbtt__handle_clipped_edge(e,0,z,n,Z,O,j,K)):j<Z&&Z<u?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,Z,O),mi.stbtt__handle_clipped_edge(e,0,z,n,Z,O,j,K)):u<X&&X<j?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,X,W),mi.stbtt__handle_clipped_edge(e,0,z,n,X,W,j,K)):j<X&&X<u?(mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,X,W),mi.stbtt__handle_clipped_edge(e,0,z,n,X,W,j,K)):mi.stbtt__handle_clipped_edge(e,0,z,n,u,H,j,K)}}n=n.next}},mi.stbtt__rasterize_sorted_edges=function(e,t,i,r,n,s){var a,o,l,h,_=null,c=0,u=0;if(64<e.w){var d=2*e.w+1;o=new Array(d)}else{o=new Array(129)}for(l=o,h=e.w,a=s,t[u+i].y0=s+e.h+1;c<e.h;){var f,g,v=a+0,p=a+1;f=_,g=null;for(var m=0,y=e.w;m<y;){o[m++]=0}for(var b=0,w=e.w+1;b<w;){l[h+b++]=0}for(;null!=f;){var x=f;if(x.ey<=v){if(null==g?_=x.next:g.next=x.next,f=x.next,0==x.direction)throw new dt("Error");x.direction=0}else f=(g=f).next}for(;t[u].y0<=p;){if(t[u].y0!=t[u].y1){var B=mi.stbtt__new_active(t,u,n,v);if(!(B.ey>=v))throw new dt("Error");B.next=_,_=B}++u}null!=_&&mi.stbtt__fill_active_edges_new(o,l,h+1,e.w,_,v);for(var S=0,T=0,k=e.w;T<k;){var I,A,C=T++;S+=l[h+C],I=o[C]+S,255<(A=0|(I=255*Math.abs(I)+.5))&&(A=255),e.pixels.writeU8(e.pixels_offset+c*e.stride+C,A)}for(g=null,f=_;null!=f;){var D=f;D.fx+=D.fdx,f=(g=f).next}++a,++c}},mi.STBTT__COMPARE=function(e,t){return e.y0<t.y0},mi.stbtt__sort_edges_ins_sort=function(e,t){for(var i,r=1,n=t;r<n;){var s=r++,a=e[s],o=a;for(i=s;0<i;){var l=e[i-1];if(!mi.STBTT__COMPARE(o,l))break;e[i]=e[i-1],--i}s!=i&&(e[i]=a)}},mi.stbtt__sort_edges_quicksort=function(e,t,i){for(;12<i;){var r,n,s,a,o,l;if(s=i>>1,mi.STBTT__COMPARE(e[t],e[t+s])!=(n=mi.STBTT__COMPARE(e[t+s],e[t+i-1])))r=e[t+(l=mi.STBTT__COMPARE(e[t],e[t+i-1])==n?0:i-1)],e[t+l]=e[t+s],e[t+s]=r;for(r=e[t],e[t]=e[t+s],e[t+s]=r,o=i-(a=1);;){for(;mi.STBTT__COMPARE(e[t+a],e[t]);)++a;for(;mi.STBTT__COMPARE(e[t],e[t+o]);)--o;if(o<=a)break;r=e[t+a],e[t+a]=e[t+o],e[t+o]=r,++a,--o}o<i-a?(mi.stbtt__sort_edges_quicksort(e,t,o),t+=a,i-=a):(mi.stbtt__sort_edges_quicksort(e,t+a,i-a),i=o)}},mi.stbtt__sort_edges=function(e,t){mi.stbtt__sort_edges_quicksort(e,0,t),mi.stbtt__sort_edges_ins_sort(e,t)},mi.stbtt__rasterize=function(e,t,i,r,n,s,a,o,l,h,_){for(var c,u,d,f,g=_?-s:s,v=u=0,p=r;v<p;){u+=i[v++]}if(null!=(c=new Array(u+1))){for(var m=0,y=c.length;m<y;){c[m++]=new gi}for(var b=f=u=0,w=r;b<w;){var x=b++,B=t,S=0+f;f+=i[x],d=i[x]-1;for(var T=0,k=i[x];T<k;){var I=T++,A=I,C=d;B[S+d].y!=B[S+I].y?(c[u].invert=!1,(_?B[S+d].y>B[S+I].y:B[S+d].y<B[S+I].y)&&(c[u].invert=!0,A=d,C=I),c[u].x0=B[S+A].x*n+a,c[u].y0=1*(B[S+A].y*g+o),c[u].x1=B[S+C].x*n+a,c[u].y1=1*(B[S+C].y*g+o),++u,d=I):d=I}}mi.stbtt__sort_edges(c,u),mi.stbtt__rasterize_sorted_edges(e,c,u,1,l,h)}},mi.stbtt__add_point=function(e,t,i,r){null!=e&&(e[t].x=i,e[t].y=r)},mi.stbtt__tesselate_curve=function(e,t,i,r,n,s,a,o,l,h){var _=(i+2*n+a)/4,c=(r+2*s+o)/4,u=(i+a)/2-_,d=(r+o)/2-c;return 16<h||(l<u*u+d*d?(mi.stbtt__tesselate_curve(e,t,i,r,(i+n)/2,(r+s)/2,_,c,l,h+1),mi.stbtt__tesselate_curve(e,t,_,c,(n+a)/2,(s+o)/2,a,o,l,h+1)):(mi.stbtt__add_point(e,t.value,a,o),t.value+=1)),1},mi.stbtt_FlattenCurves=function(e,t,i,r,n){for(var s=null,a=0,o=i*i,l=0,h=0,_=0,c=t;_<c;){1==e[_++].type&&++l}if(0==(n.value=l))return null;var u=new Array(l);if(r.value=u,null==r.value)return n.value=0,null;for(var d=0;d<2;){var f=0,g=0;if(1==d++){if(null==(s=new Array(a)))return r.value=null,n.value=0,null;for(var v=0,p=s.length;v<p;){s[v++]=new pi}}l=-1;for(var m=a=0,y=t;m<y;){var b=m++;switch(e[b].type){case 1:0<=l&&(r.value[l]=a-h),++l,h=a,f=e[b].x,g=e[b].y,mi.stbtt__add_point(s,a++,f,g);break;case 2:f=e[b].x,g=e[b].y,mi.stbtt__add_point(s,a++,f,g);break;case 3:var w={value:a};mi.stbtt__tesselate_curve(s,w,f,g,e[b].cx,e[b].cy,e[b].x,e[b].y,o,0),a=w.value,f=e[b].x,g=e[b].y}}r.value[l]=a-h}return s},mi.stbtt_Rasterize=function(e,t,i,r,n,s,a,o,l,h,_){var c,u=s<n?s:n,d=0,f={value:d},g=new ii,v=mi.stbtt_FlattenCurves(i,r,t/u,g,f);d=f.value,c=g.value,null!=v&&mi.stbtt__rasterize(e,v,c,d,n,s,a,o,l,h,_)},mi.stbtt_GetGlyphBitmapSubpixel=function(e,t,i,r,n,s,a){var o,l,h,_,c=new fi,u=mi.stbtt_GetGlyphShape(e,s),d=u.length;if(0==t&&(t=i),0==i){if(0==t)return null;i=t}var f=mi.stbtt_GetGlyphBitmapBoxSubpixel(e,s,t,i,r,n);return o=f.x0,l=f.y0,h=f.x1,_=f.y1,c.w=h-o,c.h=_-l,c.pixels=null,a.width=c.w,a.height=c.h,a.xoff=o,a.yoff=l,0!=c.w&&0!=c.h&&(c.pixels=tr.alloc(c.w*c.h),null!=c.pixels&&(c.stride=c.w,mi.stbtt_Rasterize(c,.35,u,d,t,i,r,n,o,l,!0))),c.pixels},mi.stbtt_GetGlyphBitmap=function(e,t,i,r,n){return mi.stbtt_GetGlyphBitmapSubpixel(e,t,i,0,0,r,n)},mi.stbtt_MakeGlyphBitmapSubpixel=function(e,t,i,r,n,s,a,o,l,h,_){var c,u,d=mi.stbtt_GetGlyphShape(e,_),f=null==d?0:d.length,g=new fi,v=mi.stbtt_GetGlyphBitmapBoxSubpixel(e,_,a,o,l,h);c=v.x0,u=v.y0,g.pixels=t,g.pixels_offset=i,g.w=r,g.h=n,g.stride=s,0!=g.w&&0!=g.h&&mi.stbtt_Rasterize(g,.35,d,f,a,o,l,h,c,u,!0)},mi.stbtt_MakeGlyphBitmap=function(e,t,i,r,n,s,a,o,l){mi.stbtt_MakeGlyphBitmapSubpixel(e,t,i,r,n,s,a,o,0,0,l)},mi.stbtt_GetCodepointBitmapSubpixel=function(e,t,i,r,n,s,a){return mi.stbtt_GetGlyphBitmapSubpixel(e,t,i,r,n,mi.stbtt_FindGlyphIndex(e,s),a)},mi.stbtt_MakeCodepointBitmapSubpixel=function(e,t,i,r,n,s,a,o,l,h,_){mi.stbtt_MakeGlyphBitmapSubpixel(e,t,i,r,n,s,a,o,l,h,mi.stbtt_FindGlyphIndex(e,_))},mi.stbtt_GetCodepointBitmap=function(e,t,i,r,n){return mi.stbtt_GetCodepointBitmapSubpixel(e,t,i,0,0,r,n)},mi.stbtt_MakeCodepointBitmap=function(e,t,i,r,n,s,a,o,l){mi.stbtt_MakeCodepointBitmapSubpixel(e,t,i,r,n,s,a,o,0,0,l)},mi.stbtt_BakeFontBitmap=function(e,t,i,r,n,s,a,o){var l,h,_,c,u=new ui;if(!mi.stbtt_InitFont(u,e,t))return-1;for(var d=0,f=n*s;d<f;){var g=d++;r.writeU8(g,0)}h=_=1,c=1,l=mi.stbtt_ScaleForPixelHeight(u,i);for(var v=0,p=0;p<a.length;){var m,y,b,w,x,B=a[p];++p;var S=mi.stbtt_FindGlyphIndex(u,B),T=mi.stbtt_GetGlyphHMetrics(u,S);m=T.advanceWidth,T.leftSideBearing;var k=mi.stbtt_GetGlyphBitmapBox(u,S,l,l);if(y=k.x0,b=k.y0,n<=h+(w=k.x1-y)+1&&(_=c,h=1),s<=_+(x=k.y1-b)+1)return-v;if(n<=h+w)throw new dt("Error");if(s<=_+x)throw new dt("Error");mi.stbtt_MakeGlyphBitmap(u,r,h+_*n,w,x,n,l,l,S),o[v].x0=h,o[v].y0=_,o[v].x1=h+w,o[v].y1=_+x,o[v].xadvance=l*m,o[v].xoff=y,o[v].yoff=b,h=h+w+1,c<_+x+1&&(c=_+x+1),++v}return c},mi.stbtt_GetBakedQuad=function(e,t,i,r,n,s,a,o){var l=o?0:-.5,h=1/t,_=1/i,c=e[r],u=Math.floor(n.value+c.xoff+.5),d=Math.floor(s.value+c.yoff+.5);a.x0=u+l,a.y0=d+l,a.x1=u+c.x1-c.x0+l,a.y1=d+c.y1-c.y0+l,a.s0=c.x0*h,a.t0=c.y0*_,a.s1=c.x1*h,a.t1=c.y1*_,n.value+=c.xadvance};var yi=i["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"]};yi.Always=["Always",0],yi.Always.toString=r,(yi.Always.__enum__=yi).Never=["Never",1],yi.Never.toString=r,(yi.Never.__enum__=yi).Equal=["Equal",2],yi.Equal.toString=r,(yi.Equal.__enum__=yi).NotEqual=["NotEqual",3],yi.NotEqual.toString=r,(yi.NotEqual.__enum__=yi).Less=["Less",4],yi.Less.toString=r,(yi.Less.__enum__=yi).LessEqual=["LessEqual",5],yi.LessEqual.toString=r,(yi.LessEqual.__enum__=yi).Greater=["Greater",6],yi.Greater.toString=r,(yi.Greater.__enum__=yi).GreaterEqual=["GreaterEqual",7],yi.GreaterEqual.toString=r,yi.GreaterEqual.__enum__=yi;var bi=function(){};(i["kha.graphics4.ConstantLocation"]=bi).__name__=!0;var wi=function(e,t,i,r){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=e,this.format=t,this.renderTarget=i,this.depthStencilFormat=r,i&&this.createTexture()};(i["kha.graphics4.CubeMap"]=wi).__name__=!0,wi.__interfaces__=[We,Oe],wi.createRenderTarget=function(e,t,i,r){return null==r&&(r=0),null==t&&(t=Ui.RGBA32),null==i&&(i=0),new wi(e,t,!0,i)},wi.prototype={createTexture:function(){if(null!=D.gl){if(this.texture=D.gl.createTexture(),D.gl.bindTexture(34067,this.texture),D.gl.texParameteri(34067,10240,9729),D.gl.texParameteri(34067,10241,9729),D.gl.texParameteri(34067,10242,33071),D.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=D.gl.createFramebuffer(),D.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:for(var e=0;e<6;){var t=e++;D.gl.texImage2D(34069+t,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}break;case 2:for(var i=0;i<6;){var r=i++;D.gl.texImage2D(34069+r,0,D.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null)}break;case 3:for(var n=0;n<6;){var s=n++;D.gl.texImage2D(34069+s,0,D.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null)}break;case 4:for(var a=0;a<6;){var o=a++;D.gl.texImage2D(34069+o,0,D.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,D.halfFloat.HALF_FLOAT_OES,null)}break;case 5:for(var l=0;l<6;){var h=l++;D.gl.texImage2D(34069+h,0,D.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null)}break;case 6:for(var _=0;_<6;){var c=_++;D.gl.texImage2D(34069+c,0,D.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,D.halfFloat.HALF_FLOAT_OES,null)}break;default:for(var u=0;u<6;){var d=u++;D.gl.texImage2D(34069+d,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}}if(this.format==Ui.DEPTH16&&(D.gl.texParameteri(34067,10240,9728),D.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!D.gl2)){var f=D.gl.createTexture();D.gl.bindTexture(34067,f);for(var g=0;g<6;){var v=g++;D.gl.texImage2D(34069+v,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),D.gl.framebufferTexture2D(36160,36064,34069+v,f,0)}D.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),D.gl.bindFramebuffer(36160,null)}D.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:this.depthTexture=D.gl.createTexture(),D.gl.bindTexture(34067,this.depthTexture),1==e?D.gl.texImage2D(34067,0,D.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):D.gl.texImage2D(34067,0,D.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),D.gl.texParameteri(34067,10240,9728),D.gl.texParameteri(34067,10241,9728),D.gl.texParameteri(34067,10242,33071),D.gl.texParameteri(34067,10243,33071),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=D.gl.createTexture(),D.gl.bindTexture(34067,this.depthTexture),D.gl.texImage2D(34067,0,D.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,D.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),D.gl.texParameteri(34067,10240,9728),D.gl.texParameteri(34067,10241,9728),D.gl.texParameteri(34067,10242,33071),D.gl.texParameteri(34067,10243,33071),D.gl.bindFramebuffer(36160,this.frameBuffer),D.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(e){D.gl.activeTexture(33984+e),D.gl.bindTexture(34067,this.texture)},setDepth:function(e){D.gl.activeTexture(33984+e),D.gl.bindTexture(34067,this.depthTexture)},unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g1:function(){return null},get_g2:function(){return null},get_g4:function(){return null==this.graphics4&&(this.graphics4=new gr(this)),this.graphics4},__class__:wi,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var xi=i["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"]};xi.Clockwise=["Clockwise",0],xi.Clockwise.toString=r,(xi.Clockwise.__enum__=xi).CounterClockwise=["CounterClockwise",1],xi.CounterClockwise.toString=r,(xi.CounterClockwise.__enum__=xi).None=["None",2],xi.None.toString=r,xi.None.__enum__=xi;var Bi=function(e,t){this.sources=[];for(var i=0;i<e.length;){var r=e[i];++i,this.sources.push(r.toString())}this.type=35632,this.shader=null,this.files=t};(i["kha.graphics4.FragmentShader"]=Bi).__name__=!0,Bi.fromSource=function(e){var t=new Bi([],["runtime-string"]);return t.sources.push(e),t},Bi.prototype={delete:function(){D.gl.deleteShader(this.shader),this.shader=null,this.sources=null},__class__:Bi};var Si=function(e){};(i["kha.graphics4.GeometryShader"]=Si).__name__=!0,Si.prototype={delete:function(){},__class__:Si};var Ti=function(){};(i["kha.graphics4.Graphics"]=Ti).__name__=!0,Ti.prototype={__class__:Ti};var ki=function(e){this.destinationBlend=K.Undefined,this.sourceBlend=K.Undefined,this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,ki.bufferIndex=0,ki.initShaders(),this.initBuffers(),this.projectionLocation=ki.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=ki.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.ImageShaderPainter"]=ki).__name__=!0,ki.initShaders=function(){null==ki.structure&&(ki.structure=Ci.createImageVertexStructure()),null==ki.shaderPipeline&&(ki.shaderPipeline=Ci.createImagePipeline(ki.structure),ki.shaderPipeline.compile())},ki.prototype={get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return null==e?(this.projectionLocation=ki.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=ki.shaderPipeline.getTextureUnit("tex")):(this.projectionLocation=e.getConstantLocation("projectionMatrix"),this.textureLocation=e.getTextureUnit("tex")),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==ki.rectVertexBuffer){ki.rectVertexBuffer=new zi(6e3,ki.structure,Wi.DynamicUsage),ki.rectVertices=ki.rectVertexBuffer.lock(),ki.indexBuffer=new Di(9e3,Wi.StaticUsage);for(var e=ki.indexBuffer.lock(),t=0;t<1500;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}ki.indexBuffer.unlock()}},setRectVertices:function(e,t,i,r,n,s,a,o){var l=9*ki.bufferIndex*4;ki.rectVertices[l]=e,ki.rectVertices[l+1]=t,ki.rectVertices[l+2]=-5,ki.rectVertices[l+9]=i,ki.rectVertices[l+10]=r,ki.rectVertices[l+11]=-5,ki.rectVertices[l+18]=n,ki.rectVertices[l+19]=s,ki.rectVertices[l+20]=-5,ki.rectVertices[l+27]=a,ki.rectVertices[l+28]=o,ki.rectVertices[l+29]=-5},setRectTexCoords:function(e,t,i,r){var n=9*ki.bufferIndex*4;ki.rectVertices[n+3]=e,ki.rectVertices[n+4]=r,ki.rectVertices[n+12]=e,ki.rectVertices[n+13]=t,ki.rectVertices[n+21]=i,ki.rectVertices[n+22]=t,ki.rectVertices[n+30]=i,ki.rectVertices[n+31]=r},setRectColor:function(e,t,i,r){var n=9*ki.bufferIndex*4;ki.rectVertices[n+5]=e,ki.rectVertices[n+6]=t,ki.rectVertices[n+7]=i,ki.rectVertices[n+8]=r,ki.rectVertices[n+14]=e,ki.rectVertices[n+15]=t,ki.rectVertices[n+16]=i,ki.rectVertices[n+17]=r,ki.rectVertices[n+23]=e,ki.rectVertices[n+24]=t,ki.rectVertices[n+25]=i,ki.rectVertices[n+26]=r,ki.rectVertices[n+32]=e,ki.rectVertices[n+33]=t,ki.rectVertices[n+34]=i,ki.rectVertices[n+35]=r},drawBuffer:function(){ki.rectVertexBuffer.unlock(),this.g.setVertexBuffer(ki.rectVertexBuffer),this.g.setIndexBuffer(ki.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?ki.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,ki.lastTexture),this.g.setTextureParameters(this.textureLocation,Fi.Clamp,Fi.Clamp,this.bilinear?Gi.LinearFilter:Gi.PointFilter,this.bilinear?Gi.LinearFilter:Gi.PointFilter,this.bilinearMipmaps?Pi.LinearMipFilter:Pi.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*ki.bufferIndex*3),this.g.setTexture(this.textureLocation,null),ki.bufferIndex=0,ki.rectVertices=ki.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setBilinearMipmapFilter:function(e){this.end(),this.bilinearMipmaps=e},drawImage:function(e,t,i,r,n,s,a,o,l,h,_){var c=e;(1500<=ki.bufferIndex+1||null!=ki.lastTexture&&c!=ki.lastTexture)&&this.drawBuffer();var u=.00392156862745098*((16711680&_)>>>16),d=.00392156862745098*((65280&_)>>>8),f=.00392156862745098*(255&_),g=.00392156862745098*(_>>>24)*h,v=9*ki.bufferIndex*4;ki.rectVertices[v+5]=u,ki.rectVertices[v+6]=d,ki.rectVertices[v+7]=f,ki.rectVertices[v+8]=g,ki.rectVertices[v+14]=u,ki.rectVertices[v+15]=d,ki.rectVertices[v+16]=f,ki.rectVertices[v+17]=g,ki.rectVertices[v+23]=u,ki.rectVertices[v+24]=d,ki.rectVertices[v+25]=f,ki.rectVertices[v+26]=g,ki.rectVertices[v+32]=u,ki.rectVertices[v+33]=d,ki.rectVertices[v+34]=f,ki.rectVertices[v+35]=g;var p=c.get_width()/c.get_realWidth(),m=c.get_height()/c.get_realHeight(),y=9*ki.bufferIndex*4;ki.rectVertices[y+3]=0,ki.rectVertices[y+4]=m,ki.rectVertices[y+12]=0,ki.rectVertices[y+13]=0,ki.rectVertices[y+21]=p,ki.rectVertices[y+22]=0,ki.rectVertices[y+30]=p,ki.rectVertices[y+31]=m;var b=9*ki.bufferIndex*4;ki.rectVertices[b]=t,ki.rectVertices[b+1]=i,ki.rectVertices[b+2]=-5,ki.rectVertices[b+9]=r,ki.rectVertices[b+10]=n,ki.rectVertices[b+11]=-5,ki.rectVertices[b+18]=s,ki.rectVertices[b+19]=a,ki.rectVertices[b+20]=-5,ki.rectVertices[b+27]=o,ki.rectVertices[b+28]=l,ki.rectVertices[b+29]=-5,++ki.bufferIndex,ki.lastTexture=c},drawImage2:function(e,t,i,r,n,s,a,o,l,h,_,c,u,d,f){var g=e;(1500<=ki.bufferIndex+1||null!=ki.lastTexture&&g!=ki.lastTexture)&&this.drawBuffer();var v=t/g.get_realWidth(),p=i/g.get_realHeight(),m=(t+r)/g.get_realWidth(),y=(i+n)/g.get_realHeight(),b=9*ki.bufferIndex*4;ki.rectVertices[b+3]=v,ki.rectVertices[b+4]=y,ki.rectVertices[b+12]=v,ki.rectVertices[b+13]=p,ki.rectVertices[b+21]=m,ki.rectVertices[b+22]=p,ki.rectVertices[b+30]=m,ki.rectVertices[b+31]=y;var w=.00392156862745098*((16711680&f)>>>16),x=.00392156862745098*((65280&f)>>>8),B=.00392156862745098*(255&f),S=.00392156862745098*(f>>>24)*d,T=9*ki.bufferIndex*4;ki.rectVertices[T+5]=w,ki.rectVertices[T+6]=x,ki.rectVertices[T+7]=B,ki.rectVertices[T+8]=S,ki.rectVertices[T+14]=w,ki.rectVertices[T+15]=x,ki.rectVertices[T+16]=B,ki.rectVertices[T+17]=S,ki.rectVertices[T+23]=w,ki.rectVertices[T+24]=x,ki.rectVertices[T+25]=B,ki.rectVertices[T+26]=S,ki.rectVertices[T+32]=w,ki.rectVertices[T+33]=x,ki.rectVertices[T+34]=B,ki.rectVertices[T+35]=S;var k=9*ki.bufferIndex*4;ki.rectVertices[k]=s,ki.rectVertices[k+1]=a,ki.rectVertices[k+2]=-5,ki.rectVertices[k+9]=o,ki.rectVertices[k+10]=l,ki.rectVertices[k+11]=-5,ki.rectVertices[k+18]=h,ki.rectVertices[k+19]=_,ki.rectVertices[k+20]=-5,ki.rectVertices[k+27]=c,ki.rectVertices[k+28]=u,ki.rectVertices[k+29]=-5,++ki.bufferIndex,ki.lastTexture=g},drawImageScale:function(e,t,i,r,n,s,a,o,l,h,_){var c=e;(1500<=ki.bufferIndex+1||null!=ki.lastTexture&&c!=ki.lastTexture)&&this.drawBuffer();var u=t/c.get_realWidth(),d=i/c.get_realHeight(),f=(t+r)/c.get_realWidth(),g=(i+n)/c.get_realHeight(),v=9*ki.bufferIndex*4;ki.rectVertices[v+3]=u,ki.rectVertices[v+4]=g,ki.rectVertices[v+12]=u,ki.rectVertices[v+13]=d,ki.rectVertices[v+21]=f,ki.rectVertices[v+22]=d,ki.rectVertices[v+30]=f,ki.rectVertices[v+31]=g;var p=.00392156862745098*((16711680&_)>>>16),m=.00392156862745098*((65280&_)>>>8),y=.00392156862745098*(255&_),b=9*ki.bufferIndex*4;ki.rectVertices[b+5]=p,ki.rectVertices[b+6]=m,ki.rectVertices[b+7]=y,ki.rectVertices[b+8]=h,ki.rectVertices[b+14]=p,ki.rectVertices[b+15]=m,ki.rectVertices[b+16]=y,ki.rectVertices[b+17]=h,ki.rectVertices[b+23]=p,ki.rectVertices[b+24]=m,ki.rectVertices[b+25]=y,ki.rectVertices[b+26]=h,ki.rectVertices[b+32]=p,ki.rectVertices[b+33]=m,ki.rectVertices[b+34]=y,ki.rectVertices[b+35]=h;var w=9*ki.bufferIndex*4;ki.rectVertices[w]=s,ki.rectVertices[w+1]=l,ki.rectVertices[w+2]=-5,ki.rectVertices[w+9]=s,ki.rectVertices[w+10]=a,ki.rectVertices[w+11]=-5,ki.rectVertices[w+18]=o,ki.rectVertices[w+19]=a,ki.rectVertices[w+20]=-5,ki.rectVertices[w+27]=o,ki.rectVertices[w+28]=l,ki.rectVertices[w+29]=-5,++ki.bufferIndex,ki.lastTexture=c},end:function(){0<ki.bufferIndex&&this.drawBuffer(),ki.lastTexture=null},__class__:ki,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ii=function(e){this.destinationBlend=K.Undefined,this.sourceBlend=K.Undefined,this.myPipeline=null,this.g=e,Ii.bufferIndex=0,Ii.triangleBufferIndex=0,Ii.initShaders(),this.initBuffers(),this.projectionLocation=Ii.shaderPipeline.getConstantLocation("projectionMatrix")};(i["kha.graphics4.ColoredShaderPainter"]=Ii).__name__=!0,Ii.initShaders=function(){null==Ii.structure&&(Ii.structure=Ci.createColoredVertexStructure()),null==Ii.shaderPipeline&&(Ii.shaderPipeline=Ci.createColoredPipeline(Ii.structure),Ii.shaderPipeline.compile())},Ii.prototype={get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return this.projectionLocation=null==e?Ii.shaderPipeline.getConstantLocation("projectionMatrix"):e.getConstantLocation("projectionMatrix"),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Ii.rectVertexBuffer){Ii.rectVertexBuffer=new zi(400,Ii.structure,Wi.DynamicUsage),Ii.rectVertices=Ii.rectVertexBuffer.lock(),Ii.indexBuffer=new Di(600,Wi.StaticUsage);for(var e=Ii.indexBuffer.lock(),t=0;t<100;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}Ii.indexBuffer.unlock(),Ii.triangleVertexBuffer=new zi(300,Ii.structure,Wi.DynamicUsage),Ii.triangleVertices=Ii.triangleVertexBuffer.lock(),Ii.triangleIndexBuffer=new Di(300,Wi.StaticUsage);for(var r=Ii.triangleIndexBuffer.lock(),n=0;n<100;){var s=n++;r[3*s]=3*s,r[3*s+1]=3*s+1,r[3*s+2]=3*s+2}Ii.triangleIndexBuffer.unlock()}},setRectVertices:function(e,t,i,r,n,s,a,o){var l=7*Ii.bufferIndex*4;Ii.rectVertices[l]=e,Ii.rectVertices[l+1]=t,Ii.rectVertices[l+2]=-5,Ii.rectVertices[l+7]=i,Ii.rectVertices[l+8]=r,Ii.rectVertices[l+9]=-5,Ii.rectVertices[l+14]=n,Ii.rectVertices[l+15]=s,Ii.rectVertices[l+16]=-5,Ii.rectVertices[l+21]=a,Ii.rectVertices[l+22]=o,Ii.rectVertices[l+23]=-5},setRectColors:function(e,t){var i=7*Ii.bufferIndex*4,r=e*(.00392156862745098*(t>>>24));Ii.rectVertices[i+3]=.00392156862745098*((16711680&t)>>>16),Ii.rectVertices[i+4]=.00392156862745098*((65280&t)>>>8),Ii.rectVertices[i+5]=.00392156862745098*(255&t),Ii.rectVertices[i+6]=r,Ii.rectVertices[i+10]=.00392156862745098*((16711680&t)>>>16),Ii.rectVertices[i+11]=.00392156862745098*((65280&t)>>>8),Ii.rectVertices[i+12]=.00392156862745098*(255&t),Ii.rectVertices[i+13]=r,Ii.rectVertices[i+17]=.00392156862745098*((16711680&t)>>>16),Ii.rectVertices[i+18]=.00392156862745098*((65280&t)>>>8),Ii.rectVertices[i+19]=.00392156862745098*(255&t),Ii.rectVertices[i+20]=r,Ii.rectVertices[i+24]=.00392156862745098*((16711680&t)>>>16),Ii.rectVertices[i+25]=.00392156862745098*((65280&t)>>>8),Ii.rectVertices[i+26]=.00392156862745098*(255&t),Ii.rectVertices[i+27]=r},setTriVertices:function(e,t,i,r,n,s){var a=7*Ii.triangleBufferIndex*3;Ii.triangleVertices[a]=e,Ii.triangleVertices[a+1]=t,Ii.triangleVertices[a+2]=-5,Ii.triangleVertices[a+7]=i,Ii.triangleVertices[a+8]=r,Ii.triangleVertices[a+9]=-5,Ii.triangleVertices[a+14]=n,Ii.triangleVertices[a+15]=s,Ii.triangleVertices[a+16]=-5},setTriColors:function(e,t){var i=7*Ii.triangleBufferIndex*3,r=e*(.00392156862745098*(t>>>24));Ii.triangleVertices[i+3]=.00392156862745098*((16711680&t)>>>16),Ii.triangleVertices[i+4]=.00392156862745098*((65280&t)>>>8),Ii.triangleVertices[i+5]=.00392156862745098*(255&t),Ii.triangleVertices[i+6]=r,Ii.triangleVertices[i+10]=.00392156862745098*((16711680&t)>>>16),Ii.triangleVertices[i+11]=.00392156862745098*((65280&t)>>>8),Ii.triangleVertices[i+12]=.00392156862745098*(255&t),Ii.triangleVertices[i+13]=r,Ii.triangleVertices[i+17]=.00392156862745098*((16711680&t)>>>16),Ii.triangleVertices[i+18]=.00392156862745098*((65280&t)>>>8),Ii.triangleVertices[i+19]=.00392156862745098*(255&t),Ii.triangleVertices[i+20]=r},drawBuffer:function(e){e||0<Ii.triangleBufferIndex&&this.drawTriBuffer(!0),Ii.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ii.rectVertexBuffer),this.g.setIndexBuffer(Ii.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ii.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ii.bufferIndex*3),Ii.bufferIndex=0,Ii.rectVertices=Ii.rectVertexBuffer.lock()},drawTriBuffer:function(e){e||0<Ii.bufferIndex&&this.drawBuffer(!0),Ii.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(Ii.triangleVertexBuffer),this.g.setIndexBuffer(Ii.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ii.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ii.triangleBufferIndex),Ii.triangleBufferIndex=0,Ii.triangleVertices=Ii.triangleVertexBuffer.lock()},fillRect:function(e,t,i,r,n,s,a,o,l,h){0<Ii.triangleBufferIndex&&this.drawTriBuffer(!0),100<=Ii.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(i,r,n,s,a,o,l,h),++Ii.bufferIndex},fillTriangle:function(e,t,i,r,n,s,a,o){0<Ii.bufferIndex&&this.drawBuffer(!0),100<=Ii.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(e,t),this.setTriVertices(i,r,n,s,a,o),++Ii.triangleBufferIndex},endTris:function(e){0<Ii.triangleBufferIndex&&this.drawTriBuffer(e)},endRects:function(e){0<Ii.bufferIndex&&this.drawBuffer(e)},end:function(){0<Ii.triangleBufferIndex&&this.drawTriBuffer(!1),0<Ii.bufferIndex&&this.drawBuffer(!1)},__class__:Ii,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ai=function(e){this.bakedQuadCache=new Qe,this.destinationBlend=K.Undefined,this.sourceBlend=K.Undefined,this.bilinear=!1,this.myPipeline=null,this.g=e,Ai.bufferIndex=0,Ai.initShaders(),this.initBuffers(),this.projectionLocation=Ai.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ai.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.TextShaderPainter"]=Ai).__name__=!0,Ai.initShaders=function(){null==Ai.structure&&(Ai.structure=Ci.createTextVertexStructure()),null==Ai.shaderPipeline&&(Ai.shaderPipeline=Ci.createTextPipeline(Ai.structure),Ai.shaderPipeline.compile())},Ai.findIndex=function(e,t){for(var i=0,r=t.length;i<r;){var n=i++;if(t[n]==e)return n}return 0},Ai.prototype={get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return null==e?(this.projectionLocation=Ai.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ai.shaderPipeline.getTextureUnit("tex")):(this.projectionLocation=e.getConstantLocation("projectionMatrix"),this.textureLocation=e.getTextureUnit("tex")),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Ai.rectVertexBuffer){Ai.rectVertexBuffer=new zi(400,Ai.structure,Wi.DynamicUsage),Ai.rectVertices=Ai.rectVertexBuffer.lock(),Ai.indexBuffer=new Di(600,Wi.StaticUsage);for(var e=Ai.indexBuffer.lock(),t=0;t<100;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}Ai.indexBuffer.unlock()}},setRectVertices:function(e,t,i,r,n,s,a,o){var l=9*Ai.bufferIndex*4;Ai.rectVertices[l]=e,Ai.rectVertices[l+1]=t,Ai.rectVertices[l+2]=-5,Ai.rectVertices[l+9]=i,Ai.rectVertices[l+10]=r,Ai.rectVertices[l+11]=-5,Ai.rectVertices[l+18]=n,Ai.rectVertices[l+19]=s,Ai.rectVertices[l+20]=-5,Ai.rectVertices[l+27]=a,Ai.rectVertices[l+28]=o,Ai.rectVertices[l+29]=-5},setRectTexCoords:function(e,t,i,r){var n=9*Ai.bufferIndex*4;Ai.rectVertices[n+3]=e,Ai.rectVertices[n+4]=r,Ai.rectVertices[n+12]=e,Ai.rectVertices[n+13]=t,Ai.rectVertices[n+21]=i,Ai.rectVertices[n+22]=t,Ai.rectVertices[n+30]=i,Ai.rectVertices[n+31]=r},setRectColors:function(e,t){var i=9*Ai.bufferIndex*4,r=e*(.00392156862745098*(t>>>24));Ai.rectVertices[i+5]=.00392156862745098*((16711680&t)>>>16),Ai.rectVertices[i+6]=.00392156862745098*((65280&t)>>>8),Ai.rectVertices[i+7]=.00392156862745098*(255&t),Ai.rectVertices[i+8]=r,Ai.rectVertices[i+14]=.00392156862745098*((16711680&t)>>>16),Ai.rectVertices[i+15]=.00392156862745098*((65280&t)>>>8),Ai.rectVertices[i+16]=.00392156862745098*(255&t),Ai.rectVertices[i+17]=r,Ai.rectVertices[i+23]=.00392156862745098*((16711680&t)>>>16),Ai.rectVertices[i+24]=.00392156862745098*((65280&t)>>>8),Ai.rectVertices[i+25]=.00392156862745098*(255&t),Ai.rectVertices[i+26]=r,Ai.rectVertices[i+32]=.00392156862745098*((16711680&t)>>>16),Ai.rectVertices[i+33]=.00392156862745098*((65280&t)>>>8),Ai.rectVertices[i+34]=.00392156862745098*(255&t),Ai.rectVertices[i+35]=r},drawBuffer:function(){Ai.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ai.rectVertexBuffer),this.g.setIndexBuffer(Ai.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ai.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Ai.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,Fi.Clamp,Fi.Clamp,this.bilinear?Gi.LinearFilter:Gi.PointFilter,this.bilinear?Gi.LinearFilter:Gi.PointFilter,Pi.NoMipFilter),this.g.drawIndexedVertices(0,2*Ai.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Ai.bufferIndex=0,Ai.rectVertices=Ai.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setFont:function(e){this.font=Re.__cast(e,Je)},startString:function(e){this.text=e},charCodeAt:function(e){return $.cca(this.text,e)},stringLength:function(){return this.text.length},endString:function(){this.text=null},drawString:function(e,t,i,r,n,s,a){var o=this.font._get(this.fontSize,a),l=o.getTexture();null!=Ai.lastTexture&&l!=Ai.lastTexture&&this.drawBuffer(),Ai.lastTexture=l;var h=r,_=n;this.startString(e);for(var c=0,u=this.stringLength();c<u;){var d=c++,f=o.getBakedQuad(this.bakedQuadCache,Ai.findIndex(this.charCodeAt(d),a),h,_);if(null!=f){var g,v,p;100<=Ai.bufferIndex+1&&this.drawBuffer(),this.setRectColors(t,i),this.setRectTexCoords(f.s0*l.get_width()/l.get_realWidth(),f.t0*l.get_height()/l.get_realHeight(),f.s1*l.get_width()/l.get_realWidth(),f.t1*l.get_height()/l.get_realHeight());var m=f.x0;p=f.y1;var y,b,w,x=s._02*m+s._12*p+s._22;v=(s._00*m+s._10*p+s._20)/x,g=(s._01*m+s._11*p+s._21)/x;var B=f.x0;w=f.y0;var S,T,k,I=s._02*B+s._12*w+s._22;b=(s._00*B+s._10*w+s._20)/I,y=(s._01*B+s._11*w+s._21)/I;var A=f.x1;k=f.y0;var C,D,P,E=s._02*A+s._12*k+s._22;T=(s._00*A+s._10*k+s._20)/E,S=(s._01*A+s._11*k+s._21)/E;var N=f.x1;P=f.y1;var M=s._02*N+s._12*P+s._22;D=(s._00*N+s._10*P+s._20)/M,C=(s._01*N+s._11*P+s._21)/M,this.setRectVertices(v,g,b,y,T,S,D,C),h+=f.xadvance,++Ai.bufferIndex}}this.endString()},drawCharacters:function(e,t,i,r,n,s,a,o,l){var h=this.font._get(this.fontSize,l),_=h.getTexture();null!=Ai.lastTexture&&_!=Ai.lastTexture&&this.drawBuffer(),Ai.lastTexture=_;for(var c=s,u=a,d=t,f=t+i;d<f;){var g=d++,v=h.getBakedQuad(this.bakedQuadCache,Ai.findIndex(e[g],l),c,u);if(null!=v){var p,m,y;100<=Ai.bufferIndex+1&&this.drawBuffer(),this.setRectColors(r,n),this.setRectTexCoords(v.s0*_.get_width()/_.get_realWidth(),v.t0*_.get_height()/_.get_realHeight(),v.s1*_.get_width()/_.get_realWidth(),v.t1*_.get_height()/_.get_realHeight());var b=v.x0;y=v.y1;var w,x,B,S=o._02*b+o._12*y+o._22;m=(o._00*b+o._10*y+o._20)/S,p=(o._01*b+o._11*y+o._21)/S;var T=v.x0;B=v.y0;var k,I,A,C=o._02*T+o._12*B+o._22;x=(o._00*T+o._10*B+o._20)/C,w=(o._01*T+o._11*B+o._21)/C;var D=v.x1;A=v.y0;var P,E,N,M=o._02*D+o._12*A+o._22;I=(o._00*D+o._10*A+o._20)/M,k=(o._01*D+o._11*A+o._21)/M;var L=v.x1;N=v.y1;var R=o._02*L+o._12*N+o._22;E=(o._00*L+o._10*N+o._20)/R,P=(o._01*L+o._11*N+o._21)/R,this.setRectVertices(m,p,x,w,I,k,E,P),c+=v.xadvance,++Ai.bufferIndex}}},end:function(){0<Ai.bufferIndex&&this.drawBuffer(),Ai.lastTexture=null},__class__:Ai,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ci=function(e){this.myMipmapScaleQuality=ei.High,this.myImageScaleQuality=ei.High,Qt.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new ki(this.g),this.coloredPainter=new Ii(this.g),this.textPainter=new Ai(this.g),this.textPainter.fontSize=this.get_fontSize(),this.setProjection(),null==Ci.videoPipeline&&(Ci.videoPipeline=Ci.createImagePipeline(Ci.createImageVertexStructure()),Ci.videoPipeline.fragmentShader=nt.painter_video_frag,Ci.videoPipeline.vertexShader=nt.painter_video_vert,Ci.videoPipeline.compile())};(i["kha.graphics4.Graphics2"]=Ci).__name__=!0,Ci.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},Ci.createImageVertexStructure=function(){var e=new ji;return e.add("vertexPosition",Hi.Float3),e.add("texPosition",Hi.Float2),e.add("vertexColor",Hi.Float4),e},Ci.createImagePipeline=function(e){var t=new Ni;return t.fragmentShader=nt.painter_image_frag,t.vertexShader=nt.painter_image_vert,t.inputLayout=[e],t.blendSource=K.BlendOne,t.blendDestination=K.InverseSourceAlpha,t.alphaBlendSource=K.BlendOne,t.alphaBlendDestination=K.InverseSourceAlpha,t},Ci.createColoredVertexStructure=function(){var e=new ji;return e.add("vertexPosition",Hi.Float3),e.add("vertexColor",Hi.Float4),e},Ci.createColoredPipeline=function(e){var t=new Ni;return t.fragmentShader=nt.painter_colored_frag,t.vertexShader=nt.painter_colored_vert,t.inputLayout=[e],t.blendSource=K.SourceAlpha,t.blendDestination=K.InverseSourceAlpha,t.alphaBlendSource=K.SourceAlpha,t.alphaBlendDestination=K.InverseSourceAlpha,t},Ci.createTextVertexStructure=function(){var e=new ji;return e.add("vertexPosition",Hi.Float3),e.add("texPosition",Hi.Float2),e.add("vertexColor",Hi.Float4),e},Ci.createTextPipeline=function(e){var t=new Ni;return t.fragmentShader=nt.painter_text_frag,t.vertexShader=nt.painter_text_vert,t.inputLayout=[e],t.blendSource=K.SourceAlpha,t.blendDestination=K.InverseSourceAlpha,t.alphaBlendSource=K.SourceAlpha,t.alphaBlendDestination=K.InverseSourceAlpha,t},Ci.__super__=Qt,Ci.prototype=n(Qt.prototype,{setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();Re.__instanceof(this.canvas,Ye)?this.projectionMatrix=br.orthogonalProjection(0,e,t,0,.1,1e3):(ze.get_nonPow2Supported()||(e=Ci.upperPowerOfTwo(e),t=Ci.upperPowerOfTwo(t)),this.g.renderTargetsInvertedY()?this.projectionMatrix=br.orthogonalProjection(0,e,0,t,.1,1e3):this.projectionMatrix=br.orthogonalProjection(0,e,t,0,.1,1e3)),this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(e,t,i){var r=this.coloredPainter;0<Ii.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ii.bufferIndex&&r.drawBuffer(!1),this.textPainter.end();var n,s,a,o=t+e.get_width(),l=i+e.get_height(),h=this.transformations[this.transformations.length-1],_=t;a=l;var c,u,d=h._02*_+h._12*a+h._22;s=(h._00*_+h._10*a+h._20)/d,n=(h._01*_+h._11*a+h._21)/d;var f,g=this.transformations[this.transformations.length-1],v=t;f=i;var p,m,y=g._02*v+g._12*f+g._22;u=(g._00*v+g._10*f+g._20)/y,c=(g._01*v+g._11*f+g._21)/y;var b,w=this.transformations[this.transformations.length-1],x=o;b=i;var B,S,T=w._02*x+w._12*b+w._22;m=(w._00*x+w._10*b+w._20)/T,p=(w._01*x+w._11*b+w._21)/T;var k,I=this.transformations[this.transformations.length-1],A=o;k=l;var C=I._02*A+I._12*k+I._22;S=(I._00*A+I._10*k+I._20)/C,B=(I._01*A+I._11*k+I._21)/C;var D=this.imagePainter,P=this.get_opacity(),E=this.get_color(),N=e;(1500<=ki.bufferIndex+1||null!=ki.lastTexture&&N!=ki.lastTexture)&&D.drawBuffer();var M=.00392156862745098*((16711680&E)>>>16),L=.00392156862745098*((65280&E)>>>8),R=.00392156862745098*(255&E),V=.00392156862745098*(E>>>24)*P,F=9*ki.bufferIndex*4;ki.rectVertices[F+5]=M,ki.rectVertices[F+6]=L,ki.rectVertices[F+7]=R,ki.rectVertices[F+8]=V,ki.rectVertices[F+14]=M,ki.rectVertices[F+15]=L,ki.rectVertices[F+16]=R,ki.rectVertices[F+17]=V,ki.rectVertices[F+23]=M,ki.rectVertices[F+24]=L,ki.rectVertices[F+25]=R,ki.rectVertices[F+26]=V,ki.rectVertices[F+32]=M,ki.rectVertices[F+33]=L,ki.rectVertices[F+34]=R,ki.rectVertices[F+35]=V;var G=N.get_width()/N.get_realWidth(),U=N.get_height()/N.get_realHeight(),O=9*ki.bufferIndex*4;ki.rectVertices[O+3]=0,ki.rectVertices[O+4]=U,ki.rectVertices[O+12]=0,ki.rectVertices[O+13]=0,ki.rectVertices[O+21]=G,ki.rectVertices[O+22]=0,ki.rectVertices[O+30]=G,ki.rectVertices[O+31]=U;var W=9*ki.bufferIndex*4;ki.rectVertices[W]=s,ki.rectVertices[W+1]=n,ki.rectVertices[W+2]=-5,ki.rectVertices[W+9]=u,ki.rectVertices[W+10]=c,ki.rectVertices[W+11]=-5,ki.rectVertices[W+18]=m,ki.rectVertices[W+19]=p,ki.rectVertices[W+20]=-5,ki.rectVertices[W+27]=S,ki.rectVertices[W+28]=B,ki.rectVertices[W+29]=-5,++ki.bufferIndex,ki.lastTexture=N},drawScaledSubImage:function(e,t,i,r,n,s,a,o,l){var h,_,c=this.coloredPainter;0<Ii.triangleBufferIndex&&c.drawTriBuffer(!1),0<Ii.bufferIndex&&c.drawBuffer(!1),this.textPainter.end();var u,d=this.transformations[this.transformations.length-1],f=s;u=a+l;var g,v,p=d._02*f+d._12*u+d._22;_=(d._00*f+d._10*u+d._20)/p,h=(d._01*f+d._11*u+d._21)/p;var m,y=this.transformations[this.transformations.length-1],b=s;m=a;var w,x,B=y._02*b+y._12*m+y._22;v=(y._00*b+y._10*m+y._20)/B,g=(y._01*b+y._11*m+y._21)/B;var S,T=this.transformations[this.transformations.length-1],k=s+o;S=a;var I,A,C=T._02*k+T._12*S+T._22;x=(T._00*k+T._10*S+T._20)/C,w=(T._01*k+T._11*S+T._21)/C;var D,P=this.transformations[this.transformations.length-1],E=s+o;D=a+l;var N=P._02*E+P._12*D+P._22;A=(P._00*E+P._10*D+P._20)/N,I=(P._01*E+P._11*D+P._21)/N;var M=this.imagePainter,L=this.get_opacity(),R=this.get_color(),V=e;(1500<=ki.bufferIndex+1||null!=ki.lastTexture&&V!=ki.lastTexture)&&M.drawBuffer();var F=t/V.get_realWidth(),G=i/V.get_realHeight(),U=(t+r)/V.get_realWidth(),O=(i+n)/V.get_realHeight(),W=9*ki.bufferIndex*4;ki.rectVertices[W+3]=F,ki.rectVertices[W+4]=O,ki.rectVertices[W+12]=F,ki.rectVertices[W+13]=G,ki.rectVertices[W+21]=U,ki.rectVertices[W+22]=G,ki.rectVertices[W+30]=U,ki.rectVertices[W+31]=O;var z=.00392156862745098*((16711680&R)>>>16),H=.00392156862745098*((65280&R)>>>8),Z=.00392156862745098*(255&R),X=.00392156862745098*(R>>>24)*L,j=9*ki.bufferIndex*4;ki.rectVertices[j+5]=z,ki.rectVertices[j+6]=H,ki.rectVertices[j+7]=Z,ki.rectVertices[j+8]=X,ki.rectVertices[j+14]=z,ki.rectVertices[j+15]=H,ki.rectVertices[j+16]=Z,ki.rectVertices[j+17]=X,ki.rectVertices[j+23]=z,ki.rectVertices[j+24]=H,ki.rectVertices[j+25]=Z,ki.rectVertices[j+26]=X,ki.rectVertices[j+32]=z,ki.rectVertices[j+33]=H,ki.rectVertices[j+34]=Z,ki.rectVertices[j+35]=X;var K=9*ki.bufferIndex*4;ki.rectVertices[K]=_,ki.rectVertices[K+1]=h,ki.rectVertices[K+2]=-5,ki.rectVertices[K+9]=v,ki.rectVertices[K+10]=g,ki.rectVertices[K+11]=-5,ki.rectVertices[K+18]=x,ki.rectVertices[K+19]=w,ki.rectVertices[K+20]=-5,ki.rectVertices[K+27]=A,ki.rectVertices[K+28]=I,ki.rectVertices[K+29]=-5,++ki.bufferIndex,ki.lastTexture=V},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},drawRect:function(e,t,i,r,n){null==n&&(n=1),this.imagePainter.end(),this.textPainter.end();var s,a=this.transformations[this.transformations.length-1],o=e-n/2;s=t+n/2;var l,h=a._02*o+a._12*s+a._22,_=(a._00*o+a._10*s+a._20)/h,c=(a._01*o+a._11*s+a._21)/h,u=new wr(_,c),d=this.transformations[this.transformations.length-1],f=e-n/2;l=t-n/2;var g,v=d._02*f+d._12*l+d._22,p=(d._00*f+d._10*l+d._20)/v,m=(d._01*f+d._11*l+d._21)/v,y=new wr(p,m),b=this.transformations[this.transformations.length-1],w=e+i+n/2;g=t-n/2;var x,B=b._02*w+b._12*g+b._22,S=(b._00*w+b._10*g+b._20)/B,T=(b._01*w+b._11*g+b._21)/B,k=new wr(S,T),I=this.transformations[this.transformations.length-1],A=e+i+n/2;x=t+n/2;var C=I._02*A+I._12*x+I._22,D=(I._00*A+I._10*x+I._20)/C,P=(I._01*A+I._11*x+I._21)/C,E=new wr(D,P);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,y.x,y.y,k.x,k.y,E.x,E.y);var N,M=this.transformations[this.transformations.length-1],L=e-n/2;N=t+r+n/2;var R=M._02*L+M._12*N+M._22,V=(M._00*L+M._10*N+M._20)/R,F=(M._01*L+M._11*N+M._21)/R;u=new wr(V,F);var G,U=this.transformations[this.transformations.length-1],O=e+n/2;G=t-n/2;var W=U._02*O+U._12*G+U._22,z=(U._00*O+U._10*G+U._20)/W,H=(U._01*O+U._11*G+U._21)/W;k=new wr(z,H);var Z,X=this.transformations[this.transformations.length-1],j=e+n/2;Z=t+r+n/2;var K=X._02*j+X._12*Z+X._22,Y=(X._00*j+X._10*Z+X._20)/K,Q=(X._01*j+X._11*Z+X._21)/K;E=new wr(Y,Q),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,y.x,y.y,k.x,k.y,E.x,E.y);var q,J=this.transformations[this.transformations.length-1],$=e-n/2;q=t+r-n/2;var ee=J._02*$+J._12*q+J._22,te=(J._00*$+J._10*q+J._20)/ee,ie=(J._01*$+J._11*q+J._21)/ee;y=new wr(te,ie);var re,ne=this.transformations[this.transformations.length-1],se=e+i+n/2;re=t+r-n/2;var ae=ne._02*se+ne._12*re+ne._22,oe=(ne._00*se+ne._10*re+ne._20)/ae,le=(ne._01*se+ne._11*re+ne._21)/ae;k=new wr(oe,le);var he,_e=this.transformations[this.transformations.length-1],ce=e+i+n/2;he=t+r+n/2;var ue=_e._02*ce+_e._12*he+_e._22,de=(_e._00*ce+_e._10*he+_e._20)/ue,fe=(_e._01*ce+_e._11*he+_e._21)/ue;E=new wr(de,fe),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,y.x,y.y,k.x,k.y,E.x,E.y);var ge,ve=this.transformations[this.transformations.length-1],pe=e+i-n/2;ge=t+r+n/2;var me=ve._02*pe+ve._12*ge+ve._22,ye=(ve._00*pe+ve._10*ge+ve._20)/me,be=(ve._01*pe+ve._11*ge+ve._21)/me;u=new wr(ye,be);var we,xe=this.transformations[this.transformations.length-1],Be=e+i-n/2;we=t-n/2;var Se=xe._02*Be+xe._12*we+xe._22,Te=(xe._00*Be+xe._10*we+xe._20)/Se,ke=(xe._01*Be+xe._11*we+xe._21)/Se;y=new wr(Te,ke);var Ie,Ae=this.transformations[this.transformations.length-1],Ce=e+i+n/2;Ie=t-n/2;var De=Ae._02*Ce+Ae._12*Ie+Ae._22,Pe=(Ae._00*Ce+Ae._10*Ie+Ae._20)/De,Ee=(Ae._01*Ce+Ae._11*Ie+Ae._21)/De;k=new wr(Pe,Ee);var Ne,Me=this.transformations[this.transformations.length-1],Le=e+i+n/2;Ne=t+r+n/2;var Re=Me._02*Le+Me._12*Ne+Me._22,Ve=(Me._00*Le+Me._10*Ne+Me._20)/Re,Fe=(Me._01*Le+Me._11*Ne+Me._21)/Re;E=new wr(Ve,Fe),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,y.x,y.y,k.x,k.y,E.x,E.y)},fillRect:function(e,t,i,r){var n,s;this.imagePainter.end(),this.textPainter.end();var a,o=this.transformations[this.transformations.length-1],l=e;a=t+r;var h,_,c=o._02*l+o._12*a+o._22;s=(o._00*l+o._10*a+o._20)/c,n=(o._01*l+o._11*a+o._21)/c;var u,d=this.transformations[this.transformations.length-1],f=e;u=t;var g,v,p=d._02*f+d._12*u+d._22;_=(d._00*f+d._10*u+d._20)/p,h=(d._01*f+d._11*u+d._21)/p;var m,y=this.transformations[this.transformations.length-1],b=e+i;m=t;var w,x,B=y._02*b+y._12*m+y._22;v=(y._00*b+y._10*m+y._20)/B,g=(y._01*b+y._11*m+y._21)/B;var S,T=this.transformations[this.transformations.length-1],k=e+i;S=t+r;var I=T._02*k+T._12*S+T._22;x=(T._00*k+T._10*S+T._20)/I,w=(T._01*k+T._11*S+T._21)/I,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),s,n,_,h,v,g,x,w)},drawString:function(e,t,i){this.imagePainter.end();var r=this.coloredPainter;0<Ii.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ii.bufferIndex&&r.drawBuffer(!1),this.textPainter.drawString(e,this.get_opacity(),this.get_color(),t,i,this.transformations[this.transformations.length-1],this.get_fontGlyphs())},drawCharacters:function(e,t,i,r,n){this.imagePainter.end();var s=this.coloredPainter;0<Ii.triangleBufferIndex&&s.drawTriBuffer(!1),0<Ii.bufferIndex&&s.drawBuffer(!1),this.textPainter.drawCharacters(e,t,i,this.get_opacity(),this.get_color(),r,n,this.transformations[this.transformations.length-1],this.get_fontGlyphs())},get_font:function(){return this.myFont},set_font:function(e){return this.textPainter.setFont(e),this.myFont=e},set_fontSize:function(e){return Qt.prototype.set_fontSize.call(this,this.textPainter.fontSize=e)},drawLine:function(e,t,i,r,n){var s;null==n&&(n=1),this.imagePainter.end(),this.textPainter.end(),(s=r==t?new wr(0,-1):new wr(1,-(i-e)/(r-t))).set_length(n);var a=new wr(e+.5*s.x,t+.5*s.y),o=new wr(i+.5*s.x,r+.5*s.y),l=new wr(a.x-s.x,a.y-s.y),h=new wr(o.x-s.x,o.y-s.y),_=this.transformations[this.transformations.length-1],c=_._02*a.x+_._12*a.y+_._22,u=(_._00*a.x+_._10*a.y+_._20)/c,d=(_._01*a.x+_._11*a.y+_._21)/c;a=new wr(u,d);var f=this.transformations[this.transformations.length-1],g=f._02*o.x+f._12*o.y+f._22,v=(f._00*o.x+f._10*o.y+f._20)/g,p=(f._01*o.x+f._11*o.y+f._21)/g;o=new wr(v,p);var m=this.transformations[this.transformations.length-1],y=m._02*l.x+m._12*l.y+m._22,b=(m._00*l.x+m._10*l.y+m._20)/y,w=(m._01*l.x+m._11*l.y+m._21)/y;l=new wr(b,w);var x=this.transformations[this.transformations.length-1],B=x._02*h.x+x._12*h.y+x._22,S=(x._00*h.x+x._10*h.y+x._20)/B,T=(x._01*h.x+x._11*h.y+x._21)/B;h=new wr(S,T),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,o.x,o.y,l.x,l.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),l.x,l.y,o.x,o.y,h.x,h.y)},fillTriangle:function(e,t,i,r,n,s){var a,o;this.imagePainter.end(),this.textPainter.end();var l,h=this.transformations[this.transformations.length-1],_=e;l=t;var c,u,d=h._02*_+h._12*l+h._22;o=(h._00*_+h._10*l+h._20)/d,a=(h._01*_+h._11*l+h._21)/d;var f,g=this.transformations[this.transformations.length-1],v=i;f=r;var p,m,y=g._02*v+g._12*f+g._22;u=(g._00*v+g._10*f+g._20)/y,c=(g._01*v+g._11*f+g._21)/y;var b,w=this.transformations[this.transformations.length-1],x=n;b=s;var B=w._02*x+w._12*b+w._22;m=(w._00*x+w._10*b+w._20)/B,p=(w._01*x+w._11*b+w._21)/B,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),o,a,u,c,m,p)},get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(e){return this.imagePainter.setBilinearFilter(e==ei.High),this.textPainter.setBilinearFilter(e==ei.High),this.myImageScaleQuality=e},get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(e){return this.imagePainter.setBilinearMipmapFilter(e==ei.High),this.myMipmapScaleQuality=e},setPipeline:function(e){this.flush(),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e),null!=e&&this.g.setPipeline(e)},scissor:function(e,t,i,r){this.flush(),this.g.scissor(e,t,i,r)},disableScissor:function(){this.flush(),this.g.disableScissor()},begin:function(e,t){null==e&&(e=!0),this.g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;0<Ii.triangleBufferIndex&&e.drawTriBuffer(!1),0<Ii.bufferIndex&&e.drawBuffer(!1)},end:function(){this.flush(),this.g.end()},drawVideoInternal:function(e,t,i,r,n){},drawVideo:function(e,t,i,r,n){this.setPipeline(Ci.videoPipeline),this.drawVideoInternal(e,t,i,r,n),this.setPipeline(null)},__class__:Ci});var Di=function(e,t,i){null==i&&(i=!1),this.usage=t,this.mySize=e,this.buffer=D.gl.createBuffer();var r=new Uint32Array(e);this._data=r};(i["kha.graphics4.IndexBuffer"]=Di).__name__=!0,Di.prototype={delete:function(){this._data=null,D.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e,e+t)},unlock:function(){D.gl.bindBuffer(34963,this.buffer);var e=null==D.elementIndexUint?new Uint16Array(this._data):this._data;D.gl.bufferData(34963,e,this.usage==Wi.DynamicUsage?35048:35044)},set:function(){D.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Di};var Pi=i["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"]};Pi.NoMipFilter=["NoMipFilter",0],Pi.NoMipFilter.toString=r,(Pi.NoMipFilter.__enum__=Pi).PointMipFilter=["PointMipFilter",1],Pi.PointMipFilter.toString=r,(Pi.PointMipFilter.__enum__=Pi).LinearMipFilter=["LinearMipFilter",2],Pi.LinearMipFilter.toString=r,Pi.LinearMipFilter.__enum__=Pi;var Ei=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=xi.None,this.depthWrite=!1,this.depthMode=yi.Always,this.stencilMode=yi.Always,this.stencilBothPass=Mi.Keep,this.stencilDepthFail=Mi.Keep,this.stencilFail=Mi.Keep,this.stencilReferenceValue=0,this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=K.BlendOne,this.blendDestination=K.BlendZero,this.blendOperation=j.Add,this.alphaBlendSource=K.BlendOne,this.alphaBlendDestination=K.BlendZero,this.alphaBlendOperation=j.Add,this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=!0,this.conservativeRasterization=!1};(i["kha.graphics4.PipelineStateBase"]=Ei).__name__=!0,Ei.prototype={set_colorWriteMask:function(e){return this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=e},__class__:Ei,__properties__:{set_colorWriteMask:"set_colorWriteMask"}};var Ni=function(){this.program=null,Ei.call(this),this.textures=[],this.textureValues=[]};(i["kha.graphics4.PipelineState"]=Ni).__name__=!0,Ni.__super__=Ei,Ni.prototype=n(Ei.prototype,{delete:function(){null!=this.program&&D.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&D.gl.deleteProgram(this.program),this.program=D.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),D.gl.attachShader(this.program,this.vertexShader.shader),D.gl.attachShader(this.program,this.fragmentShader.shader);for(var e=0,t=0,i=this.inputLayout;t<i.length;){var r=i[t];++t;for(var n=0,s=r.elements;n<s.length;){var a=s[n];++n,D.gl.bindAttribLocation(this.program,e,a.name),a.data==Hi.Float4x4?e+=4:++e}}if(D.gl.linkProgram(this.program),!D.gl.getProgramParameter(this.program,35714))throw new dt("Could not link the shader program:\n"+D.gl.getProgramInfoLog(this.program))},set:function(){D.gl.useProgram(this.program);for(var e=0,t=this.textureValues.length;e<t;){var i=e++;D.gl.uniform1i(this.textureValues[i],i)}D.gl.colorMask(this.colorWriteMaskRed,this.colorWriteMaskGreen,this.colorWriteMaskBlue,this.colorWriteMaskAlpha)},compileShader:function(e){if(null==e.shader){for(var t=D.gl.createShader(e.type),i=0!=D.gl.getShaderPrecisionFormat(35632,36338).precision,r=e.files,n=0,s=r.length;n<s;){var a=n++;if(D.gl2){if(0<=r[a].indexOf("-webgl2")||0<=r[a].indexOf("runtime-string")){D.gl.shaderSource(t,e.sources[a]);break}}else{if(!i&&(0<=r[a].indexOf("-relaxed")||0<=r[a].indexOf("runtime-string"))){D.gl.shaderSource(t,e.sources[a]);break}if(i&&(r[a].indexOf("-relaxed")<0||0<=r[a].indexOf("runtime-string"))){D.gl.shaderSource(t,e.sources[a]);break}}}if(D.gl.compileShader(t),!D.gl.getShaderParameter(t,35713))throw new dt("Could not compile shader:\n"+D.gl.getShaderInfoLog(t));e.shader=t}},getConstantLocation:function(e){for(var t=D.gl.getUniformLocation(this.program,e),i=5126,r=0,n=D.gl.getProgramParameter(this.program,35718);r<n;){var s=r++,a=D.gl.getActiveUniform(this.program,s);if(a.name==e||a.name==e+"[0]"){i=a.type;break}}return new fr(t,i)},getTextureUnit:function(e){var t=this.findTexture(e);if(t<0){var i=D.gl.getUniformLocation(this.program,e);t=this.textures.length,this.textureValues.push(i),this.textures.push(e)}return new pr(t)},findTexture:function(e){for(var t=0,i=this.textures.length;t<i;){var r=t++;if(this.textures[r]==e)return r}return-1},__class__:Ni});var Mi=i["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"]};Mi.Keep=["Keep",0],Mi.Keep.toString=r,(Mi.Keep.__enum__=Mi).Zero=["Zero",1],Mi.Zero.toString=r,(Mi.Zero.__enum__=Mi).Replace=["Replace",2],Mi.Replace.toString=r,(Mi.Replace.__enum__=Mi).Increment=["Increment",3],Mi.Increment.toString=r,(Mi.Increment.__enum__=Mi).IncrementWrap=["IncrementWrap",4],Mi.IncrementWrap.toString=r,(Mi.IncrementWrap.__enum__=Mi).Decrement=["Decrement",5],Mi.Decrement.toString=r,(Mi.Decrement.__enum__=Mi).DecrementWrap=["DecrementWrap",6],Mi.DecrementWrap.toString=r,(Mi.DecrementWrap.__enum__=Mi).Invert=["Invert",7],Mi.Invert.toString=r,Mi.Invert.__enum__=Mi;var Li=function(e,t){};(i["kha.graphics4.TessellationControlShader"]=Li).__name__=!0,Li.prototype={delete:function(){},__class__:Li};var Ri=function(e,t){};(i["kha.graphics4.TessellationEvaluationShader"]=Ri).__name__=!0,Ri.prototype={delete:function(){},__class__:Ri};var Vi=i["kha.graphics4.TexDir"]={__ename__:!0,__constructs__:["U","V"]};Vi.U=["U",0],Vi.U.toString=r,(Vi.U.__enum__=Vi).V=["V",1],Vi.V.toString=r,Vi.V.__enum__=Vi;var Fi=i["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"]};Fi.Repeat=["Repeat",0],Fi.Repeat.toString=r,(Fi.Repeat.__enum__=Fi).Mirror=["Mirror",1],Fi.Mirror.toString=r,(Fi.Mirror.__enum__=Fi).Clamp=["Clamp",2],Fi.Clamp.toString=r,Fi.Clamp.__enum__=Fi;var Gi=i["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"]};Gi.PointFilter=["PointFilter",0],Gi.PointFilter.toString=r,(Gi.PointFilter.__enum__=Gi).LinearFilter=["LinearFilter",1],Gi.LinearFilter.toString=r,(Gi.LinearFilter.__enum__=Gi).AnisotropicFilter=["AnisotropicFilter",2],Gi.AnisotropicFilter.toString=r,Gi.AnisotropicFilter.__enum__=Gi;var Ui=i["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"]};Ui.RGBA32=["RGBA32",0],Ui.RGBA32.toString=r,(Ui.RGBA32.__enum__=Ui).L8=["L8",1],Ui.L8.toString=r,(Ui.L8.__enum__=Ui).RGBA128=["RGBA128",2],Ui.RGBA128.toString=r,(Ui.RGBA128.__enum__=Ui).DEPTH16=["DEPTH16",3],Ui.DEPTH16.toString=r,(Ui.DEPTH16.__enum__=Ui).RGBA64=["RGBA64",4],Ui.RGBA64.toString=r,(Ui.RGBA64.__enum__=Ui).A32=["A32",5],Ui.A32.toString=r,(Ui.A32.__enum__=Ui).A16=["A16",6],Ui.A16.toString=r,Ui.A16.__enum__=Ui;var Oi=function(){};(i["kha.graphics4.TextureUnit"]=Oi).__name__=!0;var Wi=i["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"]};Wi.StaticUsage=["StaticUsage",0],Wi.StaticUsage.toString=r,(Wi.StaticUsage.__enum__=Wi).DynamicUsage=["DynamicUsage",1],Wi.DynamicUsage.toString=r,(Wi.DynamicUsage.__enum__=Wi).ReadableUsage=["ReadableUsage",2],Wi.ReadableUsage.toString=r,Wi.ReadableUsage.__enum__=Wi;var zi=function(e,t,i,r,n){null==n&&(n=!1),null==r&&(r=0),this.usage=i,this.instanceDataStepRate=r,this.mySize=e;for(var s=this.myStride=0,a=t.elements;s<a.length;){var o=a[s];switch(++s,o.data[1]){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=D.gl.createBuffer();var l=new nn(e*this.myStride/4|0);this._data=l,this.sizes=[],this.offsets=[],this.sizes[t.elements.length-1]=0;for(var h=this.offsets[t.elements.length-1]=0,_=0,c=0,u=t.elements;c<u.length;){var d,f=u[c];switch(++c,f.data[1]){case 0:d=1;break;case 1:d=2;break;case 2:d=3;break;case 3:d=4;break;case 4:d=16}switch(this.sizes[_]=d,this.offsets[_]=h,f.data[1]){case 0:h+=4;break;case 1:h+=8;break;case 2:h+=12;break;case 3:h+=16;break;case 4:h+=64}++_}};(i["kha.graphics4.VertexBuffer"]=zi).__name__=!0,zi.prototype={delete:function(){this._data=null,D.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e*this.stride(),(e+t)*this.stride())},unlock:function(){D.gl.bindBuffer(34962,this.buffer),D.gl.bufferData(34962,this._data,this.usage==Wi.DynamicUsage?35048:35044)},stride:function(){return this.myStride},count:function(){return this.mySize},set:function(e){var t=!!D.gl2||D.gl.getExtension("ANGLE_instanced_arrays");D.gl.bindBuffer(34962,this.buffer);for(var i=0,r=0,n=this.sizes.length;r<n;){var s=r++;if(4<this.sizes[s])for(var a=this.sizes[s],o=0;0<a;)D.gl.enableVertexAttribArray(e+i),D.gl.vertexAttribPointer(e+i,4,5126,!1,this.myStride,this.offsets[s]+o),t&&(D.gl2?D.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),a-=4,o+=16,++i;else D.gl.enableVertexAttribArray(e+i),D.gl.vertexAttribPointer(e+i,this.sizes[s],5126,!1,this.myStride,this.offsets[s]),t&&(D.gl2?D.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),++i}return i},__class__:zi};var Hi=i["kha.graphics4.VertexData"]={__ename__:!0,__constructs__:["Float1","Float2","Float3","Float4","Float4x4"]};Hi.Float1=["Float1",0],Hi.Float1.toString=r,(Hi.Float1.__enum__=Hi).Float2=["Float2",1],Hi.Float2.toString=r,(Hi.Float2.__enum__=Hi).Float3=["Float3",2],Hi.Float3.toString=r,(Hi.Float3.__enum__=Hi).Float4=["Float4",3],Hi.Float4.toString=r,(Hi.Float4.__enum__=Hi).Float4x4=["Float4x4",4],Hi.Float4x4.toString=r,Hi.Float4x4.__enum__=Hi;var Zi=function(e,t){this.name=e,this.data=t};(i["kha.graphics4.VertexElement"]=Zi).__name__=!0,Zi.prototype={__class__:Zi};var Xi=function(e,t){this.sources=[];for(var i=0;i<e.length;){var r=e[i];++i,this.sources.push(r.toString())}this.type=35633,this.shader=null,this.files=t};(i["kha.graphics4.VertexShader"]=Xi).__name__=!0,Xi.fromSource=function(e){var t=new Xi([],["runtime-string"]);return t.sources.push(e),t},Xi.prototype={delete:function(){D.gl.deleteShader(this.shader),this.shader=null,this.sources=null},__class__:Xi};var ji=function(){this.elements=[],this.instanced=!1};(i["kha.graphics4.VertexStructure"]=ji).__name__=!0,ji.prototype={add:function(e,t){this.elements.push(new Zi(e,t))},size:function(){return this.elements.length},byteSize:function(){for(var e=0,t=0,i=this.elements.length;t<i;){var r=t++;e+=this.dataByteSize(this.elements[r].data)}return e},dataByteSize:function(e){switch(e[1]){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(e){return this.elements[e]},__class__:ji};var Ki=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],Ki.instances[e]=this};(i["kha.input.Gamepad"]=Ki).__name__=!0,Ki.get=function(e){return null==e&&(e=0),e>=Ki.instances.length?null:Ki.instances[e]},Ki.notifyOnConnect=function(e,t){null!=e&&Ki.connectListeners.push(e),null!=t&&Ki.disconnectListeners.push(t)},Ki.removeConnect=function(e,t){null!=e&&$.remove(Ki.connectListeners,e),null!=t&&$.remove(Ki.disconnectListeners,t)},Ki.sendConnectEvent=function(e){Ki.instances[e].connected=!0;for(var t=0,i=Ki.connectListeners;t<i.length;){var r=i[t];++t,r(e)}},Ki.sendDisconnectEvent=function(e){Ki.instances[e].connected=!1;for(var t=0,i=Ki.disconnectListeners;t<i.length;){var r=i[t];++t,r(e)}},Ki.prototype={notify:function(e,t){null!=e&&this.axisListeners.push(e),null!=t&&this.buttonListeners.push(t)},remove:function(e,t){null!=e&&$.remove(this.axisListeners,e),null!=t&&$.remove(this.buttonListeners,t)},get_id:function(){return D.getGamepadId(this.index)},sendAxisEvent:function(e,t){for(var i=0,r=this.axisListeners;i<r.length;){var n=r[i];++i,n(e,t)}},sendButtonEvent:function(e,t){for(var i=0,r=this.buttonListeners;i<r.length;){var n=r[i];++i,n(e,t)}},__class__:Ki,__properties__:{get_id:"get_id"}};var Yi=function(){this.__id=Pr.nextId++,this._inputBuffer=new Te(new en(1))};(i["kha.network.Controller"]=Yi).__name__=!0,Yi.prototype={_id:function(){return this.__id},_receive:function(e){},__class__:Yi};var Qi=e.kha.input.Keyboard=function(){Yi.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Qi.instance=this};(i["kha.input.Keyboard"]=Qi).__name__=!0,Qi.get=function(e){return null==e&&(e=0),D.getKeyboard(e)},Qi.__super__=Yi,Qi.prototype=n(Yi.prototype,{notify:function(e,t,i){null!=e&&this.downListeners.push(e),null!=t&&this.upListeners.push(t),null!=i&&this.pressListeners.push(i)},remove:function(e,t,i){null!=e&&$.remove(this.downListeners,e),null!=t&&$.remove(this.upListeners,t),null!=i&&$.remove(this.pressListeners,i)},show:function(){},hide:function(){},sendDownEvent:function(e){if(null!=Rr.the()){var t=new Te(new en(5));t.setInt32(0,0),t.b[4]=255&e,Rr.the().sendControllerUpdate(this._id(),t)}for(var i=0,r=this.downListeners;i<r.length;){var n=r[i];++i,n(e)}},sendUpEvent:function(e){if(null!=Rr.the()){var t=new Te(new en(5));t.setInt32(0,1),t.b[4]=255&e,Rr.the().sendControllerUpdate(this._id(),t)}for(var i=0,r=this.upListeners;i<r.length;){var n=r[i];++i,n(e)}},sendPressEvent:function(e){if(null!=Rr.the()){var t=new Te(new en(5));t.setInt32(0,2);var i=$.cca(e,0);t.b[4]=255&i,Rr.the().sendControllerUpdate(this._id(),t)}for(var r=0,n=this.pressListeners;r<n.length;){var s=n[r];++r,s(e)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t);else{var i=String.fromCharCode(e.b[4]);this.sendPressEvent(i)}else{var r=e.b[4];this.sendUpEvent(r)}else{var n=e.b[4];this.sendDownEvent(n)}},__class__:Qi});var qi=e.kha.input.Mouse=function(){Yi.call(this),qi.instance=this};(i["kha.input.Mouse"]=qi).__name__=!0,qi.get=function(e){return null==e&&(e=0),D.getMouse(e)},qi.__super__=Yi,qi.prototype=n(Yi.prototype,{notify:function(e,t,i,r,n){this.notifyWindowed(0,e,t,i,r,n)},remove:function(e,t,i,r,n){this.removeWindowed(0,e,t,i,r,n)},notifyWindowed:function(e,t,i,r,n,s){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(i)}if(null!=r){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(r)}if(null!=n){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(n)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(s)}},removeWindowed:function(e,t,i,r,n,s){null!=t&&(null!=this.windowDownListeners?e<this.windowDownListeners.length?$.remove(this.windowDownListeners[e],t):me.trace('no downListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):me.trace("no downListeners were ever registered",{fileName:"Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?e<this.windowUpListeners.length?$.remove(this.windowUpListeners[e],i):me.trace('no upListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):me.trace("no upListeners were ever registered",{fileName:"Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowMoveListeners?e<this.windowMoveListeners.length?$.remove(this.windowMoveListeners[e],r):me.trace('no moveListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):me.trace("no moveListeners were ever registered",{fileName:"Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowWheelListeners?e<this.windowWheelListeners.length?$.remove(this.windowWheelListeners[e],n):me.trace('no wheelListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):me.trace("no wheelListeners were ever registered",{fileName:"Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowLeaveListeners?e<this.windowLeaveListeners.length?$.remove(this.windowLeaveListeners[e],s):me.trace('no leaveListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):me.trace("no leaveListeners were ever registered",{fileName:"Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(e,t){},removeFromLockChange:function(e,t){},hideSystemCursor:function(){},showSystemCursor:function(){},sendLeaveEvent:function(e){if(null!=Rr.the()){var t=new Te(new en(8));t.setInt32(0,0),t.setInt32(4,e),Rr.the().sendControllerUpdate(this._id(),t)}if(null!=this.windowLeaveListeners)for(var i=0,r=this.windowLeaveListeners[e];i<r.length;){var n=r[i];++i,n()}},sendDownEvent:function(e,t,i,r){if(null!=Rr.the()){var n=new Te(new en(20));n.setInt32(0,1),n.setInt32(4,e),n.setInt32(8,t),n.setInt32(12,i),n.setInt32(16,r),Rr.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowDownListeners)for(var s=0,a=this.windowDownListeners[e];s<a.length;){var o=a[s];++s,o(t,i,r)}},sendUpEvent:function(e,t,i,r){if(null!=Rr.the()){var n=new Te(new en(20));n.setInt32(0,2),n.setInt32(4,e),n.setInt32(8,t),n.setInt32(12,i),n.setInt32(16,r),Rr.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowUpListeners)for(var s=0,a=this.windowUpListeners[e];s<a.length;){var o=a[s];++s,o(t,i,r)}},sendMoveEvent:function(e,t,i,r,n){if(null!=Rr.the()){var s=new Te(new en(24));s.setInt32(0,3),s.setInt32(4,e),s.setInt32(8,t),s.setInt32(12,i),s.setInt32(16,r),s.setInt32(20,n),Rr.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowMoveListeners)for(var a=0,o=this.windowMoveListeners[e];a<o.length;){var l=o[a];++a,l(t,i,r,n)}},sendWheelEvent:function(e,t){if(null!=Rr.the()){var i=new Te(new en(12));i.setInt32(0,4),i.setInt32(4,e),i.setInt32(8,t),Rr.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowWheelListeners)for(var r=0,n=this.windowWheelListeners[e];r<n.length;){var s=n[r];++r,s(t)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t)if(3!=t)if(4!=t);else{var i=e.getInt32(4),r=e.getInt32(8);this.sendWheelEvent(i,r)}else{var n=e.getInt32(4),s=e.getInt32(8),a=e.getInt32(12),o=e.getInt32(16),l=e.getInt32(20);this.sendMoveEvent(n,s,a,o,l)}else{var h=e.getInt32(4),_=e.getInt32(8),c=e.getInt32(12),u=e.getInt32(16);this.sendUpEvent(h,_,c,u)}else{var d=e.getInt32(4),f=e.getInt32(8),g=e.getInt32(12),v=e.getInt32(16);this.sendDownEvent(d,f,g,v)}else{var p=e.getInt32(4);this.sendLeaveEvent(p)}},__class__:qi});var Ji=function(){qi.call(this)};(i["kha.input.MouseImpl"]=Ji).__name__=!0,Ji.__super__=qi,Ji.prototype=n(qi.prototype,{lock:function(){D.lockMouse()},unlock:function(){D.unlockMouse()},canLock:function(){return D.canLockMouse()},isLocked:function(){return D.isMouseLocked()},notifyOnLockChange:function(e,t){D.notifyOfMouseLockChange(e,t)},removeFromLockChange:function(e,t){D.removeFromMouseLockChange(e,t)},hideSystemCursor:function(){D.khanvas.style.cursor="none"},showSystemCursor:function(){D.khanvas.style.cursor="default"},_receive:function(e){e.getInt32(0)},__class__:Ji});var $i=function(){$i.instance=this};(i["kha.input.Pen"]=$i).__name__=!0,$i.get=function(e){return null==e&&(e=0),D.getPen(e)},$i.prototype={notify:function(e,t,i){this.notifyWindowed(0,e,t,i)},remove:function(e,t,i){this.removeWindowed(0,e,t,i)},notifyWindowed:function(e,t,i,r){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(i)}if(null!=r){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(r)}},removeWindowed:function(e,t,i,r){null!=t&&null!=this.windowDownListeners&&e<this.windowDownListeners.length&&$.remove(this.windowDownListeners[e],t),null!=i&&null!=this.windowUpListeners&&e<this.windowUpListeners.length&&$.remove(this.windowUpListeners[e],i),null!=r&&null!=this.windowMoveListeners&&e<this.windowMoveListeners.length&&$.remove(this.windowMoveListeners[e],r)},sendDownEvent:function(e,t,i,r){if(null!=this.windowDownListeners)for(var n=0,s=this.windowDownListeners[e];n<s.length;){var a=s[n];++n,a(t,i,r)}},sendUpEvent:function(e,t,i,r){if(null!=this.windowUpListeners)for(var n=0,s=this.windowUpListeners[e];n<s.length;){var a=s[n];++n,a(t,i,r)}},sendMoveEvent:function(e,t,i,r){if(null!=this.windowMoveListeners)for(var n=0,s=this.windowMoveListeners[e];n<s.length;){var a=s[n];++n,a(t,i,r)}},__class__:$i};var er=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],er.instance=this};(i["kha.input.Surface"]=er).__name__=!0,er.get=function(e){return null==e&&(e=0),0!=e?null:er.instance},er.prototype={notify:function(e,t,i){null!=e&&this.touchStartListeners.push(e),null!=t&&this.touchEndListeners.push(t),null!=i&&this.moveListeners.push(i)},remove:function(e,t,i){null!=e&&$.remove(this.touchStartListeners,e),null!=t&&$.remove(this.touchEndListeners,t),null!=i&&this.moveListeners.push(i)},sendTouchStartEvent:function(e,t,i){for(var r=0,n=this.touchStartListeners;r<n.length;){var s=n[r];++r,s(e,t,i)}},sendTouchEndEvent:function(e,t,i){for(var r=0,n=this.touchEndListeners;r<n.length;){var s=n[r];++r,s(e,t,i)}},sendMoveEvent:function(e,t,i){for(var r=0,n=this.moveListeners;r<n.length;){var s=n[r];++r,s(e,t,i)}},__class__:er};var tr=function(e){this.bytes=e};(i["kha.internal.BytesBlob"]=tr).__name__=!0,tr.__interfaces__=[We],tr.fromBytes=function(e){return new tr(e)},tr.alloc=function(e){return new tr(new Te(new en(e)))},tr.readF32=function(e){var t=0==(-2147483648&e)?1:-1,i=e>>23&255,r=8388607&e;switch(i){case 0:return 0;case 255:return 0!=r?NaN:0<t?1/0:-1/0;default:return t*((r+8388608)/8388608)*Math.pow(2,i-127)}},tr.bit=function(e,t){if(1==(e>>>t&1)){return 0,!0}return 0,!1},tr.toText=function(e,t){for(var i="",r=0,n=t;r<n;){var s=r++;i+=String.fromCharCode(e[s])}return i},tr.prototype={sub:function(e,t){return new tr(this.bytes.sub(e,t))},get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=255&t},readU8:function(e){var t=this.bytes.b[e];return++e,t},readS8:function(e){var t=this.bytes.b[e];return++e,(0==(128&t)?1:-1)*(t&=127)},readU16BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];return e+=2,256*t+i},readU16LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];return e+=2,256*i+t},readU32LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],r=this.bytes.b[e+2],n=this.bytes.b[e+3];return e+=4,t+256*i+256*r*256+256*n*256*256},readU32BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],r=this.bytes.b[e+2],n=this.bytes.b[e+3];return e+=4,n+256*r+256*i*256+256*t*256*256},readS16BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];e+=2;var r=0==(128&t)?1:-1;return t&=127,-1==r?256*t-32767+i:256*t+i},readS16LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],r=0==(128&i)?1:-1;return i&=127,e+=2,-1==r?256*i-32767+t:256*i+t},readS32LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],r=this.bytes.b[e+2],n=this.bytes.b[e+3],s=0==(128&n)?1:-1;return n&=127,e+=4,-1==s?-2147483647+t+256*i+256*r*256+256*n*256*256:t+256*i+256*r*256+256*n*256*256},readS32BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],r=this.bytes.b[e+2],n=this.bytes.b[e+3],s=0==(128&t)?1:-1;return t&=127,e+=4,-1==s?-2147483647+n+256*r+256*i*256+256*t*256*256:n+256*r+256*i*256+256*t*256*256},readF32LE:function(e){return tr.readF32(this.readS32LE(e))},readF32BE:function(e){return tr.readF32(this.readS32BE(e))},toString:function(){return this.bytes.toString()},readUtf8Char:function(e){if(e.value>=this.get_length())return-1;var t=this.readU8(e.value);++e.value;var i=0;if(tr.bit(t,7))if(tr.bit(t,7)&&tr.bit(t,6)&&!tr.bit(t,5)){var r=31&t,n=this.readU8(e.value);++e.value,i=r<<6|63&n}else tr.bit(t,7)&&tr.bit(t,6)&&tr.bit(t,5)&&!tr.bit(t,4)?e.value+=2:tr.bit(t,7)&&tr.bit(t,6)&&tr.bit(t,5)&&tr.bit(t,4)&&!tr.bit(t,3)&&(e.value+=3);else i=t;return i},readUtf8Block:function(e,t){var i=0;if(t.value>=this.get_length())return"";for(;i<2e3;){var r=this.readUtf8Char(t);if(r<0)break;e[i]=r,++i}return tr.toText(e,i)},readUtf8String:function(){var e=new Array(2e3),t="",i=0;3<=this.get_length()&&239==this.bytes.b[0]&&187==this.bytes.b[1]&&191==this.bytes.b[2]&&(i=3);for(var r={value:i};r.value<this.get_length();)t+=this.readUtf8Block(e,r);return t},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:tr,__properties__:{get_length:"get_length"}};var ir=function(e){this.stopped=!1,this.element=e};(i["kha.js.AEAudioChannel"]=ir).__name__=!0,ir.__interfaces__=[mt],ir.prototype={play:function(){this.stopped=!1,D.mobile?D.insideInputEvent?(this.element.play(),D.mobileAudioPlaying=!0):D.mobileAudioPlaying?this.element.play():ir.todo.push(this):this.element.play()},pause:function(){try{this.element.pause()}catch(e){e instanceof dt&&(e=e.val),me.trace(e,{fileName:"AEAudioChannel.hx",lineNumber:39,className:"kha.js.AEAudioChannel",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0,this.stopped=!0}catch(e){e instanceof dt&&(e=e.val),me.trace(e,{fileName:"AEAudioChannel.hx",lineNumber:50,className:"kha.js.AEAudioChannel",methodName:"stop"})}},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},get_position:function(){return this.element.currentTime},get_volume:function(){return this.element.volume},set_volume:function(e){return this.element.volume=e},get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:ir,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var rr=function(){};(i["kha.js.AudioElementAudio"]=rr).__name__=!0,rr._compile=function(){},rr.play=function(e,t){return null==t&&(t=!1),rr.stream(e,t)},rr.stream=function(e,t){null==t&&(t=!1),e.element.loop=t;var i=new ir(e.element);return i.play(),i};var nr=function(e){this.bakedQuadCache=new Qe,Qt.call(this),this.canvas=e,(nr.instance=this).myColor=Ze.fromBytes(0,0,0),e.save()};(i["kha.js.CanvasGraphics"]=nr).__name__=!0,nr.stringWidth=function(e,t){return null==nr.instance?5*t.length:(nr.instance.set_font(e),nr.instance.canvas.measureText(t).width)},nr.__super__=Qt,nr.prototype=n(Qt.prototype,{begin:function(e,t){null==e&&(e=!0),e&&this.clear(t)},clear:function(e){null==e&&(e=0),this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",.00392156862745098*(e>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(e,t,i){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(Re.__cast(e,He).image,t,i),this.canvas.globalAlpha=1},drawScaledSubImage:function(e,t,i,r,n,s,a,o,l){this.canvas.globalAlpha=this.get_opacity();try{if(o<0||l<0){this.canvas.save(),this.canvas.translate(s,a);var h=0,_=0;o<0&&(this.canvas.scale(-1,1),h=-o),l<0&&(this.canvas.scale(1,-1),_=-l),this.canvas.drawImage(Re.__cast(e,He).image,t,i,r,n,h,_,o,l),this.canvas.restore()}else this.canvas.drawImage(Re.__cast(e,He).image,t,i,r,n,s,a,o,l)}catch(e){}this.canvas.globalAlpha=1},set_color:function(e){return this.myColor=e,this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",e},get_color:function(){return this.myColor},get_imageScaleQuality:function(){return this.scaleQuality},set_imageScaleQuality:function(e){return e==ei.Low?(this.canvas.mozImageSmoothingEnabled=!1,this.canvas.webkitImageSmoothingEnabled=!1,this.canvas.msImageSmoothingEnabled=!1,this.canvas.imageSmoothingEnabled=!1):(this.canvas.mozImageSmoothingEnabled=!0,this.canvas.webkitImageSmoothingEnabled=!0,this.canvas.msImageSmoothingEnabled=!0,this.canvas.imageSmoothingEnabled=!0),this.scaleQuality=e},drawRect:function(e,t,i,r,n){null==n&&(n=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(n),this.canvas.rect(e,t,i,r),this.canvas.stroke(),this.canvas.lineWidth=s},fillRect:function(e,t,i,r){var n=this.get_opacity();this.canvas.globalAlpha=n*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(e,t,i,r),this.canvas.globalAlpha=this.get_opacity()},drawArc:function(e,t,i,r,n,s,a){null==a&&(a=!1),null==s&&(s=1),this.canvas.beginPath();var o=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.arc(e,t,i,r,n,a),this.canvas.stroke(),this.canvas.lineWidth=o},drawCircle:function(e,t,i,r){null==r&&(r=1);var n=2*Math.PI;this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.arc(e,t,i,0,n,!1),this.canvas.stroke(),this.canvas.lineWidth=s},_drawArc:function(e,t,i,r,n,s,a){this.canvas.beginPath();var o=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.arc(e,t,i,r,n,a),this.canvas.stroke(),this.canvas.lineWidth=o},fillArc:function(e,t,i,r,n,s){null==s&&(s=!1),this.canvas.beginPath(),this.canvas.arc(e,t,i,r,n,s),this.canvas.fill()},fillCircle:function(e,t,i){this.canvas.beginPath(),this.canvas.arc(e,t,i,0,2*Math.PI,!1),this.canvas.fill()},drawString:function(e,t,i){var r=this.webfont.getImage(this.get_fontSize(),this.myColor,this.get_fontGlyphs());if(0<r.width)for(var n=t,s=i,a=0,o=e.length;a<o;){var l,h=a++;null!=(l=null!=this.get_fontGlyphs()?this.webfont.kravur._get(this.get_fontSize(),this.get_fontGlyphs()).getBakedQuad(this.bakedQuadCache,this.get_fontGlyphs().indexOf($.cca(e,h)),n,s):this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,$.cca(e,h)-32,n,s))&&(0<l.s1-l.s0&&0<l.t1-l.t0&&0<l.x1-l.x0&&0<l.y1-l.y0&&this.canvas.drawImage(r,l.s0*r.width,l.t0*r.height,(l.s1-l.s0)*r.width,(l.t1-l.t0)*r.height,l.x0,l.y0,l.x1-l.x0,l.y1-l.y0),n+=l.xadvance)}},set_font:function(e){return this.webfont=Re.__cast(e,or),this.webfont},get_font:function(){return this.webfont},drawLine:function(e,t,i,r,n){null==n&&(n=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(n),this.canvas.moveTo(e,t),this.canvas.lineTo(i,r),this.canvas.moveTo(0,0),this.canvas.stroke(),this.canvas.lineWidth=s},fillTriangle:function(e,t,i,r,n,s){this.canvas.beginPath(),this.canvas.closePath(),this.canvas.fill()},scissor:function(e,t,i,r){this.canvas.beginPath(),this.canvas.rect(e,t,i,r),this.canvas.clip()},disableScissor:function(){this.canvas.restore()},drawVideo:function(e,t,i,r,n){this.canvas.drawImage(Re.__cast(e,ur).element,t,i,r,n)},setTransformation:function(e){this.canvas.setTransform(e._00,e._01,e._10,e._11,e._20,e._21)},__class__:nr});var sr=function(e){this._parts=null,this._parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],this.url=e;var t=new s("^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?://)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\\d*))?)(((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[?#]|$)))*/?)?([^?#/]*))(?:\\?([^#]*))?(?:#(.*))?)","");t.match(e);for(var i=0,r=this._parts.length;i<r;){var n=i++;this[this._parts[n]]=t.matched(n)}};(i["kha.js.URLParser"]=sr).__name__=!0,sr.parse=function(e){return new sr(e)},sr.prototype={toString:function(){for(var e="For Url -> "+this.url+"\n",t=0,i=this._parts.length;t<i;){var r=t++;e+=this._parts[r]+": "+E.string(U.field(this,this._parts[r]))+(r==this._parts.length-1?"":"\n")}return e},__class__:sr};var ar=function(){je.call(this)};(i["kha.js.EnvironmentVariables"]=ar).__name__=!0,ar.__super__=je,ar.prototype=n(je.prototype,{getVariable:function(e){for(var t=new sr(window.location.href).query.split("&"),i=0;i<t.length;){var r=t[i];++i;var n=r.split("=");if(n[0]==e)return n[1]}return me.trace("Environment variables requested.",{fileName:"EnvironmentVariables.hx",lineNumber:90,className:"kha.js.EnvironmentVariables",methodName:"getVariable"}),""},__class__:ar});var or=function(e){this.images=new Be,this.kravur=new or.Kravur(e)};(i["kha.js.Font"]=or).__name__=!0,or.__interfaces__=[We],or.fromBytes=function(e){return new or(tr.fromBytes(e))},or.prototype={height:function(e){return this.kravur._get(e).getHeight()},width:function(e,t){return this.kravur._get(e).stringWidth(t)},widthOfCharacters:function(e,t,i,r){return this.kravur._get(e).charactersWidth(t,i,r)},baseline:function(e){return this.kravur._get(e).getBaselinePosition()},getImage:function(e,t,i){var r=null==i?e:1e4*e+i.length;if(!this.images.h.hasOwnProperty(r)){var n=this.images,s=new Be;n.h[r]=s}if(!this.images.h[r].h.hasOwnProperty(t)){var a=this.kravur._get(e,i),o=window.document.createElement("canvas");o.width=a.width,o.height=a.height;var l=o.getContext("2d");l.fillStyle="black",l.fillRect(0,0,a.width,a.height);for(var h=l.getImageData(0,0,a.width,a.height),_=Re.__cast(a.getTexture(),He).bytes,c=0,u=_.length;c<u;){var d=c++;h.data[4*d]=(16711680&t)>>>16,h.data[4*d+1]=(65280&t)>>>8,h.data[4*d+2]=255&t,h.data[4*d+3]=_.b[d]}l.putImageData(h,0,0);var f=window.document.createElement("img");return f.src=o.toDataURL("image/png"),this.images.h[r].h[t]=f}return this.images.h[r].h[t]},unload:function(){this.kravur=null,this.images=null},__class__:or};var lr=function(){};(i["kha.js.MobileWebAudio"]=lr).__name__=!0,lr._init=function(){try{return void(lr._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},lr.play=function(e,t){null==t&&(t=!1);var i=new hr(e,t);return i.play(),i},lr.stream=function(e,t){return null==t&&(t=!1),lr.play(e,t)};var hr=function(e,t){this.stopped=!1,this.paused=!1,this.buffer=e._buffer,this.loop=t,this.createSource()};(i["kha.js.MobileWebAudioChannel"]=hr).__name__=!0,hr.__interfaces__=[mt],hr.prototype={createSource:function(){var e=this;this.source=lr._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){e.stopped=!0},this.gain=lr._context.createGain(),this.source.connect(this.gain),this.gain.connect(lr._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=lr._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=lr._context.currentTime,this.source.start())},pause:function(){this.pauseTime=lr._context.currentTime-this.startTime,this.paused=!0,this.source.stop()},stop:function(){this.paused=!1,this.stopped=!0,this.source.stop()},get_length:function(){return this.source.buffer.duration},get_position:function(){return this.stopped?this.get_length():this.paused?this.pauseTime:lr._context.currentTime-this.startTime},get_volume:function(){return this.gain.gain.value},set_volume:function(e){return this.gain.gain.value=e},get_finished:function(){return this.stopped},__class__:hr,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var _r=function(e,t,i){var r=this;st.call(this);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onerror=function(){i({url:e})},n.onload=function(){r.compressedData=Te.ofData(n.response),r.uncompressedData=null,lr._context.decodeAudioData(r.compressedData.b.bufferValue,function(e){r._buffer=e,t(r)},function(){i({url:e,error:"Audio format not supported"})})},n.send(null)};(i["kha.js.MobileWebAudioSound"]=_r).__name__=!0,_r.__super__=st,_r.prototype=n(st.prototype,{uncompress:function(e){e()},__class__:_r});var cr=function(e,t,i){st.call(this),this.done=t,this.failed=i,cr.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var r=0;r<e.length;){var n=e[r];++r,""!=this.element.canPlayType("audio/ogg")&&_.endsWith(n,".ogg")&&this.filenames.push(n),""!=this.element.canPlayType("audio/mp4")&&_.endsWith(n,".mp4")&&this.filenames.push(n)}this.element.addEventListener("error",Xr(this,this.errorListener),!1),this.element.addEventListener("canplay",Xr(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(i["kha.js.Sound"]=cr).__name__=!0,cr.__super__=st,cr.prototype=n(st.prototype,{errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var r=t++;if(this.element.src==this.filenames[r])return void(this.element.src=this.filenames[r+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Xr(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Xr(this,this.canPlayThroughListener),!1),this.done(this),$.remove(cr.loading,this)},uncompress:function(e){e()},__class__:cr});var ur=function(){ot.call(this)};(i["kha.js.Video"]=ur).__name__=!0,ur.fromElement=function(e){var t=new ur;return t.element=e,null!=D.gl&&(t.texture=ze.fromVideo(t)),t},ur.fromFile=function(e,t){var i=new ur;i.done=t,i.element=window.document.createElement("video"),i.filenames=[];for(var r=0;r<e.length;){var n=e[r];++r,""!=i.element.canPlayType("video/webm")&&_.endsWith(n,".webm")&&i.filenames.push(n),""!=i.element.canPlayType("video/mp4")&&_.endsWith(n,".mp4")&&i.filenames.push(n)}i.element.addEventListener("error",Xr(i,i.errorListener),!1),i.element.addEventListener("canplaythrough",Xr(i,i.canPlayThroughListener),!1),i.element.preload="auto",i.element.src=i.filenames[0]},ur.__super__=ot,ur.prototype=n(ot.prototype,{width:function(){return this.element.videoWidth},height:function(){return this.element.videoHeight},play:function(e){null==e&&(e=!1);try{this.element.loop=e,this.element.play()}catch(e){e instanceof dt&&(e=e.val),me.trace(e,{fileName:"Video.hx",lineNumber:64,className:"kha.js.Video",methodName:"play"})}},pause:function(){try{this.element.pause()}catch(e){e instanceof dt&&(e=e.val),me.trace(e,{fileName:"Video.hx",lineNumber:73,className:"kha.js.Video",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0}catch(e){e instanceof dt&&(e=e.val),me.trace(e,{fileName:"Video.hx",lineNumber:83,className:"kha.js.Video",methodName:"stop"})}},getCurrentPos:function(){return Math.ceil(1e3*this.element.currentTime)},get_position:function(){return Math.ceil(1e3*this.element.currentTime)},set_position:function(e){return this.element.currentTime=e/1e3,e},getLength:function(){return isFinite(this.element.duration)?Math.floor(1e3*this.element.duration):-1},errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var r=t++;if(this.element.src==this.filenames[r])return void(this.element.src=this.filenames[r+1])}me.trace("Error loading "+this.element.src,{fileName:"Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Xr(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Xr(this,this.canPlayThroughListener),!1),null!=D.gl&&(this.texture=ze.fromVideo(this)),this.done(this)},__class__:ur});var dr=function(e,t,i){var r=this;st.call(this);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onerror=function(){i({url:e})},n.onload=function(){r.compressedData=Te.ofData(n.response),r.uncompressedData=null,t(r)},n.send(null)};(i["kha.js.WebAudioSound"]=dr).__name__=!0,dr.__super__=st,dr.prototype=n(st.prototype,{superUncompress:function(e){st.prototype.uncompress.call(this,e)},uncompress:function(d){var f=this;yt._context.decodeAudioData(this.compressedData.b.bufferValue,function(e){var i=e.getChannelData(0),t=i.length,r=new nn(2*t);if(f.uncompressedData=r,1==e.numberOfChannels){var n=0,s=0,a=2*t,o=function(){};(o=function(){for(var e=n+11025,t=a<e?a:e;n<t;)f.uncompressedData[n]=i[s],f.uncompressedData[n+1]=i[s],n+=2,s+=1;n<a?window.setTimeout(o,0):f.compressedData=null})(),window.setTimeout(d,250)}else{var l=e.getChannelData(1),h=0,_=0,c=2*t,u=function(){};(u=function(){for(var e=h+11025,t=c<e?c:e;h<t;)f.uncompressedData[h]=i[_],f.uncompressedData[h+1]=l[_],h+=2,_+=1;h<c?window.setTimeout(u,0):f.compressedData=null})(),window.setTimeout(d,250)}},function(){f.superUncompress(d)})},__class__:dr});var fr=function(e,t){this.value=e,this.type=t};(i["kha.js.graphics4.ConstantLocation"]=fr).__name__=!0,fr.__interfaces__=[bi],fr.prototype={__class__:fr};var gr=function(e){var t=new nn(9);this.matrix3Cache=t;var i=new nn(16);this.matrixCache=i,this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=e,this.init(),D.gl2?this.instancedExtension=!0:(this.instancedExtension=D.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=D.gl.getExtension("EXT_blend_minmax"))};(i["kha.js.graphics4.Graphics"]=gr).__name__=!0,gr.__interfaces__=[Ti],gr.getBlendFunc=function(e){switch(e[1]){case 0:case 2:return 0;case 1:return 1;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},gr.getBlendOp=function(e){switch(e[1]){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},gr.prototype={init:function(){if(null!=this.renderTarget)if(this.isCubeMap=Re.__instanceof(this.renderTarget,wi),this.isCubeMap){var e=Re.__cast(this.renderTarget,wi);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture,this.isDepthAttachment=e.isDepthAttachment}else{var t=Re.__cast(this.renderTarget,lt);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture}},begin:function(e){if(D.gl.enable(3042),D.gl.blendFunc(770,771),null==this.renderTarget)D.gl.bindFramebuffer(36160,null),D.gl.viewport(0,0,A.windowWidth(),A.windowHeight());else if(D.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),D.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=e){D.gl.framebufferTexture2D(36160,D.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var t=0,i=e.length;t<i;){var r=t++;D.gl.framebufferTexture2D(36160,D.drawBuffers.COLOR_ATTACHMENT0_WEBGL+r+1,3553,Re.__cast(e[r],lt).texture,0)}for(var n=[D.drawBuffers.COLOR_ATTACHMENT0_WEBGL],s=0,a=e.length;s<a;){var o=s++;n.push(D.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}D.gl2?D.gl.drawBuffers(n):D.drawBuffers.drawBuffersWEBGL(n)}},beginFace:function(e){D.gl.enable(3042),D.gl.blendFunc(770,771),D.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),D.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+e,this.renderTargetTexture,0),D.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},beginEye:function(e){D.gl.enable(3042),D.gl.blendFunc(770,771),D.gl.bindFramebuffer(36160,null),0==e?D.gl.viewport(0,0,.5*A.windowWidth()|0,A.windowHeight()):D.gl.viewport(.5*A.windowWidth()|0,0,.5*A.windowWidth()|0,A.windowHeight())},end:function(){},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(e,t,i){var r=0;null!=e&&(r|=16384,D.gl.colorMask(!0,!0,!0,!0),D.gl.clearColor(.00392156862745098*((16711680&e)>>>16),.00392156862745098*((65280&e)>>>8),.00392156862745098*(255&e),.00392156862745098*(e>>>24))),null!=t&&(r|=256,D.gl.enable(2929),D.gl.depthMask(!0),D.gl.clearDepth(t)),null!=i&&(r|=1024,D.gl.enable(2960),D.gl.stencilMask(255),D.gl.clearStencil(i)),D.gl.clear(r),D.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?D.gl.enable(2929):D.gl.disable(2929),D.gl.depthMask(this.depthMask)},viewport:function(e,t,i,r){var n=null==this.renderTarget?A.windowHeight(0):this.renderTarget.get_height();D.gl.viewport(e,n-t-r,i,r)},setDepthMode:function(e,t){switch(t[1]){case 0:e?D.gl.enable(2929):D.gl.disable(2929),this.depthTest=e,D.gl.depthFunc(519);break;case 1:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(512);break;case 2:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(514);break;case 3:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(517);break;case 4:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(513);break;case 5:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(515);break;case 6:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(516);break;case 7:D.gl.enable(2929),this.depthTest=!0,D.gl.depthFunc(518)}D.gl.depthMask(e),this.depthMask=e},setBlendingMode:function(e,t,i,r,n,s){e==K.BlendOne&&t==K.BlendZero?D.gl.disable(3042):(D.gl.enable(3042),D.gl.blendFuncSeparate(gr.getBlendFunc(e),gr.getBlendFunc(t),gr.getBlendFunc(r),gr.getBlendFunc(n)),D.gl.blendEquationSeparate(gr.getBlendOp(i),gr.getBlendOp(s)))},createVertexBuffer:function(e,t,i,r){return null==r&&(r=!1),new zi(e,t,i)},setVertexBuffer:function(e){Re.__cast(e,zi).set(0)},setVertexBuffers:function(e){for(var t=0,i=0;i<e.length;){var r=e[i];++i,t+=Re.__cast(r,zi).set(t)}},createIndexBuffer:function(e,t,i){return null==i&&(i=!1),new Di(e,t)},setIndexBuffer:function(e){this.indicesCount=e.count(),Re.__cast(e,Di).set()},setTexture:function(e,t){null==t?(D.gl.activeTexture(33984+Re.__cast(e,pr).value),D.gl.bindTexture(3553,null)):Re.__cast(t,lt).set(Re.__cast(e,pr).value)},setTextureDepth:function(e,t){Re.__cast(t,lt).setDepth(Re.__cast(e,pr).value)},setTextureArray:function(e,t){},setVideoTexture:function(e,t){null==t?(D.gl.activeTexture(33984+Re.__cast(e,pr).value),D.gl.bindTexture(3553,null)):Re.__cast(Re.__cast(t,ur).texture,lt).set(Re.__cast(e,pr).value)},setImageTexture:function(e,t){},setTextureParameters:function(e,t,i,r,n,s){switch(D.gl.activeTexture(33984+Re.__cast(e,pr).value),t[1]){case 0:D.gl.texParameteri(3553,10242,10497);break;case 1:D.gl.texParameteri(3553,10242,33648);break;case 2:D.gl.texParameteri(3553,10242,33071)}switch(i[1]){case 0:D.gl.texParameteri(3553,10243,10497);break;case 1:D.gl.texParameteri(3553,10243,33648);break;case 2:D.gl.texParameteri(3553,10243,33071)}switch(r[1]){case 0:switch(s[1]){case 0:D.gl.texParameteri(3553,10241,9728);break;case 1:D.gl.texParameteri(3553,10241,9984);break;case 2:D.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(s[1]){case 0:D.gl.texParameteri(3553,10241,9729);break;case 1:D.gl.texParameteri(3553,10241,9985);break;case 2:D.gl.texParameteri(3553,10241,9987)}r==Gi.AnisotropicFilter&&D.gl.texParameteri(3553,D.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(n[1]){case 0:D.gl.texParameteri(3553,10240,9728);break;case 1:case 2:D.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(e,t,i,r,n,s,a){},setCubeMap:function(e,t){null==t?(D.gl.activeTexture(33984+Re.__cast(e,pr).value),D.gl.bindTexture(34067,null)):t.set(Re.__cast(e,pr).value)},setCubeMapDepth:function(e,t){t.setDepth(Re.__cast(e,pr).value)},setCullMode:function(e){switch(e[1]){case 0:D.gl.enable(2884),D.gl.cullFace(1029);break;case 1:D.gl.enable(2884),D.gl.cullFace(1028);break;case 2:D.gl.disable(2884)}},setPipeline:function(e){this.setCullMode(e.cullMode),this.setDepthMode(e.depthWrite,e.depthMode),this.setStencilParameters(e.stencilMode,e.stencilBothPass,e.stencilDepthFail,e.stencilFail,e.stencilReferenceValue,e.stencilReadMask,e.stencilWriteMask),this.setBlendingMode(e.blendSource,e.blendDestination,e.blendOperation,e.alphaBlendSource,e.alphaBlendDestination,e.alphaBlendOperation),e.set(),this.colorMaskRed=e.colorWriteMaskRed,this.colorMaskGreen=e.colorWriteMaskGreen,this.colorMaskBlue=e.colorWriteMaskBlue,this.colorMaskAlpha=e.colorWriteMaskAlpha},setBool:function(e,t){D.gl.uniform1i(Re.__cast(e,fr).value,t?1:0)},setInt:function(e,t){D.gl.uniform1i(Re.__cast(e,fr).value,t)},setFloat:function(e,t){D.gl.uniform1f(Re.__cast(e,fr).value,t)},setFloat2:function(e,t,i){D.gl.uniform2f(Re.__cast(e,fr).value,t,i)},setFloat3:function(e,t,i,r){D.gl.uniform3f(Re.__cast(e,fr).value,t,i,r)},setFloat4:function(e,t,i,r,n){D.gl.uniform4f(Re.__cast(e,fr).value,t,i,r,n)},setFloats:function(e,t){var i=Re.__cast(e,fr);switch(i.type){case 35664:D.gl.uniform2fv(i.value,t);break;case 35665:D.gl.uniform3fv(i.value,t);break;case 35666:D.gl.uniform4fv(i.value,t);break;case 35676:D.gl.uniformMatrix4fv(i.value,!1,t);break;default:D.gl.uniform1fv(i.value,t)}},setVector2:function(e,t){D.gl.uniform2f(Re.__cast(e,fr).value,t.x,t.y)},setVector3:function(e,t){D.gl.uniform3f(Re.__cast(e,fr).value,t.x,t.y,t.z)},setVector4:function(e,t){D.gl.uniform4f(Re.__cast(e,fr).value,t.x,t.y,t.z,t.w)},setMatrix:function(e,t){this.matrixCache[0]=t._00,this.matrixCache[1]=t._01,this.matrixCache[2]=t._02,this.matrixCache[3]=t._03,this.matrixCache[4]=t._10,this.matrixCache[5]=t._11,this.matrixCache[6]=t._12,this.matrixCache[7]=t._13,this.matrixCache[8]=t._20,this.matrixCache[9]=t._21,this.matrixCache[10]=t._22,this.matrixCache[11]=t._23,this.matrixCache[12]=t._30,this.matrixCache[13]=t._31,this.matrixCache[14]=t._32,this.matrixCache[15]=t._33,D.gl.uniformMatrix4fv(Re.__cast(e,fr).value,!1,this.matrixCache)},setMatrix3:function(e,t){this.matrix3Cache[0]=t._00,this.matrix3Cache[1]=t._01,this.matrix3Cache[2]=t._02,this.matrix3Cache[3]=t._10,this.matrix3Cache[4]=t._11,this.matrix3Cache[5]=t._12,this.matrix3Cache[6]=t._20,this.matrix3Cache[7]=t._21,this.matrix3Cache[8]=t._22,D.gl.uniformMatrix3fv(Re.__cast(e,fr).value,!1,this.matrix3Cache)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0);var i=null==D.elementIndexUint?5123:5125,r=5123==i?2:4;D.gl.drawElements(4,-1==t?this.indicesCount:t,i,e*r)},convertStencilAction:function(e){switch(e[1]){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},setStencilParameters:function(e,t,i,r,n,s,a){if(null==a&&(a=255),null==s&&(s=255),e==yi.Always&&t==Mi.Keep&&i==Mi.Keep&&r==Mi.Keep)D.gl.disable(2960);else{D.gl.enable(2960);var o=0;switch(e[1]){case 0:o=519;break;case 1:o=512;break;case 2:o=514;break;case 3:o=517;break;case 4:o=513;break;case 5:o=515;break;case 6:o=516;break;case 7:o=518}D.gl.stencilMask(a),D.gl.stencilOp(this.convertStencilAction(r),this.convertStencilAction(i),this.convertStencilAction(t)),D.gl.stencilFunc(o,n,s)}},scissor:function(e,t,i,r){D.gl.enable(3089),null==this.renderTarget?D.gl.scissor(e,A.windowHeight(0)-t-r,i,r):D.gl.scissor(e,t,i,r)},disableScissor:function(){D.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},drawIndexedVerticesInstanced:function(e,t,i){if(null==i&&(i=-1),null==t&&(t=0),this.instancedRenderingAvailable()){var r=null==D.elementIndexUint?5123:5125,n=null==D.elementIndexUint?2:4;D.gl2?D.gl.drawElementsInstanced(4,-1==i?this.indicesCount:i,r,t*n,e):this.instancedExtension.drawElementsInstancedANGLE(4,-1==i?this.indicesCount:i,r,t*n,e)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:gr};var vr=function(e){Ci.call(this,e)};(i["kha.js.graphics4.Graphics2"]=vr).__name__=!0,vr.__super__=Ci,vr.prototype=n(Ci.prototype,{drawVideoInternal:function(e,t,i,r,n){var s=Re.__cast(e,ur);this.drawScaledSubImage(s.texture,0,0,s.texture.get_width(),s.texture.get_height(),t,i,r,n)},begin:function(e,t){null==e&&(e=!0),D.gl.colorMask(!0,!0,!0,!0),D.gl.disable(2929),D.gl.depthFunc(519),Ci.prototype.begin.call(this,e,t)},__class__:vr});var pr=function(e){this.value=e};(i["kha.js.graphics4.TextureUnit"]=pr).__name__=!0,pr.__interfaces__=[Oi],pr.prototype={__class__:pr};var mr=function(){};(i["kha.vr.VrInterface"]=mr).__name__=!0,mr.prototype={GetSensorState:function(){return null},GetPredictedSensorState:function(e){return null},WarpSwapBlack:function(){},WarpSwapLoadingIcon:function(){},WarpSwap:function(e){},IsPresenting:function(){return!1},IsVrEnabled:function(){return!1},GetTimeInSeconds:function(){return 0},GetProjectionMatrix:function(e){return null},GetViewMatrix:function(e){return null},onVRRequestPresent:function(){},onVRExitPresent:function(){},onResetPose:function(){},__class__:mr};var yr=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.rightViewMatrix=new br(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.leftViewMatrix=new br(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.rightProjectionMatrix=new br(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.leftProjectionMatrix=new br(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.vrEnabled=!1,mr.call(this)};(i["kha.js.vr.VrInterface"]=yr).__name__=!0,yr.__super__=mr,yr.prototype=n(mr.prototype,{getVRDisplays:function(){var r=this;navigator.getVRDisplays().then(function(e){if(0<e.length){r.frameData=new VRFrameData,r.vrDisplay=e[0],r.vrDisplay.depthNear=.1,r.vrDisplay.depthFar=1024;var t=r.vrDisplay.getEyeParameters("left"),i=r.vrDisplay.getEyeParameters("right");r.width=D.khanvas.width,r.height=D.khanvas.height,r.vrWidth=2*Math.max(t.renderWidth,i.renderWidth)|0,r.vrHeight=0|Math.max(t.renderHeight,i.renderHeight)}else me.trace("There are no VR displays connected.",{fileName:"VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},onVRRequestPresent:function(){var e=this;try{this.vrDisplay.requestPresent([{source:D.khanvas}]).then(function(){e.onResize(),e.vrDisplay.requestAnimationFrame(Xr(e,e.onAnimationFrame))})}catch(e){e instanceof dt&&(e=e.val),me.trace("Failed to requestPresent.",{fileName:"VrInterface.hx",lineNumber:71,className:"kha.js.vr.VrInterface",methodName:"onVRRequestPresent"}),me.trace(e,{fileName:"VrInterface.hx",lineNumber:72,className:"kha.js.vr.VrInterface",methodName:"onVRRequestPresent"})}},onVRExitPresent:function(){var e=this;try{this.vrDisplay.exitPresent([{source:D.khanvas}]).then(function(){e.onResize()})}catch(e){e instanceof dt&&(e=e.val),me.trace("Failed to exitPresent.",{fileName:"VrInterface.hx",lineNumber:82,className:"kha.js.vr.VrInterface",methodName:"onVRExitPresent"}),me.trace(e,{fileName:"VrInterface.hx",lineNumber:83,className:"kha.js.vr.VrInterface",methodName:"onVRExitPresent"})}},onResetPose:function(){try{this.vrDisplay.resetPose()}catch(e){e instanceof dt&&(e=e.val),me.trace("Failed to resetPose",{fileName:"VrInterface.hx",lineNumber:91,className:"kha.js.vr.VrInterface",methodName:"onResetPose"}),me.trace(e,{fileName:"VrInterface.hx",lineNumber:92,className:"kha.js.vr.VrInterface",methodName:"onResetPose"})}},onAnimationFrame:function(e){null!=this.vrDisplay&&this.vrDisplay.isPresenting&&(this.vrDisplay.requestAnimationFrame(Xr(this,this.onAnimationFrame)),this.vrDisplay.getFrameData(this.frameData),this.leftProjectionMatrix=this.createMatrixFromArray(this.frameData.leftProjectionMatrix),this.leftViewMatrix=this.createMatrixFromArray(this.frameData.leftViewMatrix),this.rightProjectionMatrix=this.createMatrixFromArray(this.frameData.rightProjectionMatrix),this.rightViewMatrix=this.createMatrixFromArray(this.frameData.rightViewMatrix),this.vrDisplay.submitFrame())},onResize:function(){null!=this.vrDisplay&&this.vrDisplay.isPresenting?(D.khanvas.width=this.vrWidth,D.khanvas.height=this.vrHeight):(D.khanvas.width=this.width,D.khanvas.height=this.height)},GetSensorState:function(){return this.GetPredictedSensorState(0)},GetPredictedSensorState:function(e){var t=new Or;t.Predicted=new Ur,t.Recorded=t.Predicted,t.Predicted.AngularAcceleration=new Ar,t.Predicted.AngularVelocity=new Ar,t.Predicted.LinearAcceleration=new Ar,t.Predicted.LinearVelocity=new Ar,t.Predicted.TimeInSeconds=e,t.Predicted.Pose=new Gr,t.Predicted.Pose.Orientation=new kr,t.Predicted.Pose.Position=new Ar;var i=this.frameData.pose;return null!=i&&(t.Predicted.AngularVelocity=this.createVectorFromArray(i.angularVelocity),t.Predicted.AngularAcceleration=this.createVectorFromArray(i.angularAcceleration),t.Predicted.LinearVelocity=this.createVectorFromArray(i.linearVelocity),t.Predicted.LinearAcceleration=this.createVectorFromArray(i.linearAcceleration),t.Predicted.Pose.Orientation=this.createQuaternion(i.orientation),t.Predicted.Pose.Position=this.createVectorFromArray(i.position)),t},WarpSwapBlack:function(){},WarpSwapLoadingIcon:function(){},WarpSwap:function(e){},IsPresenting:function(){return null!=this.vrDisplay&&this.vrDisplay.isPresenting},IsVrEnabled:function(){return this.vrEnabled},GetTimeInSeconds:function(){return P.time()},GetProjectionMatrix:function(e){return 0==e?this.leftProjectionMatrix:this.rightProjectionMatrix},GetViewMatrix:function(e){return 0==e?this.leftViewMatrix:this.rightViewMatrix},createMatrixFromArray:function(e){var t=new br(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._00=e[0],t._01=e[1],t._02=e[2],t._03=e[3],t._10=e[4],t._11=e[5],t._12=e[6],t._13=e[7],t._20=e[8],t._21=e[9],t._22=e[10],t._23=e[11],t._30=e[12],t._31=e[13],t._32=e[14],t._33=e[15],t},createVectorFromArray:function(e){var t=new Ar(0,0,0);return null!=e&&(t.x=e[0],t.y=e[1],t.z=e[2]),t},createQuaternion:function(e){var t=new kr(0,0,0,0);return null!=e&&(t.set_x(e[0]),t.set_y(e[1]),t.set_z(e[2]),t.set_w(e[3])),t},__class__:yr});var br=function(e,t,i,r,n,s,a,o,l,h,_,c,u,d,f,g){this._00=e,this._10=t,this._20=i,this._30=r,this._01=n,this._11=s,this._21=a,this._31=o,this._02=l,this._12=h,this._22=_,this._32=c,this._03=u,this._13=d,this._23=f,this._33=g};(i["kha.math.FastMatrix4"]=br).__name__=!0,br.fromMatrix4=function(e){return new br(e._00,e._10,e._20,e._30,e._01,e._11,e._21,e._31,e._02,e._12,e._22,e._32,e._03,e._13,e._23,e._33)},br.orthogonalProjection=function(e,t,i,r,n,s){return new br(2/(t-e),0,0,-(t+e)/(t-e),0,2/(r-i),0,-(r+i)/(r-i),0,0,-2/(s-n),-(s+n)/(s-n),0,0,0,1)},br.perspectiveProjection=function(e,t,i,r){var n=1/Math.tan(e/2);return new br(n/t,0,0,0,0,n,0,0,0,0,(r+i)/(i-r),2*r*i/(i-r),0,0,-1,0)},br.lookAt=function(e,t,i){var r=new xr(t.x-e.x,t.y-e.y,t.z-e.z);r.set_length(1);var n,s,a,o=r.y*i.z-r.z*i.y,l=r.z*i.x-r.x*i.z,h=r.x*i.y-r.y*i.x,_=new xr(o,l,h);return _.set_length(1),a=_.y*r.z-_.z*r.y,s=_.z*r.x-_.x*r.z,n=_.x*r.y-_.y*r.x,new br(_.x,_.y,_.z,-(_.x*e.x+_.y*e.y+_.z*e.z),a,s,n,-(a*e.x+s*e.y+n*e.z),-r.x,-r.y,-r.z,r.x*e.x+r.y*e.y+r.z*e.z,0,0,0,1)},br.prototype={__class__:br};var wr=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(i["kha.math.FastVector2"]=wr).__name__=!0,wr.fromVector2=function(e){return new wr(e.x,e.y)},wr.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,e},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:wr,__properties__:{set_length:"set_length",get_length:"get_length"}};var xr=function(e,t,i){null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i};(i["kha.math.FastVector3"]=xr).__name__=!0,xr.fromVector3=function(e){return new xr(e.x,e.y,e.z)},xr.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,e},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:xr,__properties__:{set_length:"set_length",get_length:"get_length"}};var Br=function(e,t,i,r){null==r&&(r=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i,this.w=r};(i["kha.math.FastVector4"]=Br).__name__=!0,Br.fromVector4=function(e){return new Br(e.x,e.y,e.z,e.w)},Br.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,e},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:Br,__properties__:{set_length:"set_length",get_length:"get_length"}};var Sr=function(e,t,i,r,n,s,a,o,l){this._00=e,this._10=t,this._20=i,this._01=r,this._11=n,this._21=s,this._02=a,this._12=o,this._22=l};(i["kha.math.Matrix3"]=Sr).__name__=!0,Sr.prototype={__class__:Sr};var Tr=function(e,t,i,r,n,s,a,o,l,h,_,c,u,d,f,g){this._00=e,this._10=t,this._20=i,this._30=r,this._01=n,this._11=s,this._21=a,this._31=o,this._02=l,this._12=h,this._22=_,this._32=c,this._03=u,this._13=d,this._23=f,this._33=g};(i["kha.math.Matrix4"]=Tr).__name__=!0,Tr.orthogonalProjection=function(e,t,i,r,n,s){return new Tr(2/(t-e),0,0,-(t+e)/(t-e),0,2/(r-i),0,-(r+i)/(r-i),0,0,-2/(s-n),-(s+n)/(s-n),0,0,0,1)},Tr.perspectiveProjection=function(e,t,i,r){var n=1/Math.tan(e/2);return new Tr(n/t,0,0,0,0,n,0,0,0,0,(r+i)/(i-r),2*r*i/(i-r),0,0,-1,0)},Tr.lookAt=function(e,t,i){var r=new Ar(t.x-e.x,t.y-e.y,t.z-e.z);r.set_length(1);var n,s,a,o=r.y*i.z-r.z*i.y,l=r.z*i.x-r.x*i.z,h=r.x*i.y-r.y*i.x,_=new Ar(o,l,h);return _.set_length(1),a=_.y*r.z-_.z*r.y,s=_.z*r.x-_.x*r.z,n=_.x*r.y-_.y*r.x,new Tr(_.x,_.y,_.z,-(_.x*e.x+_.y*e.y+_.z*e.z),a,s,n,-(a*e.x+s*e.y+n*e.z),-r.x,-r.y,-r.z,r.x*e.x+r.y*e.y+r.z*e.z,0,0,0,1)},Tr.prototype={__class__:Tr};var kr=function(e,t,i,r){null==r&&(r=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.values=[],this.values.push(e),this.values.push(t),this.values.push(i),this.values.push(r)};(i["kha.math.Quaternion"]=kr).__name__=!0,kr.fromAxisAngle=function(e,t){var i=new kr;i.set_w(Math.cos(t/2)),i.set_x(i.set_y(i.set_z(Math.sin(t/2))));var r=i;r.set_x(r.get_x()*e.x);var n=i;n.set_y(n.get_y()*e.y);var s=i;return s.set_z(s.get_z()*e.z),i},kr.prototype={slerp:function(e,t){var i=this.dot(t);if(.9995<i){var r=t.add(this.sub(t).scaled(e));return r.normalize(),r}i<0&&(i=0),1<i&&(i=1);var n=Math.acos(i)*e,s=t.sub(this.scaled(i));s.normalize();var a=this.scaled(Math.cos(n)).add(s.scaled(Math.sin(n)));return a.normalize(),a},rotated:function(e){var t=new kr;return t.set_w(this.get_w()*e.get_w()-this.get_x()*e.get_x()-this.get_y()*e.get_y()-this.get_z()*e.get_z()),t.set_x(this.get_w()*e.get_x()+this.get_x()*e.get_w()+this.get_y()*e.get_z()-this.get_z()*e.get_y()),t.set_y(this.get_w()*e.get_y()+this.get_y()*e.get_w()+this.get_z()*e.get_x()-this.get_x()*e.get_z()),t.set_z(this.get_w()*e.get_z()+this.get_z()*e.get_w()+this.get_x()*e.get_y()-this.get_y()*e.get_x()),t.normalize(),t},scaled:function(e){return new kr(this.get_x()*e,this.get_y()*e,this.get_z()*e,this.get_w()*e)},scale:function(e){this.set_x(this.get_x()*e),this.set_y(this.get_y()*e),this.set_z(this.get_z()*e),this.set_w(this.get_w()*e)},matrix:function(){var e=2*this.get_x(),t=2*this.get_y(),i=2*this.get_z(),r=this.get_w()*e,n=this.get_w()*t,s=this.get_w()*i,a=this.get_x()*e,o=this.get_x()*t,l=this.get_x()*i,h=this.get_y()*t,_=this.get_y()*i,c=this.get_z()*i;return new Tr(1-(h+c),o-s,l+n,0,o+s,1-(a+c),_-r,0,l-n,_+r,1-(a+h),0,0,0,0,1)},get:function(e){return this.values[e]},set:function(e,t){this.values[e]=t},get_x:function(){return this.values[0]},set_x:function(e){return this.values[0]=e},get_y:function(){return this.values[1]},set_y:function(e){return this.values[1]=e},get_z:function(){return this.values[2]},set_z:function(e){return this.values[2]=e},get_w:function(){return this.values[3]},set_w:function(e){return this.values[3]=e},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z()+this.get_w()*this.get_w())},set_length:function(e){if(0==this.get_length())return 0;var t=e/this.get_length();this.set_x(this.get_x()*t);this.set_y(this.get_y()*t);return this.set_z(this.get_z()*t),e},addVector:function(e){var t=new kr(this.get_x(),this.get_y(),this.get_z(),this.get_w()),i=new kr(0,e.x,e.y,e.z);i=i.mult(t);var r=t;r.set_x(r.get_x()+.5*i.get_x());var n=t;n.set_y(n.get_y()+.5*i.get_y());var s=t;s.set_z(s.get_z()+.5*i.get_z());var a=t;return a.set_w(a.get_w()+.5*i.get_w()),t},add:function(e){return new kr(this.get_x()+e.get_x(),this.get_y()+e.get_y(),this.get_z()+e.get_z(),this.get_w()+e.get_w())},sub:function(e){return new kr(this.get_x()-e.get_x(),this.get_y()-e.get_y(),this.get_z()-e.get_z(),this.get_w()-e.get_w())},mult:function(e){var t=new kr;return t.set_x(this.get_w()*e.get_x()+this.get_x()*e.get_w()+this.get_y()*e.get_z()-this.get_z()*e.get_y()),t.set_y(this.get_w()*e.get_y()-this.get_x()*e.get_z()+this.get_y()*e.get_w()+this.get_z()*e.get_x()),t.set_z(this.get_w()*e.get_z()+this.get_x()*e.get_y()-this.get_y()*e.get_x()+this.get_z()*e.get_w()),t.set_w(this.get_w()*e.get_w()-this.get_x()*e.get_x()-this.get_y()*e.get_y()-this.get_z()*e.get_z()),t},normalize:function(){this.scale(1/this.get_length())},dot:function(e){return this.get_x()*e.get_x()+this.get_y()*e.get_y()+this.get_z()*e.get_z()+this.get_w()*e.get_w()},getEulerAngles:function(e,t,i,r,n){null==n&&(n=1),null==r&&(r=1);var s=new Ar,a=[];a[0]=this.get_x(),a[1]=this.get_y(),a[2]=this.get_z();var o=this.get_w()*this.get_w(),l=a[e]*a[e],h=a[t]*a[t],_=a[i]*a[i],c=-1,u=Math.PI/2;(e+1)%3==t&&(t+1)%3==i&&(c=1);var d=2*c*(c*this.get_w()*a[t]+a[e]*a[i]);return d<1e-7-1?(s.x=0,s.y=-r*n*u,s.z=r*n*Math.atan2(2*(c*a[e]*a[t]+this.get_w()*a[i]),o+h-l-_)):1-1e-7<d?(s.x=0,s.y=r*n*u,s.z=r*n*Math.atan2(2*(c*a[e]*a[t]+this.get_w()*a[i]),o+h-l-_)):(s.x=-r*n*Math.atan2(-2*(this.get_w()*a[e]-c*a[t]*a[i]),o+_-l-h),s.y=r*n*Math.asin(d),s.z=r*n*Math.atan2(2*(this.get_w()*a[i]-c*a[e]*a[t]),o+l-h-_)),s},__class__:kr,__properties__:{set_length:"set_length",get_length:"get_length",set_w:"set_w",get_w:"get_w",set_z:"set_z",get_z:"get_z",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var Ir=function(e){this.index=0,this.MT=[],this.MT[623]=0,this.MT[0]=e;for(var t=1;t<624;){var i=t++;this.MT[i]=1812433253*(this.MT[i-1]^this.MT[i-1]>>30)+i}};(i["kha.math.Random"]=Ir).__name__=!0,Ir.init=function(e){Ir.Default=new Ir(e)},Ir.get=function(){return Ir.Default.Get()},Ir.getFloat=function(){return Ir.Default.GetFloat()},Ir.getUpTo=function(e){return Ir.Default.GetUpTo(e)},Ir.getIn=function(e,t){return Ir.Default.GetIn(e,t)},Ir.getFloatIn=function(e,t){return e+Ir.Default.GetFloat()*(t-e)},Ir.prototype={Get:function(){0==this.index&&this.GenerateNumbers();var e=this.MT[this.index];return e^=e>>11,e^=e<<7&-1658038656,e^=e<<15&-272236544,e^=e>>18,this.index=(this.index+1)%624,e},GetFloat:function(){return this.Get()/2147483646},GetUpTo:function(e){return this.Get()%(e+1)},GetIn:function(e,t){return this.Get()%(t+1-e)+e},GetFloatIn:function(e,t){return e+this.GetFloat()*(t-e)},GenerateNumbers:function(){for(var e=0;e<624;){var t=e++,i=(1&this.MT[t])+this.MT[(t+1)%624]&2147483647;this.MT[t]=this.MT[(t+397)%624]^i>>1,i%2!=0&&(this.MT[t]^=-1727483681)}},__class__:Ir};var Ar=function(e,t,i){null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i};(i["kha.math.Vector3"]=Ar).__name__=!0,Ar.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,e},__class__:Ar,__properties__:{set_length:"set_length",get_length:"get_length"}};var Cr=function(e,t,i,r){null==r&&(r=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i,this.w=r};(i["kha.math.Vector4"]=Cr).__name__=!0,Cr.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,e},__class__:Cr,__properties__:{set_length:"set_length",get_length:"get_length"}};var Dr=function(){};(i["kha.network.Client"]=Dr).__name__=!0,Dr.prototype={__class__:Dr,__properties__:{get_id:"get_id"}};var Pr=function(){};(i["kha.network.ControllerBuilder"]=Pr).__name__=!0;var Er=function(){};(i["kha.network.Entity"]=Er).__name__=!0,Er.prototype={__class__:Er};var Nr=function(e){this.myId=e};(i["kha.network.LocalClient"]=Nr).__name__=!0,Nr.__interfaces__=[Dr],Nr.prototype={send:function(e,t){},receive:function(e){},onClose:function(e){},get_controllers:function(){return null},get_id:function(){return this.myId},__class__:Nr,__properties__:{get_id:"get_id",get_controllers:"get_controllers"}};var Mr=function(e,t,i,r){this.open=!1;var n=this;this.socket=new WebSocket("ws://"+e+":"+t),this.socket.onerror=function(e){me.trace("Network error.",{fileName:"Network.hx",lineNumber:14,className:"kha.network.Network",methodName:"new"}),i()},this.socket.binaryType="arraybuffer",this.socket.onopen=function(){n.open=!0},this.socket.onclose=function(e){me.trace("Network connection closed. "+Mr.webSocketCloseReason(e.code)+" ("+e.reason+").",{fileName:"Network.hx",lineNumber:22,className:"kha.network.Network",methodName:"new"}),r()}};(i["kha.network.Network"]=Mr).__name__=!0,Mr.webSocketCloseReason=function(e){switch(e){case 1e3:return"Normal Closure";case 1001:return"Going Away";case 1002:return"Protocol error";case 1003:return"Unsupported Data";case 1005:return"No Status Rcvd";case 1006:return"Abnormal Closure";case 1007:return"Invalid frame";case 1008:return"Policy Violation";case 1009:return"Message Too Big";case 1010:return"Mandatory Ext.";case 1011:return"Internal Server Error";case 1015:return"TLS handshake";default:return""}},Mr.prototype={send:function(e,t){this.open&&this.socket.send(e.b.bufferValue)},listen:function(i){this.socket.onmessage=function(e){var t=Te.ofData(e.data);i(t)}},__class__:Mr};var Lr=function(e,t){this.time=e,this.data=t};(i["kha.network.State"]=Lr).__name__=!0,Lr.prototype={__class__:Lr};var Rr=function(e,t,i){this.ping=1,this.currentPlayers=0,this.controllers=new Be,this.entities=new Be,(Rr.instance=this).maxPlayers=e,this.address=t,this.port=i};(i["kha.network.Session"]=Rr).__name__=!0,Rr.the=function(){return Rr.instance},Rr.prototype={get_me:function(){return this.localClient},addEntity:function(e){var t=this.entities,i=e._id();t.h[i]=e},addController:function(e){me.trace("Adding controller id "+e._id(),{fileName:"Session.hx",lineNumber:88,className:"kha.network.Session",methodName:"addController"}),e._inputBufferIndex=0;var t=this.controllers,i=e._id();t.h[i]=e},sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var i=new Te(new en(this.controllers.h[e]._inputBufferIndex+4+t.length));i.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=i}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},sendPing:function(){var e=new Te(new en(5));e.b[0]=4,e.setFloat(1,P.realTime()),this.sendToServer(e)},sendPlayerUpdate:function(){},receive:function(e,t){switch(e.b[0]){case 0:var i=e.b[1];this.localClient=new Nr(i),P.resetTime(),this.startCallback();break;case 1:for(var r=e.getDouble(1),n=9,s=this.entities.iterator();s.hasNext();){var a=s.next();a._receive(n,e),n+=a._size()}P.warp(r);break;case 3:switch(e.b[1]){case 0:break;case 1:this.executeRPC(e)}break;case 4:var o=e.getFloat(1);this.ping=P.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=e.getInt32(1)}},executeRPC:function(e){var t=[],i=e.getInt32(2),r=6,n=e.getUInt16(r);r+=2;for(var s="",a=0,o=n;a<o;){a++;s+=String.fromCharCode(e.b[r]),++r}var l=e.getUInt16(r);r+=2;for(var h="",_=0,c=l;_<c;){_++;h+=String.fromCharCode(e.b[r]),++r}for(;r<e.length;){var u=e.b[r];switch(++r,u){case 66:var d=1==e.b[r];++r,me.trace("Bool: "+(null==d?"null":""+d),{fileName:"Session.hx",lineNumber:295,className:"kha.network.Session",methodName:"executeRPC"}),t.push(d);break;case 70:var f=e.getDouble(r);r+=8,me.trace("Float: "+f,{fileName:"Session.hx",lineNumber:300,className:"kha.network.Session",methodName:"executeRPC"}),t.push(f);break;case 73:var g=e.getInt32(r);r+=4,me.trace("Int: "+g,{fileName:"Session.hx",lineNumber:305,className:"kha.network.Session",methodName:"executeRPC"}),t.push(g);break;case 83:var v=e.getUInt16(r);r+=2;for(var p="",m=0,y=v;m<y;){m++;p+=String.fromCharCode(e.b[r]),++r}me.trace("String: "+p,{fileName:"Session.hx",lineNumber:315,className:"kha.network.Session",methodName:"executeRPC"}),t.push(p);break;default:me.trace("Unknown argument type.",{fileName:"Session.hx",lineNumber:318,className:"kha.network.Session",methodName:"executeRPC"})}}if(-1==i)U.field(te.resolveClass(s),h+"_remotely").apply(null,t);else{var b=Vr.objects[i];U.field(Vr.objects[i],h+"_remotely").apply(b,t)}},waitForStart:function(e,t,i,r,n){var s=this;this.startCallback=e,this.refusedCallback=t,this.resetCallback=n,this.network=new Mr(this.address,this.port,i,function(){r(),s.reset()}),this.network.listen(function(e){s.receive(e)}),this.updateTaskId=P.addFrameTask(Xr(this,this.update),0),this.ping=1,this.pingTaskId=P.addTimeTask(Xr(this,this.sendPing),0,1)},reset:function(){P.removeFrameTask(this.updateTaskId),P.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new Be,this.entities=new Be,this.resetCallback()},update:function(){for(var e=this.controllers.iterator();e.hasNext();){var t=e.next();if(0<t._inputBufferIndex){var i=new Te(new en(22+t._inputBufferIndex));i.b[0]=2,i.setInt32(1,t._id()),i.setDouble(5,P.time()),i.setInt32(13,A.windowWidth(0)),i.setInt32(17,A.windowHeight(0));var r=A.get_screenRotation()[1];i.b[21]=255&r,i.blit(22,t._inputBuffer,0,t._inputBufferIndex),this.sendToServer(i),t._inputBufferIndex=0}}},sendToServer:function(e){this.network.send(e,!1)},__class__:Rr,__properties__:{get_me:"get_me"}};var Vr=function(){};(i["kha.network.SyncBuilder"]=Vr).__name__=!0;var Fr=function(e,t,i,r){this._0=e,this._1=t,this._2=i,this._3=r};(i["kha.simd.Float32x4"]=Fr).__name__=!0,Fr.create=function(){return new Fr(0,0,0,0)},Fr.loadAllFast=function(e){return new Fr(e,e,e,e)},Fr.load=function(e,t,i,r){return new Fr(e,t,i,r)},Fr.loadFast=function(e,t,i,r){return new Fr(e,t,i,r)},Fr.get=function(e,t){var i=0;switch(t){case 0:i=e._0;break;case 1:i=e._1;break;case 2:i=e._2;break;case 3:i=e._3}return i},Fr.getFast=function(e,t){switch(t){case 0:return e._0;case 1:return e._1;case 2:return e._2;case 3:return e._3}return 0},Fr.abs=function(e){return new Fr(Math.abs(e._0),Math.abs(e._1),Math.abs(e._2),Math.abs(e._3))},Fr.add=function(e,t){return new Fr(e._0+t._0,e._1+t._1,e._2+t._2,e._3+t._3)},Fr.div=function(e,t){return new Fr(e._0/t._0,e._1/t._1,e._2/t._2,e._3/t._3)},Fr.mul=function(e,t){return new Fr(e._0*t._0,e._1*t._1,e._2*t._2,e._3*t._3)},Fr.neg=function(e){return new Fr(-e._0,-e._1,-e._2,-e._3)},Fr.reciprocalApproximation=function(e){return new Fr(0,0,0,0)},Fr.reciprocalSqrtApproximation=function(e){return new Fr(0,0,0,0)},Fr.sub=function(e,t){return new Fr(e._0-t._0,e._1-t._1,e._2-t._2,e._3-t._3)},Fr.sqrt=function(e){return new Fr(Math.sqrt(e._0),Math.sqrt(e._1),Math.sqrt(e._2),Math.sqrt(e._3))},Fr.prototype={__class__:Fr};var Gr=function(){this.Orientation=new kr,this.Position=new Ar};(i["kha.vr.Pose"]=Gr).__name__=!0,Gr.prototype={__class__:Gr};var Ur=function(){};(i["kha.vr.PoseState"]=Ur).__name__=!0,Ur.prototype={__class__:Ur};var Or=function(){};(i["kha.vr.SensorState"]=Or).__name__=!0,Or.prototype={__class__:Or};var Wr=function(){};(i["kha.vr.TimeWarpImage"]=Wr).__name__=!0,Wr.prototype={__class__:Wr};var zr=function(){};(i["kha.vr.TimeWarpParms"]=zr).__name__=!0,zr.prototype={__class__:zr};var Hr,Zr=0;function Xr(e,t){return null==t?null:(null==t.__id__&&(t.__id__=Zr++),null==e.hx__closures__?e.hx__closures__={}:i=e.hx__closures__[t.__id__],null==i&&((i=function(){return i.method.apply(i.scope,arguments)}).scope=e,i.method=t,e.hx__closures__[t.__id__]=i),i);var i}i.Math=Math,String.prototype.__class__=i.String=String,String.__name__=!0,i.Array=Array,Array.__name__=!0,Date.prototype.__class__=i.Date=Date,Date.__name__=["Date"];var jr=i.Int={__name__:["Int"]},Kr=i.Dynamic={__name__:["Dynamic"]},Yr=i.Float=Number;Yr.__name__=["Float"];var Qr=i.Bool=Boolean;Qr.__ename__=["Bool"];var qr=i.Class={__name__:["Class"]},Jr={},$r={},en=t.ArrayBuffer||Ve;null==en.prototype.slice&&(en.prototype.slice=Ve.sliceImpl);var tn,rn=t.DataView||Fe,nn=t.Float32Array||Ge._new,sn=t.Uint8Array||Ue._new;d._emptyArgs=[],f.isIniaited=!1,f.onSystemUpdate={handlers:[]},f.onUpdate={handlers:[]},f.onDraw={handlers:[]},f.onStart={handlers:[]},f.onStop={handlers:[]},f.onWindowResize={handlers:[]},f.isRunning=!1,f.isProcessing=!1,f._updateTaskId=-1,f._countUniqueID=0,f._dirtyWindowResize=!1,f._onKhaInitCallbacks=[],f._destroyCallbacks=[],f.gameTitle="Gecko2D-Game",f.Flags=(tn=new Ie,null!=$r[""]?tn.setReserved("",""):tn.h[""]="",tn),g.__pool__=new d(g,{amount:1}),p.__pool__=new d(p,{amount:1}),m.AliceBlue=15792383,m.AntiqueWhite=16444375,m.Aqua=65535,m.Aquamarine=8388564,m.Azure=15794175,m.Beige=16119260,m.Bisque=16770244,m.Black=0,m.BlanchedAlmond=16772045,m.Blue=255,m.BlueViolet=9055202,m.Brown=10824234,m.BurlyWood=14596231,m.CadetBlue=6266528,m.Chartreuse=8388352,m.Chocolate=13789470,m.Coral=16744272,m.CornflowerBlue=6591981,m.Cornsilk=16775388,m.Crimson=14423100,m.Cyan=65535,m.DarkBlue=139,m.DarkCyan=35723,m.DarkGoldenRod=12092939,m.DarkGray=11119017,m.DarkGrey=11119017,m.DarkGreen=25600,m.DarkKhaki=12433259,m.DarkMagenta=9109643,m.DarkOliveGreen=5597999,m.DarkOrange=16747520,m.DarkOrchid=10040012,m.DarkRed=9109504,m.DarkSalmon=15308410,m.DarkSeaGreen=9419919,m.DarkSlateBlue=4734347,m.DarkSlateGray=3100495,m.DarkSlateGrey=3100495,m.DarkTurquoise=52945,m.DarkViolet=9699539,m.DeepPink=16716947,m.DeepSkyBlue=49151,m.DimGray=6908265,m.DimGrey=6908265,m.DodgerBlue=2003199,m.FireBrick=11674146,m.FloralWhite=16775920,m.ForestGreen=2263842,m.Fuchsia=16711935,m.Gainsboro=14474460,m.GhostWhite=16316671,m.Gold=16766720,m.GoldenRod=14329120,m.Gray=8421504,m.Grey=8421504,m.Green=32768,m.GreenYellow=11403055,m.HoneyDew=15794160,m.HotPink=16738740,m.IndianRed=13458524,m.Indigo=4915330,m.Ivory=16777200,m.Khaki=15787660,m.Lavender=15132410,m.LavenderBlush=16773365,m.LawnGreen=8190976,m.LemonChiffon=16775885,m.LightBlue=11393254,m.LightCoral=15761536,m.LightCyan=14745599,m.LightGoldenRodYellow=16448210,m.LightGray=13882323,m.LightGrey=13882323,m.LightGreen=9498256,m.LightPink=16758465,m.LightSalmon=16752762,m.LightSeaGreen=2142890,m.LightSkyBlue=8900346,m.LightSlateGray=7833753,m.LightSlateGrey=7833753,m.LightSteelBlue=11584734,m.LightYellow=16777184,m.Lime=65280,m.LimeGreen=3329330,m.Linen=16445670,m.Magenta=16711935,m.Maroon=8388608,m.MediumAquaMarine=6737322,m.MediumBlue=205,m.MediumOrchid=12211667,m.MediumPurple=9662683,m.MediumSeaGreen=3978097,m.MediumSlateBlue=8087790,m.MediumSpringGreen=64154,m.MediumTurquoise=4772300,m.MediumVioletRed=13047173,m.MidnightBlue=1644912,m.MintCream=16121850,m.MistyRose=16770273,m.Moccasin=16770229,m.NavajoWhite=16768685,m.Navy=128,m.OldLace=16643558,m.Olive=8421376,m.OliveDrab=7048739,m.Orange=16753920,m.OrangeRed=16729344,m.Orchid=14315734,m.PaleGoldenRod=15657130,m.PaleGreen=10025880,m.PaleTurquoise=11529966,m.PaleVioletRed=14381203,m.PapayaWhip=16773077,m.PeachPuff=16767673,m.Peru=13468991,m.Pink=16761035,m.Plum=14524637,m.PowderBlue=11591910,m.Purple=8388736,m.RebeccaPurple=6697881,m.Red=16711680,m.RosyBrown=12357519,m.RoyalBlue=4286945,m.SaddleBrown=9127187,m.Salmon=16416882,m.SandyBrown=16032864,m.SeaGreen=3050327,m.SeaShell=16774638,m.Sienna=10506797,m.Silver=12632256,m.SkyBlue=8900331,m.SlateBlue=6970061,m.SlateGray=7372944,m.SlateGrey=7372944,m.Snow=16775930,m.SpringGreen=65407,m.SteelBlue=4620980,m.Tan=13808780,m.Teal=32896,m.Thistle=14204888,m.Tomato=16737095,m.Turquoise=4251856,m.Violet=15631086,m.Wheat=16113331,m.White=16777215,m.WhiteSmoke=16119285,m.Yellow=16776960,m.YellowGreen=10145074,m.invMaxChannelValue=.00392156862745098,b.__pool__=new d(b,{amount:1}),C.width=3,C.height=3,w.emptyMatrix=new C(1,0,0,0,1,0,0,0,1),B.__pool__=new d(B,{amount:1}),I._initiated=!1,I.Anchor=S,I._mode=k.None,I.matrix=new C(1,0,0,0,1,0,0,0,1),I._scale=new T(1,1),I._position=new T(0,0),I._size=new T(0,0),I._anchor=new T(.5,.5),I.windowWidth=0,I.windowHeight=0,I.centerX=0,I.centerY=0,P.timeWarpSaveTime=10,P.DIF_COUNT=3,P.maxframetime=.5,P.startTime=0,A.renderListeners=[],A.foregroundListeners=[],A.resumeListeners=[],A.pauseListeners=[],A.backgroundListeners=[],A.shutdownListeners=[],A.dropFilesListeners=[],D.mobile=!1,D.ios=!1,D.mobileAudioPlaying=!1,D.chrome=!1,D.firefox=!1,D.ie=!1,D.insideInputEvent=!1,D.maxGamepads=4,D.leftMouseCtrlDown=!1,D.minimumScroll=999,D.lastFirstTouchX=0,D.lastFirstTouchY=0,D.iosSoundEnabled=!1,D.iosTouchs=[],N._initTime=P.realTime(),N.scale=1,N.fixedTime=0,N.fixedUnscaledDelta=0,N.fixedUnscaledTime=0,N.time=0,N.unscaledDelta=0,N.unscaledTime=0,N._lastFixedNow=0,N._lastNow=0,L.isDepthEnabled=!1,V.__pool__=new d(V,{amount:1}),V.__componentTypes__=[],V.__componentName__="gecko.components.Component",G.__componentTypes__=[],G.__componentName__="gecko.components.draw.DrawComponent",G.__pool__=new d(G,{amount:1}),O.__pool__=new d(O,{amount:1}),O.__componentTypes__=[],O.__componentName__="gecko.components.draw.CircleComponent",W.__pool__=new d(W,{amount:1}),W.__componentTypes__=[],W.__componentName__="gecko.components.draw.PolygonComponent",z.__pool__=new d(z,{amount:1}),z.__componentTypes__=[],z.__componentName__="gecko.components.draw.RectangleComponent",H.__pool__=new d(H,{amount:1}),Z.__pool__=new d(Z,{amount:1}),Y.Add=Y.Create(K.BlendOne,K.BlendOne),Y.Multiply=Y.Create(K.DestinationColor,K.InverseSourceAlpha),Y.Screen=Y.Create(K.BlendOne,K.InverseSourceColor),Y.Subtract=Y.Create(K.BlendZero,K.InverseSourceColor),Y.Lighten=Y.Create(K.BlendOne,K.BlendOne,j.Max),J.__pool__=new d(J,{amount:1}),J.__systemName__="gecko.systems.System",re.__systemName__="gecko.systems.draw.DrawSystem",re.__pool__=new d(re,{amount:1}),ne.__pool__=new d(ne,{amount:1}),se.__pool__=new d(se,{amount:1}),ae.__pool__=new d(ae,{amount:1}),le.__pool__=new d(le,{amount:1}),he.__pool__=new d(he,{amount:1}),_e.__pool__=new d(_e,{amount:1}),ge._deg2rad=Math.PI/180,ge._rad2deg=180/Math.PI,be.DEFAULT_RESOLVER=new ye,be.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",we.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",we.BYTES=Te.ofString(we.CHARS),Se.count=0,Le.i64tmp=new pe(0,0),Re.__toStr={}.toString,Ge.BYTES_PER_ELEMENT=4,Ue.BYTES_PER_ELEMENT=1,Ze.Black=-16777216,Ze.White=-1,Ze.Red=-65536,Ze.Blue=-16776961,Ze.Green=-16711936,Ze.Magenta=-65281,Ze.Yellow=-256,Ze.Cyan=-16711681,Ze.Purple=-8388480,Ze.Pink=-16181,Ze.Orange=-23296,Ze.Transparent=0,Ze.invMaxChannelValue=.00392156862745098,Xe.js="1",Xe.kha_a1="1",Xe.kha_g3="1",Xe.kha_html5_js="1",Xe["source-header"]="Generated by Haxe 3.4.2",Xe.jquery_ver="11204",Xe.kha_js="1",Xe.sys_html5="1",Xe.sys_g4="1",Xe.sys_g2="1",Xe.kha_webgl="1",Xe.kha="1",Xe.kha_g2="1",Xe["/Users/nazarigonzalez/Gecko2D/Sources"]="1",Xe.kha_g4="1",Xe.sys_g3="1",Xe.kha_g1="1",Xe.sys_a1="1",Xe.game_name="Gecko2D-Game",Xe.haxe_ver="3.402",Xe.canvas_id="kanvas",Xe.kha_version="1611",Xe.js_es="5",Xe.kha_html5="1",Xe["js-es5"]="1",Xe.js_es5="1",Xe.sys_a2="1",Xe.dce="std",Xe.sys_g1="1",Xe.true="1",Xe.haxe3="1",Xe.kha_a2="1",Xe.script_name="game",Ke.Default=new Ke(!1,!1,!1),nt.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",nt.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",nt.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",nt.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",nt.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",nt.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",nt.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",nt.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",nt.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",nt.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",nt.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",nt.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",nt.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",nt.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",nt.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",nt.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",nt.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",nt.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",nt.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",lt.GL_RGBA16F=34842,lt.GL_RGBA32F=34836,lt.GL_R16F=33325,lt.GL_R32F=33326,lt.GL_RED=6403,lt.GL_DEPTH_COMPONENT24=33190,lt.GL_DEPTH24_STENCIL8=35056,lt.GL_DEPTH32F_STENCIL8=36013,bt.channelCount=16,St.POLY=79764919,At.INVALID_BITS=-1,Pt.EOP=-1,Pt.M__PI=3.141592653589793,Pt.DIVTAB_NUMER=32,Pt.DIVTAB_DENOM=64,Pt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Et.NO_CODE=255,Et.delay=0,Vt.PACKET_ID=1,Vt.PACKET_COMMENT=3,Vt.PACKET_SETUP=5,zt.CONTINUED_PACKET=1,zt.FIRST_PAGE=2,zt.LAST_PAGE=4,Kt.MAX_CHANNELS=16,Kt.PUSHDATA_CRC_COUNT=4,Kt.FAST_HUFFMAN_LENGTH=10,Kt.FAST_HUFFMAN_TABLE_SIZE=1024,Kt.FAST_HUFFMAN_TABLE_MASK=1023,Qt._glyphs=function(e){for(var t=[],i=32;i<256;){var r=i++;t.push(r)}return t}(),mi.STBTT_vmove=1,mi.STBTT_vline=2,mi.STBTT_vcurve=3,mi.STBTT_MACSTYLE_DONTCARE=0,mi.STBTT_MACSTYLE_BOLD=1,mi.STBTT_MACSTYLE_ITALIC=2,mi.STBTT_MACSTYLE_UNDERSCORE=4,mi.STBTT_MACSTYLE_NONE=8,mi.STBTT_PLATFORM_ID_UNICODE=0,mi.STBTT_PLATFORM_ID_MAC=1,mi.STBTT_PLATFORM_ID_ISO=2,mi.STBTT_PLATFORM_ID_MICROSOFT=3,mi.STBTT_UNICODE_EID_UNICODE_1_0=0,mi.STBTT_UNICODE_EID_UNICODE_1_1=1,mi.STBTT_UNICODE_EID_ISO_10646=2,mi.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,mi.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,mi.STBTT_MS_EID_SYMBOL=0,mi.STBTT_MS_EID_UNICODE_BMP=1,mi.STBTT_MS_EID_SHIFTJIS=2,mi.STBTT_MS_EID_UNICODE_FULL=10,mi.STBTT_MAC_EID_ROMAN=0,mi.STBTT_MAC_EID_ARABIC=4,mi.STBTT_MAC_EID_JAPANESE=1,mi.STBTT_MAC_EID_HEBREW=5,mi.STBTT_MAC_EID_CHINESE_TRAD=2,mi.STBTT_MAC_EID_GREEK=6,mi.STBTT_MAC_EID_KOREAN=3,mi.STBTT_MAC_EID_RUSSIAN=7,mi.STBTT_MS_LANG_ENGLISH=1033,mi.STBTT_MS_LANG_ITALIAN=1040,mi.STBTT_MS_LANG_CHINESE=2052,mi.STBTT_MS_LANG_JAPANESE=1041,mi.STBTT_MS_LANG_DUTCH=1043,mi.STBTT_MS_LANG_KOREAN=1042,mi.STBTT_MS_LANG_FRENCH=1036,mi.STBTT_MS_LANG_RUSSIAN=1049,mi.STBTT_MS_LANG_GERMAN=1031,mi.STBTT_MS_LANG_SPANISH=1033,mi.STBTT_MS_LANG_HEBREW=1037,mi.STBTT_MS_LANG_SWEDISH=1053,mi.STBTT_MAC_LANG_ENGLISH=0,mi.STBTT_MAC_LANG_JAPANESE=11,mi.STBTT_MAC_LANG_ARABIC=12,mi.STBTT_MAC_LANG_KOREAN=23,mi.STBTT_MAC_LANG_DUTCH=4,mi.STBTT_MAC_LANG_RUSSIAN=32,mi.STBTT_MAC_LANG_FRENCH=1,mi.STBTT_MAC_LANG_SPANISH=6,mi.STBTT_MAC_LANG_GERMAN=2,mi.STBTT_MAC_LANG_SWEDISH=5,mi.STBTT_MAC_LANG_HEBREW=10,mi.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,mi.STBTT_MAC_LANG_ITALIAN=3,mi.STBTT_MAC_LANG_CHINESE_TRAD=19,mi.STBTT_MAX_OVERSAMPLE=8,mi.STBTT_RASTERIZER_VERSION=2,wi.GL_RGBA16F=34842,wi.GL_RGBA32F=34836,wi.GL_R16F=33325,wi.GL_R32F=33326,wi.GL_DEPTH_COMPONENT24=33190,wi.GL_DEPTH24_STENCIL8=35056,wi.GL_DEPTH32F_STENCIL8=36013,ki.bufferSize=1500,ki.vertexSize=9,Ii.bufferSize=100,Ii.triangleBufferSize=100,Ai.bufferSize=100,Ki.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Ki.instances=[],Ki.connectListeners=[],Ki.disconnectListeners=[],Qi.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},qi.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},tr.bufferSize=2e3,ir.todo=[],cr.loading=[],br.width=4,br.height=4,Sr.width=3,Sr.height=3,Tr.width=4,Tr.height=4,kr.AXIS_X=0,kr.AXIS_Y=1,kr.AXIS_Z=2,Pr.nextId=0,Rr.START=0,Rr.ENTITY_UPDATES=1,Rr.CONTROLLER_UPDATES=2,Rr.REMOTE_CALL=3,Rr.PING=4,Rr.SESSION_ERROR=5,Rr.PLAYER_UPDATES=6,Rr.RPC_SERVER=0,Rr.RPC_ALL=1,Vr.nextId=0,Vr.objects=[],h.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
