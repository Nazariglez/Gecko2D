!function(e,t){"use strict";e.kha=e.kha||{},e.kha.input=e.kha.input||{},e.kha._Color=e.kha._Color||{};var i={},n=function(){return Ai.__string_rec(this,"")};function s(e,t){function i(){}i.prototype=e;var n=new i;for(var s in t)n[s]=t[s];return t.toString!==Object.prototype.toString&&(n.toString=t.toString),n}var r=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};(i.EReg=r).__name__=!0,r.prototype={r:null,match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new dt("EReg::matched")},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},__class__:r};var a=function(){this._assetsToLoad=["bullet.png","bulletShoot.wav","enemyExplosion.wav","enemyShip.png","kenpixel_mini_square.ttf","playerExplosion.wav","playerShip.png","smokeOrange0.png","smokeOrange1.png","smokeOrange2.png","smokeOrange3.png"],ae.enable(),0!=this._assetsToLoad.length?this._loadAssets():this._gotoMainScene()};(i.Game=a).__name__=!0,a.prototype={_assetsToLoad:null,_gotoMainScene:function(){var e=d.world,t=ys.__pool__.get();t.init(),t.isAlreadyDestroyed=!1,e.changeScene(t,!0)},_loadAssets:function(){var n=this,s=d.world.currentScene,e=s.createEntity();e.transform.get_position().set(R.centerX,R.centerY),e.transform.get_size().set(500,40);var t=q.__pool__.get();t.init(null,null,2),t.isAlreadyDestroyed=!1;var i=e.addComponent(t),r=y.load(this._assetsToLoad);r.onProgressEnd.handlers.push(function(e,t){i.progress=e}),r.onComplete.handlers.push(function(){var e=s.timerManager,t=be.__pool__.get();t.init(.5,0,!1,0,e),t.isAlreadyDestroyed=!1;var i=t;i.destroyOnEnd=!0,i.onEnd.handlers.push(function(){n._gotoMainScene()}),i.start()}),r.start()},__class__:a};var $=function(){};(i.HxOverrides=$).__name__=!0,$.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(t[0]),i.setUTCMinutes(t[1]),i.setUTCSeconds(t[2]),i;case 10:var n=e.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var s=e.split(" "),r=s[0].split("-"),a=s[1].split(":");return new Date(r[0],r[1]-1,r[2],a[0],a[1],a[2]);default:throw new dt("Invalid date format : "+e)}},$.cca=function(e,t){var i=e.charCodeAt(t);if(i==i)return i},$.substr=function(e,t,i){if(null==i)i=e.length;else if(i<0){if(0!=t)return"";i=e.length+i}return e.substr(t,i)},$.remove=function(e,t){var i=e.indexOf(t);return-1!=i&&(e.splice(i,1),!0)},$.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var u=function(){};(i.Lambda=u).__name__=!0,u.array=function(e){for(var t,i=[],n=((t=e)instanceof Array?function(){return $.iter(t)}:"function"==typeof t.iterator?Ts(t,t.iterator):t.iterator)();n.hasNext();){var s=n.next();i.push(s)}return i};var ee=function(){this.length=0};(i.List=ee).__name__=!0,ee.prototype={h:null,q:null,length:null,add:function(e){var t=new o(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},iterator:function(){return new l(this.h)},__class__:ee};var o=function(e,t){this.item=e,this.next=t};(i["_List.ListNode"]=o).__name__=!0,o.prototype={item:null,next:null,__class__:o};var l=function(e){this.head=e};(i["_List.ListIterator"]=l).__name__=!0,l.prototype={head:null,hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:l};var _=function(){};(i.Main=_).__name__=!0,_.main=function(){d.init(_._onReady,{width:800,height:600,bgColor:2490445,maximizable:!0,resizable:!0,screen:{width:800,height:600,mode:E.AspectFit}})},_._onReady=function(){new a},Math.__name__=!0;var K=function(){};(i.Reflect=K).__name__=!0,K.field=function(e,t){try{return e[t]}catch(e){return null}},K.getProperty=function(e,t){var i;return null==e?null:!!e.__properties__&&(i=e.__properties__["get_"+t])?e[i]():e[t]},K.setProperty=function(e,t,i){var n;!!e.__properties__&&(n=e.__properties__["set_"+t])?e[n](i):e[t]=i},K.fields=function(e){var t=[];if(null!=e){var i=Object.prototype.hasOwnProperty;for(var n in e)"__id__"!=n&&"hx__closures__"!=n&&i.call(e,n)&&t.push(n)}return t},K.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},K.isObject=function(e){if(null==e)return!1;var t=typeof e;return"string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)};var N=function(){};(i.Std=N).__name__=!0,N.string=function(e){return Ai.__string_rec(e,"")},N.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=$.cca(e,1)&&88!=$.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var X=function(){};(i.StringTools=X).__name__=!0,X.endsWith=function(e,t){var i=t.length,n=e.length;return i<=n&&$.substr(e,n-i,i)==t};var te=function(){};(i.Type=te).__name__=!0,te.resolveClass=function(e){var t=i[e];return null!=t&&t.__name__?t:null},te.resolveEnum=function(e){var t=i[e];return null!=t&&t.__ename__?t:null},te.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new dt("Too many arguments")}},te.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},te.createEnum=function(e,t,i){var n=K.field(e,t);if(null==n)throw new dt("No such constructor "+t);if(K.isFunction(n)){if(null==i)throw new dt("Constructor "+t+" need parameters");return n.apply(e,i)}if(null!=i&&0!=i.length)throw new dt("Constructor "+t+" does not need parameters");return n},te.getInstanceFields=function(e){var t=[];for(var i in e.prototype)t.push(i);return $.remove(t,"__class__"),$.remove(t,"__properties__"),t};var nt={};(i["_UInt.UInt_Impl_"]=nt).__name__=!0,nt.gt=function(e,t){var i=e<0;return i!=t<0?i:t<e},nt.gte=function(e,t){var i=e<0;return i!=t<0?i:t<=e},nt.toFloat=function(e){return e<0?4294967296+e:e+0};var h=function(){};(i["gecko.macros.IAutoPool"]=h).__name__=!0,h.prototype={beforeDestroy:null,__class__:h};var c=function(e,i){this._reset=null,this._init=null,this._objects=[];var n=this;if(i=this._parseOptions(i),this._class=e,this._args=i.args,null!=i.init&&(this._init=i.init),null!=i.reset&&(this._reset=i.reset),d.isIniaited)for(var t=0,s=i.amount;t<s;){t++;this._objects.push(this._create())}else d.addOnKhaInitCallback(function(){for(var e=0,t=i.amount;e<t;){e++;n._objects.push(n._create())}})};(i["gecko.utils.Pool"]=c).__name__=!0,c.prototype={_objects:null,_class:null,_args:null,_init:null,_reset:null,setInitCallback:function(e){this._init=e},setResetCallback:function(e){this._reset=e},_parseOptions:function(e){return null==e&&(e={}),e.args=null!=e.args?e.args:null,e.amount=null!=e.amount?e.amount:1,e.init=null!=e.init?e.init:null,e.reset=null!=e.reset?e.reset:null,e},_create:function(){return te.createInstance(this._class,null!=this._args?this._args:c._emptyArgs)},get:function(){var e=0<this._objects.length?this._objects.shift():this._create();return null!=this._init&&this._init(e),e},safePut:function(e){null!=e&&-1==this._objects.indexOf(e)&&(null!=this._reset&&this._reset(e),this._objects.push(e))},put:function(e){null!=e&&(null!=this._reset&&this._reset(e),this._objects.push(e))},clean:function(){this._objects=[]},length:null,get_length:function(){return this._objects.length},__class__:c,__properties__:{get_length:"get_length"}};var d=function(){};(i["gecko.Gecko"]=d).__name__=!0,d.__properties__={get_bgColor:"get_bgColor",get_currentScene:"get_currentScene"},d.getUniqueID=function(){return d._countUniqueID++},d.init=function(e,t){var i=d._parseOptions(null!=t?t:{});M.init(i.khaOptions,function(){d._init(i,e)})},d._init=function(e,t){d._opts=e,null==d.graphics&&(d.graphics=new k);var i=e.width,n=e.height;e.maximizable&&(i=window.innerWidth,n=window.innerHeight,e.resizable&&window.addEventListener("resize",d._onHtml5WindowResize)),d.resize(i,n),R.init(e.screen,e.antialiasing,i,n),es.init(e.randomSeed);var s=xe.__pool__.get();s.isAlreadyDestroyed=!1,d.timerManager=s;var r=ke.__pool__.get();r.isAlreadyDestroyed=!1,d.tweenManager=r,d._initWorld(),d.renderTicker=new Ce,d.onStop.handlers.push(Ts(Ss=d.renderTicker,Ss.clear)),d.onStop.handlers.push(V._clear),d.isIniaited=!0,d.start(),d._dispatchOnKhaInit(),t()},d.addOnKhaInitCallback=function(e){if(d.isIniaited)throw new dt("Kha init callback must be added before Gecko init.");d._onKhaInitCallbacks.push(e)},d._dispatchOnKhaInit=function(){for(var e=d._onKhaInitCallbacks.pop();null!=e;)e(),e=d._onKhaInitCallbacks.pop()},d.start=function(){if(!d.isRunning&&d.isIniaited){M.notifyOnRender(d._render),d._updateTaskId=L.addTimeTask(d._update,0,1/d._opts.fps),d.isRunning=!0;var e=d.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},d.stop=function(){if(d.isRunning&&d.isIniaited){M.removeRenderListener(d._render),L.removeTimeTask(d._updateTaskId),d.isRunning=!1;var e=d.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},d._initWorld=function(){null==d.world&&(d.world=new U),d.onUpdate.handlers.push(Ts(Ss=d.world,Ss.update)),d.onDraw.handlers.push(Ts(Ss=d.world,Ss.draw))},d.resize=function(e,t){e=e<=0?800:e,t=t<=0?600:t,M.changeResolution(e,t),d._resizeHtml5Canvas(e,t);var i=d.onWindowResize.handlers;if(0!=i.length)for(var n=0;n<i.length;){var s=i[n];++n,s(e,t)}},d._resizeHtml5Canvas=function(e,t){var i=d.getHtml5Canvas();i.width=e,i.style.width=e+"px",i.height=t,i.style.height=t+"px"},d._onHtml5WindowResize=function(){d._dirtyWindowResize=!0},d._parseOptions=function(e){var t={},i=null!=e.khaOptions?e.khaOptions:{};return t.title=null!=e.title?e.title:d.gameTitle,t.width=null!=e.width?e.width:800,t.height=null!=e.height?e.height:600,t.bgColor=null!=e.bgColor?e.bgColor:0,t.fullScreen=e.fullScreen,t.maximizable=null!=e.maximizable&&e.maximizable,t.resizable=null!=e.resizable&&e.resizable,t.fps=null!=e.fps?e.fps:60,t.useFixedDelta=null==e.useFixedDelta||e.useFixedDelta,t.screen=null!=e.screen?e.screen:{width:e.width,height:e.height,mode:E.None},null==t.screen.mode&&(t.screen.mode=E.None),null==e.randomSeed?t.randomSeed=1e3*M.get_time()|0:t.randomSeed=e.randomSeed,i.title=t.title,i.width=t.width,i.height=t.height,i.windowMode=null!=i.windowMode?i.windowMode:t.fullScreen?Et.Fullscreen:Et.Window,i.samplesPerPixel=null!=i.samplesPerPixel?i.samplesPerPixel:0!=t.antialiasing?t.antialiasing:0,i.maximizable=null!=i.maximizable?i.maximizable:t.maximizable,i.resizable=null!=i.resizable?i.resizable:t.resizable,t.khaOptions=i,t},d._safeDestroyObjects=function(){for(;0<d._destroyCallbacks.length;){d._destroyCallbacks.shift()()}},d._update=function(){d.isProcessing=!0,d._dirtyWindowResize&&(d.resize(window.innerWidth,window.innerHeight),d._dirtyWindowResize=!1),V._tick();var e=d._opts.useFixedDelta?V.fixedUnscaledDelta*V.scale:V.unscaledDelta*V.scale;d.timerManager.tick(e),d.tweenManager.tick(e);var t=d.onUpdate.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}var s=d.onSystemUpdate.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(V.unscaledDelta*V.scale)}for(d.isProcessing=!1;0<d._destroyCallbacks.length;){d._destroyCallbacks.shift()()}},d._render=function(e){d.isProcessing=!0,d.renderTicker.tick(),d.graphics.setRenderTarget(R.buffer),d.graphics.begin(null,d._opts.bgColor);var t=d.onDraw.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(d.graphics)}d.graphics.end();var s=d._opts.bgColor+-16777216;e.get_g2().begin(null,s);var r=e.get_g2(),a=r.transformations[r.transformations.length-1],o=R.matrix;for(a._00=o._00,a._10=o._10,a._20=o._20,a._01=o._01,a._11=o._11,a._21=o._21,a._02=o._02,a._12=o._12,a._22=o._22,e.get_g2().drawImage(R.buffer,0,0),e.get_g2().end(),d.isProcessing=!1;0<d._destroyCallbacks.length;){d._destroyCallbacks.shift()()}},d.getHtml5Canvas=function(){return window.document.getElementById(mt.canvas_id)},d.get_currentScene=function(){return d.world.currentScene},d.get_bgColor=function(){return d._opts.bgColor};var f=function(){this.__flagToDestroy__=!1,this.isAlreadyDestroyed=!1,this.id=d.getUniqueID()};(i["gecko.BaseObject"]=f).__name__=!0,f.create=function(){var e=f.__pool__.get();return e.isAlreadyDestroyed=!1,e},f.getPool=function(){return f.__pool__},f.prototype={id:null,beforeDestroy:function(){},isAlreadyDestroyed:null,__flagToDestroy__:null,destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),f.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),f.__pool__.safePut(this))},__class__:f};var g=function(){this._name="",this._entity=null,f.call(this);this.onAddedToEntity={handlers:[]};this.onRemovedFromEntity={handlers:[]}};(i["gecko.components.Component"]=g).__name__=!0,g.getName=function(e){return W.fromComponent(e).__componentName__},g.getBaseTypes=function(e){return W.fromComponent(e).__componentTypes__},g._toClass=function(e){return W.fromComponent(e)},g.create=function(){var e=g.__pool__.get();return e.isAlreadyDestroyed=!1,e},g.getPool=function(){return g.__pool__},g.__super__=f,g.prototype=s(f.prototype,{_entity:null,_name:null,onAddedToEntity:null,onRemovedFromEntity:null,beforeDestroy:function(){f.prototype.beforeDestroy.call(this),null!=this._entity&&this._entity.removeComponent(this.get___type__()),De.clear(this.onAddedToEntity),De.clear(this.onRemovedFromEntity)},toString:function(){return"Component: "+(""==this._name?this.get___typeName__():this._name)},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_entity:function(){return this._entity},set_entity:function(e){if(this._entity==e)return this._entity;if(null!=this._entity){var t=this.onRemovedFromEntity.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this._entity)}}if(this._entity=e,null!=this._entity){var s=this.onAddedToEntity.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(this._entity)}}return this._entity},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),g.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),g.__pool__.safePut(this))},__type__:null,__typeName__:null,get___type__:function(){return g},get___typeName__:function(){return"gecko.components.Component"},__class__:g,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name",set_entity:"set_entity",get_entity:"get_entity"}});var m=function(){g.call(this)};(i["components.OutBoundsComponent"]=m).__name__=!0,m.create=function(){var e=m.__pool__.get();return e.isAlreadyDestroyed=!1,e},m.getPool=function(){return m.__pool__},m.__super__=g,m.prototype=s(g.prototype,{get___typeName__:function(){return"components.OutBoundsComponent"},get___type__:function(){return m},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),m.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),m.__pool__.safePut(this))},__class__:m});var B=function(){this.speed=0,g.call(this)};(i["components.PlayerComponent"]=B).__name__=!0,B.create=function(e,t,i,n,s){null==s&&(s=400);var r=B.__pool__.get();return r.init(e,t,i,n,s),r.isAlreadyDestroyed=!1,r},B.getPool=function(){return B.__pool__},B.__super__=g,B.prototype=s(g.prototype,{left:null,right:null,up:null,down:null,speed:null,init:function(e,t,i,n,s){null==s&&(s=400),this.left=e,this.right=t,this.up=i,this.down=n,this.speed=s},get___typeName__:function(){return"components.PlayerComponent"},get___type__:function(){return B},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),B.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),B.__pool__.safePut(this))},__class__:B});var p=function(){};(i["gecko.IUpdatable"]=p).__name__=!0,p.prototype={update:null,__class__:p};var v=function(){this._time=0,this.speed=0,this.delay=0,g.call(this)};(i["components.ShootComponent"]=v).__name__=!0,v.__interfaces__=[p],v.create=function(e,t,i){null==i&&(i=.25),null==t&&(t=720);var n=v.__pool__.get();return n.init(e,t,i),n.isAlreadyDestroyed=!1,n},v.getPool=function(){return v.__pool__},v.__super__=g,v.prototype=s(g.prototype,{key:null,delay:null,speed:null,_time:null,init:function(e,t,i){null==i&&(i=.25),null==t&&(t=720),this.key=e,this.delay=i,this.speed=t,this._time=0},update:function(e){0<this._time&&(this._time-=e)},resetTimer:function(){this._time=this.delay},canShoot:function(){return this._time<=0},get___typeName__:function(){return"components.ShootComponent"},get___type__:function(){return v},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),v.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),v.__pool__.safePut(this))},__class__:v});var y=function(e){this.onProgressEnd={handlers:[]};this.onProgressStart={handlers:[]};this.onError={handlers:[]};this.onComplete={handlers:[]},this._task=function(){},this.loaded=0,this.len=0,this.len=e};(i["gecko.Assets"]=y).__name__=!0,y.__properties__={get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_videoFormats:"get_videoFormats",get_imageFormats:"get_imageFormats"},y._parseAssetName=function(e,t){null==t&&(t=!1),e=t?e:Qe.withoutExtension(e),e=null!=N.parseInt(e.charAt(0))?"_"+e:e;var i=new RegExp("[/\\.-\\s]","gi".split("u").join(""));return Qe.normalize(e).replace(i,"_")},y._existsAssetsName=function(e,t){return-1!=K.field(_t,t).names.indexOf(e)},y.load=function(t,e,i){var s=new y(t.length);return null!=e&&s.onComplete.handlers.push(e),null!=i&&s.onError.handlers.push(i),s.setTask(function(){var e=s.observProgress(y._loadAsset);Ae.eachSeries_String(t,e,function(e){if(null!=e){Re.trace("Error: "+e,{fileName:"Assets.hx",lineNumber:54,className:"gecko.Assets",methodName:"load"});var t=s.onError.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}}})}),s},y._loadAsset=function(e,t){var i=Qe.extension(e),n=i;if(0<=y._imageExtensions.indexOf(n))y.loadImage(e,t);else{var s=i;if(0<=y._videoExtensions.indexOf(s))y.loadVideo(e,t);else{var r=i;if(0<=y._fontExtensions.indexOf(r))y.loadFont(e,t);else{var a=i;0<=y._soundExtensions.indexOf(a)?y.loadSound(e,t):"json"==i?y.loadJson(e,t):y.loadBlob(e,t)}}}},y.loadJson=function(l,h){var e=y._parseAssetName(l,!0);-1!=K.field(_t,"blobs").names.indexOf(e)?_t.loadBlob(e,function(e){var t,i,n=y.json,s=JSON.parse(e.toString());null!=Ns[l]?n.setReserved(l,s):n.h[l]=s;var r=y.json;if(null!=(null!=Ns[l]?r.getReserved(l):r.h[l]).frames){var a=y.json;i=null!=(null!=Ns[l]?a.getReserved(l):a.h[l]).meta}else i=!1;if(i){var o=y.json;t=null!=(null!=Ns[l]?o.getReserved(l):o.h[l]).meta.image}else t=!1;if(t){var _=JSON.parse(e.toString());y.loadImage(_.meta.image,function(e){if(null==e){for(var t=0,i=K.fields(_.frames);t<i.length;){var n=i[t];++t;var s=y.textures,r=_.meta.image,a=y.images,o=de.fromTexturePacker(null!=Ns[r]?a.getReserved(r):a.h[r],K.field(_.frames,n)),l=s;null!=Ns[n]?l.setReserved(n,o):l.h[n]=o}h()}else h(e)})}else h()},null,{fileName:"Assets.hx",lineNumber:87,className:"gecko.Assets",methodName:"loadJson"}):h("Invalid asset name: "+l)},y.loadImage=function(r,a){var e=y._parseAssetName(r);-1!=K.field(_t,"images").names.indexOf(e)?_t.loadImage(e,function(e){var t=y.images;null!=Ns[r]?t.setReserved(r,e):t.h[r]=e;var i=y.textures,n=new de(e),s=i;null!=Ns[r]?s.setReserved(r,n):s.h[r]=n,a()},null,{fileName:"Assets.hx",lineNumber:114,className:"gecko.Assets",methodName:"loadImage"}):a("Invalid asset name: "+r)},y.loadVideo=function(i,n){var e=y._parseAssetName(i);-1!=K.field(_t,"videos").names.indexOf(e)?_t.loadVideo(e,function(e){var t=y.videos;null!=Ns[i]?t.setReserved(i,e):t.h[i]=e,n()},null,{fileName:"Assets.hx",lineNumber:127,className:"gecko.Assets",methodName:"loadVideo"}):n("Invalid asset name: "+i)},y.loadBlob=function(i,n){var e=y._parseAssetName(i,!0);-1!=K.field(_t,"blobs").names.indexOf(e)?_t.loadBlob(e,function(e){var t=y.blobs;null!=Ns[i]?t.setReserved(i,e):t.h[i]=e,n()},null,{fileName:"Assets.hx",lineNumber:139,className:"gecko.Assets",methodName:"loadBlob"}):n("Invalid asset name: "+i)},y.loadSound=function(i,n){var e=y._parseAssetName(i);-1!=K.field(_t,"sounds").names.indexOf(e)?_t.loadSound(e,function(t){t.uncompress(function(){var e=y.sounds;null!=Ns[i]?e.setReserved(i,t):e.h[i]=t,n()})},null,{fileName:"Assets.hx",lineNumber:151,className:"gecko.Assets",methodName:"loadSound"}):n("Invalid asset name: "+i)},y.loadFont=function(i,n){var e=y._parseAssetName(i);-1!=K.field(_t,"fonts").names.indexOf(e)?_t.loadFont(e,function(e){var t=y.fonts;null!=Ns[i]?t.setReserved(i,e):t.h[i]=e,n()},null,{fileName:"Assets.hx",lineNumber:165,className:"gecko.Assets",methodName:"loadFont"}):n("Invalid asset name: "+i)},y.unload=function(t,e,i){var n=new y(t.length);return null!=e&&n.onComplete.handlers.push(e),null!=i&&n.onError.handlers.push(i),n.setTask(function(){var e=n.observProgress(y._unloadAsset);Ae.eachSeries_String(t,e,function(e){Re.trace(e,{fileName:"Assets.hx",lineNumber:187,className:"gecko.Assets",methodName:"unload"})})}),n},y._unloadAsset=function(e,t){var i=Qe.extension(e),n=i;if(0<=y._imageExtensions.indexOf(n))y.unloadImage(e,t);else{var s=i;if(0<=y._videoExtensions.indexOf(s))y.unloadVideo(e,t);else{var r=i;if(0<=y._fontExtensions.indexOf(r))y.unloadFont(e,t);else{var a=i;0<=y._soundExtensions.indexOf(a)?y.unloadSound(e,t):y.unloadBlob(e,t)}}}},y.unloadImage=function(e,t){var i=y.textures,n=null!=Ns[e]?i.getReserved(e):i.h[e];null!=n&&(n.unload(),y.textures.remove(e));var s=y.images;(null!=Ns[e]?s.getReserved(e):s.h[e]).unload(),y.images.remove(e),t()},y.unloadVideo=function(e,t){var i=y.videos;(null!=Ns[e]?i.getReserved(e):i.h[e]).unload(),y.videos.remove(e),t()},y.unloadFont=function(e,t){var i=y.fonts;(null!=Ns[e]?i.getReserved(e):i.h[e]).unload(),y.fonts.remove(e),t()},y.unloadSound=function(e,t){var i=y.sounds;(null!=Ns[e]?i.getReserved(e):i.h[e]).unload(),y.sounds.remove(e),t()},y.unloadBlob=function(e,t){var i=y.blobs;(null!=Ns[e]?i.getReserved(e):i.h[e]).unload(),y.blobs.remove(e),t()},y.unloadJson=function(e,t){y.json.remove(e),t()},y.get_imageFormats=function(){return _t.get_imageFormats()},y.get_videoFormats=function(){return _t.get_videoFormats()},y.get_soundFormats=function(){return _t.get_soundFormats()},y.get_fontFormats=function(){return _t.get_fontFormats()},y.prototype={progress:null,len:null,loaded:null,_task:null,onComplete:null,onError:null,onProgressStart:null,onProgressEnd:null,start:function(){return this._task(),this},setTask:function(e){this._task=e},observProgress:function(n){var c=this;return function(h,u){var e=c.onProgressStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(c.get_progress(),h)}n(h,function(e){if(null==e){c.loaded+=1;var t=c.onProgressEnd.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(c.get_progress(),h)}if(0!=c.len&&c.len==c.loaded){var s=c.onComplete.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a()}}u()}else{var o=c.onError.handlers;if(0!=o.length)for(var l=0;l<o.length;){var _=o[l];++l,_(e)}u(e)}})}},get_progress:function(){return 0|Math.ceil(100/(this.len/this.loaded))},__class__:y,__properties__:{get_progress:"get_progress"}};var b=function(){this.destroyOnEnd=!1,this._lastLoop=!1,this._volume=1,this.isPaused=!1,this.isPlaying=!1,this._soundName="",f.call(this);this.onFinish={handlers:[]};this.onPlay={handlers:[]};this.onStop={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.Audio"]=b).__name__=!0,b.createFromSound=function(e){var t=new b;return t.set_sound(e),t},b.create=function(e){var t=b.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},b.getPool=function(){return b.__pool__},b.__super__=f,b.prototype=s(f.prototype,{onFinish:null,onPlay:null,onStop:null,onPause:null,onResume:null,_sound:null,_soundName:null,isPlaying:null,isPaused:null,position:null,length:null,_volume:null,_channel:null,_lastLoop:null,destroyOnEnd:null,init:function(e){this.set_soundName(e)},play:function(e){if(null==e&&(e=!1),!this.isPlaying){null!=this._channel&&e==this._lastLoop?this._channel.play():this._channel=zt.play(this._sound,e),this._channel.set_volume(this._volume),this._lastLoop=e,this.isPlaying=!0,d.onSystemUpdate.handlers.push(Ts(this,this.update));var t=this.onPlay.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n()}}},stop:function(){if(!this.isPlaying){this._channel.stop(),this.isPlaying=!1,$.remove(d.onSystemUpdate.handlers,Ts(this,this.update));var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},pause:function(){if(this.isPlaying||!this.isPaused){this._channel.pause(),this.isPaused=!0,$.remove(d.onSystemUpdate.handlers,Ts(this,this.update));var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},resume:function(){if(!this.isPlaying&&this.isPaused){this._channel.play(),this.isPaused=!1,d.onSystemUpdate.handlers.push(Ts(this,this.update));var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},update:function(e){this.isPlaying&&this._channel.get_finished()&&this._finish()},_finish:function(){this._channel.stop(),this.isPlaying=!1,$.remove(d.onSystemUpdate.handlers,Ts(this,this.update));var e=this.onFinish.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}this.destroyOnEnd&&this.destroy()},clone:function(){if(null!=this._soundName){var e=this._soundName,t=b.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t}return b.createFromSound(this._sound)},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.isPlaying=!1,this.isPaused=!1,De.clear(this.onFinish),De.clear(this.onPlay),De.clear(this.onStop),De.clear(this.onPause),De.clear(this.onResume),this._channel=null,this._lastLoop=!1,this.destroyOnEnd=!1,this._soundName="",this._sound=null,this._volume=1},get_soundName:function(){return this._soundName},set_soundName:function(e){if(e==this._soundName)return this._soundName;var t=y.sounds,i=null!=Ns[e]?t.getReserved(e):t.h[e];if(null==i)throw new dt("Sound "+e+" not found...");return this.set_sound(i),this._soundName=e},get_sound:function(){return this._sound},set_sound:function(e){return this._channel=zt.play(e),this._channel.stop(),this._sound=e},get_position:function(){return null!=this._channel?this._channel.get_position():0},get_length:function(){return null!=this._channel?this._channel.get_length():0},get_volume:function(){return this._volume},set_volume:function(e){return e==this._volume?this._volume:null!=this._channel?this._channel.set_volume(e):this._volume=e},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),b.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),b.__pool__.safePut(this))},__class__:b,__properties__:{set_volume:"set_volume",get_volume:"get_volume",get_length:"get_length",get_position:"get_position",set_soundName:"set_soundName",get_soundName:"get_soundName",set_sound:"set_sound",get_sound:"get_sound"}});var w=function(){this._shakeAxisY=!0,this._shakeAxisX=!0,this._shakeIntensity=0,this._shakeDuration=0,this.style=x.LOCKON,this.deadzone=null,this.bounds=null,this._wasChanged=!0,this._dirty=!0,this.bgColor=null,this.height=0,this.width=0,this.y=0,this.x=0,this._matrix=new D(1,0,0,0,1,0,0,0,1),this._zoom=1,this._scene=null,f.call(this),this._containerTransform=new G(null),this._transform=new G(null);this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]};this.onShakeEnd={handlers:[]}};(i["gecko.Camera"]=w).__name__=!0,w.__interfaces__=[p],w.create=function(e,t,i,n,s){null==n&&(n=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var r=w.__pool__.get();return r.init(e,t,i,n,s),r.isAlreadyDestroyed=!1,r},w.getPool=function(){return w.__pool__},w.__super__=f,w.prototype=s(f.prototype,{_scene:null,_transform:null,_containerTransform:null,lookAt:null,followLerp:null,_zoom:null,matrix:null,_matrix:null,buffer:null,x:null,y:null,width:null,height:null,bgColor:null,target:null,_dirty:null,_wasChanged:null,bounds:null,deadzone:null,style:null,_shakeDuration:null,_shakeIntensity:null,_shakeAxisX:null,_shakeAxisY:null,onAddedToScene:null,onRemovedFromScene:null,onShakeEnd:null,init:function(e,t,i,n,s){null==n&&(n=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.bgColor=s,this.resize(0==i?(0|R.buffer.get_width())-e:i,0==n?(0|R.buffer.get_height())-t:n),this._containerTransform.get_anchor().set(.5,.5),this._containerTransform.get_pivot().set(.5,.5),this._containerTransform.get_size().set(this.width,this.height),this._containerTransform.get_position().set(this.width/2,this.height/2);var r=oe.__pool__.get();r.init(0,0),r.isAlreadyDestroyed=!1,this.lookAt=r,this.lookAt.setObserver(Ts(this,this._onSetLookAt)),this.lookAt.set(this.width/2,this.height/2);var a=oe.__pool__.get();a.init(1,1),a.isAlreadyDestroyed=!1,this.followLerp=a,this._dirty=!0},_onSetPoint:function(e){this._dirty=!0},shake:function(e,t,i,n){null==n&&(n=!0),null==i&&(i=!0),null==t&&(t=.5),null==e&&(e=.02),this._shakeIntensity=e,this._shakeDuration=t,this._shakeAxisX=i,this._shakeAxisY=n},update:function(e){if(null!=this.target){var t=this.target.transform.get_position();if(null!=this.deadzone){var i=this.width/2,n=this.height/2,s=this.lookAt._x,r=this.lookAt._y,a=this.lookAt._x-i+this.deadzone.x-t._x;if(0<a){var o=this.followLerp._x;s=(1-o)*this.lookAt._x+o*(this.lookAt._x-a)}else{var l=this.deadzone;if((a=this.lookAt._x-i+(l.x+l.width)-t._x)<0){var _=this.followLerp._x;s=(1-_)*this.lookAt._x+_*(this.lookAt._x-a)}}if(0<(a=this.lookAt._y-n+this.deadzone.y-t._y)){var h=this.followLerp._y;r=(1-h)*this.lookAt._y+h*(this.lookAt._y-a)}else{var u=this.deadzone;if((a=this.lookAt._y-n+(u.y+u.height)-t._y)<0){var c=this.followLerp._y;r=(1-c)*this.lookAt._y+c*(this.lookAt._y-a)}}this.lookAt.set(s,r)}else{var d=this.followLerp._x,f=this.followLerp._y;this.lookAt.set((1-d)*this.lookAt._x+d*t._x,(1-f)*this.lookAt._y+f*t._y)}}if(null!=this.bounds){var g=this.width/this._containerTransform.get_scale()._x/2,m=this.height/this._containerTransform.get_scale()._y/2,p=this.lookAt._x-g,v=this.lookAt._x+g,y=this.lookAt._y-m,b=this.lookAt._y+m;if(p<this.bounds.x)this.lookAt.set_x(this.bounds.x+g);else{var w=this.bounds;if(v>w.x+w.width){var x=this.bounds;this.lookAt.set_x(x.x+x.width-g)}}if(y<this.bounds.y)this.lookAt.set_y(this.bounds.y+m);else{var S=this.bounds;if(b>S.y+S.height){var B=this.bounds;this.lookAt.set_y(B.y+B.height-m)}}}if(0<this._shakeDuration){var T=this.lookAt._x,k=this.lookAt._y;if(this._shakeAxisX){var I=this.width*this._shakeIntensity;T+=es.getFloatIn(-I,I)*this._containerTransform.get_scale()._x}if(this._shakeAxisX){var A=this.height*this._shakeIntensity;k+=es.getFloatIn(-A,A)*this._containerTransform.get_scale()._y}if(this._transform.get_position().set(-T+this.width/2,-k+this.height/2),this._shakeDuration-=e,this._shakeDuration<=0){this._transform.get_position().set(-this.lookAt._x+this.width/2,-this.lookAt._y+this.height/2);var D=this.onShakeEnd.handlers;if(0!=D.length)for(var C=0;C<D.length;){var P=D[C];++C,P(this)}}this._dirty=!0}},preDraw:function(e){},postDraw:function(e){},lookAtEntity:function(e){var t=this.lookAt,i=e.transform.get_position();t.set(i._x,i._y)},follow:function(e,t,i,n){null==n&&(n=1),null==i&&(i=1),this.target=e;var s=this.lookAt,r=this.target.transform.get_position();switch(s.set(r._x,r._y),this.followLerp.set(i,n),this.style=null!=t?t:x.LOCKON,this.style[1]){case 0:this.deadzone=null;break;case 1:var a=this.width/8,o=this.height/3,l=(this.width-a)/2,_=(this.height-o)/2-.25*o,h=le.__pool__.get();h.init(l,_,a,o),h.isAlreadyDestroyed=!1,this.deadzone=h;break;case 2:var u=Math.max(this.width,this.height)/4,c=(this.width-u)/2,d=(this.height-u)/2,f=le.__pool__.get();f.init(c,d,u,u),f.isAlreadyDestroyed=!1,this.deadzone=f;break;case 3:var g=Math.max(this.width,this.height)/8,m=(this.width-g)/2,p=(this.height-g)/2,v=le.__pool__.get();v.init(m,p,g,g),v.isAlreadyDestroyed=!1,this.deadzone=v}},unfollow:function(){this.target=null},resize:function(e,t){this.width=e,this.height=t,null!=this.buffer&&this.buffer.unload();var i=d._opts.antialiasing;this.buffer=ct.createRenderTarget(e,t,null,null,i)},containsScreenPoint:function(e){return e._x>=this.x&&e._x<=this.x+this.width&&(e._y>=this.y&&e._y<=this.y+this.height)},updateMatrix:function(){if(this._dirty){var e=this._matrix,t=this._transform.get_localMatrix(),i=this._containerTransform.get_worldMatrix();e._00=t._00*i._00+t._01*i._10,e._01=t._00*i._01+t._01*i._11,e._10=t._10*i._00+t._11*i._10,e._11=t._10*i._01+t._11*i._11,e._20=t._20*i._00+t._21*i._10+i._20,e._21=t._20*i._01+t._21*i._11+i._21,this._dirty=!1,this._wasChanged=!0}},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),null!=this._scene&&this._scene.removeCamera(this),this.buffer.unload(),this.buffer=null,this.target=null,this.lookAt.destroy(),this.lookAt=null,this.followLerp.destroy(),(this.followLerp=null)!=this.bounds&&(this.bounds.destroy(),this.bounds=null),null!=this.deadzone&&(this.deadzone.destroy(),this.deadzone=null),this.x=0,this.y=0,this.width=0,this.height=0,this.bgColor=0,this._zoom=1,this._dirty=!0,this._wasChanged=!0,De.clear(this.onAddedToScene),De.clear(this.onRemovedFromScene),De.clear(this.onShakeEnd),this._containerTransform._reset(),this._transform._reset()},_onSetLookAt:function(e){this._transform.get_position().set(-e._x+this.width/2,-e._y+this.height/2),this._dirty=!0},get_zoom:function(){return this._zoom},set_zoom:function(e){return this._dirty=!0,this._containerTransform.get_scale().set(e,e),this._zoom=e},get_matrix:function(){return this._dirty&&this.updateMatrix(),this._matrix},get_rotation:function(){return this._containerTransform.get_rotation()},set_rotation:function(e){return this._dirty=!0,this._containerTransform.set_rotation(e)},get_wasChanged:function(){return this._dirty&&this.updateMatrix(),this._wasChanged},set_wasChanged:function(e){return this._wasChanged=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;if(null!=this._scene){var t=this.onRemovedFromScene.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this,this._scene)}}if(this._scene=e,null!=this._scene){var s=this.onAddedToScene.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(this,this._scene)}}return this._scene},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),w.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),w.__pool__.safePut(this))},__class__:w,__properties__:{set_wasChanged:"set_wasChanged",get_wasChanged:"get_wasChanged",get_matrix:"get_matrix",set_zoom:"set_zoom",get_zoom:"get_zoom",set_rotation:"set_rotation",get_rotation:"get_rotation",set_scene:"set_scene",get_scene:"get_scene"}});var x=i["gecko.CameraStyle"]={__ename__:!0,__constructs__:["LOCKON","PLATFORMER","TOPDOWN","TOPDOWN_TIGHT"]};x.LOCKON=["LOCKON",0],x.LOCKON.toString=n,(x.LOCKON.__enum__=x).PLATFORMER=["PLATFORMER",1],x.PLATFORMER.toString=n,(x.PLATFORMER.__enum__=x).TOPDOWN=["TOPDOWN",2],x.TOPDOWN.toString=n,(x.TOPDOWN.__enum__=x).TOPDOWN_TIGHT=["TOPDOWN_TIGHT",3],x.TOPDOWN_TIGHT.toString=n,x.TOPDOWN_TIGHT.__enum__=x;var S={};(i["gecko._Color.Color_Impl_"]=S).__name__=!0,S.__properties__={set_BlueValue:"set_BlueValue",get_BlueValue:"get_BlueValue",set_GreenValue:"set_GreenValue",get_GreenValue:"get_GreenValue",set_RedValue:"set_RedValue",get_RedValue:"get_RedValue",set_BlueByte:"set_BlueByte",get_BlueByte:"get_BlueByte",set_GreenByte:"set_GreenByte",get_GreenByte:"get_GreenByte",set_RedByte:"set_RedByte",get_RedByte:"get_RedByte"},S._new=function(e){return e},S.fromValue=function(e){return S._new(e)},S.fromBytes=function(e,t,i){return e<<16|t<<8|i},S.fromFloats=function(e,t,i){return(255*e|0)<<16|(255*t|0)<<8|255*i|0},S.random=function(){return es.getUpTo(255)<<16|es.getUpTo(255)<<8|es.getUpTo(255)},S.fromString=function(e){if(7==e.length&&35==e.charCodeAt(0)){var t=N.parseInt("0x"+$.substr(e,1,null));return S._new(t)}throw new dt("Invalid Color string: '"+e+"'")},S.toARGB=function(e){return e+-16777216},S.get_RedByte=function(e){return(16711680&e)>>>16},S.set_RedByte=function(e,t){return e=t<<16|(65280&e)>>>8<<8|255&e,t},S.get_GreenByte=function(e){return(65280&e)>>>8},S.set_GreenByte=function(e,t){return e=(16711680&e)>>>16<<16|t<<8|255&e,t},S.get_BlueByte=function(e){return 255&e},S.set_BlueByte=function(e,t){return e=(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},S.get_RedValue=function(e){return.00392156862745098*((16711680&e)>>>16)},S.set_RedValue=function(e,t){return e=(255*t|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t},S.get_GreenValue=function(e){return.00392156862745098*((65280&e)>>>8)},S.set_GreenValue=function(e,t){return e=(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(255*t|0)<<8|.00392156862745098*(255&e)*255|0,t},S.get_BlueValue=function(e){return.00392156862745098*(255&e)},S.set_BlueValue=function(e,t){return e=(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|255*t|0,t};var T=function(){this._componentTypes=new Ii,this._componentsList=[],this._components=new Ii,this._renderer=null,this._tags=new Ii,this._name="",this.enabled=!0,this._isRoot=!1,f.call(this),this.transform=new G(this);this.onComponentAdded={handlers:[]};this.onComponentRemoved={handlers:[]};this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]}};(i["gecko.Entity"]=T).__name__=!0,T.create=function(){var e=T.__pool__.get();return e.isAlreadyDestroyed=!1,e},T.getPool=function(){return T.__pool__},T.__super__=f,T.prototype=s(f.prototype,{_isRoot:null,enabled:null,_name:null,_scene:null,_tags:null,transform:null,_renderer:null,_components:null,_componentsList:null,_componentTypes:null,onComponentAdded:null,onComponentRemoved:null,onAddedToScene:null,onRemovedFromScene:null,beforeDestroy:function(){f.prototype.beforeDestroy.call(this),null!=this._scene&&this._scene.removeEntity(this),this.transform._reset();for(var e=this._components.keys();e.hasNext();){var t=e.next(),i=this._components,n=null!=Ns[t]?i.getReserved(t):i.h[t];this._removeComponent(n,!0)}this.removeAllTags(),this._isRoot=!1,De.clear(this.onComponentAdded),De.clear(this.onComponentRemoved),De.clear(this.onAddedToScene),De.clear(this.onRemovedFromScene)},getDrawComponent:function(){return this._renderer},hasDrawComponent:function(){return null!=this._renderer},addTag:function(e){var t=this._tags;null!=Ns[e]?t.setReserved(e,!0):t.h[e]=!0},removeTag:function(e){this._tags.remove(e)},hasTag:function(e){var t=this._tags;return null!=Ns[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeAllTags:function(){for(var e=this._tags.keys();e.hasNext();){var t=e.next();this._tags.remove(t)}},hasComponentOfType:function(e){var t=this._componentTypes,i=W.fromComponent(e).__componentName__,n=t;return null!=Ns[i]?n.existsReserved(i):n.h.hasOwnProperty(i)},getComponentsOfType:function(e){var t=this._componentTypes,i=W.fromComponent(e).__componentName__,n=t;return null!=Ns[i]?n.getReserved(i):n.h[i]},addComponent:function(e){e.set_entity(this),Ai.__instanceof(e,Z)&&(null!=this._renderer&&this.removeComponent(this._renderer.get___type__()),this._renderer=e);var t=this._components,i=e.get___typeName__(),n=t;null!=Ns[i]?n.setReserved(i,e):n.h[i]=e,this._componentsList.push(e);var s=W.fromComponent(e.get___type__()).__componentTypes__;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r;var o=this._componentTypes;if(null!=Ns[a]?o.existsReserved(a):o.h.hasOwnProperty(a)){var l=this._componentTypes;(null!=Ns[a]?l.getReserved(a):l.h[a]).push(e)}else{var _=this._componentTypes,h=[e];null!=Ns[a]?_.setReserved(a,h):_.h[a]=h}}var u=this.onComponentAdded.handlers;if(0!=u.length)for(var c=0;c<u.length;){var d=u[c];++c,d(this,e)}return e},removeComponent:function(e,t){null==t&&(t=!1);var i=this._components,n=W.fromComponent(e).__componentName__,s=i,r=null!=Ns[n]?s.getReserved(n):s.h[n];return null!=r?(this._removeComponent(r,t),t?null:r):null},_removeComponent:function(e,t){null==t&&(t=!1),this._components.remove(e.get___typeName__()),$.remove(this._componentsList,e),null!=this._renderer&&e.get___type__()==this._renderer.get___type__()&&(this._renderer=null);var i=W.fromComponent(e.get___type__()).__componentTypes__;if(0!=i.length)for(var n=0;n<i.length;){var s=i[n];++n;var r=this._componentTypes,a=null!=Ns[s]?r.getReserved(s):r.h[s];$.remove(a,e),0==a.length&&this._componentTypes.remove(s)}e.set_entity(null);var o=this.onComponentRemoved.handlers;if(0!=o.length)for(var l=0;l<o.length;){var _=o[l];++l,_(this,e)}t&&e.destroy()},removeAllComponents:function(e){null==e&&(e=!1);for(var t=this._components,i=new We(t,t.arrayKeys());i.hasNext();){var n=i.next();this.removeComponent(n.get___type__(),e)}},getAllComponents:function(){return this._componentsList},getComponent:function(e){return this._components.h[W.fromComponent(e).__componentName__]},hasComponent:function(e){var t=this._components.h,i=W.fromComponent(e).__componentName__;return t.hasOwnProperty(i)},toString:function(){return"Entity: id -> "+this.id+", components -> "+N.string(this._componentsList.map(function(e){return""==e._name?e.get___typeName__():e._name}))},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;var t=this._scene;if(this._scene=e,null!=t){var i=this.onRemovedFromScene.handlers;if(0!=i.length)for(var n=0;n<i.length;){var s=i[n];++n,s(this,t)}}if(null!=this._scene){var r=this.onAddedToScene.handlers;if(0!=r.length)for(var a=0;a<r.length;){var o=r[a];++a,o(this,this._scene)}}return this._scene},get_isRoot:function(){return this._isRoot},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),T.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),T.__pool__.safePut(this))},__type__:null,__typeName__:null,get___type__:function(){return T},get___typeName__:function(){return"gecko.Entity"},__class__:T,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_scene:"set_scene",get_scene:"get_scene",set_name:"set_name",get_name:"get_name",get_isRoot:"get_isRoot"}});var D=function(e,t,i,n,s,r,a,o,l){this._00=e,this._10=t,this._20=i,this._01=n,this._11=s,this._21=r,this._02=a,this._12=o,this._22=l};(i["kha.math.FastMatrix3"]=D).__name__=!0,D.fromMatrix3=function(e){return new D(e._00,e._10,e._20,e._01,e._11,e._21,e._02,e._12,e._22)},D.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:D};var k=function(){this._fontSize=1,this._alpha=1,this._color=16777215};(i["gecko.Graphics"]=k).__name__=!0,k._pointsToVec2=function(e){for(var t=[],i=0;i<e.length;){var n=e[i];++i,t.push(n._vec2)}return t},k.prototype={buffer:null,isRendering:null,g2:null,g4:null,_g2Cache:null,_g4Cache:null,_color:null,_alpha:null,_font:null,_fontSize:null,_blendMode:null,_blendPipeline:null,_swtTemp:null,_shtTemp:null,_dwTemp:null,_dhTemp:null,_temp1:null,_temp2:null,_temp3:null,_temp4:null,_temp5:null,_temp6:null,setRenderTarget:function(e){if(this.isRendering)throw d.stop(),new dt("You can't change the buffer while rendering");this.buffer=e},beginRenderTarget:function(e){this.g2.end(),this._g2Cache=this.g2,this._g4Cache=this.g4,this.g2=e.get_g2(),this.g4=e.get_g4(),this.g2.begin(!1)},endRenderTarget:function(){this.g2.end(),this.g2=this._g2Cache,this.g4=this._g4Cache,this._g2Cache=null,this._g4Cache=null,this.g2.begin()},begin:function(e,t){null==e&&(e=!0),this.isRendering=!0,this.buffer.get_g2().begin(e,t+-16777216)},end:function(){this.buffer.get_g2().end(),this.isRendering=!1},clear:function(e){this.buffer.get_g2().clear(e+-16777216)},reset:function(){this.buffer.get_g2().set_color(-1),this._color=16777215,this.buffer.get_g2().set_opacity(1),this._alpha=1;var e=k.emptyMatrix,t=this.buffer.get_g2(),i=t.transformations[t.transformations.length-1];i._00=e._00,i._10=e._10,i._20=e._20,i._01=e._01,i._11=e._11,i._21=e._21,i._02=e._02,i._12=e._12,i._22=e._22;this.buffer.get_g2()},apply:function(e,t,i){this.buffer.get_g2().set_color(t+-16777216),this._color=t,this.buffer.get_g2().set_opacity(i),this._alpha=i;var n=this.buffer.get_g2(),s=n.transformations[n.transformations.length-1];s._00=e._00,s._10=e._10,s._20=e._20,s._01=e._01,s._11=e._11,s._21=e._21,s._02=e._02,s._12=e._12,s._22=e._22;this.buffer.get_g2()},drawLine:function(e,t,i,n,s){this.buffer.get_g2().drawLine(e,t,i,n,s)},drawImage:function(e,t,i){this.buffer.get_g2().drawImage(e,t,i)},drawTexture:function(e,t,i){if(e.rotated){this._swtTemp=e.frame.width*e.pivot._x,this._shtTemp=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new D(1,0,-this._swtTemp,0,1,-this._shtTemp,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var n=this.buffer.get_g2();n.transformations[n.transformations.length-1]._20+=this._shtTemp;var s=this.buffer.get_g2();s.transformations[s.transformations.length-1]._21+=this._swtTemp,null!=e.trim?this.buffer.get_g2().drawSubImage(e.image,t-e.trim.x,i+e.trim.y,e.frame.x,e.frame.y,e.trim.width,e.trim.height):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x,e.frame.y,e.frame.width,e.frame.height),this.buffer.get_g2().popTransformation()}else null!=e.trim?this.buffer.get_g2().drawSubImage(e.image,t+e.trim.x,i+e.trim.y,e.frame.x,e.frame.y,e.trim.width,e.trim.height):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x,e.frame.y,e.frame.width,e.frame.height)},drawSubImage:function(e,t,i,n,s,r,a){this.buffer.get_g2().drawSubImage(e,t,i,n,s,r,a)},_drawSubTextureRotated:function(e,t,i,n,s,r,a){this._temp3=e.frame.width*e.pivot._x,this._temp4=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new D(1,0,-this._temp3,0,1,-this._temp4,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var o=this.buffer.get_g2();o.transformations[o.transformations.length-1]._20+=this._temp4;var l=this.buffer.get_g2();l.transformations[l.transformations.length-1]._21+=this._temp3,null!=e.trim?(this._swtTemp=n>e.trim.x?n-e.trim.x:0,this._temp1=e.trim.x-n,this._temp1=this._temp1<0?0:this._temp1,this._shtTemp=s>e.trim.y?s-e.trim.y:0,this._temp2=e.trim.y-s,this._temp2=this._temp2<0?0:this._temp2,this._temp5=r-this._temp1,this._temp5=this._temp5>e.trim.width?e.trim.width:this._temp5,this._temp6=a-this._temp2,this._temp6=this._temp6>e.trim.height?e.trim.height:this._temp6,this.buffer.get_g2().drawSubImage(e.image,t-(this._temp2<0?0:this._temp2),i+(this._temp1<0?0:this._temp1),e.frame.x-this._shtTemp,e.frame.y+this._swtTemp,this._temp6,this._temp5)):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x-s,e.frame.y+n,a,r),this.buffer.get_g2().popTransformation()},_drawSubTexture:function(e,t,i,n,s,r,a){null!=e.trim?(this._swtTemp=n>e.trim.x?n-e.trim.x:0,this._shtTemp=s>e.trim.y?s-e.trim.y:0,this._temp1=e.trim.x-n,this._temp1=this._temp1<0?0:this._temp1,this._temp2=e.trim.y-s,this._temp2=this._temp2<0?0:this._temp2,this._temp3=r-this._temp1,this._temp3=this._temp3>e.trim.width?e.trim.width:this._temp3,this._temp4=a-this._temp2,this._temp4=this._temp4>e.trim.height?e.trim.height:this._temp4,this.buffer.get_g2().drawSubImage(e.image,t+this._temp1,i+this._temp2,e.frame.x+this._swtTemp,e.frame.y+this._shtTemp,this._temp3,this._temp4)):(this._swtTemp=e.frame.width-n,this._shtTemp=e.frame.height-s,this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x+n,e.frame.y+s,r>this._swtTemp?this._swtTemp:r,a>this._shtTemp?this._shtTemp:a))},drawSubTexture:function(e,t,i,n,s,r,a){if(e.rotated){this._temp3=e.frame.width*e.pivot._x,this._temp4=e.frame.height*e.pivot._y,this.buffer.get_g2().pushTransformation(new D(1,0,-this._temp3,0,1,-this._temp4,0,0,1)),this.buffer.get_g2().rotate(-.5*Math.PI,t,i);var o=this.buffer.get_g2();o.transformations[o.transformations.length-1]._20+=this._temp4;var l=this.buffer.get_g2();l.transformations[l.transformations.length-1]._21+=this._temp3,null!=e.trim?(this._swtTemp=n>e.trim.x?n-e.trim.x:0,this._temp1=e.trim.x-n,this._temp1=this._temp1<0?0:this._temp1,this._shtTemp=s>e.trim.y?s-e.trim.y:0,this._temp2=e.trim.y-s,this._temp2=this._temp2<0?0:this._temp2,this._temp5=r-this._temp1,this._temp5=this._temp5>e.trim.width?e.trim.width:this._temp5,this._temp6=a-this._temp2,this._temp6=this._temp6>e.trim.height?e.trim.height:this._temp6,this.buffer.get_g2().drawSubImage(e.image,t-(this._temp2<0?0:this._temp2),i+(this._temp1<0?0:this._temp1),e.frame.x-this._shtTemp,e.frame.y+this._swtTemp,this._temp6,this._temp5)):this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x-s,e.frame.y+n,a,r),this.buffer.get_g2().popTransformation()}else null!=e.trim?(this._swtTemp=n>e.trim.x?n-e.trim.x:0,this._shtTemp=s>e.trim.y?s-e.trim.y:0,this._temp1=e.trim.x-n,this._temp1=this._temp1<0?0:this._temp1,this._temp2=e.trim.y-s,this._temp2=this._temp2<0?0:this._temp2,this._temp3=r-this._temp1,this._temp3=this._temp3>e.trim.width?e.trim.width:this._temp3,this._temp4=a-this._temp2,this._temp4=this._temp4>e.trim.height?e.trim.height:this._temp4,this.buffer.get_g2().drawSubImage(e.image,t+this._temp1,i+this._temp2,e.frame.x+this._swtTemp,e.frame.y+this._shtTemp,this._temp3,this._temp4)):(this._swtTemp=e.frame.width-n,this._shtTemp=e.frame.height-s,this.buffer.get_g2().drawSubImage(e.image,t,i,e.frame.x+n,e.frame.y+s,r>this._swtTemp?this._swtTemp:r,a>this._shtTemp?this._shtTemp:a))},drawScaledImage:function(e,t,i,n,s){this.buffer.get_g2().drawScaledImage(e,t,i,n,s)},drawScaledTexture:function(e,t,i,n,s){null!=e.trim?this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x-e.trim.x,e.frame.y-e.trim.y,e.trim.width+e.trim.x,e.trim.height+e.trim.y,t,i,n-e.trim.x,s-e.trim.y):this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x,e.frame.y,e.frame.width,e.frame.height,e.frame.x+t,e.frame.y+i,n,s)},drawScaledSubImage:function(e,t,i,n,s,r,a,o,l){this.buffer.get_g2().drawScaledSubImage(e,t,i,n,s,r,a,o,l)},drawScaledSubTexture:function(e,t,i,n,s,r,a,o,l){null!=e.trim?(this._swtTemp=e.trim.width+e.trim.x-t,this._swtTemp=n<this._swtTemp?n:this._swtTemp,this._shtTemp=e.trim.height+e.trim.y-i,this._shtTemp=s<this._shtTemp?s:this._shtTemp,this._dwTemp=o-e.trim.x,this._dhTemp=l-e.trim.y,this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x-e.trim.x+t,e.frame.y-e.trim.y+i,this._swtTemp,this._shtTemp,r,a,o,l)):this.buffer.get_g2().drawScaledSubImage(e.image,e.frame.x+t,e.frame.y+i,n<e.frame.width?n:e.frame.width,s<e.frame.height?s:e.frame.height,r,a,o,l)},drawVideo:function(e,t,i,n,s){this.buffer.get_g2().drawVideo(e,t,i,n,s)},drawText:function(e,t,i){this.buffer.get_g2().drawString(e,t,i)},drawAlignedText:function(e,t,i,n,s){wi.drawAlignedString(this.buffer.get_g2(),e,t,i,n,s)},drawAlignedCharacters:function(e,t,i,n,s,r,a){wi.drawAlignedCharacters(this.buffer.get_g2(),e,t,i,n,s,r,a)},drawRect:function(e,t,i,n,s){this.buffer.get_g2().drawRect(e,t,i,n,s)},fillRect:function(e,t,i,n){this.buffer.get_g2().fillRect(e,t,i,n)},fillTriangle:function(e,t,i,n,s,r){this.buffer.get_g2().fillTriangle(e,t,i,n,s,r)},drawArc:function(e,t,i,n,s,r,a){null==a&&(a=!1),null==r&&(r=1),wi.drawArc(this.buffer.get_g2(),e,t,i,n,s,r,a)},fillArc:function(e,t,i,n,s,r){null==r&&(r=!1),wi.fillArc(this.buffer.get_g2(),e,t,i,n,s,r)},drawCircle:function(e,t,i,n,s){wi.drawCircle(this.buffer.get_g2(),e,t,i,n,s)},drawCubicBezier:function(e,t,i,n){wi.drawCubicBezier(this.buffer.get_g2(),e,t,i,n)},drawCubicBezierPath:function(e,t,i,n){wi.drawCubicBezierPath(this.buffer.get_g2(),e,t,i,n)},drawPolygon:function(e,t,i,n){var s=k._pointsToVec2(i);wi.drawPolygon(this.buffer.get_g2(),e,t,s,n)},fillCircle:function(e,t,i,n){wi.fillCircle(this.buffer.get_g2(),e,t,i,n)},fillPolygon:function(e,t,i){var n=k._pointsToVec2(i);wi.fillPolygon(this.buffer.get_g2(),e,t,n)},get_color:function(){return this._color},set_color:function(e){return this.buffer.get_g2().set_color(e+-16777216),this._color=e},get_alpha:function(){return this._alpha},set_alpha:function(e){return this.buffer.get_g2().set_opacity(e),this._alpha=e},get_matrix:function(){var e=this.buffer.get_g2();return e.transformations[e.transformations.length-1]},set_matrix:function(e){var t=this.buffer.get_g2(),i=t.transformations[t.transformations.length-1];i._00=e._00,i._10=e._10,i._20=e._20,i._01=e._01,i._11=e._11,i._21=e._21,i._02=e._02,i._12=e._12,i._22=e._22;var n=this.buffer.get_g2();return n.transformations[n.transformations.length-1]},get_font:function(){return this._font},set_font:function(e){return this.buffer.get_g2().set_font(e),this._font=e},get_fontSize:function(){return this._fontSize},set_fontSize:function(e){return this.buffer.get_g2().set_fontSize(e),this._fontSize=e},set_blendMode:function(e){return e!=this._blendMode&&(this._blendMode=e,this.buffer.get_g2().set_pipeline(null!=e?e.getPipeline():null)),this._blendMode},get_blendMode:function(){return this._blendMode},__class__:k,__properties__:{set_matrix:"set_matrix",get_matrix:"get_matrix",set_blendMode:"set_blendMode",get_blendMode:"get_blendMode",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_alpha:"set_alpha",get_alpha:"get_alpha",set_color:"set_color",get_color:"get_color"}};var I=function(){};(i["gecko.IDrawable"]=I).__name__=!0,I.prototype={draw:null,__class__:I};var A=function(){this._dirtyProcess=!1,this.currentCameraRendering=null,this._cameraRendering=-1,this._entitiesToRemove=[],this._entitiesToAdd=[],this._systemsToRemove=[],this._systemsToAdd=[];this.onCameraRemoved={handlers:[]};this.onCameraAdded={handlers:[]};this.onSystemRemoved={handlers:[]};this.onSystemAdded={handlers:[]};this.onEntityRemoved={handlers:[]};this.onEntityAdded={handlers:[]},this._systemsList=[],this._updatableSystems=[],this._drawableSystems=[],this._systems=new Ii,this._entitesMap=new Ge,this.entities=[],this._isProcessing=!1,this._dirtySortSystems=!1,this._camerasToRemove=[],this._camerasToAdd=[],this.cameras=[],this._name="",f.call(this);var e=xe.__pool__.get();e.isAlreadyDestroyed=!1,this.timerManager=e;var t=ke.__pool__.get();t.isAlreadyDestroyed=!1,this.tweenManager=t;var i=T.__pool__.get();i.isAlreadyDestroyed=!1,this.rootEntity=i,this.rootEntity._name="scene-root-entity";var n=this.rootEntity,s=Z.__pool__.get();s.isAlreadyDestroyed=!1,n.addComponent(s),this.rootEntity._isRoot=!0};(i["gecko.Scene"]=A).__name__=!0,A.createWithDrawSystem=function(e){var t=A.__pool__.get();t.isAlreadyDestroyed=!1;var i=t,n=ve.__pool__.get();n.init(),n.isAlreadyDestroyed=!1;var s=n;return null!=e&&(s.priority=e),i.addSystem(s),i},A.create=function(){var e=A.__pool__.get();return e.isAlreadyDestroyed=!1,e},A.getPool=function(){return A.__pool__},A.__super__=f,A.prototype=s(f.prototype,{_name:null,rootEntity:null,cameras:null,_camerasToAdd:null,_camerasToRemove:null,_dirtySortSystems:null,_isProcessing:null,entities:null,_entitesMap:null,_systems:null,_drawableSystems:null,_updatableSystems:null,_systemsList:null,onEntityAdded:null,onEntityRemoved:null,onSystemAdded:null,onSystemRemoved:null,onCameraAdded:null,onCameraRemoved:null,_systemsToAdd:null,_systemsToRemove:null,_entitiesToAdd:null,_entitiesToRemove:null,_cameraRendering:null,currentCameraRendering:null,_dirtyProcess:null,timerManager:null,tweenManager:null,beforeDestroy:function(){for(f.prototype.beforeDestroy.call(this);0<this._systemsList.length;){var e=this._systemsList[0];this._removeSystem(e),e.destroy()}for(;0<this.entities.length;){var t=this.entities[0];this._removeEntity(t),t.destroy()}for(;0<this.cameras.length;){var i=this.cameras[0];this._removeCamera(i),i.destroy()}this.timerManager.cleanTimers(),this.tweenManager.cleanTweens(),De.clear(this.onEntityAdded),De.clear(this.onEntityRemoved),De.clear(this.onSystemAdded),De.clear(this.onSystemRemoved),De.clear(this.onCameraAdded),De.clear(this.onCameraRemoved),this.rootEntity.transform._reset()},getEntityById:function(e){return this._entitesMap.h[e]},createCamera:function(e,t,i,n){null==n&&(n=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var s=w.__pool__.get();return s.init(e,t,i,n,null),s.isAlreadyDestroyed=!1,this.addCamera(s)},createEntity:function(){var e=T.__pool__.get();return e.isAlreadyDestroyed=!1,this.addEntity(e)},addEntity:function(e){return null!=this._entitesMap.get(e.id)||(this._isProcessing?(this._entitiesToAdd.push(e),this._dirtyProcess=!0):this._addEntity(e)),e},_addEntity:function(e){e.set_scene(this),null!=e.transform&&null==e.transform._parent&&e.transform.set_parent(this.rootEntity.transform),this.entities.push(e),this._entitesMap.h[e.id]=e;for(var t=0,i=this._systemsList;t<i.length;){var n=i[t];++t,n._registerEntity(e),e.onComponentAdded.handlers.push(Ts(this,this._onEntityAddComponent))}var s=this.onEntityAdded.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(e)}},removeEntity:function(e){if(null!=this._entitesMap.get(e.id))return this._isProcessing?(this._entitiesToRemove.push(e),void(this._dirtyProcess=!0)):void this._removeEntity(e)},_removeEntity:function(e){for(var t=0,i=this._systemsList;t<i.length;){var n=i[t];++t,$.remove(e.onComponentAdded.handlers,Ts(this,this._onEntityAddComponent)),e.set_scene(null),null!=this.rootEntity&&e.transform._parent==this.rootEntity.transform&&e.transform.set_parent(null),n._removeEntity(e)}$.remove(this.entities,e),this._entitesMap.remove(e.id);var s=this.onEntityRemoved.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(e)}},addCamera:function(e){return-1!=this.cameras.indexOf(e)||(this._isProcessing?(this._camerasToAdd.push(e),this._dirtyProcess=!0):this._addCamera(e)),e},_addCamera:function(e){e.set_scene(this),this.cameras.push(e);var t=this.onCameraAdded.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}},removeCamera:function(e){if(-1==this.cameras.indexOf(e))return this._isProcessing?(this._camerasToRemove.push(e),void(this._dirtyProcess=!0)):void this._removeCamera(e)},_removeCamera:function(e){e.set_scene(null),$.remove(this.cameras,e);var t=this.onCameraRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}},addSystem:function(e){var t=e.get___type__();return null!=this._systems.get(me.fromSystem(t).__systemName__)||(this._isProcessing?(this._systemsToAdd.push(e),this._dirtyProcess=!0):this._addSystem(e)),e},_addSystem:function(e){e.set_scene(this);var t=this._systems,i=e.get___typeName__(),n=t;null!=Ns[i]?n.setReserved(i,e):n.h[i]=e,this._systemsList.push(e);for(var s=0,r=this.entities;s<r.length;){var a=r[s];++s,e._registerEntity(a)}Ai.__instanceof(e,I)&&this._drawableSystems.push(e),Ai.__instanceof(e,p)&&this._updatableSystems.push(e),this._dirtySortSystems=!0;var o=this.onSystemAdded.handlers;if(0!=o.length)for(var l=0;l<o.length;){var _=o[l];++l,_(e)}return e},getSystem:function(e){var t=this._systems,i=me.fromSystem(e).__systemName__,n=t;return null!=Ns[i]?n.getReserved(i):n.h[i]},_sortSystems:function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0},removeSystem:function(e){var t=this._systems,i=me.fromSystem(e).__systemName__,n=t,s=null!=Ns[i]?n.getReserved(i):n.h[i];if(null!=s){if(this._isProcessing)return this._systemsToRemove.push(s),void(this._dirtyProcess=!0);this._removeSystem(s)}},_removeSystem:function(e){e.set_scene(null),this._systems.remove(e.get___typeName__()),$.remove(this._systemsList,e),$.remove(this._drawableSystems,e),$.remove(this._updatableSystems,e),e._removeAllEntities();var t=this.onSystemRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}},process:function(e){if(this._isProcessing=!0,this._dirtySortSystems&&(this._systemsList.sort(Ts(this,this._sortSystems)),this._drawableSystems.sort(Ts(this,this._sortSystems)),this._updatableSystems.sort(Ts(this,this._sortSystems)),this._dirtySortSystems=!1),this.update(e),this._dirtyProcess){for(;0!=this._entitiesToAdd.length;)this._addEntity(this._entitiesToAdd.pop());for(;0!=this._entitiesToRemove.length;)this._removeEntity(this._entitiesToRemove.pop());for(;0!=this._systemsToAdd.length;)this._addSystem(this._systemsToAdd.pop());for(;0!=this._systemsToRemove.length;)this._removeSystem(this._systemsToRemove.pop());for(;0!=this._camerasToAdd.length;)this._addCamera(this._camerasToAdd.pop());for(;0!=this._camerasToRemove.length;)this._removeCamera(this._camerasToRemove.pop());this._dirtyProcess=!1}this._isProcessing=!1},update:function(e){if(this.timerManager.tick(e),this.tweenManager.tick(e),0<this.cameras.length)for(var t=0,i=this.cameras;t<i.length;){var n=i[t];++t,n.update(e)}for(var s=0,r=this._updatableSystems;s<r.length;){var a=r[s];++s,a.enabled&&a.update(e)}},updateCameraTransform:function(e){if(this._cameraRendering!=e.id||e.get_wasChanged()){var t=this.rootEntity.transform.get_worldMatrix(),i=e.get_matrix();t._00=i._00,t._10=i._10,t._20=i._20,t._01=i._01,t._11=i._11,t._21=i._21,t._02=i._02,t._12=i._12,t._22=i._22;for(var n=0,s=this.rootEntity.transform._children.length;n<s;){var r=n++;this.rootEntity.transform._children[r]._setDirty(!0,!0,!0)}e._wasChanged=!1,this._cameraRendering=e.id}},getCameraFocused:function(e){var t=null;if(0<this.cameras.length)for(var i=0,n=this.cameras.length;i<n;){var s=i++,r=this.cameras[s];if(e._x>=r.x&&e._x<=r.x+r.width&&e._y>=r.y&&e._y<=r.y+r.height){t=this.cameras[s];break}}return t},draw:function(e){if(this._isProcessing=!0,this.currentCameraRendering=null,0<this.cameras.length){e.end();for(var t=e.buffer,i=0,n=this.cameras;i<n.length;){var s=n[i];++i,this.currentCameraRendering=s,this.updateCameraTransform(s),e.setRenderTarget(s.buffer),null!=s.bgColor?e.begin(!0,s.bgColor):e.begin();for(var r=0,a=this._drawableSystems;r<a.length;){var o=a[r];++r,o.enabled&&o.draw(e)}e.end()}e.setRenderTarget(t),e.begin();for(var l=0,_=this.cameras;l<_.length;){var h=_[l];++l,h.preDraw(e);var u=h.buffer,c=h.x,d=h.y;e.buffer.get_g2().drawImage(u,c,d),h.postDraw(e)}}else for(var f=0,g=this._drawableSystems;f<g.length;){var m=g[f];++f,m.enabled&&m.draw(e)}this._isProcessing=!1},_onEntityAddComponent:function(e,t){for(var i=0,n=this._systemsList;i<n.length;){var s=n[i];++i,s._entities.h.hasOwnProperty(e.id)||s._registerEntity(e)}},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),A.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),A.__pool__.safePut(this))},__type__:null,__typeName__:null,get___type__:function(){return A},get___typeName__:function(){return"gecko.Scene"},__class__:A,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name"}});var C=i["gecko._Screen.AnchorMode"]={__ename__:!0,__constructs__:["TopLeft","TopCenter","TopRight","LeftCenter","Center","RightCenter","BottomLeft","BottomCenter","BottomRight"]};C.TopLeft=["TopLeft",0],C.TopLeft.toString=n,(C.TopLeft.__enum__=C).TopCenter=["TopCenter",1],C.TopCenter.toString=n,(C.TopCenter.__enum__=C).TopRight=["TopRight",2],C.TopRight.toString=n,(C.TopRight.__enum__=C).LeftCenter=["LeftCenter",3],C.LeftCenter.toString=n,(C.LeftCenter.__enum__=C).Center=["Center",4],C.Center.toString=n,(C.Center.__enum__=C).RightCenter=["RightCenter",5],C.RightCenter.toString=n,(C.RightCenter.__enum__=C).BottomLeft=["BottomLeft",6],C.BottomLeft.toString=n,(C.BottomLeft.__enum__=C).BottomCenter=["BottomCenter",7],C.BottomCenter.toString=n,(C.BottomCenter.__enum__=C).BottomRight=["BottomRight",8],C.BottomRight.toString=n,C.BottomRight.__enum__=C;var P=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(i["kha.math.Vector2"]=P).__name__=!0,P.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,e},__class__:P,__properties__:{set_length:"set_length",get_length:"get_length"}};var E=i["gecko.ScreenMode"]={__ename__:!0,__constructs__:["None","Fill","AspectFit","AspectFill"]};E.None=["None",0],E.None.toString=n,(E.None.__enum__=E).Fill=["Fill",1],E.Fill.toString=n,(E.Fill.__enum__=E).AspectFit=["AspectFit",2],E.AspectFit.toString=n,(E.AspectFit.__enum__=E).AspectFill=["AspectFill",3],E.AspectFill.toString=n,E.AspectFill.__enum__=E;var R=function(){};(i["gecko.Screen"]=R).__name__=!0,R.__properties__={set_mode:"set_mode",get_mode:"get_mode",get_height:"get_height",get_width:"get_width"},R.init=function(e,t,i,n){R._size.x=e.width,R._size.y=e.height,R.windowWidth=i,R.windowHeight=n,R._fixPosition();var s=0|R._size.x,r=0|R._size.y;R.buffer=ct.createRenderTarget(s,r,cn.RGBA32,0,t),R.centerX=.5*s,R.centerY=.5*r;var a=e.mode;a!=R._mode&&(R._mode=a,R._setScreenMode(R._mode)),R._updateMatrix(),R._initiated||(d.onWindowResize.handlers.push(R._changeWindowSize),R._initiated=!0)},R.getRealScreenPoint=function(e,t,i){var n=1/(R.matrix._00*R.matrix._11+R.matrix._10*-R.matrix._01);i.set(R.matrix._11*n*e+-R.matrix._10*n*t+(R.matrix._21*R.matrix._10-R.matrix._20*R.matrix._11)*n,R.matrix._00*n*t+-R.matrix._01*n*e+(-R.matrix._21*R.matrix._00+R.matrix._20*R.matrix._01)*n)},R.setAnchor=function(e){switch(e[1]){case 0:R._anchor.x=0,R._anchor.y=0;break;case 1:R._anchor.x=.5,R._anchor.y=0;break;case 2:R._anchor.x=1,R._anchor.y=0;break;case 3:R._anchor.x=0,R._anchor.y=.5;break;case 4:R._anchor.x=.5,R._anchor.y=.5;break;case 5:R._anchor.x=1,R._anchor.y=.5;break;case 6:R._anchor.x=0,R._anchor.y=1;break;case 7:R._anchor.x=.5,R._anchor.y=1;break;case 8:R._anchor.x=1,R._anchor.y=1}R._fixPosition(),R._updateMatrix()},R._fixPosition=function(){R._position.x=R.windowWidth*(1-R._anchor.x),R._position.y=R.windowHeight*(1-R._anchor.y)},R._changeWindowSize=function(e,t){R.windowWidth=e,R.windowHeight=t,R._fixPosition(),R._setScreenMode(R._mode)},R._updateMatrix=function(){R.matrix._00=R._scale.x,R.matrix._11=R._scale.y,R.matrix._20=R._position.x-R._anchor.x*R._size.x*R._scale.x,R.matrix._21=R._position.y-R._anchor.y*R._size.y*R._scale.y},R._setScreenMode=function(e){switch(R._mode[1]){case 1:var t=R.windowWidth,i=R.buffer.get_width();R._scale.x=t/i;var n=R.windowHeight,s=R.buffer.get_height();R._scale.y=n/s;break;case 2:var r=Math.min(R.windowWidth/R.buffer.get_width(),R.windowHeight/R.buffer.get_height());R._scale.x=r,R._scale.y=r;break;case 3:var a=Math.max(R.windowWidth/R.buffer.get_width(),R.windowHeight/R.buffer.get_height());R._scale.x=a,R._scale.y=a}return R._updateMatrix(),R._mode},R.get_width=function(){return R.buffer.get_width()},R.get_height=function(){return R.buffer.get_height()},R.get_mode=function(){return R._mode},R.set_mode=function(e){return e==R._mode?R._mode:(R._mode=e,R._setScreenMode(R._mode))};var L=function(){};(i["kha.Scheduler"]=L).__name__=!0,L.init=function(){L.deltas=[];for(var e=0,t=L.DIF_COUNT;e<t;){var i=e++;L.deltas[i]=0}L.stopped=!0,L.frame_tasks_sorted=!0,L.current=L.lastTime=L.realTime(),L.currentFrameTaskId=0,L.currentTimeTaskId=0,L.currentGroupId=0,L.timeTasks=[],L.pausedTimeTasks=[],L.outdatedTimeTasks=[],L.timeTasksScratchpad=[],L.frameTasks=[],L.toDeleteFrame=[]},L.start=function(e){null==e&&(e=!1),L.vsync=M.get_vsync();var t=M.get_refreshRate();57<=t&&t<=63&&(t=60),L.onedifhz=1/t,L.stopped=!1,L.resetTime(),L.lastTime=L.realTime()-L.startTime;for(var i=0,n=L.DIF_COUNT;i<n;){var s=i++;L.deltas[s]=0}if(e){for(var r=0,a=L.timeTasks;r<a.length;){var o=a[r];++r,o.paused=!1}for(var l=0,_=L.frameTasks;l<_.length;){var h=_[l];++l,h.paused=!1}}},L.stop=function(){L.stopped=!0},L.isStopped=function(){return L.stopped},L.warpTimeTasksBack=function(e,t){for(var i=0;i<t.length;){var n=t[i];if(++i,n.start>=e)n.next=n.start;else if(0<n.period){var s=e-n.start,r=Math.ceil(s/n.period);n.next=n.start+r*n.period}}},L.warp=function(e){if(e<L.lastTime){L.current=e,L.lastTime=e,L.warpTimeTasksBack(e,L.outdatedTimeTasks),L.warpTimeTasksBack(e,L.timeTasks);for(var t=0,i=L.outdatedTimeTasks;t<i.length;){var n=i[t];++t,n.next>=e&&L.timeTasksScratchpad.push(n)}for(var s=0,r=L.timeTasksScratchpad;s<r.length;){var a=r[s];++s,$.remove(L.outdatedTimeTasks,a)}for(var o=0,l=L.timeTasksScratchpad;o<l.length;){var _=l[o];++o,L.insertSorted(L.timeTasks,_)}for(;0<L.timeTasksScratchpad.length;)$.remove(L.timeTasksScratchpad,L.timeTasksScratchpad[0])}else e>L.lastTime&&(L.startTime-=e-L.lastTime,L.current=e,L.lastTime=e,L.executeTimeTasks(e))},L.executeFrame=function(){var e=L.realTime()-L.startTime-L.lastTime,t=L.current;if(0<=e){if(null==_s.the())if(e>L.maxframetime)L.startTime+=e-L.maxframetime,t+=e=L.maxframetime;else if(L.vsync){for(var i=L.onedifhz;i<e-L.onedifhz;)i+=L.onedifhz;e=i;for(var n=0,s=L.DIF_COUNT-2;n<s;){var r=n++;e+=L.deltas[r],L.deltas[r]=L.deltas[r+1]}e+=L.deltas[L.DIF_COUNT-2],e/=L.DIF_COUNT,L.deltas[L.DIF_COUNT-2]=i,t+=e}else{for(var a=0,o=L.DIF_COUNT-1;a<o;){var l=a++;L.deltas[l]=L.deltas[l+1]}L.deltas[L.DIF_COUNT-1]=e;for(var _=0,h=0,u=L.DIF_COUNT;h<u;){var c=h++;_+=L.deltas[c]}t+=_/=L.DIF_COUNT}else t+=e;L.lastTime=t,L.stopped||(L.current=t);for(var d=0,f=L.pausedTimeTasks;d<f.length;){var g=f[d];++d,g.next+=e}if(L.stopped)for(var m=0,p=L.timeTasks;m<p.length;){var v=p[m];++m,v.next+=e}L.executeTimeTasks(t);for(var y=0,b=L.outdatedTimeTasks;y<b.length;){var w=b[y];++y,w.next<t-10&&L.timeTasksScratchpad.push(w)}for(var x=0,S=L.timeTasksScratchpad;x<S.length;){var B=S[x];++x,$.remove(L.outdatedTimeTasks,B)}for(;0<L.timeTasksScratchpad.length;)$.remove(L.timeTasksScratchpad,L.timeTasksScratchpad[0])}L.sortFrameTasks();for(var T=0,k=L.frameTasks;T<k.length;){var I=k[T];++T,L.stopped||I.paused||!I.active||I.task()||(I.active=!1)}for(var A=0,D=L.frameTasks;A<D.length;){var C=D[A];++A,C.active||L.toDeleteFrame.push(C)}for(;0<L.toDeleteFrame.length;)$.remove(L.frameTasks,L.toDeleteFrame.pop())},L.executeTimeTasks=function(e){for(;0<L.timeTasks.length&&(L.activeTimeTask=L.timeTasks[0],L.activeTimeTask.next<=e);)L.activeTimeTask.next+=L.activeTimeTask.period,$.remove(L.timeTasks,L.activeTimeTask),L.activeTimeTask.active&&L.activeTimeTask.task()?0<L.activeTimeTask.period&&(0==L.activeTimeTask.duration||L.activeTimeTask.duration>=L.activeTimeTask.start+L.activeTimeTask.next)?L.insertSorted(L.timeTasks,L.activeTimeTask):L.archiveTimeTask(L.activeTimeTask,e):(L.activeTimeTask.active=!1,L.archiveTimeTask(L.activeTimeTask,e));L.activeTimeTask=null},L.archiveTimeTask=function(e,t){},L.time=function(){return L.current},L.realTime=function(){return M.get_time()},L.resetTime=function(){var e=M.get_time(),t=e-L.startTime;L.startTime=e;for(var i=0,n=L.timeTasks;i<n.length;){var s=n[i];++i,s.start-=t,s.next-=t}for(var r=0,a=L.DIF_COUNT;r<a;){var o=r++;L.deltas[o]=0}L.current=0,L.lastTime=0},L.addBreakableFrameTask=function(e,t){return L.frameTasks.push(new kt(e,t,++L.currentFrameTaskId)),L.frame_tasks_sorted=!1,L.currentFrameTaskId},L.addFrameTask=function(e,t){return L.addBreakableFrameTask(function(){return e(),!0},t)},L.pauseFrameTask=function(e,t){for(var i=0,n=L.frameTasks;i<n.length;){var s=n[i];if(++i,s.id==e){s.paused=t;break}}},L.removeFrameTask=function(e){for(var t=0,i=L.frameTasks;t<i.length;){var n=i[t];if(++t,n.id==e){n.active=!1;break}}},L.generateGroupId=function(){return++L.currentGroupId},L.addBreakableTimeTaskToGroup=function(e,t,i,n,s){null==s&&(s=0),null==n&&(n=0);var r=new Tt;return r.active=!0,r.task=t,r.id=++L.currentTimeTaskId,r.groupId=e,r.start=L.current+i,(r.period=0)!=n&&(r.period=n),(r.duration=0)!=s&&(r.duration=r.start+s),r.next=r.start,L.insertSorted(L.timeTasks,r),r.id},L.addTimeTaskToGroup=function(e,t,i,n,s){return null==s&&(s=0),null==n&&(n=0),L.addBreakableTimeTaskToGroup(e,function(){return t(),!0},i,n,s)},L.addBreakableTimeTask=function(e,t,i,n){return null==n&&(n=0),null==i&&(i=0),L.addBreakableTimeTaskToGroup(0,e,t,i,n)},L.addTimeTask=function(e,t,i,n){return null==n&&(n=0),null==i&&(i=0),L.addTimeTaskToGroup(0,e,t,i,n)},L.getTimeTask=function(e){if(null!=L.activeTimeTask&&L.activeTimeTask.id==e)return L.activeTimeTask;for(var t=0,i=L.timeTasks;t<i.length;){var n=i[t];if(++t,n.id==e)return n}for(var s=0,r=L.pausedTimeTasks;s<r.length;){var a=r[s];if(++s,a.id==e)return a}return null},L.pauseTimeTask=function(e,t){var i=L.getTimeTask(e);null!=i&&L.pauseRunningTimeTask(i,t),null!=L.activeTimeTask&&L.activeTimeTask.id==e&&(L.activeTimeTask.paused=t)},L.pauseRunningTimeTask=function(e,t){(e.paused=t)?($.remove(L.timeTasks,e),L.pausedTimeTasks.push(e)):(L.insertSorted(L.timeTasks,e),$.remove(L.pausedTimeTasks,e))},L.pauseTimeTasks=function(e,t){for(var i=0,n=L.timeTasks;i<n.length;){var s=n[i];++i,s.groupId==e&&L.pauseRunningTimeTask(s,t)}null!=L.activeTimeTask&&L.activeTimeTask.groupId==e&&(L.activeTimeTask.paused=t)},L.removeTimeTask=function(e){var t=L.getTimeTask(e);null!=t&&(t.active=!1,$.remove(L.timeTasks,t))},L.removeTimeTasks=function(e){for(var t=0,i=L.timeTasks;t<i.length;){var n=i[t];++t,n.groupId==e&&(n.active=!1,L.timeTasksScratchpad.push(n))}for(var s=0,r=L.timeTasksScratchpad;s<r.length;){var a=r[s];++s,$.remove(L.timeTasks,a)}for(;0<L.timeTasksScratchpad.length;)$.remove(L.timeTasksScratchpad,L.timeTasksScratchpad[0]);null!=L.activeTimeTask&&L.activeTimeTask.groupId==e&&(L.activeTimeTask.active=!1)},L.numTasksInSchedule=function(){return L.timeTasks.length+L.frameTasks.length},L.insertSorted=function(e,t){for(var i=0,n=e.length;i<n;){var s=i++;if(e[s].next>t.next)return void e.splice(s,0,t)}e.push(t)},L.sortFrameTasks=function(){L.frame_tasks_sorted||(L.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),L.frame_tasks_sorted=!0)};var M=function(){};(i["kha.System"]=M).__name__=!0,M.__properties__={get_systemId:"get_systemId",get_refreshRate:"get_refreshRate",get_vsync:"get_vsync",get_screenRotation:"get_screenRotation",get_time:"get_time",get_title:"get_title"},M.init=function(e,t){null==e.title&&(e.title="Kha"),null==e.width&&(e.width=800),null==e.height&&(e.height=600),null==e.samplesPerPixel&&(e.samplesPerPixel=1),null==e.vSync&&(e.vSync=!0),null==e.windowMode&&(e.windowMode=Et.Window),null==e.resizable&&(e.resizable=!1),null==e.maximizable&&(e.maximizable=!1),null==e.minimizable&&(e.minimizable=!0),M.theTitle=e.title,F.init(e,t)},M.initEx=function(e,t,i,n){M.theTitle=e,F.initEx(e,t,i,n)},M.get_title=function(){return M.theTitle},M.notifyOnRender=function(e,t){for(null==t&&(t=0);t>=M.renderListeners.length;)M.renderListeners.push([]);M.renderListeners[t].push(e)},M.removeRenderListener=function(e,t){null==t&&(t=0),$.remove(M.renderListeners[t],e)},M.notifyOnApplicationState=function(e,t,i,n,s){null!=e&&M.foregroundListeners.push(e),null!=t&&M.resumeListeners.push(t),null!=i&&M.pauseListeners.push(i),null!=n&&M.backgroundListeners.push(n),null!=s&&M.shutdownListeners.push(s)},M.notifyOnDropFiles=function(e){M.dropFilesListeners.push(e)},M.notifyOnCutCopyPaste=function(e,t,i){M.cutListener=e,M.copyListener=t,M.pasteListener=i},M.render=function(e,t){if(0!=M.renderListeners.length)for(var i=0,n=M.renderListeners[e];i<n.length;){var s=n[i];++i,s(t)}},M.foreground=function(){for(var e=0,t=M.foregroundListeners;e<t.length;){var i=t[e];++e,i()}},M.resume=function(){for(var e=0,t=M.resumeListeners;e<t.length;){var i=t[e];++e,i()}},M.pause=function(){for(var e=0,t=M.pauseListeners;e<t.length;){var i=t[e];++e,i()}},M.background=function(){for(var e=0,t=M.backgroundListeners;e<t.length;){var i=t[e];++e,i()}},M.shutdown=function(){for(var e=0,t=M.shutdownListeners;e<t.length;){var i=t[e];++e,i()}},M.dropFiles=function(e){for(var t=0,i=M.dropFilesListeners;t<i.length;){var n=i[t];++t,n(e)}},M.get_time=function(){return F.getTime()},M.windowWidth=function(e){return null==e&&(e=0),F.windowWidth(e)},M.windowHeight=function(e){return null==e&&(e=0),F.windowHeight(e)},M.screenDpi=function(){return F.screenDpi()},M.get_screenRotation=function(){return F.getScreenRotation()},M.get_vsync=function(){return F.getVsync()},M.get_refreshRate=function(){return F.getRefreshRate()},M.get_systemId=function(){return F.getSystemId()},M.requestShutdown=function(){F.requestShutdown()},M.changeResolution=function(e,t){F.changeResolution(e,t)},M.loadUrl=function(e){F.loadUrl(e)},M.canSwitchFullscreen=function(){return F.canSwitchFullscreen()},M.isFullscreen=function(){return F.isFullscreen()},M.requestFullscreen=function(){F.requestFullscreen()},M.exitFullscreen=function(){F.exitFullscreen()},M.notifyOnFullscreenChange=function(e,t){F.notifyOfFullscreenChange(e,t)},M.removeFullscreenListener=function(e,t){F.removeFromFullscreenChange(e,t)};var F=function(){};(i["kha.SystemImpl"]=F).__name__=!0,F.errorHandler=function(e,t,i,n,s){return window.console.error(s.stack),!0},F.init=function(e,t){F.options=e,F.mobile=F.isMobile(),F.ios=F.isIOS(),F.chrome=F.isChrome(),F.firefox=F.isFirefox(),F.ie=F.isIE(),F.init2(),t()},F.initEx=function(e,t,i,n){Re.trace("initEx is not supported on the html5 target, running init() with first window options",{fileName:"SystemImpl.hx",lineNumber:82,className:"kha.SystemImpl",methodName:"initEx"}),F.init({title:e,width:t[0].width,height:t[0].height},n),null!=i&&i(0)},F.isMobile=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("Android")||0<=e.indexOf("webOS")||0<=e.indexOf("BlackBerry")||0<=e.indexOf("Windows Phone")||!!F.isIOS()},F.isIOS=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("iPhone")||0<=e.indexOf("iPad")||0<=e.indexOf("iPod")},F.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},F.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},F.isIE=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")},F.windowWidth=function(e){return null==e&&(e=0),0==F.khanvas.width&&null!=F.options.width?F.options.width:F.khanvas.width},F.windowHeight=function(e){return null==e&&(e=0),0==F.khanvas.height&&null!=F.options.height?F.options.height:F.khanvas.height},F.screenDpi=function(){var e=window.document.createElement("div");e.style.position="absolute",e.style.width="1in",e.style.height="1in",e.style.left="-100%",e.style.top="-100%",window.document.body.appendChild(e);var t=e.offsetHeight;return e.remove(),t},F.setCanvas=function(e){F.khanvas=e},F.getScreenRotation=function(){return It.RotationNone},F.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},F.getVsync=function(){return!0},F.getRefreshRate=function(){return 60},F.getSystemId=function(){return"HTML5"},F.requestShutdown=function(){window.close()},F.init2=function(e){Re.trace=Ai.__trace,F.keyboard=new xn,F.mouse=new Bn,F.surface=new kn,F.gamepads=[],F.gamepadStates=[];for(var t=0;t<4;){var i=t++;F.gamepads[i]=new bn(i),F.gamepadStates[i]=new Ct}if(window.addEventListener("gamepadconnected",function(e){bn.sendConnectEvent(e.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(e){bn.sendDisconnectEvent(e.gamepad.index)}),F.ie){F.pressedKeys=[];for(var n=0;n<256;){n++;F.pressedKeys.push(!1)}for(var s=0;s<256;){s++;F.pressedKeys.push(null)}}window.document.addEventListener("copy",function(e){var t=e;if(null!=M.copyListener){var i=M.copyListener();null!=i&&t.clipboardData.setData("text/plain",i),t.preventDefault()}}),window.document.addEventListener("cut",function(e){var t=e;if(null!=M.cutListener){var i=M.cutListener();null!=i&&t.clipboardData.setData("text/plain",i),t.preventDefault()}}),window.document.addEventListener("paste",function(e){var t=e;if(null!=M.pasteListener){var i=t.clipboardData.getData("text/plain");M.pasteListener(i),t.preventDefault()}}),ft.init(),L.init(),F.loadFinished(),pt.instance=new En},F.getMouse=function(e){return 0!=e?null:F.mouse},F.getKeyboard=function(e){return 0!=e?null:F.keyboard},F.checkGamepad=function(e){for(var t=0,i=e.axes.length;t<i;){var n=t++;if(null!=e.axes[n]&&F.gamepadStates[e.index].axes[n]!=e.axes[n]){var s=e.axes[n];n%2==1&&(s=-s),F.gamepadStates[e.index].axes[n]=s,F.gamepads[e.index].sendAxisEvent(n,s)}}for(var r=0,a=e.buttons.length;r<a;){var o=r++;null!=e.buttons[o]&&F.gamepadStates[e.index].buttons[o]!=e.buttons[o].value&&(F.gamepadStates[e.index].buttons[o]=e.buttons[o].value,F.gamepads[e.index].sendButtonEvent(o,e.buttons[o].value))}e.axes.length<=4&&7<e.buttons.length&&(F.gamepadStates[e.index].axes[4]=e.buttons[6].value,F.gamepads[e.index].sendAxisEvent(4,e.buttons[6].value),F.gamepadStates[e.index].axes[5]=e.buttons[7].value,F.gamepads[e.index].sendAxisEvent(5,e.buttons[7].value))},F.loadFinished=function(){var l=F.khanvas;null==l&&(l=window.document.getElementById(mt.canvas_id));var e=!(l.style.cursor="default");try{F.gl=l.getContext("webgl2",{alpha:!1,antialias:1<F.options.samplesPerPixel,stencil:!0,preserveDrawingBuffer:!0}),F.gl.pixelStorei(37441,1),F.halfFloat={HALF_FLOAT_OES:5131},F.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},F.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},F.elementIndexUint=!0,F.gl.getExtension("EXT_color_buffer_float"),F.gl.getExtension("OES_texture_float_linear"),F.gl.getExtension("OES_texture_half_float_linear"),F.anisotropicFilter=F.gl.getExtension("EXT_texture_filter_anisotropic"),null==F.anisotropicFilter&&(F.anisotropicFilter=F.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),e=!0,F.gl2=!0,At.init()}catch(e){Re.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"SystemImpl.hx",lineNumber:348,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!F.gl2)try{F.gl=l.getContext("experimental-webgl",{alpha:!1,antialias:1<F.options.samplesPerPixel,stencil:!0,preserveDrawingBuffer:!0}),null!=F.gl&&(F.gl.pixelStorei(37441,1),F.gl.getExtension("OES_texture_float"),F.gl.getExtension("OES_texture_float_linear"),F.halfFloat=F.gl.getExtension("OES_texture_half_float"),F.gl.getExtension("OES_texture_half_float_linear"),F.depthTexture=F.gl.getExtension("WEBGL_depth_texture"),F.gl.getExtension("EXT_shader_texture_lod"),F.gl.getExtension("OES_standard_derivatives"),F.anisotropicFilter=F.gl.getExtension("EXT_texture_filter_anisotropic"),null==F.anisotropicFilter&&(F.anisotropicFilter=F.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),F.drawBuffers=F.gl.getExtension("WEBGL_draw_buffers"),F.elementIndexUint=F.gl.getExtension("OES_element_index_uint"),e=!0,At.init())}catch(e){Re.trace("Could not initialize WebGL, falling back to Canvas.",{fileName:"SystemImpl.hx",lineNumber:372,className:"kha.SystemImpl",methodName:"loadFinished"})}if(F.setCanvas(l),e){var t=new Wn;F.frame=new yt(0,null,null,t),F.frame.init(new bi(F.frame),new zn(F.frame),t)}else{Rn.Kravur=xt,xt=Rn;var i=new Pn(l.getContext("2d"));F.frame=new yt(0,null,i,null),F.frame.init(new bi(F.frame),i,null)}!F.mobile&&Wt._init()?(F._hasWebAudio=!0,zt._init()):F.mobile?(F._hasWebAudio=!1,Ln._init(),zt=Ln):(F._hasWebAudio=!1,Cn._compile(),zt=Cn),Zn.instance=new jn,L.start();var n=window,_=n.requestAnimationFrame;null==_&&(_=n.mozRequestAnimationFrame),null==_&&(_=n.webkitRequestAnimationFrame),null==_&&(_=n.msRequestAnimationFrame);var h=null,s=h=function(e){var t=window;null==_?t.setTimeout(h,16.666666666666668):_(h);var i=F.getGamepads();if(null!=i)for(var n=0,s=i.length;n<s;){var r=i[n++];null!=r&&F.checkGamepad(r)}if(L.executeFrame(),l.getContext){var a=l.clientWidth,o=l.clientHeight;l.width==a&&l.height==o||(l.width=a,l.height=o),M.render(0,F.frame),null!=F.gl&&(F.gl.clearColor(1,1,1,1),F.gl.colorMask(!1,!1,!1,!0),F.gl.clear(16384),F.gl.colorMask(!0,!0,!0,!0))}};null==_?n.setTimeout(s,16.666666666666668):_(s),null==l.getAttribute("tabindex")&&l.setAttribute("tabindex","0"),l.focus(),l.oncontextmenu=function(e){e.stopPropagation(),e.preventDefault()},l.onmousedown=F.mouseDown,l.onmousemove=F.mouseMove,null!=F.keyboard&&(l.onkeydown=F.keyDown,l.onkeyup=F.keyUp,l.onkeypress=F.keyPress),l.onblur=F.onBlur,l.onfocus=F.onFocus,l.onmousewheel=l.onwheel=F.mouseWheel,l.onmouseleave=F.mouseLeave,l.addEventListener("wheel mousewheel",F.mouseWheel,!1),l.addEventListener("touchstart",F.touchDown,!1),l.addEventListener("touchend",F.touchUp,!1),l.addEventListener("touchmove",F.touchMove,!1),l.addEventListener("touchcancel",F.touchCancel,!1),window.addEventListener("unload",F.unload)},F.lockMouse=function(){Ts(Ss=F.khanvas,Ss.requestPointerLock)?F.khanvas.requestPointerLock():F.khanvas.mozRequestPointerLock?F.khanvas.mozRequestPointerLock():F.khanvas.webkitRequestPointerLock&&F.khanvas.webkitRequestPointerLock()},F.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},F.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},F.isMouseLocked=function(){return document.pointerLockElement===F.khanvas||document.mozPointerLockElement===F.khanvas||document.webkitPointerLockElement===F.khanvas},F.notifyOfMouseLockChange=function(e,t){window.document.addEventListener("pointerlockchange",e,!1),window.document.addEventListener("mozpointerlockchange",e,!1),window.document.addEventListener("webkitpointerlockchange",e,!1),window.document.addEventListener("pointerlockerror",t,!1),window.document.addEventListener("mozpointerlockerror",t,!1),window.document.addEventListener("webkitpointerlockerror",t,!1)},F.removeFromMouseLockChange=function(e,t){window.document.removeEventListener("pointerlockchange",e,!1),window.document.removeEventListener("mozpointerlockchange",e,!1),window.document.removeEventListener("webkitpointerlockchange",e,!1),window.document.removeEventListener("pointerlockerror",t,!1),window.document.removeEventListener("mozpointerlockerror",t,!1),window.document.removeEventListener("webkitpointerlockerror",t,!1)},F.unload=function(e){},F.setMouseXY=function(e){var t=F.khanvas.getBoundingClientRect(),i=F.khanvas.clientLeft,n=F.khanvas.clientTop;F.mouseX=(e.clientX-t.left-i)*F.khanvas.width/(t.width-2*i)|0,F.mouseY=(e.clientY-t.top-n)*F.khanvas.height/(t.height-2*n)|0},F.unlockSoundOnIOS=function(){if(F.ios&&!F.iosSoundEnabled){var e=Ln._context.createBuffer(1,1,22050),t=Ln._context.createBufferSource();t.buffer=e,t.connect(Ln._context.destination),t.start(),t.stop(),F.iosSoundEnabled=!0}},F.mouseLeave=function(){F.mouse.sendLeaveEvent(0)},F.mouseWheel=function(e){return F.insideInputEvent=!0,F.unlockSoundOnIOS(),e.preventDefault(),0==e.deltaMode?e.deltaY<0?F.mouse.sendWheelEvent(0,-1):0<e.deltaY&&F.mouse.sendWheelEvent(0,1):1==e.deltaMode&&(F.minimumScroll=0|Math.min(F.minimumScroll,Math.abs(e.deltaY)),F.mouse.sendWheelEvent(0,e.deltaY/F.minimumScroll|0)),F.insideInputEvent=!1},F.mouseDown=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS(),F.setMouseXY(e),1==e.which?(e.ctrlKey?(F.leftMouseCtrlDown=!0,F.mouse.sendDownEvent(0,1,F.mouseX,F.mouseY)):(F.leftMouseCtrlDown=!1,F.mouse.sendDownEvent(0,0,F.mouseX,F.mouseY)),null!=Ts(Ss=F.khanvas,Ss.setCapture)?F.khanvas.setCapture():F.khanvas.ownerDocument.addEventListener("mousemove",F.documentMouseMove,!0),F.khanvas.ownerDocument.addEventListener("mouseup",F.mouseLeftUp)):2==e.which?(F.mouse.sendDownEvent(0,2,F.mouseX,F.mouseY),F.khanvas.ownerDocument.addEventListener("mouseup",F.mouseMiddleUp)):3==e.which&&(F.mouse.sendDownEvent(0,1,F.mouseX,F.mouseY),F.khanvas.ownerDocument.addEventListener("mouseup",F.mouseRightUp)),F.insideInputEvent=!1},F.mouseLeftUp=function(e){F.unlockSoundOnIOS(),1==e.which&&(F.insideInputEvent=!0,F.khanvas.ownerDocument.removeEventListener("mouseup",F.mouseLeftUp),null!=Ts(Ss=F.khanvas,Ss.releaseCapture)?F.khanvas.ownerDocument.releaseCapture():F.khanvas.ownerDocument.removeEventListener("mousemove",F.documentMouseMove,!0),F.leftMouseCtrlDown?F.mouse.sendUpEvent(0,1,F.mouseX,F.mouseY):F.mouse.sendUpEvent(0,0,F.mouseX,F.mouseY),F.leftMouseCtrlDown=!1,F.insideInputEvent=!1)},F.mouseMiddleUp=function(e){F.unlockSoundOnIOS(),2==e.which&&(F.insideInputEvent=!0,F.khanvas.ownerDocument.removeEventListener("mouseup",F.mouseMiddleUp),F.mouse.sendUpEvent(0,2,F.mouseX,F.mouseY),F.insideInputEvent=!1)},F.mouseRightUp=function(e){F.unlockSoundOnIOS(),3==e.which&&(F.insideInputEvent=!0,F.khanvas.ownerDocument.removeEventListener("mouseup",F.mouseRightUp),F.mouse.sendUpEvent(0,1,F.mouseX,F.mouseY),F.insideInputEvent=!1)},F.documentMouseMove=function(e){e.stopPropagation(),F.mouseMove(e)},F.mouseMove=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS();var t=F.mouseX,i=F.mouseY;F.setMouseXY(e);var n=e.movementX,s=e.movementY;null==e.movementX&&(n=null!=e.mozMovementX?e.mozMovementX:null!=e.webkitMovementX?e.webkitMovementX:F.mouseX-t,s=null!=e.mozMovementY?e.mozMovementY:null!=e.webkitMovementY?e.webkitMovementY:F.mouseY-i),F.firefox&&(n=n*window.devicePixelRatio|0,s=s*window.devicePixelRatio|0),F.mouse.sendMoveEvent(0,F.mouseX,F.mouseY,n,s),F.insideInputEvent=!1},F.setTouchXY=function(e){var t=F.khanvas.getBoundingClientRect(),i=F.khanvas.clientLeft,n=F.khanvas.clientTop;F.touchX=(e.clientX-t.left-i)*F.khanvas.width/(t.width-2*i)|0,F.touchY=(e.clientY-t.top-n)*F.khanvas.height/(t.height-2*n)|0},F.touchDown=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS(),e.stopPropagation(),e.preventDefault();for(var t=0,i=e.changedTouches;t<i.length;){var n=i[t];++t;var s=n.identifier;F.ios&&(-1==(s=F.iosTouchs.indexOf(-1))&&(s=F.iosTouchs.length),F.iosTouchs[s]=n.identifier),F.setTouchXY(n),F.mouse.sendDownEvent(0,0,F.touchX,F.touchY),F.surface.sendTouchStartEvent(s,F.touchX,F.touchY)}F.insideInputEvent=!1},F.touchUp=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS();for(var t=0,i=e.changedTouches;t<i.length;){var n=i[t];++t;var s=n.identifier;F.ios&&(s=F.iosTouchs.indexOf(s),F.iosTouchs[s]=-1),F.setTouchXY(n),F.mouse.sendUpEvent(0,0,F.touchX,F.touchY),F.surface.sendTouchEndEvent(s,F.touchX,F.touchY)}F.insideInputEvent=!1},F.touchMove=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS();for(var t=0,i=0,n=e.changedTouches;i<n.length;){var s=n[i];if(++i,F.setTouchXY(s),0==t){var r=F.touchX-F.lastFirstTouchX,a=F.touchY-F.lastFirstTouchY;F.lastFirstTouchX=F.touchX,F.lastFirstTouchY=F.touchY,F.mouse.sendMoveEvent(0,F.touchX,F.touchY,r,a)}var o=s.identifier;F.ios&&(o=F.iosTouchs.indexOf(o)),F.surface.sendMoveEvent(o,F.touchX,F.touchY),++t}F.insideInputEvent=!1},F.touchCancel=function(e){F.insideInputEvent=!0,F.unlockSoundOnIOS();for(var t=0,i=e.changedTouches;t<i.length;){var n=i[t];++t;var s=n.identifier;F.ios&&(s=F.iosTouchs.indexOf(s)),F.setTouchXY(n),F.mouse.sendUpEvent(0,0,F.touchX,F.touchY),F.surface.sendTouchEndEvent(s,F.touchX,F.touchY)}F.iosTouchs=[],F.insideInputEvent=!1},F.onBlur=function(){M.background()},F.onFocus=function(){M.foreground()},F.keycodeToChar=function(e,t,i){if(null!=e){if(1==e.length)return e;switch(e){case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-"}}switch(t){case 48:return i?"=":"0";case 49:return i?"!":"1";case 50:return i?'"':"2";case 51:return i?"":"3";case 52:return i?"$":"4";case 53:return i?"%":"5";case 54:return i?"&":"6";case 55:return i?"/":"7";case 56:return i?"(":"8";case 57:return i?")":"9";case 106:return"*";case 107:return"+";case 109:return"-";case 111:return"/";case 187:return i?"*":"+";case 188:return i?";":",";case 189:return i?"_":"-";case 190:return i?":":".";case 191:return i?"'":"#";case 212:return i?"`":"";case 219:return i?"?":"";case 226:return i?">":"<"}return 96<=t&&t<=105?String.fromCharCode(-48+t):65<=t&&t<=90?i?String.fromCharCode(t):String.fromCharCode(t-65+97):String.fromCharCode(t)},F.keyDown=function(e){if((e.keyCode<112||123<e.keyCode)&&null!=e.key&&1!=e.key.length&&e.preventDefault(),e.stopPropagation(),F.ie){if(F.pressedKeys[e.keyCode])return void e.preventDefault();F.pressedKeys[e.keyCode]=!0}else if(e.repeat)return void e.preventDefault();F.keyboard.sendDownEvent(e.keyCode)},F.keyUp=function(e){e.preventDefault(),e.stopPropagation(),F.ie&&(F.pressedKeys[e.keyCode]=!1),F.keyboard.sendUpEvent(e.keyCode)},F.keyPress=function(e){0!=e.which&&(e.preventDefault(),e.stopPropagation(),F.keyboard.sendPressEvent(String.fromCharCode(e.which)))},F.canSwitchFullscreen=function(){return"fullscreenElement "in document||"mozFullScreenElement"in document||"webkitFullscreenElement"in document||"msFullscreenElement"in document},F.isFullscreen=function(){return document.fullscreenElement===this.khanvas||document.mozFullScreenElement===this.khanvas||document.webkitFullscreenElement===this.khanvas||document.msFullscreenElement===this.khanvas},F.requestFullscreen=function(){Ts(Ss=F.khanvas,Ss.requestFullscreen)?F.khanvas.requestFullscreen():F.khanvas.msRequestFullscreen?F.khanvas.msRequestFullscreen():F.khanvas.mozRequestFullScreen?F.khanvas.mozRequestFullScreen():F.khanvas.webkitRequestFullscreen&&F.khanvas.webkitRequestFullscreen()},F.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},F.notifyOfFullscreenChange=function(e,t){window.document.addEventListener("fullscreenchange",e,!1),window.document.addEventListener("mozfullscreenchange",e,!1),window.document.addEventListener("webkitfullscreenchange",e,!1),window.document.addEventListener("MSFullscreenChange",e,!1),window.document.addEventListener("fullscreenerror",t,!1),window.document.addEventListener("mozfullscreenerror",t,!1),window.document.addEventListener("webkitfullscreenerror",t,!1),window.document.addEventListener("MSFullscreenError",t,!1)},F.removeFromFullscreenChange=function(e,t){window.document.removeEventListener("fullscreenchange",e,!1),window.document.removeEventListener("mozfullscreenchange",e,!1),window.document.removeEventListener("webkitfullscreenchange",e,!1),window.document.removeEventListener("MSFullscreenChange",e,!1),window.document.removeEventListener("fullscreenerror",t,!1),window.document.removeEventListener("mozfullscreenerror",t,!1),window.document.removeEventListener("webkitfullscreenerror",t,!1),window.document.removeEventListener("MSFullscreenError",t,!1)},F.changeResolution=function(e,t){},F.setKeepScreenOn=function(e){},F.loadUrl=function(e){window.open(e,"_blank")},F.getGamepadId=function(e){var t=F.getGamepads();return null!=t&&t[e]?t[e].id:"unkown"},F.getGamepads=function(){return F.chrome&&Zn.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},F.getPen=function(e){return null==e&&(e=0),null};var V=function(){};(i["gecko.Time"]=V).__name__=!0,V.__properties__={get_realTime:"get_realTime",get_delta:"get_delta",get_fixedDelta:"get_fixedDelta"},V._tick=function(){var e=L.time(),t=L.realTime();V.fixedUnscaledDelta=e-V._lastFixedNow,V.unscaledDelta=t-V._lastNow,V.fixedUnscaledTime+=V.fixedUnscaledDelta,V.unscaledTime+=V.unscaledDelta,V.fixedTime+=V.fixedUnscaledDelta*V.scale,V.time+=V.unscaledDelta*V.scale,V._lastNow=t,V._lastFixedNow=e},V._clear=function(){V._lastNow=L.realTime(),V._lastFixedNow=L.time()},V.get_fixedDelta=function(){return V.fixedUnscaledDelta*V.scale},V.get_delta=function(){return V.unscaledDelta*V.scale},V.get_realTime=function(){return L.realTime()-V._initTime};var O=i["gecko.DepthMode"]={__ename__:!0,__constructs__:["DEFAULT","ENABLED","DISABLED"]};O.DEFAULT=["DEFAULT",0],O.DEFAULT.toString=n,(O.DEFAULT.__enum__=O).ENABLED=["ENABLED",1],O.ENABLED.toString=n,(O.ENABLED.__enum__=O).DISABLED=["DISABLED",2],O.DISABLED.toString=n,O.DISABLED.__enum__=O;var G=function(e){this._visibleOnCamera=[],this._fixedToCamera=!1,this._skewCache={cosX:0,cosY:0,sinX:0,sinY:0},this._dirtyPosition=!0,this._dirtyDepth=!1,this._dirtyScale=!0,this._dirtyAngle=!0,this._dirty=!0,this._worldMatrix=new D(1,0,0,0,1,0,0,0,1),this._localMatrix=new D(1,0,0,0,1,0,0,0,1),this._depth=0,this._depthMode=O.DEFAULT,this._localRotation=0,this._rotation=0,this._nextChild=null,this._branch=0,this._children=[],this._rootTransform=null,this.lastUpdateID=0,this.id=d.getUniqueID(),this.entity=e;this.onAddedToParent={handlers:[]};this.onRemovedFromParent={handlers:[]};this.onTransformChange={handlers:[]};this.onDepthChange={handlers:[]},this._flip=new _e(!1,!1),this._flip.setObserver(Ts(this,this._vecDirty));var t=oe.__pool__.get();t.init(0,0),t.isAlreadyDestroyed=!1,this._skew=t,this._skew.setObserver(Ts(this,this._onSetSkew));var i=oe.__pool__.get();i.init(.5,.5),i.isAlreadyDestroyed=!1,this._pivot=i,this._pivot.setObserver(Ts(this,this._pointDirtyPosition));var n=oe.__pool__.get();n.init(.5,.5),n.isAlreadyDestroyed=!1,this._anchor=n,this._anchor.setObserver(Ts(this,this._pointDirtyPosition));var s=oe.__pool__.get();s.init(0,0),s.isAlreadyDestroyed=!1,this._size=s,this._size.setObserver(Ts(this,this._pointDirtyPosition));var r=oe.__pool__.get();r.init(0,0),r.isAlreadyDestroyed=!1,this._position=r,this._position.setObserver(Ts(this,this._onSetPosition));var a=oe.__pool__.get();a.init(0,0),a.isAlreadyDestroyed=!1,this._localPosition=a,this._localPosition.setObserver(Ts(this,this._pointDirtyPosition));var o=oe.__pool__.get();o.init(1,1),o.isAlreadyDestroyed=!1,this._scale=o,this._scale.setObserver(Ts(this,this._onSetScale));var l=oe.__pool__.get();l.init(1,1),l.isAlreadyDestroyed=!1,this._localScale=l,this._localScale.setObserver(Ts(this,this._onSetLocalScale));var _=oe.__pool__.get();_.init(0,0),_.isAlreadyDestroyed=!1,this._tmpPoint1=_;var h=oe.__pool__.get();h.init(0,0),h.isAlreadyDestroyed=!1,this._tmpPoint2=h,this._dirty=this._dirtyPosition=this._dirtyAngle=this._dirtyScale=!0};(i["gecko.Transform"]=G).__name__=!0,G.sortChildrenHandler=function(e,t){return e._depth<t._depth?-1:e._depth>t._depth?1:0},G.prototype={id:null,lastUpdateID:null,_parent:null,_rootTransform:null,_children:null,_branch:null,_nextChild:null,localPosition:null,_localPosition:null,position:null,_position:null,scale:null,_scale:null,localScale:null,_localScale:null,_skew:null,pivot:null,_pivot:null,anchor:null,_anchor:null,size:null,_size:null,flip:null,_flip:null,_rotation:null,_localRotation:null,top:null,localTop:null,bottom:null,localBottom:null,left:null,localLeft:null,right:null,localRight:null,_depthMode:null,_depth:null,_localMatrix:null,_worldMatrix:null,_dirty:null,_dirtyAngle:null,_dirtyScale:null,_dirtyDepth:null,_dirtyPosition:null,_tmpPoint1:null,_tmpPoint2:null,onAddedToParent:null,onRemovedFromParent:null,onTransformChange:null,onDepthChange:null,_skewCache:null,entity:null,_fixedToCamera:null,_visibleOnCamera:null,existsInCamera:function(e){return!(null!=e&&0<this._visibleOnCamera.length)||-1!=this._visibleOnCamera.indexOf(e.id)},addToCamera:function(e){this._visibleOnCamera.push(e.id)},removeFromCamera:function(e){$.remove(this._visibleOnCamera,e.id)},sortChildren:function(e){null==e&&(e=G.sortChildrenHandler),this._children.sort(e)},_reset:function(){for(this.set_parent(null);0<this._children.length;)this._children[0].set_parent(null);De.clear(this.onDepthChange),De.clear(this.onAddedToParent),De.clear(this.onRemovedFromParent),De.clear(this.onTransformChange);var e=this._position;e._vec2.x=e._x=0;var t=this._position;t._vec2.y=t._y=0;var i=this._localPosition;i._vec2.x=i._x=0;var n=this._localPosition;n._vec2.y=n._y=0;var s=this._scale;s._vec2.x=s._x=1;var r=this._scale;r._vec2.y=r._y=1;var a=this._localScale;a._vec2.x=a._x=1;var o=this._localScale;o._vec2.y=o._y=1;var l=this._skew;l._vec2.x=l._x=0;var _=this._skew;_._vec2.y=_._y=0;var h=this._pivot;h._vec2.x=h._x=.5;var u=this._pivot;u._vec2.y=u._y=.5;var c=this._anchor;c._vec2.x=c._x=.5;var d=this._anchor;d._vec2.y=d._y=.5;var f=this._size;f._vec2.x=f._x=0;var g=this._size;g._vec2.y=g._y=0,this._flip._x=!1,this._flip._y=!1,this._rotation=0,this._localRotation=0,this._skewCache.cosX=0,this._skewCache.sinX=0,this._skewCache.cosY=0,this._skewCache.sinY=0,this._depth=0,this._depthMode=O.DEFAULT,this._fixedToCamera=!1,this._visibleOnCamera.length=0,this._dirty=this._dirtyPosition=this._dirtyAngle=this._dirtyScale=!0},updateTransform:function(){if(this._dirty){this.lastUpdateID++,null!=this._parent?(this._parent.updateTransform(),null==this._parent._parent?this._rootTransform=this._parent:this._rootTransform=this._parent._rootTransform):this._rootTransform=this,this._dirtyAngle&&(this._skewCache.cosX=Math.cos(this._rotation+this._skew._x),this._skewCache.sinX=Math.sin(this._rotation+this._skew._x),this._skewCache.sinY=-Math.sin(this._rotation-this._skew._y),this._skewCache.cosY=Math.cos(this._rotation-this._skew._y));var e=this._localScale._x*(this._flip._x?-1:1),t=this._localScale._y*(this._flip._y?-1:1),i=this._flip._x?1-this._anchor._x:this._anchor._x,n=this._flip._y?1-this._anchor._y:this._anchor._y,s=this._flip._x?1-this._pivot._x:this._pivot._x,r=this._flip._y?1-this._pivot._y:this._pivot._y;this._localMatrix._00=this._skewCache.cosX*e,this._localMatrix._01=this._skewCache.sinX*e,this._localMatrix._10=this._skewCache.sinY*t,this._localMatrix._11=this._skewCache.cosY*t;var a=i*this._size._x,o=n*this._size._y,l=s*this._size._x,_=r*this._size._y;if(this._localMatrix._20=this._localPosition._x-a*e+l*e,this._localMatrix._21=this._localPosition._y-o*t+_*t,0==l&&0==_||(this._localMatrix._20-=l*this._localMatrix._00+_*this._localMatrix._10,this._localMatrix._21-=l*this._localMatrix._01+_*this._localMatrix._11),this._fixedToCamera||null==this._parent){var h=this._worldMatrix,u=this._localMatrix;if(h._00=u._00,h._10=u._10,h._20=u._20,h._01=u._01,h._11=u._11,h._21=u._21,h._02=u._02,h._12=u._12,h._22=u._22,this._dirtyScale){var c=this._scale;c._vec2.x=c._x=this._localScale._x;var d=this._scale;d._vec2.y=d._y=this._localScale._y}this._dirtyAngle&&(this._rotation=this._localRotation)}else{var f=this._worldMatrix,g=this._localMatrix,m=this._parent._worldMatrix;if(f._00=g._00*m._00+g._01*m._10,f._01=g._00*m._01+g._01*m._11,f._10=g._10*m._00+g._11*m._10,f._11=g._10*m._01+g._11*m._11,f._20=g._20*m._00+g._21*m._10+m._20,f._21=g._20*m._01+g._21*m._11+m._21,this._dirtyScale){var p=this._scale;p._vec2.x=p._x=this._localScale._x*this._parent._scale._x;var v=this._scale;v._vec2.y=v._y=this._localScale._y*this._parent._scale._y}this._dirtyAngle&&(this._rotation=this._localRotation+this._parent._rotation)}this._dirtyAngle=!1,this._dirtyScale=!1,this._dirty=!1;var y=this.onTransformChange.handlers;if(0!=y.length)for(var b=0;b<y.length;){var w=y[b];++b,w()}}},_onSetSkew:function(e){this._setDirty(!0,!1,!0)},_onSetScale:function(e){if(null!=this._parent){var t=this._localScale;t._vec2.x=t._x=this._scale._x/this._parent._scale._x;var i=this._localScale;i._vec2.y=i._y=this._scale._y/this._parent._scale._y}else{var n=this._localScale;n._vec2.x=n._x=this._scale._x;var s=this._localScale;s._vec2.y=s._y=this._scale._y}this._setDirty(!0,!0),this._dirtyPosition=!1,this._dirtyScale=!1},_onSetLocalScale:function(e){this._setDirty(!0,!0)},_onSetPosition:function(e){if(null==this._parent||this._fixedToCamera){var t=this._localPosition;t._vec2.x=t._x=e._x;var i=this._localPosition;i._vec2.y=i._y=e._y}else{var n=this._parent,s=this._tmpPoint2;s=this._rootTransform.localToScreen(e,s),n.screenToLocal(s,s);var r=this._localPosition;r._vec2.x=r._x=this._tmpPoint2._x;var a=this._localPosition;a._vec2.y=a._y=this._tmpPoint2._y}this._setDirty(!0),this._dirtyPosition=!1},_vecDirty:function(e){this._setDirty(!0),this._dirtyPosition=!1},_pointDirtyPosition:function(e){this._setDirty(!0)},_setDirty:function(e,t,i){if(null==i&&(i=!1),null==t&&(t=!1),null==e&&(e=!1),!this._dirty||this._dirtyAngle!=i||this._dirtyPosition!=e||this._dirtyScale!=t){this._dirty=!0,i&&!this._dirtyAngle&&(this._dirtyAngle=!0),e&&!this._dirtyPosition&&(this._dirtyPosition=!0),t&&!this._dirtyScale&&(this._dirtyScale=!0);for(var n=0,s=this._children;n<s.length;){var r=s[n];++n,r._setDirty(this._dirtyPosition,this._dirtyScale,this._dirtyAngle)}}},localToScreen:function(e,t){if(this._dirty||this.updateTransform(),null==t){var i=oe.__pool__.get();i.init(0,0),i.isAlreadyDestroyed=!1,t=i}var n=e._x,s=e._y;return t.set_x(this._worldMatrix._00*n+this._worldMatrix._10*s+this._worldMatrix._20),t.set_y(this._worldMatrix._01*n+this._worldMatrix._11*s+this._worldMatrix._21),t},screenToLocal:function(e,t){if(this._dirty||this.updateTransform(),null==t){var i=oe.__pool__.get();i.init(0,0),i.isAlreadyDestroyed=!1,t=i}var n=e._x,s=e._y,r=1/(this._worldMatrix._00*this._worldMatrix._11+this._worldMatrix._10*-this._worldMatrix._01);return t.set_x(this._worldMatrix._11*r*n+-this._worldMatrix._10*r*s+(this._worldMatrix._21*this._worldMatrix._10-this._worldMatrix._20*this._worldMatrix._11)*r),t.set_y(this._worldMatrix._00*r*s+-this._worldMatrix._01*r*n+(-this._worldMatrix._21*this._worldMatrix._00+this._worldMatrix._20*this._worldMatrix._01)*r),t},localToLocal:function(e,t,i){return i=e.localToScreen(t,i),this.screenToLocal(i,i)},getChildrenLength:function(){return this._children.length},getChild:function(e){return this._children[e]},toString:function(){return"Transform: hasParent -> "+N.string(null!=this._parent)+", position -> "+N.string(this.get_position())+", localPosition -> "+N.string(this.get_localPosition())+", scale -> "+N.string(this.get_scale())+", localScale -> "+N.string(this.get_localScale())+",  rotation -> "+this.get_rotation()+", localRotation -> "+this.get_localRotation()+" size -> "+N.string(this.get_size())+", anchor -> "+N.string(this.get_anchor())+" pivot -> "+N.string(this.get_pivot())+", flip -> "+N.string(this.get_flip())},get_parent:function(){return this._parent},set_parent:function(e){if(e==this._parent)return this._parent;if(null!=this._parent){$.remove(this._parent._children,this);var t=this.onRemovedFromParent.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this._parent)}}if(this._parent=e,null!=this._parent){this._parent._children.push(this),(this._parent._depthMode==O.ENABLED||this._parent._depthMode==O.DEFAULT&&G.isDepthEnabled)&&this._parent.sortChildren();var s=this.onAddedToParent.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(this._parent)}}return this._setDirty(!0,!0,!0),this._parent},get_localPosition:function(){return this._dirty&&this.updateTransform(),this._localPosition},get_position:function(){if(this._dirty&&this.updateTransform(),this._dirtyPosition){if(null==this._parent||this._fixedToCamera){var e=this._position;e._vec2.x=e._x=this._localPosition._x;var t=this._position;t._vec2.y=t._y=this._localPosition._y}else{this._rootTransform.get_worldMatrix();var i=this._rootTransform,n=this._tmpPoint1;n=this._parent.localToScreen(this._localPosition,n),i.screenToLocal(n,n);var s=this._position;s._vec2.x=s._x=this._tmpPoint1._x;var r=this._position;r._vec2.y=r._y=this._tmpPoint1._y}this._dirtyPosition=!1}return this._position},get_scale:function(){return this._dirty&&this.updateTransform(),this._scale},get_localScale:function(){return this._dirty&&this.updateTransform(),this._localScale},get_size:function(){return this._dirty&&this.updateTransform(),this._size},get_anchor:function(){return this._dirty&&this.updateTransform(),this._anchor},get_pivot:function(){return this._dirty&&this.updateTransform(),this._pivot},get_flip:function(){return this._dirty&&this.updateTransform(),this._flip},get_rotation:function(){return this._dirty&&this.updateTransform(),this._rotation},set_rotation:function(e){return e==this._rotation||(this._rotation=e,null!=this._parent?this._localRotation=this._rotation+this._parent._rotation:this._localRotation=this._rotation,this._setDirty(!0,!1,!0),this._dirtyPosition=!1),this._rotation},get_localRotation:function(){return this._dirty&&this.updateTransform(),this._localRotation},set_localRotation:function(e){return e==this._localRotation||(this._localRotation=e,this._setDirty(!0,!1,!0),this._dirtyPosition=!1),this._localRotation},get_width:function(){return this.get_scale()._x*this.get_size()._x},get_localWidth:function(){return this.get_localScale()._x*this.get_size()._x},set_width:function(e){return this.get_scale().set_x(e/this.get_size()._x)},set_localWidth:function(e){return this.get_localScale().set_x(e/this.get_size()._x)},get_height:function(){return this.get_scale()._y*this.get_size()._y},get_localHeight:function(){return this.get_localScale()._y*this.get_size()._y},set_height:function(e){return this.get_scale().set_y(e/this.get_size()._y)},set_localHeight:function(e){return this.get_localScale().set_y(e/this.get_size()._y)},get_top:function(){return this.get_position()._y-this.get_scale()._y*this.get_size()._y*this.get_anchor()._y},get_bottom:function(){return this.get_position()._y+this.get_scale()._y*this.get_size()._y*(1-this.get_anchor()._y)},get_left:function(){return this.get_position()._x-this.get_scale()._x*this.get_size()._x*this.get_anchor()._x},get_right:function(){return this.get_position()._x+this.get_scale()._x*this.get_size()._x*(1-this.get_anchor()._x)},get_localTop:function(){return this.get_localPosition()._y-this.get_localScale()._y*this.get_size()._y*this.get_anchor()._y},get_localBottom:function(){return this.get_localPosition()._y+this.get_localScale()._y*this.get_size()._y*(1-this.get_anchor()._y)},get_localLeft:function(){return this.get_localPosition()._x-this.get_localScale()._x*this.get_size()._x*this.get_anchor()._x},get_localRight:function(){return this.get_localPosition()._x+this.get_localScale()._x*this.get_size()._x*(1-this.get_anchor()._x)},get_localMatrix:function(){return this._dirty&&this.updateTransform(),this._localMatrix},set_localMatrix:function(e){return this._localMatrix=e},get_worldMatrix:function(){return this._dirty&&this.updateTransform(),this._worldMatrix},set_worldMatrix:function(e){return this._worldMatrix=e},get_depth:function(){return this._depth},set_depth:function(e){if(e==this._depth)return this._depth;this._depth=e,null!=this._parent&&(this._parent._depthMode==O.ENABLED||this._parent._depthMode==O.DEFAULT&&G.isDepthEnabled)&&this._parent.sortChildren();var t=this.onDepthChange.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this)}return this._depth},set_depthMode:function(e){return e==this._depthMode||(this._depthMode=e,(this._depthMode==O.ENABLED||this._depthMode==O.DEFAULT&&G.isDepthEnabled)&&this.sortChildren()),this._depthMode},get_depthMode:function(){return this._depthMode},set_fixedToCamera:function(e){return e==this._fixedToCamera||(this._fixedToCamera=e,this._dirty=!0),this._fixedToCamera},get_fixedToCamera:function(){return this._fixedToCamera},__class__:G,__properties__:{set_fixedToCamera:"set_fixedToCamera",get_fixedToCamera:"get_fixedToCamera",set_worldMatrix:"set_worldMatrix",get_worldMatrix:"get_worldMatrix",set_localMatrix:"set_localMatrix",get_localMatrix:"get_localMatrix",set_depth:"set_depth",get_depth:"get_depth",set_depthMode:"set_depthMode",get_depthMode:"get_depthMode",get_localRight:"get_localRight",get_right:"get_right",get_localLeft:"get_localLeft",get_left:"get_left",get_localBottom:"get_localBottom",get_bottom:"get_bottom",get_localTop:"get_localTop",get_top:"get_top",set_localRotation:"set_localRotation",get_localRotation:"get_localRotation",set_rotation:"set_rotation",get_rotation:"get_rotation",get_flip:"get_flip",get_size:"get_size",get_anchor:"get_anchor",get_pivot:"get_pivot",get_localScale:"get_localScale",get_scale:"get_scale",get_position:"get_position",get_localPosition:"get_localPosition",set_localHeight:"set_localHeight",get_localHeight:"get_localHeight",set_height:"set_height",get_height:"get_height",set_localWidth:"set_localWidth",get_localWidth:"get_localWidth",set_width:"set_width",get_width:"get_width",set_parent:"set_parent",get_parent:"get_parent"}};var U=function(){this._destroyCurrentScene=!1,this.currentScene=A.createWithDrawSystem();this.onSceneChanged={handlers:[]}};(i["gecko.World"]=U).__name__=!0,U.prototype={currentScene:null,_nextScene:null,_destroyCurrentScene:null,onSceneChanged:null,changeScene:function(e,t){null==t&&(t=!1),this._destroyCurrentScene=t,this._nextScene=e},update:function(e){if(null!=this._nextScene){var t=this.currentScene;this.currentScene=this._nextScene,this._nextScene=null;var i=this.onSceneChanged.handlers;if(0!=i.length)for(var n=0;n<i.length;){var s=i[n];++n,s(t,this.currentScene)}this._destroyCurrentScene&&t.destroy()}this.currentScene.process(e)},draw:function(e){this.currentScene.draw(e)},__class__:U};var W={};(i["gecko.components._Component.ComponentClass_Impl_"]=W).__name__=!0,W.__properties__={get___componentTypes__:"get___componentTypes__",get___componentName__:"get___componentName__"},W.get___componentName__=function(e){return e.__componentName__},W.get___componentTypes__=function(e){return e.__componentTypes__},W.fromComponent=function(e){return e};var z=i["gecko.components.collision.aabb.HitBoxSide"]={__ename__:!0,__constructs__:["Top","Bottom","Left","Right"]};z.Top=["Top",0],z.Top.toString=n,(z.Top.__enum__=z).Bottom=["Bottom",1],z.Bottom.toString=n,(z.Bottom.__enum__=z).Left=["Left",2],z.Left.toString=n,(z.Left.__enum__=z).Right=["Right",3],z.Right.toString=n,z.Right.__enum__=z;var H=function(){this.collidingWith=[],this.right=0,this.left=0,this.bottom=0,this.top=0,g.call(this);this.onCollidingWith={handlers:[]};this.onCollideStart={handlers:[]};this.onCollideStop={handlers:[]}};(i["gecko.components.collision.aabb.HitBoxComponent"]=H).__name__=!0,H.create=function(e,t){var i=H.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},H.getPool=function(){return H.__pool__},H.__super__=g,H.prototype=s(g.prototype,{box:null,tagsToCollide:null,onCollidingWith:null,onCollideStart:null,onCollideStop:null,top:null,bottom:null,left:null,right:null,collidingWith:null,init:function(e,t){null!=e&&0!=e.length&&(this.tagsToCollide=e),null!=t&&(this.box=t),this.onAddedToEntity.handlers.push(Ts(this,this._initBounds)),$.remove(this.onRemovedFromEntity.handlers,Ts(this,this._disableBounds))},getCollisionSide:function(e){var t,i,n=z.Top;return t=Math.abs(this.bottom-e.top),(i=Math.abs(this.top-e.bottom))<t&&(t=i,n=z.Bottom),(i=Math.abs(this.right-e.left))<t&&(t=i,n=z.Left),(i=Math.abs(this.left-e.right))<t&&(t=i,n=z.Right),n},_initBounds:function(e){this.updateBounds(),e.transform.onTransformChange.handlers.push(Ts(this,this.updateBounds))},_disableBounds:function(e){$.remove(e.transform.onTransformChange.handlers,Ts(this,this.updateBounds))},_updateBounds:function(e){this.updateBounds()},updateBounds:function(){if(null!=this._entity&&null!=this._entity.transform){var e,t,i,n;null!=this.box?(e=this.box.x,t=this.box.y,i=this.box.width,n=this.box.height):(t=e=0,i=this._entity.transform.get_size()._x,n=this._entity.transform.get_size()._y);var s=this._entity.transform.get_worldMatrix(),r=s._00*e+s._10*t+s._20,a=s._01*e+s._11*t+s._21,o=s._00*i+s._10*t+s._20,l=s._01*i+s._11*t+s._21,_=s._00*e+s._10*n+s._20,h=s._01*e+s._11*n+s._21,u=s._00*i+s._10*n+s._20,c=s._01*i+s._11*n+s._21,d=r<o?r:o;d=(d=d<_?d:_)<u?d:u;var f=o<r?r:o;f=u<(f=_<f?f:_)?f:u;var g=a<l?a:l;g=(g=g<h?g:h)<c?g:c;var m=l<a?a:l;m=c<(m=h<m?m:h)?m:c,this.top=g,this.bottom=m,this.left=d,this.right=f}},canCollideWith:function(e){if(null==this.tagsToCollide)return!0;for(var t=0,i=this.tagsToCollide;t<i.length;){var n=i[t];if(++t,e._tags.exists(n))return!0}return!1},getTopDepth:function(e){return Math.abs(this.bottom-e.top)},getBottomDepth:function(e){return Math.abs(this.top-e.bottom)},getLeftDepth:function(e){return Math.abs(this.right-e.left)},getRightDepth:function(e){return Math.abs(this.left-e.right)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),null!=this.box&&(this.box.destroy(),this.box=null),null!=this.tagsToCollide&&(this.tagsToCollide=null),$.remove(this.onAddedToEntity.handlers,Ts(this,this._updateBounds)),$.remove(this.onRemovedFromEntity.handlers,Ts(this,this._disableBounds)),De.clear(this.onCollidingWith),De.clear(this.onCollideStart),De.clear(this.onCollideStop),this.collidingWith.length=0},isCollidingWith:function(e){return-1!=this.collidingWith.indexOf(e)},get___typeName__:function(){return"gecko.components.collision.aabb.HitBoxComponent"},get___type__:function(){return H},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),H.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),H.__pool__.safePut(this))},__class__:H});var Z=function(){this._dirtyAlpha=!0,this._alpha=1,this._localAlpha=1,this.color=16777215,this.visible=!0,g.call(this)};(i["gecko.components.draw.DrawComponent"]=Z).__name__=!0,Z.__interfaces__=[p,I],Z.create=function(){var e=Z.__pool__.get();return e.isAlreadyDestroyed=!1,e},Z.getPool=function(){return Z.__pool__},Z.__super__=g,Z.prototype=s(g.prototype,{visible:null,color:null,_localAlpha:null,_alpha:null,_dirtyAlpha:null,isVisible:null,update:function(e){},preDraw:function(e){},draw:function(e){},postDraw:function(e){},generateTexture:function(e){if(null==this._entity)return Re.trace("DrawComponent.generateTexture() needs a entity to work.",{fileName:"DrawComponent.hx",lineNumber:32,className:"gecko.components.draw.DrawComponent",methodName:"generateTexture"}),null;null==e&&(e=d.graphics);var t=ct.createRenderTarget(0|this._entity.transform.get_size()._x,0|this._entity.transform.get_size()._y),i=e.isRendering,n=e.buffer;return i&&e.end(),e.setRenderTarget(t),e.begin(),e.end(),e.setRenderTarget(n),i&&e.begin(),new de(t)},beforeDestroy:function(){g.prototype.beforeDestroy.call(this),this.visible=!0,this.color=16777215,this._alpha=1,this._localAlpha=1,this._dirtyAlpha=!0},get_isVisible:function(){return!!this.visible&&0<this.get_alpha()},get_localAlpha:function(){return this._localAlpha},set_localAlpha:function(e){return e==this._localAlpha?this._localAlpha:(this._dirtyAlpha=!0,this._localAlpha=e)},get_alpha:function(){if(this._dirtyAlpha)if(null!=this._entity&&null!=this._entity.transform._parent){var e=this._entity.transform._parent.entity._renderer;this._alpha=e.get_alpha()*this._localAlpha,this._dirtyAlpha=!1}else this._alpha=this._localAlpha,this._entity._isRoot&&(this._dirtyAlpha=!1);return this._alpha},set_alpha:function(e){if(e==this._alpha)return this._alpha;if(null!=this._entity&&null!=this._entity.transform._parent){var t=this._entity.transform._parent.entity._renderer;this._localAlpha=t.get_alpha()*e}else this._localAlpha=e;return this._alpha=e},get___typeName__:function(){return"gecko.components.draw.DrawComponent"},get___type__:function(){return Z},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Z.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Z.__pool__.safePut(this))},__class__:Z,__properties__:s(g.prototype.__properties__,{get_isVisible:"get_isVisible",set_alpha:"set_alpha",get_alpha:"get_alpha",set_localAlpha:"set_localAlpha",get_localAlpha:"get_localAlpha"})});var j=function(){this._index=-1,this.animations=[],this.isPaused=!1,this.isPlaying=!1,Z.call(this);this.onPlay={handlers:[]};this.onStop={handlers:[]};this.onStart={handlers:[]};this.onEnd={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]};this.onLoop={handlers:[]}};(i["gecko.components.draw.AnimationComponent"]=j).__name__=!0,j.create=function(){var e=j.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},j.getPool=function(){return j.__pool__},j.__super__=Z,j.prototype=s(Z.prototype,{isPlaying:null,isPaused:null,animations:null,onPlay:null,onStop:null,onStart:null,onEnd:null,onPause:null,onResume:null,onLoop:null,_texture:null,_index:null,init:function(){this.onAddedToEntity.handlers.push(Ts(this,this._setTransformSize))},beforeDestroy:function(){Z.prototype.beforeDestroy.call(this);for(var e=this.animations.pop();null!=e;)e.destroy(),e=this.animations.pop();this._texture=null,this._index=-1,this.isPlaying=!1,this.isPaused=!1,$.remove(this.onAddedToEntity.handlers,Ts(this,this._setTransformSize)),De.clear(this.onPlay),De.clear(this.onStop),De.clear(this.onStart),De.clear(this.onEnd),De.clear(this.onPause),De.clear(this.onResume),De.clear(this.onLoop)},_setTransformSize:function(e){if(null!=e.transform&&null!=this._texture){var t=this._texture._width,i=this._texture._height;e.transform.get_size().set(t,i)}},addAnimFromGridAssets:function(e,t,i,n,s,r,a,o){null==o&&(o=!1),null==a&&(a=0);var l=y.textures;return this._add(Y.createFromGrid(e,t,null!=Ns[i]?l.getReserved(i):l.h[i],n,s,r,a,o))},addAnimFromGrid:function(e,t,i,n,s,r,a,o){return null==o&&(o=!1),null==a&&(a=0),this._add(Y.createFromGrid(e,t,i,n,s,r,a,o))},addAnimFromAssets:function(e,t,i,n){return null==n&&(n=!1),this._add(Y.createFromAssets(e,t,i,n))},addAnim:function(e,t,i,n){var s=Y.__pool__.get();return s.init(e,t,i,n),s.isAlreadyDestroyed=!1,this._add(s)},_add:function(e){return this.animations.push(e),e},_getIndexByName:function(e){for(var t=0,i=this.animations.length;t<i;){var n=t++;if(this.animations[n].name==e)return n}return-1},setTextureFrame:function(e,t){null==t&&(t=0);var i=this.animations[this._getIndexByName(e)];i.index=t,this.set_texture(i.frames[i.index])},play:function(e,t,i){if(null==i&&(i=!1),null==t&&(t=!1),0!=this.animations.length){this.isPlaying=!0,null!=e?this._index=this._getIndexByName(e):-1==this._index&&(this._index=0);var n=this.animations[this._index];n.reset(i),n.loop=t,this.set_texture(n.frames[n.index]);var s=this.onPlay.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(e)}}},stop:function(){if(this.isPlaying){this.isPlaying=!1;var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(this.animations[this._index].name)}}},pause:function(){if(this.isPlaying&&!this.isPaused){this.isPaused=!0;var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(this.animations[this._index].name)}}},resume:function(){if(this.isPlaying&&this.isPaused){this.isPaused=!1;var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(this.animations[this._index].name)}}},getAnimName:function(){return-1!=this._index?this.animations[this._index].name:""},update:function(e){if(this.isPlaying&&!this.isPaused&&null!=this._texture&&-1!=this._index&&0!=this.animations.length){var t=this.animations[this._index];if(!t.isStarted){t.isStarted=!0;var i=this.onStart.handlers;if(0!=i.length)for(var n=0;n<i.length;){var s=i[n];++n,s(t.name)}}if(t.elapsedTime+=e,t.elapsedTime>=t.time){if(t.elapsedTime=0,!t.loop){t.index=0,this.isPlaying=!1,t.isStarted=!1;var r=this.onEnd.handlers;if(0!=r.length)for(var a=0;a<r.length;){var o=r[a];++a,o(t.name)}return}var l=this.onLoop.handlers;if(0!=l.length)for(var _=0;_<l.length;){var h=l[_];++_,h(t.name)}}var u=Math.floor(t.elapsedTime*t.frames.length/t.time);u!=t.index&&(t.index=u,this.set_texture(t.frames[t.index]))}},draw:function(e){if(null!=this._texture){var t=this._texture;if(t.rotated){e._swtTemp=t.frame.width*t.pivot._x,e._shtTemp=t.frame.height*t.pivot._y,e.buffer.get_g2().pushTransformation(new D(1,0,-e._swtTemp,0,1,-e._shtTemp,0,0,1)),e.buffer.get_g2().rotate(-.5*Math.PI,0,0);var i=e.buffer.get_g2();i.transformations[i.transformations.length-1]._20+=e._shtTemp;var n=e.buffer.get_g2();n.transformations[n.transformations.length-1]._21+=e._swtTemp,null!=t.trim?e.buffer.get_g2().drawSubImage(t.image,0-t.trim.x,t.trim.y,t.frame.x,t.frame.y,t.trim.width,t.trim.height):e.buffer.get_g2().drawSubImage(t.image,0,0,t.frame.x,t.frame.y,t.frame.width,t.frame.height),e.buffer.get_g2().popTransformation()}else null!=t.trim?e.buffer.get_g2().drawSubImage(t.image,t.trim.x,t.trim.y,t.frame.x,t.frame.y,t.trim.width,t.trim.height):e.buffer.get_g2().drawSubImage(t.image,0,0,t.frame.x,t.frame.y,t.frame.width,t.frame.height)}},set_texture:function(e){if(e==this._texture)return this._texture;if(this._texture=e,null!=this._texture&&null!=this._entity&&null!=this._entity.transform){var t=this._texture._width,i=this._texture._height;this._entity.transform.get_size().set(t,i)}return this._texture},get_texture:function(){return this._texture},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),j.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),j.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.AnimationComponent"},get___type__:function(){return j},__class__:j,__properties__:s(Z.prototype.__properties__,{set_texture:"set_texture",get_texture:"get_texture"})});var Y=function(){this.elapsedTime=0,this.isStarted=!1,this.index=0,this.frames=[],this.time=1,this.loop=!1,this.name="",f.call(this)};(i["gecko.components.draw.AnimationData"]=Y).__name__=!0,Y.createFromGrid=function(e,t,i,n,s,r,a,o){null==o&&(o=!1),null==a&&(a=0);for(var l,_=i._width/s,h=i._height/n,u=i.frame.x,c=i.frame.y,d=[],f=0,g=n;f<g;)for(var m=f++,p=0,v=s;p<v;){var y=p++,b=i.image,w=le.__pool__.get();w.init(u+y*_,c+m*h,_,h),w.isAlreadyDestroyed=!1,d.push(new de(b,w,0|_,0|h))}if(0==a&&null==r)l=d;else if(0<a)l=d.slice(0,a);else{if(!(null!=r&&0<r.length))throw new dt("Animation "+e+": Invalid grid data");l=[];for(var x=0;x<r.length;){var S=r[x];++x,l.push(d[S])}}var B=Y.__pool__.get();return B.init(e,t,l,o),B.isAlreadyDestroyed=!1,B},Y.createFromAssets=function(n,e,t,i){null==i&&(i=!1);var s=u.array(t.map(function(e){var t=y.textures,i=null!=Ns[e]?t.getReserved(e):t.h[e];if(null==i)throw new dt("Animation "+n+": Invalid texture name "+e);return i})),r=Y.__pool__.get();return r.init(n,e,s,i),r.isAlreadyDestroyed=!1,r},Y.create=function(e,t,i,n){null==n&&(n=!1);var s=Y.__pool__.get();return s.init(e,t,i,n),s.isAlreadyDestroyed=!1,s},Y.getPool=function(){return Y.__pool__},Y.__super__=f,Y.prototype=s(f.prototype,{name:null,loop:null,time:null,frames:null,index:null,isStarted:null,elapsedTime:null,init:function(e,t,i,n){null==n&&(n=!1),this.name=e,this.time=t,this.frames=i},reset:function(e){null==e&&(e=!1),this.isStarted=!1,this.elapsedTime=0,e&&(this.index=0)},getCurrentTexture:function(){return this.frames[this.index]},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.name="",this.loop=!1,this.time=1,this.frames=[],this.index=0,this.isStarted=!1,this.elapsedTime=0},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Y.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Y.__pool__.safePut(this))},__class__:Y});var q=function(){this.outlineWidth=2,this.progress=0,Z.call(this)};(i["gecko.components.draw.ProgressBarComponent"]=q).__name__=!0,q.create=function(e,t,i){null==i&&(i=2);var n=q.__pool__.get();return n.init(e,t,i),n.isAlreadyDestroyed=!1,n},q.getPool=function(){return q.__pool__},q.__super__=Z,q.prototype=s(Z.prototype,{progress:null,lineColor:null,fillColor:null,outlineWidth:null,init:function(e,t,i){null==i&&(i=2),this.lineColor=null!=e?e:16777215,this.fillColor=null!=t?t:7048739,this.outlineWidth=i},draw:function(e){var t=this.fillColor;e.buffer.get_g2().set_color(t+-16777216),e._color=t;var i=this._entity.transform.get_size()._x*(this.progress/100),n=this._entity.transform.get_size()._y;e.buffer.get_g2().fillRect(0,0,i,n);var s=this.lineColor;e.buffer.get_g2().set_color(s+-16777216),e._color=s;var r=this._entity.transform.get_size()._x,a=this._entity.transform.get_size()._y,o=this.outlineWidth;e.buffer.get_g2().drawRect(0,0,r,a,o)},beforeDestroy:function(){Z.prototype.beforeDestroy.call(this),this.progress=0,this.outlineWidth=2},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),q.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),q.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.ProgressBarComponent"},get___type__:function(){return q},__class__:q});var Q=function(){Z.call(this)};(i["gecko.components.draw.SpriteComponent"]=Q).__name__=!0,Q.createFromTexture=function(e){var t=Q.__pool__.get();t.init(""),t.isAlreadyDestroyed=!1;var i=t;return i.set_texture(e),i},Q.create=function(e){var t=Q.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},Q.getPool=function(){return Q.__pool__},Q.__super__=Z,Q.prototype=s(Z.prototype,{_texture:null,init:function(e){var t=y.textures;this.set_texture(null!=Ns[e]?t.getReserved(e):t.h[e]),this.onAddedToEntity.handlers.push(Ts(this,this._setTransformSize))},draw:function(e){if(null!=this._texture){var t=this._texture;if(t.rotated){e._swtTemp=t.frame.width*t.pivot._x,e._shtTemp=t.frame.height*t.pivot._y,e.buffer.get_g2().pushTransformation(new D(1,0,-e._swtTemp,0,1,-e._shtTemp,0,0,1)),e.buffer.get_g2().rotate(-.5*Math.PI,0,0);var i=e.buffer.get_g2();i.transformations[i.transformations.length-1]._20+=e._shtTemp;var n=e.buffer.get_g2();n.transformations[n.transformations.length-1]._21+=e._swtTemp,null!=t.trim?e.buffer.get_g2().drawSubImage(t.image,0-t.trim.x,t.trim.y,t.frame.x,t.frame.y,t.trim.width,t.trim.height):e.buffer.get_g2().drawSubImage(t.image,0,0,t.frame.x,t.frame.y,t.frame.width,t.frame.height),e.buffer.get_g2().popTransformation()}else null!=t.trim?e.buffer.get_g2().drawSubImage(t.image,t.trim.x,t.trim.y,t.frame.x,t.frame.y,t.trim.width,t.trim.height):e.buffer.get_g2().drawSubImage(t.image,0,0,t.frame.x,t.frame.y,t.frame.width,t.frame.height)}},beforeDestroy:function(){Z.prototype.beforeDestroy.call(this),this.set_texture(null),$.remove(this.onAddedToEntity.handlers,Ts(this,this._setTransformSize))},_setTransformSize:function(e){if(null!=e.transform){var t=this._texture._width,i=this._texture._height;e.transform.get_size().set(t,i)}},get_texture:function(){return this._texture},set_texture:function(e){if(e==this._texture)return this._texture;if(this._texture=e,null!=this._texture&&null!=this._entity&&null!=this._entity.transform){var t=this._texture._width,i=this._texture._height;this._entity.transform.get_size().set(t,i)}return this._texture},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Q.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Q.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.SpriteComponent"},get___type__:function(){return Q},__class__:Q,__properties__:s(Z.prototype.__properties__,{set_texture:"set_texture",get_texture:"get_texture"})});var J=function(){this.height=0,this.width=0,this._parsedOriginX=0,this._parsedLineHeight=0,this._parsedText=[],this._splitRegex=new r("(?:\r\n|\r|\n)","g"),this._align="left",this._lineWidth=0,this._lineSpacing=0,this._fontSize=10,this._text="",this._fontName="",Z.call(this)};(i["gecko.components.draw.TextComponent"]=J).__name__=!0,J.create=function(e,t,i,n){null==n&&(n="left");var s=J.__pool__.get();return s.init(e,t,i,n),s.isAlreadyDestroyed=!1,s},J.getPool=function(){return J.__pool__},J.__super__=Z,J.prototype=s(Z.prototype,{font:null,_fontName:null,_text:null,_fontSize:null,_lineSpacing:null,_lineWidth:null,_align:null,_splitRegex:null,_parsedText:null,_parsedLineHeight:null,_parsedAlign:null,_parsedOriginX:null,width:null,height:null,init:function(e,t,i,n){null==n&&(n="left"),this.set_fontName(t),this.set_text(e),this.set_fontSize(i),this.set_align(n),this.onAddedToEntity.handlers.push(Ts(this,this._setTransformSize))},_setTransformSize:function(e){this._updateText()},beforeDestroy:function(){Z.prototype.beforeDestroy.call(this),this._text="",this._fontName="",this._fontSize=10,this.font=null},draw:function(e){if(null!=this.font){var t=this.font;e.buffer.get_g2().set_font(t),e._font=t;var i=this._fontSize;e.buffer.get_g2().set_fontSize(i),e._fontSize=i;for(var n=0,s=this._parsedText.length;n<s;){var r=n++,a=this._parsedText[r],o=this._parsedOriginX,l=this._parsedLineHeight*r,_=this._parsedAlign;wi.drawAlignedString(e.buffer.get_g2(),a,o,l,_,Bi.TextTop)}}},_updateText:function(){if(null!=this.font)switch(this._parsedText=this._splitInLines(this._text),this._parsedLineHeight=this.font.height(this._fontSize)+this._lineSpacing,this._setSize(),this._align){case"center":this._parsedAlign=xi.TextCenter,this._parsedOriginX=this.width/2;break;case"right":this._parsedAlign=xi.TextRight,this._parsedOriginX=this.width;break;default:this._parsedAlign=xi.TextLeft,this._parsedOriginX=0}},_splitInLines:function(e){var t=this._splitRegex.split(e);if(this._lineWidth<=0)return t;for(var i=this.font.width(this._fontSize," "),n=[],s=0;s<t.length;){var r=t[s];++s;for(var a=r.split(" "),o=0,l="",_=0,h=0;h<a.length;){var u=a[h];++h;var c=this.font.width(this._fontSize,u);_<a.length-1&&(c+=i),(o+=c)<=this._lineWidth?l+=0==_?u:" "+u:(l+="\n"+u,o=0),++_}n.push(l)}return n.join("\n").split("\n")},_setSize:function(){for(var e=-1,t=0,i=this._parsedText;t<i.length;){var n=i[t];++t;var s=this.font.width(this._fontSize,n);e<s&&(e=s)}this.width=e,this.height=(this.font.height(this._fontSize)+this._lineSpacing)*this._parsedText.length-this._lineSpacing,null!=this._entity&&this._entity.transform.get_size().set(this.width,this.height)},get_fontName:function(){return this._fontName},set_fontName:function(e){if(this._fontName==e)return this._fontName;this._fontName=e;var t=y.fonts;return this.font=null!=Ns[e]?t.getReserved(e):t.h[e],this._updateText(),this._fontName},get_text:function(){return this._text},set_text:function(e){return this._text==e||(this._text=e,this._updateText()),this._text},get_fontSize:function(){return this._fontSize},set_fontSize:function(e){return this._fontSize==e||(this._fontSize=e,this._updateText()),this._fontSize},get_lineSpacing:function(){return this._lineSpacing},set_lineSpacing:function(e){return this._lineSpacing==e||(this._lineSpacing=e,this._updateText()),this._lineSpacing},set_lineWidth:function(e){return this._lineWidth==e||(this._lineWidth=e,this._updateText()),this._lineWidth},get_lineWidth:function(){return this._lineWidth},set_align:function(e){return this._align==e||(this._align=e,this._updateText()),this._align},get_align:function(){return this._align},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),J.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),J.__pool__.safePut(this))},get___typeName__:function(){return"gecko.components.draw.TextComponent"},get___type__:function(){return J},__class__:J,__properties__:s(Z.prototype.__properties__,{set_align:"set_align",get_align:"get_align",set_lineWidth:"set_lineWidth",get_lineWidth:"get_lineWidth",set_lineSpacing:"set_lineSpacing",get_lineSpacing:"get_lineSpacing",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_text:"set_text",get_text:"get_text",set_fontName:"set_fontName",get_fontName:"get_fontName"})});var ie=function(){g.call(this)};(i["gecko.components.motion.MovementComponent"]=ie).__name__=!0,ie.create=function(e,t,i){var n=ie.__pool__.get();return n.init(e,t,i),n.isAlreadyDestroyed=!1,n},ie.getPool=function(){return ie.__pool__},ie.__super__=g,ie.prototype=s(g.prototype,{speed:null,acceleration:null,friction:null,init:function(e,t,i){var n,s;if(this.speed=e,null!=t)n=t;else{var r=oe.__pool__.get();r.init(0,0),r.isAlreadyDestroyed=!1,n=r}if(this.acceleration=n,null!=i)s=i;else{var a=oe.__pool__.get();a.init(0,0),a.isAlreadyDestroyed=!1,s=a}this.friction=s},beforeDestroy:function(){this.speed.destroy(),this.speed=null,this.acceleration.destroy(),this.acceleration=null,this.friction.destroy(),this.friction=null,g.prototype.beforeDestroy.call(this)},get___typeName__:function(){return"gecko.components.motion.MovementComponent"},get___type__:function(){return ie},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ie.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ie.__pool__.safePut(this))},__class__:ie});var ne=function(){g.call(this)};(i["gecko.components.motion.RotationComponent"]=ne).__name__=!0,ne.create=function(e,t){null==t&&(t=0);var i=ne.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},ne.getPool=function(){return ne.__pool__},ne.__super__=g,ne.prototype=s(g.prototype,{speed:null,acceleration:null,init:function(e,t){null==t&&(t=0),this.speed=e,this.acceleration=t},beforeDestroy:function(){this.speed=0,this.acceleration=0,g.prototype.beforeDestroy.call(this)},get___typeName__:function(){return"gecko.components.motion.RotationComponent"},get___type__:function(){return ne},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ne.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ne.__pool__.safePut(this))},__class__:ne});var se=function(){this._time=-1,this._index=0,this._comboData=[],this.combo="",f.call(this);this.onTrigger={handlers:[]}};(i["gecko.input.ComboKey"]=se).__name__=!0,se.create=function(e,t){null==t&&(t=750);var i=se.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},se.getPool=function(){return se.__pool__},se.__super__=f,se.prototype=s(f.prototype,{combo:null,length:null,timeTreshold:null,_comboData:null,_index:null,_time:null,onTrigger:null,init:function(e,t){null==t&&(t=750),this.combo=e,this.timeTreshold=t,this._parseCombo(),ae.onPressed.handlers.push(Ts(this,this._onKeyPress))},beforeDestroy:function(){for(f.prototype.beforeDestroy.call(this),De.clear(this.onTrigger);null!=this._comboData.pop(););this.combo="",this._restart(),$.remove(ae.onPressed.handlers,Ts(this,this._onKeyPress))},_restart:function(){this._time=-1,this._index=0},_onKeyPress:function(e){var t=(new Date).getTime();if(-1!=this._time&&t-this._time>this.timeTreshold)this._restart();else{var i=this._comboData[this._index];if(1==i.kind)if(-1!=i.keys.indexOf(e)){for(var n=!0,s=0,r=i.keys;s<r.length;){var a=r[s];if(++s,!ae.isDown(a)){n=!1;break}}if(n&&(this._nextKey(),this._index==this._comboData.length)){var o=this.onTrigger.handlers;if(0!=o.length)for(var l=0;l<o.length;){var _=o[l];++l,_()}this._restart()}}else 0<this._index&&(this._restart(),this._onKeyPress(e));else if(e!=i.keys[0]){if(0<this._index)return this._restart(),void this._onKeyPress(e)}else if(this._nextKey(),this._index==this._comboData.length){var h=this.onTrigger.handlers;if(0!=h.length)for(var u=0;u<h.length;){var c=h[u];++u,c()}this._restart()}}},_fire:function(){var e=this.onTrigger.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}this._restart()},_nextKey:function(){this._time=(new Date).getTime(),this._index<this._comboData.length&&this._index++},_isComplete:function(){return this._index==this._comboData.length},_parseCombo:function(){for(var e=this.combo.split(" "),t=0;t<e.length;){var i=e[t];if(++t,-1!=i.indexOf("+")){for(var n=i.split("+"),s={kind:1,keys:[]},r=0;r<n.length;){var a=n[r];++r;var o=ae.keyList;if(null!=Ns[a]?!o.existsReserved(a):!o.h.hasOwnProperty(a))throw new dt("Invalid keyname: "+a);var l=ae.keyList;s.keys.push(null!=Ns[a]?l.getReserved(a):l.h[a])}this._comboData.push(s)}else{var _=ae.keyList;if(null!=Ns[i]?!_.existsReserved(i):!_.h.hasOwnProperty(i))throw new dt("Invalid keyname: "+i);var h=ae.keyList,u={kind:0,keys:[null!=Ns[i]?h.getReserved(i):h.h[i]]};this._comboData.push(u)}}},get_length:function(){return this.onTrigger.handlers.length},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),se.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),se.__pool__.safePut(this))},__class__:se,__properties__:{get_length:"get_length"}});var re=function(){this.key=0,f.call(this)};(i["gecko.input.HotKey"]=re).__name__=!0,re.create=function(e){var t=re.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},re.getPool=function(){return re.__pool__},re.__super__=f,re.prototype=s(f.prototype,{key:null,wasPressed:null,wasReleased:null,isDown:null,downDuration:null,isControlDown:null,isAltDown:null,isShiftDown:null,init:function(e){this.key=e},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.key=0},get_downDuration:function(){var e=this.key;return ae._downKeys.exists(e)?ae._downKeys.get(e):-1},get_wasPressed:function(){return ae._pressedKeys.exists(this.key)},get_wasReleased:function(){return ae._releasedKeys.exists(this.key)},get_isDown:function(){return ae.isDown(this.key)},get_isControlDown:function(){return ae.isDown(17)},get_isShiftDown:function(){return ae.isDown(16)},get_isAltDown:function(){return ae.isDown(18)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),re.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),re.__pool__.safePut(this))},__class__:re,__properties__:{get_isShiftDown:"get_isShiftDown",get_isAltDown:"get_isAltDown",get_isControlDown:"get_isControlDown",get_downDuration:"get_downDuration",get_isDown:"get_isDown",get_wasReleased:"get_wasReleased",get_wasPressed:"get_wasPressed"}});var ae=function(){ae.onPressed={handlers:[]};ae.onReleased={handlers:[]};ae.onDown={handlers:[]}};(i["gecko.input.Keyboard"]=ae).__name__=!0,ae.enable=function(){ae._pressedKeys=new Ge,ae._downKeys=new Ge,ae._releasedKeys=new Ge,xn.get().notify(ae._keyDownHandler,ae._keyUpHandler,null),ae.isEnabled=!0,d.onUpdate.handlers.push(ae.update)},ae.disable=function(){$.remove(d.onUpdate.handlers,ae.update),ae.isEnabled=!1,xn.get().remove(ae._keyDownHandler,ae._keyUpHandler,null)},ae.getHotKey=function(e){if(ae._hotKeys.h.hasOwnProperty(e))return ae._hotKeys.h[e];var t=re.__pool__.get();t.init(e),t.isAlreadyDestroyed=!1;var i=t;return ae._hotKeys.h[e]=i},ae.bindCombo=function(e,t,i){null==i&&(i=750);var n=ae._combos;if(!(null!=Ns[e]?n.existsReserved(e):n.h.hasOwnProperty(e))){var s=ae._combos,r=se.__pool__.get();r.init(e,i),r.isAlreadyDestroyed=!1;var a=r,o=s;null!=Ns[e]?o.setReserved(e,a):o.h[e]=a}var l=ae._combos;(null!=Ns[e]?l.getReserved(e):l.h[e]).onTrigger.handlers.push(t)},ae.unbindCombo=function(e,t){var i=ae._combos;if(null!=Ns[e]?i.existsReserved(e):i.h.hasOwnProperty(e)){var n=ae._combos,s=(null!=Ns[e]?n.getReserved(e):n.h[e]).onTrigger;$.remove(s.handlers,t);var r=ae._combos;if(0==(null!=Ns[e]?r.getReserved(e):r.h[e]).onTrigger.handlers.length){ae._combos.remove(e);var a=ae._combos;(null!=Ns[e]?a.getReserved(e):a.h[e]).destroy()}}},ae.update=function(e){for(var t=ae._pressedKeys.keys();t.hasNext();){var i=t.next(),n=ae.onPressed.handlers;if(0!=n.length)for(var s=0;s<n.length;){var r=n[s];++s,r(i)}ae._pressedKeys.remove(i)}for(var a=ae._downKeys.keys();a.hasNext();){var o=a.next(),l=o,_=ae._downKeys,h=_.h[l]+e;_.h[l]=h;var u=ae.onDown.handlers;if(0!=u.length)for(var c=0;c<u.length;){var d=u[c];++c,d(o,ae._downKeys.h[o])}}for(var f=ae._releasedKeys.keys();f.hasNext();){var g=f.next(),m=ae.onReleased.handlers;if(0!=m.length)for(var p=0;p<m.length;){var v=m[p];++p,v(g)}ae._releasedKeys.remove(g)}},ae._keyDownHandler=function(e){ae._pressedKeys.h[e]=!0,ae._downKeys.h[e]=0},ae._keyUpHandler=function(e){ae._pressedKeys.remove(e),ae._downKeys.remove(e),ae._releasedKeys.h[e]=!0},ae.wasPressed=function(e){return ae._pressedKeys.h.hasOwnProperty(e)},ae.wasReleased=function(e){return ae._releasedKeys.h.hasOwnProperty(e)},ae.isDown=function(e,t){return null==t&&(t=-1),-1!=t?!!ae._downKeys.h.hasOwnProperty(e)&&ae._downKeys.h[e]<=t:ae._downKeys.h.hasOwnProperty(e)},ae.downDuration=function(e){return ae._downKeys.h.hasOwnProperty(e)?ae._downKeys.h[e]:-1},ae.prototype={__class__:ae};var oe=function(){this._y=0,this._x=0,this._vec2=new P,f.call(this)};(i["gecko.math.Point"]=oe).__name__=!0,oe.create=function(e,t){null==t&&(t=0),null==e&&(e=0);var i=oe.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},oe.getPool=function(){return oe.__pool__},oe.__super__=f,oe.prototype=s(f.prototype,{_vec2:null,_x:null,_y:null,_observer:null,isObserved:null,init:function(e,t){null==t&&(t=0),null==e&&(e=0),this.set(e,t)},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this._observer=null,this.isObserved=!1,this._vec2.x=this._x=0,this._vec2.y=this._y=0},_setX:function(e){this._vec2.x=this._x=e},_setY:function(e){this._vec2.y=this._y=e},getVec2:function(){return this._vec2},setObserver:function(e){this.isObserved=!0,this._observer=e},removeObserver:function(){this.isObserved=!1},set:function(e,t){e==this._x&&t==this._y||(this._vec2.x=this._x=e,this._vec2.y=this._y=t,this.isObserved&&this._observer(this))},setFloor:function(e,t){this.set(Math.floor(e),Math.floor(t))},setCeil:function(e,t){this.set(Math.ceil(e),Math.ceil(t))},setRound:function(e,t){this.set(Math.round(e),Math.round(t))},floor:function(){this.set(Math.floor(this._x),Math.floor(this._y))},ceil:function(){this.set(Math.ceil(this._x),Math.ceil(this._y))},round:function(){this.set(Math.round(this._x),Math.round(this._y))},clone:function(){var e=this._x,t=this._y,i=oe.__pool__.get();return i.init(e,t),i.isAlreadyDestroyed=!1,i},copy:function(e){this.set(e._x,e._y)},isEqual:function(e){return this._x==e._x&&this._y==e._y},add:function(e){this.set(this._x+e._x,this._y+e._y)},sub:function(e){this.set(this._x-e._x,this._y-e._y)},mult:function(e){this.set(this._x*e,this._y*e)},div:function(e){var t=1/e;this.set(this._x*t,this._y*t)},dot:function(e){return this._x*e._x+this._y*e._y},toString:function(){return"Point("+this._x+", "+this._y+")"},get_x:function(){return this._x},set_x:function(e){return e==this._x?this._x:(this._vec2.x=this._x=e,this.isObserved&&this._observer(this),e)},get_y:function(){return this._y},set_y:function(e){return e==this._y?this._y:(this._vec2.y=this._y=e,this.isObserved&&this._observer(this),e)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),oe.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),oe.__pool__.safePut(this))},__class__:oe,__properties__:{set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}});var le=function(){this.height=0,this.width=0,this.y=0,this.x=0,f.call(this)};(i["gecko.math.Rect"]=le).__name__=!0,le.fromSquare=function(e){var t=le.__pool__.get();return t.init(0,0,e,e),t.isAlreadyDestroyed=!1,t},le.fromRectangle=function(e,t){var i=le.__pool__.get();return i.init(0,0,e,t),i.isAlreadyDestroyed=!1,i},le.create=function(e,t,i,n){null==n&&(n=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0);var s=le.__pool__.get();return s.init(e,t,i,n),s.isAlreadyDestroyed=!1,s},le.getPool=function(){return le.__pool__},le.__super__=f,le.prototype=s(f.prototype,{x:null,y:null,width:null,height:null,top:null,bottom:null,left:null,right:null,centerX:null,centerY:null,init:function(e,t,i,n){null==n&&(n=0),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.set(e,t,i,n)},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.clear()},set:function(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n},clear:function(){this.x=0,this.y=0,this.width=0,this.height=0},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},clone:function(){var e=this.x,t=this.y,i=this.width,n=this.height,s=le.__pool__.get();return s.init(e,t,i,n),s.isAlreadyDestroyed=!1,s},contains:function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},containsPoint:function(e){return this.contains(e._x,e._y)},containsRect:function(e){return!!(this.contains(e.x,e.y)&&this.contains(e.x,e.y+e.height)&&this.contains(e.x+e.width,e.y))&&this.contains(e.x+e.width,e.y+e.height)},intersect:function(e){return!!(this.contains(e.x,e.y)||this.contains(e.x,e.y+e.height)||this.contains(e.x+e.width,e.y))||this.contains(e.x+e.width,e.y+e.height)},get_top:function(){return this.y},get_bottom:function(){return this.y+this.height},get_left:function(){return this.x},get_right:function(){return this.x+this.width},get_centerX:function(){return this.x+this.width/2},get_centerY:function(){return this.y+this.height/2},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),le.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),le.__pool__.safePut(this))},__class__:le,__properties__:{get_centerY:"get_centerY",get_centerX:"get_centerX",get_right:"get_right",get_left:"get_left",get_bottom:"get_bottom",get_top:"get_top"}});var _e=function(e,t){e==this._x&&t==this._y||(this._x=e,this._y=t,this.isObserved&&this._observer(this))};(i["gecko.math.Vector2g"]=_e).__name__=!0,_e.prototype={_x:null,_y:null,_observer:null,isObserved:null,setObserver:function(e){this.isObserved=!0,this._observer=e},removeObserver:function(){this.isObserved=!1},set:function(e,t){e==this._x&&t==this._y||(this._x=e,this._y=t,this.isObserved&&this._observer(this))},_setX:function(e){this._x=e},_setY:function(e){this._y=e},clone:function(e){return new _e(this._x,this._y)},copy:function(e){var t=e._x,i=e._y;t==this._x&&i==this._y||(this._x=t,this._y=i,this.isObserved&&this._observer(this))},isEqual:function(e){return this._x==e._x&&this._y==e._y},get_x:function(){return this._x},set_x:function(e){return e==this._x?this._x:(this._x=e,this.isObserved&&this._observer(this),e)},set_y:function(e){return e==this._y?this._y:(this._y=e,this.isObserved&&this._observer(this),e)},get_y:function(){return this._y},toString:function(){return"Vector2g("+N.string(this._x)+", "+N.string(this._y)+")"},__class__:_e,__properties__:{set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var he=i["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"]};he.Add=["Add",0],he.Add.toString=n,(he.Add.__enum__=he).Subtract=["Subtract",1],he.Subtract.toString=n,(he.Subtract.__enum__=he).ReverseSubtract=["ReverseSubtract",2],he.ReverseSubtract.toString=n,(he.ReverseSubtract.__enum__=he).Min=["Min",3],he.Min.toString=n,(he.Min.__enum__=he).Max=["Max",4],he.Max.toString=n,he.Max.__enum__=he;var ue=i["kha.graphics4.BlendingFactor"]={__ename__:!0,__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"]};ue.Undefined=["Undefined",0],ue.Undefined.toString=n,(ue.Undefined.__enum__=ue).BlendOne=["BlendOne",1],ue.BlendOne.toString=n,(ue.BlendOne.__enum__=ue).BlendZero=["BlendZero",2],ue.BlendZero.toString=n,(ue.BlendZero.__enum__=ue).SourceAlpha=["SourceAlpha",3],ue.SourceAlpha.toString=n,(ue.SourceAlpha.__enum__=ue).DestinationAlpha=["DestinationAlpha",4],ue.DestinationAlpha.toString=n,(ue.DestinationAlpha.__enum__=ue).InverseSourceAlpha=["InverseSourceAlpha",5],ue.InverseSourceAlpha.toString=n,(ue.InverseSourceAlpha.__enum__=ue).InverseDestinationAlpha=["InverseDestinationAlpha",6],ue.InverseDestinationAlpha.toString=n,(ue.InverseDestinationAlpha.__enum__=ue).SourceColor=["SourceColor",7],ue.SourceColor.toString=n,(ue.SourceColor.__enum__=ue).DestinationColor=["DestinationColor",8],ue.DestinationColor.toString=n,(ue.DestinationColor.__enum__=ue).InverseSourceColor=["InverseSourceColor",9],ue.InverseSourceColor.toString=n,(ue.InverseSourceColor.__enum__=ue).InverseDestinationColor=["InverseDestinationColor",10],ue.InverseDestinationColor.toString=n,ue.InverseDestinationColor.__enum__=ue;var ce=function(e,t,i){this._compiled=!1,this.source=e,this.destination=t,this.operation=i,this._compile()};(i["gecko.render.BlendMode"]=ce).__name__=!0,ce.Create=function(e,t,i){return new ce(e,t,null!=i?i:he.Add)},ce.prototype={source:null,destination:null,operation:null,_blendPipeline:null,_compiled:null,getPipeline:function(){return this._blendPipeline},_compile:function(){if(!this._compiled)if(d.isIniaited){this._blendPipeline=new rn;var e=new yn;e.add("vertexPosition",mn.Float3),e.add("texPosition",mn.Float2),e.add("vertexColor",mn.Float4),this._blendPipeline.inputLayout=[e],this._blendPipeline.fragmentShader=At.painter_image_frag,this._blendPipeline.vertexShader=At.painter_image_vert,this._blendPipeline.blendSource=this.source,this._blendPipeline.blendDestination=this.destination,this._blendPipeline.blendOperation=this.operation,this._blendPipeline.compile(),this._compiled=!0}else d.addOnKhaInitCallback(Ts(this,this._compile))},__class__:ce};var de=function(e,t,i,n,s){if(this.rotated=!1,this.image=e,null!=t)this.frame=t;else{var r=this.image.get_width(),a=this.image.get_height(),o=le.__pool__.get();o.init(0,0,r,a),o.isAlreadyDestroyed=!1,this.frame=o}null!=s&&(this.trim=s),this._width=null!=i?i:this.image.get_width(),this._height=null!=n?n:this.image.get_height()};(i["gecko.resources.Texture"]=de).__name__=!0,de.fromTexturePacker=function(e,t){var i=null,n=null;if(t.rotated){var s=t.frame.x,r=t.frame.y,a=t.frame.h,o=t.frame.w,l=le.__pool__.get();l.init(s,r,a,o),l.isAlreadyDestroyed=!1,i=l}else{var _=t.frame.x,h=t.frame.y,u=t.frame.w,c=t.frame.h,d=le.__pool__.get();d.init(_,h,u,c),d.isAlreadyDestroyed=!1,i=d}if(t.trimmed){var f=t.spriteSourceSize.x,g=t.spriteSourceSize.y,m=t.spriteSourceSize.w,p=t.spriteSourceSize.h,v=le.__pool__.get();v.init(f,g,m,p),v.isAlreadyDestroyed=!1,n=v}var y=new de(e,i,t.sourceSize.w,t.sourceSize.h,n);y.rotated=t.rotated;var b=t.pivot.x,w=t.pivot.y,x=oe.__pool__.get();return x.init(b,w),x.isAlreadyDestroyed=!1,y.pivot=x,y},de.prototype={image:null,frame:null,trimmed:null,trim:null,rotated:null,pivot:null,width:null,_width:null,height:null,_height:null,unload:function(){this.image.unload()},get_trimmed:function(){return null!=this.trim},get_width:function(){return this._width},get_height:function(){return this._height},__class__:de,__properties__:{get_height:"get_height",get_width:"get_width",get_trimmed:"get_trimmed"}};var fe=function(){this.clear()};(i["gecko.systems.Filter"]=fe).__name__=!0,fe.prototype={_query:null,clear:function(){return this._query={is:null,equal:null,base:[],baseAll:[],any:[],all:[],not:[]},this},is:function(e){return this._query.is=e,this},equal:function(e){return this._query.equal=e,this},base:function(e){return this._query.base=e,this},baseAll:function(e){return this._query.base=e,this},any:function(e){return this._query.any=e,this},addAny:function(e){return-1==this._query.any.indexOf(e)&&this._query.any.push(e),this},all:function(e){return this._query.all=e,this},addAll:function(e){return-1==this._query.all.indexOf(e)&&this._query.all.push(e),this},addBase:function(e){return-1==this._query.base.indexOf(e)&&this._query.base.push(e),this},_isEmptyQuery:function(){return null==this._query.is&&null==this._query.equal&&0==this._query.any.length&&0==this._query.all.length&&0==this._query.base.length},testEntity:function(e){if(null==this._query.is&&null==this._query.equal&&0==this._query.any.length&&0==this._query.all.length&&0==this._query.base.length)return!1;var t=e._componentsList;if(0!=t.length){if(null!=this._query.is){for(var i=!1,n=0;n<t.length;){var s=t[n];if(++n,Ai.__instanceof(s,this._query.is)){i=!0;break}}if(!i)return!1}if(null!=this._query.equal){var r=e._components.h,a=W.fromComponent(this._query.equal).__componentName__;if(!r.hasOwnProperty(a))return!1}if(0!=this._query.any.length){for(var o=!1,l=0,_=this._query.any;l<_.length;){var h=_[l];++l;var u=e._components.h,c=W.fromComponent(h).__componentName__;if(u.hasOwnProperty(c)){o=!0;break}}if(!o)return!1}if(0!=this._query.all.length){for(var d=!0,f=0,g=this._query.all;f<g.length;){var m=g[f];++f;var p=e._components.h,v=W.fromComponent(m).__componentName__;if(!p.hasOwnProperty(v)){d=!1;break}}if(!d)return!1}if(0!=this._query.base.length){for(var y=!1,b=0,w=this._query.base;b<w.length;){var x=w[b];if(++b,e._componentTypes.exists(W.fromComponent(x).__componentName__)){y=!0;break}}if(!y)return!1}if(0!=this._query.baseAll.length){for(var S=!0,B=0,T=this._query.base;B<T.length;){var k=T[B];if(++B,!e._componentTypes.exists(W.fromComponent(k).__componentName__)){S=!1;break}}if(!S)return!1}return!0}return!1},__class__:fe};var ge=function(){this.filter=new fe,this._entities=new Ge,this._entitiesList=[],this.requiredComponents=[],this.priority=0,this._name="",this._scene=null,this.enabled=!0,f.call(this);this.onEntityAdded={handlers:[]};this.onEntityRemoved={handlers:[]};this.onAddedToScene={handlers:[]};this.onRemovedFromScene={handlers:[]}};(i["gecko.systems.System"]=ge).__name__=!0,ge.getName=function(e){return me.fromSystem(e).__systemName__},ge._toClass=function(e){return me.fromSystem(e)},ge.create=function(){var e=ge.__pool__.get();return e.isAlreadyDestroyed=!1,e},ge.getPool=function(){return ge.__pool__},ge.__super__=f,ge.prototype=s(f.prototype,{enabled:null,_scene:null,_name:null,priority:null,requiredComponents:null,_entitiesList:null,_entities:null,filter:null,onEntityAdded:null,onEntityRemoved:null,onAddedToScene:null,onRemovedFromScene:null,process:function(e){this.update(e)},update:function(e){},draw:function(e){},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.removeAllEntities(),this.set_scene(null),this.filter.clear(),De.clear(this.onEntityAdded),De.clear(this.onEntityRemoved),De.clear(this.onAddedToScene),De.clear(this.onRemovedFromScene)},eachEntity:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];++t,n.enabled&&e(n)}},getEntities:function(){return this._entitiesList},getEntitiesWithComponent:function(n){return u.array(this._entitiesList.filter(function(e){var t=e._components.h,i=W.fromComponent(n).__componentName__;return t.hasOwnProperty(i)}))},isValidEntity:function(e){return this.filter.testEntity(e)},removeAllEntities:function(){for(var e=0,t=this._entitiesList;e<t.length;){var i=t[e];++e,this._removeEntity(i)}},hasEntity:function(e){return this._entities.h.hasOwnProperty(e.id)},_registerEntity:function(e){if(this.isValidEntity(e)){this._entitiesList.push(e),(this._entities.h[e.id]=e).onComponentRemoved.handlers.push(Ts(this,this._onEntityRemoveComponent));var t=this.onEntityAdded.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}}},_onEntityRemoveComponent:function(e,t){this.isValidEntity(e)||this._removeEntity(e)},_removeEntity:function(e){$.remove(e.onComponentRemoved.handlers,Ts(this,this._onEntityRemoveComponent)),$.remove(this._entitiesList,e),this._entities.remove(e.id);var t=this.onEntityRemoved.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}},_removeAllEntities:function(){for(var e=0,t=this._entitiesList;e<t.length;){var i=t[e];++e,this._removeEntity(i)}},get_name:function(){return""==this._name?this.get___typeName__():this._name},set_name:function(e){return this._name=e},get_scene:function(){return this._scene},set_scene:function(e){if(e==this._scene)return this._scene;if(null!=this._scene){var t=this.onRemovedFromScene.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this._scene)}}if(this._scene=e,null!=this._scene){var s=this.onAddedToScene.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(this._scene)}}return this._scene},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ge.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ge.__pool__.safePut(this))},__type__:null,__typeName__:null,get___type__:function(){return ge},get___typeName__:function(){return"gecko.systems.System"},__class__:ge,__properties__:{get___typeName__:"get___typeName__",get___type__:"get___type__",set_name:"set_name",get_name:"get_name",set_scene:"set_scene",get_scene:"get_scene"}});var me={};(i["gecko.systems._System.SystemClass_Impl_"]=me).__name__=!0,me.__properties__={get___systemName__:"get___systemName__"},me.get___systemName__=function(e){return e.__systemName__},me.fromSystem=function(e){return e};var pe=function(){ge.call(this)};(i["gecko.systems.collision.aabb.AABBSystem"]=pe).__name__=!0,pe.__interfaces__=[p],pe.create=function(){var e=pe.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},pe.getPool=function(){return pe.__pool__},pe.__super__=ge,pe.prototype=s(ge.prototype,{init:function(){this.filter.equal(H)},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];if(++t,n.enabled)for(var s=n._components.h[W.fromComponent(H).__componentName__],r=0,a=this._entitiesList;r<a.length;){var o=a[r];if(++r,o.enabled&&n!=o){var l=o._components.h[W.fromComponent(H).__componentName__],_=s.canCollideWith(o),h=l.canCollideWith(n);if(_&&h){var u=-1!=s.collidingWith.indexOf(o);if(s.left<l.right&&s.right>l.left&&s.top<l.bottom&&s.bottom>l.top)if(u){if(_){var c=s.onCollidingWith.handlers;if(0!=c.length)for(var d=0;d<c.length;){var f=c[d];++d,f(o)}}if(h){var g=l.onCollidingWith.handlers;if(0!=g.length)for(var m=0;m<g.length;){var p=g[m];++m,p(n)}}}else{if(_){s.collidingWith.push(o);var v=s.onCollideStart.handlers;if(0!=v.length)for(var y=0;y<v.length;){var b=v[y];++y,b(o)}}if(h){l.collidingWith.push(n);var w=l.onCollideStart.handlers;if(0!=w.length)for(var x=0;x<w.length;){var S=w[x];++x,S(n)}}}else if(u){if(_){$.remove(s.collidingWith,o);var B=s.onCollideStop.handlers;if(0!=B.length)for(var T=0;T<B.length;){var k=B[T];++T,k(o)}}if(h){$.remove(l.collidingWith,n);var I=l.onCollideStop.handlers;if(0!=I.length)for(var A=0;A<I.length;){var D=I[A];++A,D(n)}}}}}}}},get___typeName__:function(){return"gecko.systems.collision.aabb.AABBSystem"},get___type__:function(){return pe},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),pe.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),pe.__pool__.safePut(this))},__class__:pe});var ve=function(){this._drawingFixedOnCamera=!1,this._fixedToCamera=[],ge.call(this)};(i["gecko.systems.draw.DrawSystem"]=ve).__name__=!0,ve.__interfaces__=[p,I],ve.create=function(){var e=ve.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},ve.getPool=function(){return ve.__pool__},ve.__super__=ge,ve.prototype=s(ge.prototype,{_fixedToCamera:null,_drawingFixedOnCamera:null,init:function(){this.filter.is(Z),this.priority=5},beforeDestroy:function(){ge.prototype.beforeDestroy.call(this),this.priority=5,this._fixedToCamera.length=0},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];++t,n.enabled&&n._renderer.update(e)}},draw:function(e){for(this._drawingFixedOnCamera=!1,this._draw(e,this._scene.rootEntity.transform,this._scene.rootEntity._renderer),this._drawingFixedOnCamera=!0;0<this._fixedToCamera.length;){var t=this._fixedToCamera.shift();this._draw(e,t._entity.transform,t)}},_draw:function(e,t,i){var n;if(!this._drawingFixedOnCamera&&t._fixedToCamera){var s=this._scene.currentCameraRendering;n=!(null!=s&&0<t._visibleOnCamera.length)||-1!=t._visibleOnCamera.indexOf(s.id)}else n=!1;if(n)this._fixedToCamera.push(i);else if(i.visible&&0<i.get_alpha()){e.apply(t.get_worldMatrix(),i.color,i.get_alpha()),i.preDraw(e),i.draw(e);for(var r=0,a=t._children;r<a.length;){var o=a[r];++r;var l=o.entity;null!=l&&this._entities.h.hasOwnProperty(l.id)&&i.visible&&0<i.get_alpha()&&this._draw(e,o,l._renderer)}e.apply(t.get_worldMatrix(),i.color,i.get_alpha()),i.postDraw(e)}},_canBeRendered:function(e){return null!=e._renderer&&e._renderer.visible},get___typeName__:function(){return"gecko.systems.draw.DrawSystem"},get___type__:function(){return ve},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ve.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ve.__pool__.safePut(this))},__class__:ve});var ye=function(){ge.call(this)};(i["gecko.systems.motion.MotionSystem"]=ye).__name__=!0,ye.__interfaces__=[p],ye.create=function(){var e=ye.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},ye.getPool=function(){return ye.__pool__},ye.__super__=ge,ye.prototype=s(ge.prototype,{init:function(){this.filter.any([ie,ne])},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];if(++t,n.enabled){var s=n.transform,r=n._components.h[W.fromComponent(ie).__componentName__],a=n._components.h[W.fromComponent(ne).__componentName__];if(null!=r){if(0!=r.acceleration._x){var o=r.speed;o.set_x(o._x+r.acceleration._x*e)}else if(0<r.friction._x&&0!=r.speed._x){var l=r.friction._x*e;if(0<r.speed._x){var _=r.speed;_.set_x(_._x-l),r.speed._x<0&&r.speed.set_x(0)}else if(r.speed._x<0){var h=r.speed;h.set_x(h._x+l),0<r.speed._x&&r.speed.set_x(0)}}if(0!=r.acceleration._y){var u=r.speed;u.set_y(u._y+r.acceleration._y*e)}else if(0<r.friction._y&&0!=r.speed._y){var c=r.friction._y*e;if(0<r.speed._y){var d=r.speed;d.set_y(d._y-c),r.speed._y<0&&r.speed.set_y(0)}else if(r.speed._y<0){var f=r.speed;f.set_y(f._y+c),0<r.speed._y&&r.speed.set_y(0)}}s.get_position().set(s.get_localPosition()._x+r.speed._x*e,s.get_localPosition()._y+r.speed._y*e)}if(null!=a){a.speed+=a.acceleration*e;var g=s;g.set_localRotation(g.get_localRotation()+a.speed*e)}}}},get___typeName__:function(){return"gecko.systems.motion.MotionSystem"},get___type__:function(){return ye},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ye.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ye.__pool__.safePut(this))},__class__:ye});var be=function(){this._repeat=0,this._delayTime=0,this.elapsedTime=0,this.isPaused=!1,this.isEnded=!1,this.isStarted=!1,this.isActive=!1,this.delay=0,this.loop=!1,this.repeat=0,this.destroyOnEnd=!1,this.time=0,f.call(this);this.onStart={handlers:[]};this.onStop={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]};this.onInit={handlers:[]};this.onEnd={handlers:[]};this.onRepeat={handlers:[]};this.onUpdate={handlers:[]}};(i["gecko.timer.Timer"]=be).__name__=!0,be.create=function(e,t,i,n,s){null==n&&(n=0),null==i&&(i=!1),null==t&&(t=0);var r=be.__pool__.get();return r.init(e,t,i,n,s),r.isAlreadyDestroyed=!1,r},be.getPool=function(){return be.__pool__},be.__super__=f,be.prototype=s(f.prototype,{onStart:null,onStop:null,onPause:null,onResume:null,onInit:null,onEnd:null,onRepeat:null,onUpdate:null,time:null,destroyOnEnd:null,repeat:null,loop:null,delay:null,manager:null,isActive:null,isStarted:null,isEnded:null,isPaused:null,elapsedTime:null,_delayTime:null,_repeat:null,init:function(e,t,i,n,s){null==n&&(n=0),null==i&&(i=!1),null==t&&(t=0),this.time=e,this.delay=t,this.loop=i,this.repeat=n,this.manager=null!=s?s:d.timerManager,this.manager.timers.push(this)},update:function(e){if(!(this.time<=0||!this.isActive||this.isPaused))if(this.delay>this._delayTime)this._delayTime+=e;else{if(!this.isStarted){this.isStarted=!0;var t=this.onInit.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n()}}if(this.time>this.elapsedTime){var s=this.elapsedTime+e,r=s>=this.time;this.elapsedTime=r?this.time:s;var a=this.onUpdate.handlers;if(0!=a.length)for(var o=0;o<a.length;){var l=a[o];++o,l(this.elapsedTime,e)}if(r){if(this.loop||this.repeat>this._repeat){this._repeat++,this.elapsedTime=0;var _=this.onRepeat.handlers;if(0!=_.length)for(var h=0;h<_.length;){var u=_[h];++h,u(this._repeat)}return}this.isEnded=!0,this.isActive=!1;var c=this.onEnd.handlers;if(0!=c.length)for(var d=0;d<c.length;){var f=c[d];++d,f()}}}}},start:function(){if(!this.isActive){this.isActive=!0;var e=this.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},stop:function(){if(this.isActive){this.isActive=!1,this.reset();var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},pause:function(){if(this.isActive&&!this.isPaused){this.isPaused=!0;var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},resume:function(){if(this.isActive&&this.isPaused){this.isPaused=!1;var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},reset:function(){this._repeat=0,this._delayTime=0,this.elapsedTime=0,this.isStarted=!1,this.isEnded=!1},clear:function(){this.time=0,this.isActive=!1,this.destroyOnEnd=!1,this.repeat=0,this.loop=!1,this.delay=0,this.isStarted=!1,this.isEnded=!1,this.isPaused=!1,this.elapsedTime=0,this._delayTime=0,this._repeat=0},remove:function(){if(null!=this.manager){var e=this.manager;e._isProcessing?e._timersToDelete.push(this):$.remove(e.timers,this)}},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),null!=this.manager&&this.remove(),this.clear(),De.clear(this.onInit),De.clear(this.onStart),De.clear(this.onStop),De.clear(this.onResume),De.clear(this.onPause),De.clear(this.onEnd),De.clear(this.onRepeat),De.clear(this.onUpdate)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),be.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),be.__pool__.safePut(this))},__class__:be});var we=function(){this._unsubscribeAll=[],this._isParallelActive=!1,this.isPaused=!1,this.isActive=!1,this._repeat=0,this.loop=!1,this.repeat=0,this.timers=[],f.call(this);this.onProgress={handlers:[]};this.onRepeat={handlers:[]};this.onEnd={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.timer.TimerGroup"]=we).__name__=!0,we.create=function(e){var t=we.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},we.getPool=function(){return we.__pool__},we.__super__=f,we.prototype=s(f.prototype,{onProgress:null,onRepeat:null,onEnd:null,onPause:null,onResume:null,timers:null,repeat:null,loop:null,_repeat:null,isActive:null,isPaused:null,_isParallelActive:null,_unsubscribeAll:null,init:function(e){this.timers=e},addTimer:function(e){if(this.isActive)throw new dt("Timers can't be added after the group start.");if(e.isActive)throw new dt("Timers can't be active before added to a group");this.timers.push(e)},start:function(e){null==e&&(e=!1),this.isActive||this._start(e)},stop:function(e){null==e&&(e=!1),this.isActive&&this._stop()},pause:function(){if(this.isActive&&!this.isPaused){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.pause()}this.isPaused=!0;var n=this.onPause.handlers;if(0!=n.length)for(var s=0;s<n.length;){var r=n[s];++s,r()}}},resume:function(){if(this.isActive&&this.isPaused){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.resume()}var n=this.onResume.handlers;if(0!=n.length)for(var s=0;s<n.length;){var r=n[s];++s,r()}}},_start:function(e){var i=this;if(this.isActive=!0,this._isParallelActive=e,this._unsubscribeAll=[],e){Ae.each_gecko_timer_Timer(this.timers,Ts(this,this._timerEndCallback),Ts(this,this._onEnd));for(var t=0,n=this.timers;t<n.length;){var s=n[t];++t,s.reset(),s.start()}}else Ae.eachSeries_gecko_timer_Timer(this.timers,function(e,t){i._timerEndCallback(e,t),e.reset(),e.start()},Ts(this,this._onEnd))},_stop:function(e){null==e&&(e=!1);for(var t=0,i=this.timers;t<i.length;){var n=i[t];++t,n.stop(),n.reset()}this.isActive=!1,e&&(this._repeat=0);for(var s=0,r=this._unsubscribeAll;s<r.length;){var a=r[s];++s,a()}},_onProgress:function(e){var t=this.onProgress.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(e)}},_timerEndCallback:function(e,t){var i=this,n=null,s=n=function(){$.remove(e.onEnd.handlers,n),i._onProgress(e),t()};this._unsubscribeAll.push(function(){$.remove(e.onEnd.handlers,s)}),e.onEnd.handlers.push(s)},_onEnd:function(e){if(null!=e)throw new dt(e);if(this.loop||this.repeat>this._repeat){this._repeat++,this._stop(),this.start(this._isParallelActive);var t=this.onRepeat.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n(this._repeat)}}else{this._stop(!0);var s=this.onEnd.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a()}}},beforeDestroy:function(){f.prototype.beforeDestroy.call(this);for(var e=this.timers.pop();null!=e;)e.destroy(),e=this.timers.pop();for(;null!=this._unsubscribeAll.pop(););this.isActive=!1,this.isPaused=!1,this.repeat=0,this.loop=!1,this._repeat=0,De.clear(this.onProgress),De.clear(this.onRepeat),De.clear(this.onEnd),De.clear(this.onPause),De.clear(this.onResume)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),we.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),we.__pool__.safePut(this))},__class__:we});var xe=function(){this._isProcessing=!1,this._timersToDelete=[],this.timers=[],f.call(this)};(i["gecko.timer.TimerManager"]=xe).__name__=!0,xe.create=function(){var e=xe.__pool__.get();return e.isAlreadyDestroyed=!1,e},xe.getPool=function(){return xe.__pool__},xe.__super__=f,xe.prototype=s(f.prototype,{timers:null,_timersToDelete:null,_isProcessing:null,tick:function(e){this._isProcessing=!0;for(var t=0,i=this.timers;t<i.length;){var n=i[t];++t,n.isActive&&(n.update(e),n.isEnded&&n.destroyOnEnd&&n.destroy())}for(;0<this._timersToDelete.length;){var s=this._timersToDelete.shift();$.remove(this.timers,s)}this._isProcessing=!1},createTimer:function(e,t,i,n){null==n&&(n=0),null==i&&(i=!1),null==t&&(t=0);var s=be.__pool__.get();return s.init(e,t,i,n,this),s.isAlreadyDestroyed=!1,s},createGroup:function(e){var t=we.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},removeTimer:function(e){this._isProcessing?this._timersToDelete.push(e):$.remove(this.timers,e)},clear:function(){for(var e=0,t=this.timers;e<t.length;){var i=t[e];++e,i.clear()}},cleanTimers:function(){for(;0<this.timers.length;){this.timers.shift().destroy()}for(;0<this._timersToDelete.length;){this._timersToDelete.shift().destroy()}},_remove:function(e){$.remove(this.timers,e)},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.cleanTimers(),this._isProcessing=!1},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),xe.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),xe.__pool__.safePut(this))},__class__:xe});var Se=function(){};(i["gecko.tween.Easing"]=Se).__name__=!0,Se.linear=function(e){return e},Se.inQuad=function(e){return e*e},Se.outQuad=function(e){return e*(2-e)},Se.inOutQuad=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},Se.inCubic=function(e){return e*e*e},Se.outCubic=function(e){return--e*e*e+1},Se.inOutCubic=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},Se.inQuart=function(e){return e*e*e*e},Se.outQuart=function(e){return 1- --e*e*e*e},Se.inOutQuart=function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},Se.inQuint=function(e){return e*e*e*e*e},Se.outQuint=function(e){return--e*e*e*e*e+1},Se.inOutQuint=function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},Se.inSine=function(e){return 1-Math.cos(e*Math.PI/2)},Se.outSine=function(e){return Math.sin(e*Math.PI/2)},Se.inOutSine=function(e){return.5*(1-Math.cos(Math.PI*e))},Se.inExpo=function(e){return 0==e?0:Math.pow(1024,e-1)},Se.outExpo=function(e){return 1==e?1:1-Math.pow(2,-10*e)},Se.inOutExpo=function(e){return 0==e?0:1==e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},Se.inCirc=function(e){return 1-Math.sqrt(1-e*e)},Se.outCirc=function(e){return Math.sqrt(1- --e*e)},Se.inOutCirc=function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-2)*(e-2))+1)},Se.inElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<=1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)},Se.outElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<=1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1},Se.inOutElastic=function(e){if(0==e)return 0;if(1==e)return 1;var t,i=1;return i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-1))*Math.sin((e-1-t)*(2*Math.PI)/.4)*.5+1},Se.inBack=function(e){return e*e*(2.70158*e-1.70158)},Se.outBack=function(e){return--e*e*(2.70158*e+1.70158)+1},Se.inOutBack=function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-2)*(e-2)*((t+1)*(e-2)+t)+2)},Se.inBounce=function(e){return 1-Se.outBounce(1-e)},Se.outBounce=function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},Se.inOutBounce=function(e){return e<.5?.5*(1-Se.outBounce(1-2*e)):.5*Se.outBounce(2*e-1)+.5};var Be=function(){this._subtarget=[],this._subtargetFrom=[],this._subtargetTo=[],this._from={},this._to={},this._elapsedTime=0,this._delayTime=0,this._yoyo=!1,this.yoyo=!1,this._repeat=0,this.repeat=0,this.time=0,this.delay=0,this.loop=!1,this.easing=Se.linear,this.destroyOnEnd=!1,this.isPaused=!1,this.isStarted=!1,this.isEnded=!1,this.isActive=!1,f.call(this);this.onStart={handlers:[]};this.onStop={handlers:[]};this.onInit={handlers:[]};this.onEnd={handlers:[]};this.onUpdate={handlers:[]};this.onYoyo={handlers:[]};this.onRepeat={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.tween.Tween"]=Be).__name__=!0,Be.interpolate=function(e,t,i,n,s){return e+(t-e)*s(n/i)},Be.create=function(e,t,i,n,s){var r=Be.__pool__.get();return r.init(e,t,i,n,s),r.isAlreadyDestroyed=!1,r},Be.getPool=function(){return Be.__pool__},Be.__super__=f,Be.prototype=s(f.prototype,{onStart:null,onStop:null,onInit:null,onEnd:null,onUpdate:null,onYoyo:null,onRepeat:null,onPause:null,onResume:null,isActive:null,isEnded:null,isStarted:null,isPaused:null,destroyOnEnd:null,easing:null,loop:null,delay:null,time:null,repeat:null,_repeat:null,yoyo:null,_yoyo:null,_delayTime:null,_elapsedTime:null,target:null,manager:null,_to:null,_from:null,_subtargetTo:null,_subtargetFrom:null,_subtarget:null,init:function(e,t,i,n,s){this.target=e,this.easing=null!=n?n:Se.linear,this.manager=null!=s?s:d.tweenManager,this.manager.tweens.push(this),this.time=i,this._to=t},start:function(){if(!this.isActive){this.isActive=!0,this.reset();var e=this.onStart.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},stop:function(){if(this.isActive){this.isActive=!1,this.reset();var e=this.onStop.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},pause:function(){if(this.isActive&&!this.isPaused){this.isPaused=!0;var e=this.onPause.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},resume:function(){if(this.isActive&&this.isPaused){this.isPaused=!1;var e=this.onResume.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i()}}},_swapFromTo:function(){var e=this._subtargetTo,t=this._subtargetFrom;this._subtargetFrom=e,this._subtargetTo=t},setTo:function(e){this._to=e},setFrom:function(e){this._from=e},remove:function(){if(null!=this.manager){var e=this.manager;e._isProcessing?e._tweensToDelete.push(this):$.remove(e.tweens,this)}},reset:function(){if(this._elapsedTime=0,this._repeat=0,this._delayTime=0,this.isStarted=!1,this.isPaused=!1,this.isEnded=!1,this.yoyo&&this._yoyo){var e=this._subtargetTo,t=this._subtargetFrom;this._subtargetFrom=e,this._subtargetTo=t,this._yoyo=!1}},_canUpdate:function(){return!(!(0<this.time&&this.isActive)||this.isPaused)&&null!=this.target},update:function(e){if(0<this.time&&this.isActive&&!this.isPaused&&null!=this.target)if(this.delay>this._delayTime)this._delayTime+=e;else{if(!this.isStarted){this._parseTweenData(),this.isStarted=!0;var t=this.onInit.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n()}}if(this._subtarget.length<=0)return this.stop(),void this.reset();var s=this.yoyo?this.time/2:this.time;if(s>this._elapsedTime){var r=this._elapsedTime+e,a=s<=r;this._elapsedTime=a?s:r;for(var o=0,l=this._subtarget.length;o<l;){var _=o++;this._apply(this._subtargetTo[_],this._subtargetFrom[_],s,this._subtarget[_])}var h=this._yoyo?s+this._elapsedTime:this._elapsedTime,u=this.onUpdate.handlers;if(0!=u.length)for(var c=0;c<u.length;){var d=u[c];++c,d(h)}if(a){if(this.yoyo&&!this._yoyo){this._yoyo=!0;var f=this._subtargetTo,g=this._subtargetFrom;this._subtargetFrom=f,this._subtargetTo=g;var m=this.onYoyo.handlers;if(0!=m.length)for(var p=0;p<m.length;){var v=m[p];++p,v()}return void(this._elapsedTime=0)}if(this.loop||this.repeat>this._repeat){this._repeat++;var y=this.onRepeat.handlers;if(0!=y.length)for(var b=0;b<y.length;){var w=y[b];++b,w(this._repeat)}if(this._elapsedTime=0,this.yoyo&&this._yoyo){var x=this._subtargetTo,S=this._subtargetFrom;this._subtargetFrom=x,this._subtargetTo=S,this._yoyo=!1}return}this.isEnded=!0,this.isActive=!1;var B=this.onEnd.handlers;if(0!=B.length)for(var T=0;T<B.length;){var k=B[T];++T,k()}}}else;}},_parseTweenData:function(){this.isStarted||this._parse(this._to,this._from,this.target)},_parse:function(e,t,i){for(var n=null,s=null,r=null,a=0,o=K.fields(e);a<o.length;){var l=o[a];++a;var _=K.getProperty(e,l),h=K.getProperty(t,l),u=K.getProperty(i,l);if(K.isObject(_))this._parse(_,h,u);else{null==n&&(n=i,s=new Ii,r=new Ii),null!=Ns[l]?s.setReserved(l,_):s.h[l]=_;var c=null==h?u:h;null!=Ns[l]?r.setReserved(l,c):r.h[l]=c}}null!=n&&(this._subtarget.push(n),this._subtargetTo.push(s),this._subtargetFrom.push(r))},_apply:function(e,t,i,n){for(var s=e.keys();s.hasNext();){var r=s.next(),a=null!=Ns[r]?t.getReserved(r):t.h[r],o=(null!=Ns[r]?e.getReserved(r):e.h[r])-a,l=i,_=this._elapsedTime/l;K.setProperty(n,r,a+o*this.easing(_))}},clear:function(){this.target=null,this.time=0,this.isActive=!1,this.easing=Se.linear,this.destroyOnEnd=!1,this.repeat=0,this.loop=!1,this.delay=0,this.yoyo=!1,this.isStarted=!1,this.isPaused=!1,this.isEnded=!1,this._to=null,this._from=null,this._delayTime=0,this._elapsedTime=0,this._repeat=0,this._yoyo=!1,this._subtarget.length=0,this._subtargetFrom.length=0,this._subtargetTo.length=0},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),null!=this.manager&&this.remove(),this.clear(),De.clear(this.onInit),De.clear(this.onStart),De.clear(this.onStop),De.clear(this.onResume),De.clear(this.onPause),De.clear(this.onEnd),De.clear(this.onRepeat),De.clear(this.onUpdate),De.clear(this.onYoyo)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Be.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Be.__pool__.safePut(this))},__class__:Be});var Te=function(){this._unsubscribeAll=[],this.isParallelActive=!1,this.isPaused=!1,this.isActive=!1,this._yoyo=!1,this._repeat=0,this.loop=!1,this.repeat=0,this.yoyo=!1,this.tweens=[],f.call(this);this.onProgress={handlers:[]};this.onRepeat={handlers:[]};this.onYoyo={handlers:[]};this.onEnd={handlers:[]};this.onPause={handlers:[]};this.onResume={handlers:[]}};(i["gecko.tween.TweenGroup"]=Te).__name__=!0,Te.create=function(e){var t=Te.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},Te.getPool=function(){return Te.__pool__},Te.__super__=f,Te.prototype=s(f.prototype,{onProgress:null,onRepeat:null,onYoyo:null,onEnd:null,onPause:null,onResume:null,tweens:null,yoyo:null,repeat:null,loop:null,_repeat:null,_yoyo:null,isActive:null,isPaused:null,isParallelActive:null,_unsubscribeAll:null,init:function(e){this.tweens=e},addTween:function(e){if(this.isActive)throw new dt("Error: tweens can't be added after the group start.");if(e.isActive)throw new dt("Error: tweens can't be active before added to a group");this.tweens.push(e)},start:function(e){null==e&&(e=!1),this.isActive||this._start(e)},_start:function(e,t){null==t&&(t=!1);var i=this;this.isActive=!0,this.isParallelActive=e,this._unsubscribeAll=[];var n=t?this.tweens.slice():this.tweens;if(t&&n.reverse(),e){Ae.each_gecko_tween_Tween(n,Ts(this,this._tweenEndCallback),Ts(this,this._onEnd));for(var s=0;s<n.length;){var r=n[s];++s,r.reset(),r.start()}}else Ae.eachSeries_gecko_tween_Tween(n,function(e,t){i._tweenEndCallback(e,t),e.reset(),e.start()},Ts(this,this._onEnd))},stop:function(){this.isActive&&this._stop()},_stop:function(e){null==e&&(e=!1);for(var t=0,i=this.tweens;t<i.length;){var n=i[t];++t,n.stop(),n.reset()}this.isActive=!1,e&&(this._repeat=0,this._yoyo=!1);for(var s=0,r=this._unsubscribeAll;s<r.length;){var a=r[s];++s,a()}},pause:function(){if(this.isActive&&!this.isPaused){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.pause()}this.isPaused=!0;var n=this.onPause.handlers;if(0!=n.length)for(var s=0;s<n.length;){var r=n[s];++s,r()}}},resume:function(){if(this.isActive&&this.isPaused){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.resume()}this.isPaused=!1;var n=this.onResume.handlers;if(0!=n.length)for(var s=0;s<n.length;){var r=n[s];++s,r()}}},_tweenEndCallback:function(n,s){var r=this,e=function(){var e=r.onProgress.handlers;if(0!=e.length)for(var t=0;t<e.length;){var i=e[t];++t,i(n)}s()};this._unsubscribeAll.push(function(){$.remove(n.onEnd.handlers,e)}),n.onEnd.handlers.push(e)},_onEnd:function(e){if(null!=e)throw new dt(e);if(this.yoyo&&!this._yoyo){this._yoyo=!0,this._stop(),this._start(this.isParallelActive,!0);var t=this.onYoyo.handlers;if(0!=t.length)for(var i=0;i<t.length;){var n=t[i];++i,n()}}else if(this.loop||this.repeat>this._repeat){this._repeat++,this._yoyo=!1,this._stop(),this.start(this.isParallelActive);var s=this.onRepeat.handlers;if(0!=s.length)for(var r=0;r<s.length;){var a=s[r];++r,a(this._repeat)}}else{this._stop(!0);var o=this.onEnd.handlers;if(0!=o.length)for(var l=0;l<o.length;){var _=o[l];++l,_()}}},beforeDestroy:function(){f.prototype.beforeDestroy.call(this);for(var e=this.tweens.pop();null!=e;)e.destroy(),e=this.tweens.pop();for(;null!=this._unsubscribeAll.pop(););this.isActive=!1,this.isPaused=!1,this.isParallelActive=!1,this.yoyo=!1,this.repeat=0,this.loop=!1,this._repeat=0,this._yoyo=!1,De.clear(this.onEnd),De.clear(this.onRepeat),De.clear(this.onProgress),De.clear(this.onPause),De.clear(this.onYoyo),De.clear(this.onResume)},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),Te.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),Te.__pool__.safePut(this))},__class__:Te});var ke=function(){this._isProcessing=!1,this._tweensToDelete=[],this.tweens=[],f.call(this)};(i["gecko.tween.TweenManager"]=ke).__name__=!0,ke.create=function(){var e=ke.__pool__.get();return e.isAlreadyDestroyed=!1,e},ke.getPool=function(){return ke.__pool__},ke.__super__=f,ke.prototype=s(f.prototype,{tweens:null,_tweensToDelete:null,_isProcessing:null,tick:function(e){this._isProcessing=!0;for(var t=0,i=this.tweens;t<i.length;){var n=i[t];++t,n.isActive&&(n.update(e),n.isEnded&&n.destroyOnEnd&&n.destroy())}for(;0<this._tweensToDelete.length;){var s=this._tweensToDelete.shift();$.remove(this.tweens,s)}this._isProcessing=!1},createTween:function(e,t,i,n){var s=Be.__pool__.get();return s.init(e,t,i,n,this),s.isAlreadyDestroyed=!1,s},createGroup:function(e){var t=Te.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},removeTween:function(e){this._isProcessing?this._tweensToDelete.push(e):$.remove(this.tweens,e)},clear:function(){for(var e=0,t=this.tweens;e<t.length;){var i=t[e];++e,i.clear()}},cleanTweens:function(){for(;0<this.tweens.length;){this.tweens.shift().destroy()}for(;0<this._tweensToDelete.length;){this._tweensToDelete.shift().destroy()}},_remove:function(e){$.remove(this.tweens,e)},beforeDestroy:function(){f.prototype.beforeDestroy.call(this),this.cleanTweens(),this._isProcessing=!1},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ke.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ke.__pool__.safePut(this))},__class__:ke});var Ie=function(){};(i["gecko.utils.ArrayHelper"]=Ie).__name__=!0,Ie.clear=function(e){e.length=0},Ie.has=function(e,t){return-1!=e.indexOf(t)};var Ae=function(){};(i["gecko.utils.Chain"]=Ae).__name__=!0,Ae.eachSeries_String=function(e,s,r){var t=function(){r()},i=e.slice();i.reverse();for(var n=0,a=i.length;n<a;){t=function(i,n){return function(){var t,e=(t=i,function(e){null==e?t[0]():r(e)});s(n[0],e)}}([t],[i[n++]])}t()},Ae.eachSeries_gecko_timer_Timer=function(e,s,r){var t=function(){r()},i=e.slice();i.reverse();for(var n=0,a=i.length;n<a;){t=function(i,n){return function(){var t,e=(t=i,function(e){null==e?t[0]():r(e)});s(n[0],e)}}([t],[i[n++]])}t()},Ae.each_gecko_timer_Timer=function(t,e,i){for(var n=0,s=!1,r=0,a=t.length;r<a;){var o=r++;if(s)break;e(t[o],function(e){if(!s){if(null!=e&&""!=e)return s=!0,void i(e);(n+=1)==t.length&&i()}})}},Ae.eachSeries_gecko_tween_Tween=function(e,s,r){var t=function(){r()},i=e.slice();i.reverse();for(var n=0,a=i.length;n<a;){t=function(i,n){return function(){var t,e=(t=i,function(e){null==e?t[0]():r(e)});s(n[0],e)}}([t],[i[n++]])}t()},Ae.each_gecko_tween_Tween=function(t,e,i){for(var n=0,s=!1,r=0,a=t.length;r<a;){var o=r++;if(s)break;e(t[o],function(e){if(!s){if(null!=e&&""!=e)return s=!0,void i(e);(n+=1)==t.length&&i()}})}};var De={};(i["gecko.utils._Event.Event_Impl_"]=De).__name__=!0,De.__properties__={get_handlers:"get_handlers"},De.get_handlers=function(e){return e.handlers},De.create=function(){return{handlers:[]}},De._new=function(e){return e},De.clear=function(e){0!=e.handlers.length&&(e.handlers=[])},De.on=function(e,t){e.handlers.push(t)},De.off=function(e,t){$.remove(e.handlers,t)};var Ce=function(e){null==e&&(e=!1),this.isFixed=!1,this._last=0,this._elapsed=0,this._frames=0,this.timeToMeasure=1,this.ms=0,this.fps=0,this.delta=0,this.isFixed=e,this._last=e?L.time():L.realTime()};(i["gecko.utils.FPSCounter"]=Ce).__name__=!0,Ce.prototype={delta:null,fps:null,ms:null,timeToMeasure:null,_frames:null,_elapsed:null,_last:null,isFixed:null,tick:function(){var e=this.isFixed?L.time():L.realTime();this._frames++,this.delta=e-this._last,this._elapsed+=this.delta,this._last=e,this._elapsed>=this.timeToMeasure&&(this.fps=Math.round(this._frames/this._elapsed*100)/100,this.ms=Math.round(this._elapsed/this._frames*1e3),this._frames=0,this._elapsed=0)},clear:function(){this._frames=0,this._elapsed=0,this._last=this.isFixed?L.time():L.realTime()},__class__:Ce};var Pe=function(){};(i["gecko.utils.MathHelper"]=Pe).__name__=!0,Pe.toDegrees=function(e){return e*Pe._rad2deg},Pe.toRadians=function(e){return e*Pe._deg2rad},Pe.clamp=function(e,t,i){return e<t?t:i<e?i:e},Pe.clampInt=function(e,t,i){return e<t?t:i<e?i:e},Pe.lerp=function(e,t,i){return(1-e)*t+e*i},Pe.inverseLerp=function(e,t,i){return(e-t)/(i-t)},Pe.inheritTransform=function(e,t,i){e._00=t._00*i._00+t._01*i._10,e._01=t._00*i._01+t._01*i._11,e._10=t._10*i._00+t._11*i._10,e._11=t._10*i._01+t._11*i._11,e._20=t._20*i._00+t._21*i._10+i._20,e._21=t._20*i._01+t._21*i._11+i._21};var Ne=function(){};(i["haxe.IMap"]=Ne).__name__=!0,Ne.prototype={get:null,set:null,exists:null,iterator:null,__class__:Ne};var Ee=function(e,t){this.high=e,this.low=t};(i["haxe._Int64.___Int64"]=Ee).__name__=!0,Ee.prototype={high:null,low:null,__class__:Ee};var Re=function(){};(i["haxe.Log"]=Re).__name__=!0,Re.trace=function(e,t){Ai.__trace(e,t)};var Le=function(){};(i["haxe._Unserializer.DefaultResolver"]=Le).__name__=!0,Le.prototype={resolveClass:function(e){return te.resolveClass(e)},resolveEnum:function(e){return te.resolveEnum(e)},__class__:Le};var Me=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=Me.DEFAULT_RESOLVER;null==t&&(t=new Le,Me.DEFAULT_RESOLVER=t),this.resolver=t};(i["haxe.Unserializer"]=Me).__name__=!0,Me.initCodes=function(){for(var e=[],t=0,i=Me.BASE64.length;t<i;){var n=t++;e[Me.BASE64.charCodeAt(n)]=n}return e},Me.run=function(e){return new Me(e).unserialize()},Me.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var e=0,t=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||57<n)break;e=10*e+(n-48),this.pos++}else{if(this.pos!=i)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return parseFloat($.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new dt("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new dt("Invalid object key");var i=this.unserialize();e[t]=i}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new dt("Invalid enum format");var i=this.readDigits();if(0==i)return te.createEnum(e,t);for(var n=[];0<i--;)n.push(this.unserialize());return te.createEnum(e,t,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new dt("Class not found "+e);return t;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new dt("Enum not found "+i);return n;case 67:var s=this.unserialize(),r=this.resolver.resolveClass(s);if(null==r)throw new dt("Class not found "+s);var a=te.createEmptyInstance(r);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new dt("Invalid custom data");return a;case 77:var o=new Ue;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var _=this.readDigits();if(_<0||_>=this.scache.length)throw new dt("Invalid string reference");return this.scache[_];case 97:this.buf;var h=[];for(this.cache.push(h);;){var u=this.buf.charCodeAt(this.pos);if(104==u){this.pos++;break}if(117==u){this.pos++;var c=this.readDigits();h[h.length+c-1]=null}else h.push(this.unserialize())}return h;case 98:var d=new Ii;this.cache.push(d);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var f=this.unserialize(),g=this.unserialize();null!=Ns[f]?d.setReserved(f,g):d.h[f]=g}return this.pos++,d;case 99:var m=this.unserialize(),p=this.resolver.resolveClass(m);if(null==p)throw new dt("Class not found "+m);var v=te.createEmptyInstance(p);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var y=this.unserialize(),b=this.resolver.resolveEnum(y);if(null==b)throw new dt("Enum not found "+y);this.pos++;var w=this.readDigits(),x=b.__constructs__.slice()[w];if(null==x)throw new dt("Unknown enum index "+y+"@"+w);var S=this.unserializeEnum(b,x);return this.cache.push(S),S;case 107:return NaN;case 108:var B=new ee;this.cache.push(B);for(this.buf;104!=this.buf.charCodeAt(this.pos);)B.add(this.unserialize());return this.pos++,B;case 109:return-1/0;case 110:return null;case 111:var T={};return this.cache.push(T),this.unserializeObject(T),T;case 112:return 1/0;case 113:var k=new Ge;this.cache.push(k);this.buf;for(var I=this.buf.charCodeAt(this.pos++);58==I;){var A=this.readDigits(),D=this.unserialize();k.h[A]=D,I=this.buf.charCodeAt(this.pos++)}if(104!=I)throw new dt("Invalid IntMap format");return k;case 114:var C=this.readDigits();if(C<0||C>=this.cache.length)throw new dt("Invalid reference");return this.cache[C];case 115:var P=this.readDigits(),N=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<P)throw new dt("Invalid bytes length");var E=Me.CODES;null==E&&(E=Me.initCodes(),Me.CODES=E);for(var R=this.pos,L=3&P,M=R+(P-L),F=new Fe(new Es(3*(P>>2)+(2<=L?L-1:0))),V=0;R<M;){var O=E[N.charCodeAt(R++)],G=E[N.charCodeAt(R++)];F.b[V++]=255&(O<<2|G>>4);var U=E[N.charCodeAt(R++)];F.b[V++]=255&(G<<4|U>>2);var W=E[N.charCodeAt(R++)];F.b[V++]=255&(U<<6|W)}if(2<=L){var z=E[N.charCodeAt(R++)],H=E[N.charCodeAt(R++)];if(F.b[V++]=255&(z<<2|H>>4),3==L){var Z=E[N.charCodeAt(R++)];F.b[V++]=255&(H<<4|Z>>2)}}return this.pos+=P,this.cache.push(F),F;case 116:return!0;case 118:var j;if(48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))j=$.strDate($.substr(this.buf,this.pos,19)),this.pos+=19;else{var K=this.readFloat();j=new Date(K)}return this.cache.push(j),j;case 119:var X=this.unserialize(),Y=this.resolver.resolveEnum(X);if(null==Y)throw new dt("Enum not found "+X);var q=this.unserializeEnum(Y,this.unserialize());return this.cache.push(q),q;case 120:throw dt.wrap(this.unserialize());case 121:var Q=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<Q)throw new dt("Invalid string length");var J=$.substr(this.buf,this.pos,Q);return this.pos+=Q,J=decodeURIComponent(J.split("+").join(" ")),this.scache.push(J),J;case 122:return 0}throw this.pos--,new dt("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Me};var Fe=function(e){this.length=e.byteLength,this.b=new Fs(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(i["haxe.io.Bytes"]=Fe).__name__=!0,Fe.ofString=function(e){for(var t=[],i=0;i<e.length;){var n=e.charCodeAt(i++);55296<=n&&n<=56319&&(n=n-55232<<10|1023&e.charCodeAt(i++)),n<=127?t.push(n):(n<=2047?t.push(192|n>>6):(n<=65535?t.push(224|n>>12):(t.push(240|n>>18),t.push(128|n>>12&63)),t.push(128|n>>6&63)),t.push(128|63&n))}return new Fe(new Fs(t).buffer)},Fe.ofData=function(e){var t=e.hxBytes;return null!=t?t:new Fe(e)},Fe.prototype={length:null,b:null,data:null,blit:function(e,t,i,n){if(e<0||i<0||n<0||e+n>this.length||i+n>t.length)throw new dt(Ye.OutsideBounds);0==i&&n==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(i,i+n),e)},sub:function(e,t){if(e<0||t<0||e+t>this.length)throw new dt(Ye.OutsideBounds);return new Fe(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))},getDouble:function(e){return null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(e,!0)},getFloat:function(e){return null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},setDouble:function(e,t){null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(e,t,!0)},setFloat:function(e,t){null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(e,t,!0)},getUInt16:function(e){return null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(e,!0)},getInt32:function(e){return null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new Ls(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new dt(Ye.OutsideBounds);for(var i="",n=this.b,s=String.fromCharCode,r=e,a=e+t;r<a;){var o=n[r++];if(o<128){if(0==o)break;i+=s(o)}else if(o<224)i+=s((63&o)<<6|127&n[r++]);else if(o<240){i+=s((31&o)<<12|(127&n[r++])<<6|127&n[r++])}else{var l=(15&o)<<18|(127&n[r++])<<12|(127&n[r++])<<6|127&n[r++];i+=s(55232+(l>>10)),i+=s(1023&l|56320)}}return i},toString:function(){return this.getString(0,this.length)},__class__:Fe};var Ve=function(){};(i["haxe.crypto.Base64"]=Ve).__name__=!0,Ve.encode=function(e,t){null==t&&(t=!0);var i=new Oe(Ve.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:i+="==";break;case 2:i+="="}return i};var Oe=function(e){for(var t=e.length,i=1;1<<i<t;)++i;if(8<i||t!=1<<i)throw new dt("BaseCode : base length must be a power of two.");this.base=e,this.nbits=i};(i["haxe.crypto.BaseCode"]=Oe).__name__=!0,Oe.prototype={base:null,nbits:null,encodeBytes:function(e){for(var t=this.nbits,i=this.base,n=8*e.length/t|0,s=new Fe(new Es(n+(8*e.length%t==0?0:1))),r=0,a=0,o=(1<<t)-1,l=0,_=0;_<n;){for(;a<t;)a+=8,r<<=8,r|=e.b[l++];a-=t,s.b[_++]=255&i.b[r>>a&o]}return 0<a&&(s.b[_++]=255&i.b[r<<t-a&o]),s},__class__:Oe};var Ge=function(){this.h={}};(i["haxe.ds.IntMap"]=Ge).__name__=!0,Ge.__interfaces__=[Ne],Ge.prototype={h:null,set:function(e,t){this.h[e]=t},get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return $.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e]}}},__class__:Ge};var Ue=function(){this.h={__keys__:{}}};(i["haxe.ds.ObjectMap"]=Ue).__name__=!0,Ue.__interfaces__=[Ne],Ue.prototype={h:null,set:function(e,t){var i=e.__id__||(e.__id__=++Ue.count);this.h[i]=t,this.h.__keys__[i]=e},get:function(e){return this.h[e.__id__]},exists:function(e){return null!=this.h.__keys__[e.__id__]},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return $.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e.__id__]}}},__class__:Ue};var We=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};(i["haxe.ds._StringMap.StringMapIterator"]=We).__name__=!0,We.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=Ns[t]?e.getReserved(t):e.h[t]},__class__:We};var Ii=function(){this.h={}};(i["haxe.ds.StringMap"]=Ii).__name__=!0,Ii.__interfaces__=[Ne],Ii.prototype={h:null,rh:null,set:function(e,t){null!=Ns[e]?this.setReserved(e,t):this.h[e]=t},get:function(e){return null!=Ns[e]?this.getReserved(e):this.h[e]},exists:function(e){return null!=Ns[e]?this.existsReserved(e):this.h.hasOwnProperty(e)},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=Ns[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return $.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new We(this,this.arrayKeys())},__class__:Ii};var ze=function(){this.b=[]};(i["haxe.io.BytesBuffer"]=ze).__name__=!0,ze.prototype={b:null,getBytes:function(){var e=new Fe(new Fs(this.b).buffer);return this.b=null,e},__class__:ze};var He=function(){};(i["haxe.io.Input"]=He).__name__=!0,He.prototype={bigEndian:null,readByte:function(){throw new dt("Not implemented")},readBytes:function(e,t,i){var n=i,s=e.b;if(t<0||i<0||t+i>e.length)throw new dt(Ye.OutsideBounds);try{for(;0<n;)s[t]=this.readByte(),++t,--n}catch(e){if(e instanceof dt&&(e=e.val),!Ai.__instanceof(e,Xe))throw e}return i-n},readFullBytes:function(e,t,i){for(;0<i;){var n=this.readBytes(e,t,i);if(0==n)throw new dt(Ye.Blocked);t+=n,i-=n}},read:function(e){for(var t=new Fe(new Es(e)),i=0;0<e;){var n=this.readBytes(t,i,e);if(0==n)throw new dt(Ye.Blocked);i+=n,e-=n}return t},readInt32:function(){var e=this.readByte(),t=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|t<<16|e<<24:e|t<<8|i<<16|n<<24},readString:function(e){var t=new Fe(new Es(e));return this.readFullBytes(t,0,e),t.toString()},__class__:He};var Ze=function(e,t,i){if(null==t&&(t=0),null==i&&(i=e.length-t),t<0||i<0||t+i>e.length)throw new dt(Ye.OutsideBounds);this.b=e.b,this.pos=t,this.len=i,this.totlen=i};(i["haxe.io.BytesInput"]=Ze).__name__=!0,Ze.__super__=He,Ze.prototype=s(He.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(e){return e<0?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(0==this.len)throw new dt(new Xe);return this.len--,this.b[this.pos++]},readBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new dt(Ye.OutsideBounds);if(0==this.len&&0<i)throw new dt(new Xe);this.len<i&&(i=this.len);for(var n=this.b,s=e.b,r=0,a=i;r<a;){var o=r++;s[t+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:Ze,__properties__:{set_position:"set_position"}});var je=function(){};(i["haxe.io.Output"]=je).__name__=!0,je.prototype={bigEndian:null,writeByte:function(e){throw new dt("Not implemented")},writeBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new dt(Ye.OutsideBounds);for(var n=e.b,s=i;0<s;)this.writeByte(n[t]),++t,--s;return i},write:function(e){for(var t=e.length,i=0;0<t;){var n=this.writeBytes(e,i,t);if(0==n)throw new dt(Ye.Blocked);i+=n,t-=n}},writeFloat:function(e){this.writeInt32(qe.floatToI32(e))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:je};var Ke=function(){this.b=new ze};(i["haxe.io.BytesOutput"]=Ke).__name__=!0,Ke.__super__=je,Ke.prototype=s(je.prototype,{b:null,writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,i){var n=this.b;if(t<0||i<0||t+i>e.length)throw new dt(Ye.OutsideBounds);n.b;for(var s=e.b,r=t,a=t+i;r<a;){var o=r++;n.b.push(s[o])}return i},getBytes:function(){return this.b.getBytes()},__class__:Ke});var Xe=function(){};(i["haxe.io.Eof"]=Xe).__name__=!0,Xe.prototype={toString:function(){return"Eof"},__class__:Xe};var Ye=i["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Ye.Blocked=["Blocked",0],Ye.Blocked.toString=n,(Ye.Blocked.__enum__=Ye).Overflow=["Overflow",1],Ye.Overflow.toString=n,(Ye.Overflow.__enum__=Ye).OutsideBounds=["OutsideBounds",2],Ye.OutsideBounds.toString=n,(Ye.OutsideBounds.__enum__=Ye).Custom=function(e){var t=["Custom",3,e];return t.__enum__=Ye,t.toString=n,t};var qe=function(){};(i["haxe.io.FPHelper"]=qe).__name__=!0,qe.i32ToFloat=function(e){var t=e>>>23&255,i=8388607&e;return 0==i&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*i)*Math.pow(2,t-127)},qe.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,i=Math.floor(Math.log(t)/.6931471805599453);i<-127?i=-127:128<i&&(i=128);var n=Math.round(8388608*(t/Math.pow(2,i)-1));return 8388608==n&&i<128&&(n=0,++i),(e<0?-2147483648:0)|i+127<<23|n},qe.i64ToDouble=function(e,t){var i=(t>>20&2047)-1023,n=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==n&&-1023==i?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*n)*Math.pow(2,i)},qe.doubleToI64=function(e){var t=qe.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var i=e<0?-e:e,n=Math.floor(Math.log(i)/.6931471805599453),s=Math.round(4503599627370496*(i/Math.pow(2,n)-1)),r=0|s,a=s/4294967296|0;t.low=r,t.high=(e<0?-2147483648:0)|n+1023<<20|a}else 0<e?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var Qe=function(e){switch(e){case".":case"..":return this.dir=e,void(this.file="")}var t=e.lastIndexOf("/"),i=e.lastIndexOf("\\");t<i?(this.dir=$.substr(e,0,i),e=$.substr(e,i+1,null),this.backslash=!0):i<t?(this.dir=$.substr(e,0,t),e=$.substr(e,t+1,null)):this.dir=null;var n=e.lastIndexOf(".");-1!=n?(this.ext=$.substr(e,n+1,null),this.file=$.substr(e,0,n)):(this.ext=null,this.file=e)};(i["haxe.io.Path"]=Qe).__name__=!0,Qe.withoutExtension=function(e){var t=new Qe(e);return t.ext=null,t.toString()},Qe.extension=function(e){var t=new Qe(e);return null==t.ext?"":t.ext},Qe.normalize=function(e){if("/"==(e=e.split("\\").join("/")))return"/";for(var t=[],i=0,n=e.split("/");i<n.length;){var s=n[i];++i,".."==s&&0<t.length&&".."!=t[t.length-1]?t.pop():"."!=s&&t.push(s)}for(var r=t.join("/"),a=new RegExp("([^:])/+","g".split("u").join("")),o=(r.replace(a,"$1/"),""),l=!1,_=!1,h=0,u=r.length;h<u;){var c=h++,d=r.charCodeAt(c);switch(d){case 47:if(l){var f=d;l=!1,_&&(o+="/",_=!1),o+=String.fromCharCode(f)}else _=!0;break;case 58:o+=":",l=!0;break;default:var g=d;l=!1,_&&(o+="/",_=!1),o+=String.fromCharCode(g)}}return o},Qe.prototype={dir:null,file:null,ext:null,backslash:null,toString:function(){return(null==this.dir?"":this.dir+(this.backslash?"\\":"/"))+this.file+(null==this.ext?"":"."+this.ext)},__class__:Qe};var Je={};(i["haxe.io._UInt8Array.UInt8Array_Impl_"]=Je).__name__=!0,Je.fromBytes=function(e,t,i){return null==t&&(t=0),null==i&&(i=e.length-t),new Fs(e.b.bufferValue,t,i)};var dt=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,dt)};(i["js._Boot.HaxeError"]=dt).__name__=!0,dt.wrap=function(e){return e instanceof Error?e:new dt(e)},dt.__super__=Error,dt.prototype=s(Error.prototype,{val:null,__class__:dt});var Ai=function(){};(i["js.Boot"]=Ai).__name__=!0,Ai.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},Ai.__trace=function(e,t){var i,n=null!=t?t.fileName+":"+t.lineNumber+": ":"";if(n+=Ai.__string_rec(e,""),null!=t&&null!=t.customParams)for(var s=0,r=t.customParams;s<r.length;){var a=r[s];++s,n+=","+Ai.__string_rec(a,"")}"undefined"!=typeof document&&null!=(i=document.getElementById("haxe:trace"))?i.innerHTML+=Ai.__unhtml(n)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(n)},Ai.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var i=Ai.__nativeClassName(e);return null!=i?Ai.__resolveNativeClass(i):null},Ai.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var n=e[0]+"(";t+="\t";for(var s=2,r=e.length;s<r;){var a=s++;n+=2!=a?","+Ai.__string_rec(e[a],t):Ai.__string_rec(e[a],t)}return n+")"}var o="[";t+="\t";for(var l=0,_=e.length;l<_;){var h=l++;o+=(0<h?",":"")+Ai.__string_rec(e[h],t)}return o+="]"}var u;try{u=e.toString}catch(e){return"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var c=e.toString();if("[object Object]"!=c)return c}var d=null,f="{\n";t+="\t";var g=null!=e.hasOwnProperty;for(var d in e)g&&!e.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=f.length&&(f+=", \n"),f+=t+d+" : "+Ai.__string_rec(e[d],t));return f+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},Ai.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var i=e.__interfaces__;if(null!=i)for(var n=0,s=i.length;n<s;){var r=i[n++];if(r==t||Ai.__interfLoop(r,t))return!0}return Ai.__interfLoop(e.__super__,t)},Ai.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case Ds:return"boolean"==typeof e;case Is:return!0;case As:return"number"==typeof e;case ks:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(Ai.__interfLoop(Ai.getClass(e),t))return!0}else if("object"==typeof t&&Ai.__isNativeObj(t)&&e instanceof t)return!0;return t==Cs&&null!=e.__name__||(t==Ps&&null!=e.__ename__||e.__enum__==t)}},Ai.__cast=function(e,t){if(Ai.__instanceof(e,t))return e;throw new dt("Cannot cast "+N.string(e)+" to "+N.string(t))},Ai.__nativeClassName=function(e){var t=Ai.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},Ai.__isNativeObj=function(e){return null!=Ai.__nativeClassName(e)},Ai.__resolveNativeClass=function(e){return t[e]};var $e=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var i=0,n=t;i<n;){var s=i++;this.a[s]=0}this.byteLength=t}};(i["js.html.compat.ArrayBuffer"]=$e).__name__=!0,$e.sliceImpl=function(e,t){var i=new Fs(this,e,null==t?null:t-e),n=new Es(i.byteLength);return new Fs(n).set(i),n},$e.prototype={byteLength:null,a:null,slice:function(e,t){return new $e(this.a.slice(e,t))},__class__:$e};var et=function(e,t,i){if(this.buf=e,this.offset=null==t?0:t,this.length=null==i?e.byteLength-this.offset:i,this.offset<0||this.length<0||this.offset+this.length>e.byteLength)throw new dt(Ye.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};(i["js.html.compat.DataView"]=et).__name__=!0,et.prototype={buf:null,offset:null,length:null,byteLength:null,byteOffset:null,buffer:null,getInt8:function(e){var t=this.buf.a[this.offset+e];return 128<=t?t-256:t},getUint8:function(e){return this.buf.a[this.offset+e]},getInt16:function(e,t){var i=this.getUint16(e,t);return 32768<=i?i-65536:i},getUint16:function(e,t){return t?this.buf.a[this.offset+e]|this.buf.a[this.offset+e+1]<<8:this.buf.a[this.offset+e]<<8|this.buf.a[this.offset+e+1]},getInt32:function(e,t){var i=this.offset+e,n=this.buf.a[i++],s=this.buf.a[i++],r=this.buf.a[i++],a=this.buf.a[i++];return t?n|s<<8|r<<16|a<<24:a|r<<8|s<<16|n<<24},getUint32:function(e,t){var i=this.getInt32(e,t);return i<0?i+4294967296:i},getFloat32:function(e,t){return qe.i32ToFloat(this.getInt32(e,t))},getFloat64:function(e,t){var i=this.getInt32(e,t),n=this.getInt32(e+4,t);return qe.i64ToDouble(t?i:n,t?n:i)},setInt8:function(e,t){this.buf.a[e+this.offset]=t<0?t+128&255:255&t},setUint8:function(e,t){this.buf.a[e+this.offset]=255&t},setInt16:function(e,t,i){this.setUint16(e,t<0?t+65536:t,i)},setUint16:function(e,t,i){var n=e+this.offset;i?(this.buf.a[n]=255&t,this.buf.a[n++]=t>>8&255):(this.buf.a[n++]=t>>8&255,this.buf.a[n]=255&t)},setInt32:function(e,t,i){this.setUint32(e,t,i)},setUint32:function(e,t,i){var n=e+this.offset;i?(this.buf.a[n++]=255&t,this.buf.a[n++]=t>>8&255,this.buf.a[n++]=t>>16&255,this.buf.a[n++]=t>>>24):(this.buf.a[n++]=t>>>24,this.buf.a[n++]=t>>16&255,this.buf.a[n++]=t>>8&255,this.buf.a[n++]=255&t)},setFloat32:function(e,t,i){this.setUint32(e,qe.floatToI32(t),i)},setFloat64:function(e,t,i){var n=qe.doubleToI64(t);i?(this.setUint32(e,n.low),this.setUint32(e,n.high)):(this.setUint32(e,n.high),this.setUint32(e,n.low))},__class__:et};var tt=function(){};(i["js.html.compat.Float32Array"]=tt).__name__=!0,tt._new=function(e,t,i){var n;if("number"==typeof e){n=[];for(var s=0,r=e;s<r;){n[s++]=0}n.byteLength=n.length<<2;for(var a=[],o=n.byteOffset=0,l=n.length<<2;o<l;){o++;a.push(0)}n.buffer=new $e(a)}else if(Ai.__instanceof(e,$e)){var _=e;null==t&&(t=0),null==i&&(i=_.byteLength-t>>2),n=[];for(var h=0,u=i;h<u;){h++;var c=_.a[t++]|_.a[t++]<<8|_.a[t++]<<16|_.a[t++]<<24;n.push(qe.i32ToFloat(c))}n.byteLength=n.length<<2,n.byteOffset=t,n.buffer=_}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO "+N.string(e));n=e.slice();for(var d=[],f=0;f<n.length;){var g=n[f];++f;var m=qe.floatToI32(g);d.push(255&m),d.push(m>>8&255),d.push(m>>16&255),d.push(m>>>24)}n.byteLength=n.length<<2,n.byteOffset=0,n.buffer=new $e(d)}return n.subarray=tt._subarray,n.set=tt._set,n},tt._set=function(e,t){if(Ai.__instanceof(e.buffer,$e)){var i=e;if(e.byteLength+t>this.byteLength)throw new dt("set() outside of range");for(var n=0,s=e.byteLength;n<s;){var r=n++;this[r+t]=i[r]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO");var a=e;if(a.length+t>this.byteLength)throw new dt("set() outside of range");for(var o=0,l=a.length;o<l;){var _=o++;this[_+t]=a[_]}}},tt._subarray=function(e,t){var i=tt._new(this.slice(e,t));return i.byteOffset=4*e,i};var it=function(){};(i["js.html.compat.Uint8Array"]=it).__name__=!0,it._new=function(e,t,i){var n;if("number"==typeof e){n=[];for(var s=0,r=e;s<r;){n[s++]=0}n.byteLength=n.length,n.byteOffset=0,n.buffer=new $e(n)}else if(Ai.__instanceof(e,$e)){var a=e;null==t&&(t=0),null==i&&(i=a.byteLength-t),(n=0==t?a.a:a.a.slice(t,t+i)).byteLength=n.length,n.byteOffset=t,n.buffer=a}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO "+N.string(e));(n=e.slice()).byteLength=n.length,n.byteOffset=0,n.buffer=new $e(n)}return n.subarray=it._subarray,n.set=it._set,n},it._set=function(e,t){if(Ai.__instanceof(e.buffer,$e)){var i=e;if(e.byteLength+t>this.byteLength)throw new dt("set() outside of range");for(var n=0,s=e.byteLength;n<s;){var r=n++;this[r+t]=i[r]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new dt("TODO");var a=e;if(a.length+t>this.byteLength)throw new dt("set() outside of range");for(var o=0,l=a.length;o<l;){var _=o++;this[_+t]=a[_]}}},it._subarray=function(e,t){var i=it._new(this.slice(e,t));return i.byteOffset=e,i};var st=function(){this.names=["bullet","enemyShip","playerShip","smokeOrange0","smokeOrange1","smokeOrange2","smokeOrange3"],this.smokeOrange3Description={files:["assets/smokeOrange3.png"],original_height:93,type:"image",original_width:93,name:"smokeOrange3"},this.smokeOrange3Name="smokeOrange3",this.smokeOrange3=null,this.smokeOrange2Description={files:["assets/smokeOrange2.png"],original_height:93,type:"image",original_width:93,name:"smokeOrange2"},this.smokeOrange2Name="smokeOrange2",this.smokeOrange2=null,this.smokeOrange1Description={files:["assets/smokeOrange1.png"],original_height:93,type:"image",original_width:93,name:"smokeOrange1"},this.smokeOrange1Name="smokeOrange1",this.smokeOrange1=null,this.smokeOrange0Description={files:["assets/smokeOrange0.png"],original_height:93,type:"image",original_width:93,name:"smokeOrange0"},this.smokeOrange0Name="smokeOrange0",this.smokeOrange0=null,this.playerShipDescription={files:["assets/playerShip.png"],original_height:75,type:"image",original_width:99,name:"playerShip"},this.playerShipName="playerShip",this.playerShip=null,this.enemyShipDescription={files:["assets/enemyShip.png"],original_height:84,type:"image",original_width:93,name:"enemyShip"},this.enemyShipName="enemyShip",this.enemyShip=null,this.bulletDescription={files:["assets/bullet.png"],original_height:37,type:"image",original_width:13,name:"bullet"},this.bulletName="bullet",this.bullet=null};(i["kha._Assets.ImageList"]=st).__name__=!0,st.prototype={get:function(e){return K.field(this,e)},bullet:null,bulletName:null,bulletDescription:null,bulletLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"bulletLoad"})}}_t.loadImage("bullet",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"bulletLoad"})},bulletUnload:function(){this.bullet.unload(),this.bullet=null},enemyShip:null,enemyShipName:null,enemyShipDescription:null,enemyShipLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"enemyShipLoad"})}}_t.loadImage("enemyShip",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"enemyShipLoad"})},enemyShipUnload:function(){this.enemyShip.unload(),this.enemyShip=null},playerShip:null,playerShipName:null,playerShipDescription:null,playerShipLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"playerShipLoad"})}}_t.loadImage("playerShip",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"playerShipLoad"})},playerShipUnload:function(){this.playerShip.unload(),this.playerShip=null},smokeOrange0:null,smokeOrange0Name:null,smokeOrange0Description:null,smokeOrange0Load:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange0Load"})}}_t.loadImage("smokeOrange0",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange0Load"})},smokeOrange0Unload:function(){this.smokeOrange0.unload(),this.smokeOrange0=null},smokeOrange1:null,smokeOrange1Name:null,smokeOrange1Description:null,smokeOrange1Load:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange1Load"})}}_t.loadImage("smokeOrange1",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange1Load"})},smokeOrange1Unload:function(){this.smokeOrange1.unload(),this.smokeOrange1=null},smokeOrange2:null,smokeOrange2Name:null,smokeOrange2Description:null,smokeOrange2Load:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange2Load"})}}_t.loadImage("smokeOrange2",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange2Load"})},smokeOrange2Unload:function(){this.smokeOrange2.unload(),this.smokeOrange2=null},smokeOrange3:null,smokeOrange3Name:null,smokeOrange3Description:null,smokeOrange3Load:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange3Load"})}}_t.loadImage("smokeOrange3",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:130,className:"kha._Assets.ImageList",methodName:"smokeOrange3Load"})},smokeOrange3Unload:function(){this.smokeOrange3.unload(),this.smokeOrange3=null},names:null,__class__:st};var rt=function(){this.names=["bulletShoot","enemyExplosion","playerExplosion"],this.playerExplosionDescription={files:["assets/playerExplosion.ogg","assets/playerExplosion.mp3"],type:"sound",name:"playerExplosion"},this.playerExplosionName="playerExplosion",this.playerExplosion=null,this.enemyExplosionDescription={files:["assets/enemyExplosion.ogg","assets/enemyExplosion.mp3"],type:"sound",name:"enemyExplosion"},this.enemyExplosionName="enemyExplosion",this.enemyExplosion=null,this.bulletShootDescription={files:["assets/bulletShoot.ogg","assets/bulletShoot.mp3"],type:"sound",name:"bulletShoot"},this.bulletShootName="bulletShoot",this.bulletShoot=null};(i["kha._Assets.SoundList"]=rt).__name__=!0,rt.prototype={get:function(e){return K.field(this,e)},bulletShoot:null,bulletShootName:null,bulletShootDescription:null,bulletShootLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"bulletShootLoad"})}}_t.loadSound("bulletShoot",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"bulletShootLoad"})},bulletShootUnload:function(){this.bulletShoot.unload(),this.bulletShoot=null},enemyExplosion:null,enemyExplosionName:null,enemyExplosionDescription:null,enemyExplosionLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"enemyExplosionLoad"})}}_t.loadSound("enemyExplosion",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"enemyExplosionLoad"})},enemyExplosionUnload:function(){this.enemyExplosion.unload(),this.enemyExplosion=null},playerExplosion:null,playerExplosionName:null,playerExplosionDescription:null,playerExplosionLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"playerExplosionLoad"})}}_t.loadSound("playerExplosion",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:134,className:"kha._Assets.SoundList",methodName:"playerExplosionLoad"})},playerExplosionUnload:function(){this.playerExplosion.unload(),this.playerExplosion=null},names:null,__class__:rt};var at=function(){this.names=[]};(i["kha._Assets.BlobList"]=at).__name__=!0,at.prototype={get:function(e){return K.field(this,e)},names:null,__class__:at};var ot=function(){this.names=["Ubuntu_B","kenpixel_mini_square"],this.kenpixel_mini_squareDescription={files:["assets/kenpixel_mini_square.ttf"],type:"font",name:"kenpixel_mini_square"},this.kenpixel_mini_squareName="kenpixel_mini_square",this.kenpixel_mini_square=null,this.Ubuntu_BDescription={files:["assets/Ubuntu-B.ttf"],type:"font",name:"Ubuntu_B"},this.Ubuntu_BName="Ubuntu_B",this.Ubuntu_B=null};(i["kha._Assets.FontList"]=ot).__name__=!0,ot.prototype={get:function(e){return K.field(this,e)},Ubuntu_B:null,Ubuntu_BName:null,Ubuntu_BDescription:null,Ubuntu_BLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"Ubuntu_BLoad"})}}_t.loadFont("Ubuntu_B",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"Ubuntu_BLoad"})},Ubuntu_BUnload:function(){this.Ubuntu_B.unload(),this.Ubuntu_B=null},kenpixel_mini_square:null,kenpixel_mini_squareName:null,kenpixel_mini_squareDescription:null,kenpixel_mini_squareLoad:function(t,e){var i;if(null!=e)i=e;else{var n=Re.trace;i=function(e){n(e,{fileName:"AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"kenpixel_mini_squareLoad"})}}_t.loadFont("kenpixel_mini_square",function(e){t()},i,{fileName:"AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"kenpixel_mini_squareLoad"})},kenpixel_mini_squareUnload:function(){this.kenpixel_mini_square.unload(),this.kenpixel_mini_square=null},names:null,__class__:ot};var lt=function(){this.names=[]};(i["kha._Assets.VideoList"]=lt).__name__=!0,lt.prototype={get:function(e){return K.field(this,e)},names:null,__class__:lt};var _t=function(){};(i["kha.Assets"]=_t).__name__=!0,_t.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},_t.loadEverything=function(e,t,i,n){for(var s=0,r=0,a=te.getInstanceFields(at);r<a.length;){var o=a[r];++r,X.endsWith(o,"Load")&&(s+=1)}for(var l=0,_=te.getInstanceFields(st);l<_.length;){var h=_[l];++l,X.endsWith(h,"Load")&&(s+=1)}for(var u=0,c=te.getInstanceFields(rt);u<c.length;){var d=c[u];++u,X.endsWith(d,"Load")&&(s+=1)}for(var f=0,g=te.getInstanceFields(ot);f<g.length;){var m=g[f];++f,X.endsWith(m,"Load")&&(s+=1)}for(var p=0,v=te.getInstanceFields(lt);p<v.length;){var y=v[p];++p,X.endsWith(y,"Load")&&(s+=1)}if(0!=s){for(var b=s,w=function(){b-=1,_t.progress=1-b/s,0==b&&e()},x=0,S=te.getInstanceFields(at);x<S.length;){var B=S[x];if(++x,X.endsWith(B,"Load")){var T=$.substr(B,0,B.length-4),k=K.field(_t.blobs,T+"Description");null==t||t(k)?K.field(_t.blobs,B)(w,function(e){if(null==n)Re.trace;w()}):w()}}for(var I=0,A=te.getInstanceFields(st);I<A.length;){var D=A[I];if(++I,X.endsWith(D,"Load")){var C=$.substr(D,0,D.length-4),P=K.field(_t.images,C+"Description");null==t||t(P)?K.field(_t.images,D)(w,function(e){if(null==n)Re.trace;w()}):w()}}for(var N=0,E=te.getInstanceFields(rt);N<E.length;){var R=[E[N]];if(++N,X.endsWith(R[0],"Load")){var L=$.substr(R[0],0,R[0].length-4),M=[K.field(_t.sounds,L+"Description")];null==t||t(M[0])?K.field(_t.sounds,R[0])(function(e,t){return function(){null==i||i(e[0])?K.field(_t.sounds,t[0].substring(0,t[0].length-4)).uncompress(w):w()}}(M,R),null!=n?n:function(t){return function(e){t[0](e,{fileName:"Assets.hx",lineNumber:172,className:"kha.Assets",methodName:"loadEverything"})}}([Re.trace])):w()}}for(var F=0,V=te.getInstanceFields(ot);F<V.length;){var O=V[F];if(++F,X.endsWith(O,"Load")){var G=$.substr(O,0,O.length-4),U=K.field(_t.fonts,G+"Description");null==t||t(U)?K.field(_t.fonts,O)(w,function(e){if(null==n)Re.trace;w()}):w()}}for(var W=0,z=te.getInstanceFields(lt);W<z.length;){var H=z[W];if(++W,X.endsWith(H,"Load")){var Z=$.substr(H,0,H.length-4),j=K.field(_t.videos,Z+"Description");null==t||t(j)?K.field(_t.videos,H)(w,function(e){if(null==n)Re.trace;w()}):w()}}}else e()},_t.loadImage=function(t,i,e,n){var s,r=K.field(_t.images,t+"Description");if(null!=e)s=e;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadImageFromDescription(r,function(e){_t.images[t]=e,i(e)},s)},_t.loadImageFromPath=function(e,t,i,n,s){var r,a={files:[e],readable:t};if(null!=n)r=n;else{var o=Re.trace,l=s;r=function(e){o(e,l)}}St.loadImageFromDescription(a,i,r)},_t.get_imageFormats=function(){return St.getImageFormats()},_t.loadBlob=function(t,i,e,n){var s,r=K.field(_t.blobs,t+"Description");if(null!=e)s=e;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadBlobFromDescription(r,function(e){_t.blobs[t]=e,i(e)},s)},_t.loadBlobFromPath=function(e,t,i,n){var s,r={files:[e]};if(null!=i)s=i;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadBlobFromDescription(r,t,s)},_t.loadSound=function(t,i,e,n){var s,r=K.field(_t.sounds,t+"Description");if(null!=e)s=e;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadSoundFromDescription(r,function(e){_t.sounds[t]=e,i(e)},s)},_t.loadSoundFromPath=function(e,t,i,n){var s,r={files:[e]};if(null!=i)s=i;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadSoundFromDescription(r,t,s)},_t.get_soundFormats=function(){return St.getSoundFormats()},_t.loadFont=function(t,i,e,n){var s,r=K.field(_t.fonts,t+"Description");if(null!=e)s=e;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadFontFromDescription(r,function(e){_t.fonts[t]=e,i(e)},s)},_t.loadFontFromPath=function(e,t,i,n){var s,r={files:[e]};if(null!=i)s=i;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadFontFromDescription(r,t,s)},_t.get_fontFormats=function(){return["ttf"]},_t.loadVideo=function(t,i,e,n){var s,r=K.field(_t.videos,t+"Description");if(null!=e)s=e;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadVideoFromDescription(r,function(e){_t.videos[t]=e,i(e)},s)},_t.loadVideoFromPath=function(e,t,i,n){var s,r={files:[e]};if(null!=i)s=i;else{var a=Re.trace,o=n;s=function(e){a(e,o)}}St.loadVideoFromDescription(r,t,s)},_t.get_videoFormats=function(){return St.getVideoFormats()},_t.reporter=function(e,t){if(null!=e)return e;var i=Re.trace,n=t;return function(e){i(e,n)}};var ht=function(){};(i["kha.Canvas"]=ht).__name__=!0,ht.prototype={get_width:null,get_height:null,get_g1:null,get_g2:null,get_g4:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:ht,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var ut=function(){};(i["kha.Resource"]=ut).__name__=!0,ut.prototype={unload:null,__class__:ut};var ct=function(){};(i["kha.Image"]=ct).__name__=!0,ct.__interfaces__=[ut,ht],ct.__properties__={get_nonPow2Supported:"get_nonPow2Supported",get_maxSize:"get_maxSize"},ct.create=function(e,t,i,n){return null==i&&(i=cn.RGBA32),null==n&&(n=fn.StaticUsage),null==F.gl?new ft(e,t,i,!1):new Nt(e,t,i,!1,0,1)},ct.create3D=function(e,t,i,n,s){return null},ct.createRenderTarget=function(e,t,i,n,s,r){return null==r&&(r=0),null==s&&(s=1),null==n&&(n=0),null==i&&(i=cn.RGBA32),null==F.gl?new ft(e,t,i,!0):new Nt(e,t,i,!0,n,s)},ct.fromImage=function(e,t){if(null==F.gl){var i=new ft(e.width,e.height,cn.RGBA32,!1);return i.image=e,i.createTexture(),i}var n=new Nt(e.width,e.height,cn.RGBA32,!1,0,1);return n.image=e,n.createTexture(),n},ct.fromBytes=function(e,t,i,n,s){if(null==n&&(n=cn.RGBA32),null==s&&(s=fn.StaticUsage),null!=F.gl){var r=new Nt(t,i,n,!1,0,1);return r.image=r.bytesToArray(e),r.createTexture(),r}return null},ct.fromBytes3D=function(e,t,i,n,s,r){return null},ct.fromEncodedBytes=function(e,t,i,n,s){null==s&&(s=!1);var r="data:image;base64,"+Ve.encode(e),a=Ai.__cast(window.document.createElement("img"),HTMLImageElement);a.onload=function(){var e=ct.fromImage(a,s);i(e)},a.onerror=function(){n("Image was not created")},a.src=r},ct.fromVideo=function(e){if(null==F.gl){var t=new ft(e.element.videoWidth,e.element.videoHeight,cn.RGBA32,!1);return t.video=e.element,t.createTexture(),t}var i=new Nt(e.element.videoWidth,e.element.videoHeight,cn.RGBA32,!1,0,1);return i.video=e.element,i.createTexture(),i},ct.get_maxSize=function(){return null==F.gl?8192:F.gl.getParameter(3379)},ct.get_nonPow2Supported=function(){return null!=F.gl},ct.prototype={isOpaque:function(e,t){return!1},at:function(e,t){return-16777216},unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},getPixels:function(){return null},generateMipmaps:function(e){},setMipmaps:function(e){},setDepthStencilFrom:function(e){},clear:function(e,t,i,n,s,r,a){},width:null,get_width:function(){return 0},height:null,get_height:function(){return 0},depth:null,get_depth:function(){return 1},realWidth:null,get_realWidth:function(){return 0},realHeight:null,get_realHeight:function(){return 0},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null},__class__:ct,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var ft=function(e,t,i,n){this.g2canvas=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=n,this.image=null,this.video=null,n&&this.createTexture()};(i["kha.CanvasImage"]=ft).__name__=!0,ft.init=function(){var e=window.document.createElement("canvas");null!=e&&(ft.context=e.getContext("2d"),e.width=2048,e.height=2048,ft.context.globalCompositeOperation="copy")},ft.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},ft.__super__=ct,ft.prototype=s(ct.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,graphics1:null,g2canvas:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new bi(this)),this.graphics1},get_g2:function(){if(null==this.g2canvas){var e=window.document.createElement("canvas"),t=(this.image=e).getContext("2d");e.width=this.get_width(),e.height=this.get_height(),this.g2canvas=new Pn(t)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},isOpaque:function(e,t){if(null==this.data){if(null==ft.context)return!0;this.createImageData()}return 0!=this.data.data[t*(0|this.image.width)*4+4*e+3]},at:function(e,t){if(null==this.data){if(null==ft.context)return-16777216;this.createImageData()}return gt._new(this.data.data[t*(0|this.image.width)*4+4*e])},createImageData:function(){ft.context.strokeStyle="rgba(0,0,0,0)",ft.context.fillStyle="rgba(0,0,0,0)",ft.context.fillRect(0,0,this.image.width,this.image.height),ft.context.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.image.width,this.image.height),this.data=ft.context.getImageData(0,0,this.image.width,this.image.height)},texture:null,createTexture:function(){null!=F.gl&&(this.texture=F.gl.createTexture(),F.gl.bindTexture(3553,this.texture),F.gl.texParameteri(3553,10240,9729),F.gl.texParameteri(3553,10241,9729),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=F.gl.createFramebuffer(),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),F.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),F.gl.bindFramebuffer(36160,null)):null!=this.video?F.gl.texImage2D(3553,0,6408,6408,5121,this.video):F.gl.texImage2D(3553,0,6408,6408,5121,this.image),F.gl.bindTexture(3553,null))},set:function(e){F.gl.activeTexture(33984+e),F.gl.bindTexture(3553,this.texture),null!=this.video&&F.gl.texImage2D(3553,0,6408,6408,5121,this.video)},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new Fe(new Es(this.format==cn.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=F.gl){if(this.texture=F.gl.createTexture(),F.gl.bindTexture(3553,this.texture),F.gl.texParameteri(3553,10240,9729),F.gl.texParameteri(3553,10241,9729),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),F.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Fs(this.bytes.b.bufferValue)),1282==F.gl.getError()){for(var e=new Fe(new Es(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var n=t++,s=0,r=this.get_width();s<r;){var a=s++,o=this.bytes,l=n*this.get_width()+a,_=o.b[l],h=n*this.get_width()*4+4*a;e.b[h]=255&_;var u=n*this.get_width()*4+4*a+1;e.b[u]=255&_;var c=n*this.get_width()*4+4*a+2;e.b[c]=255&_;var d=n*this.get_width()*4+4*a+3;e.b[d]=255}F.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Fs(e.b.bufferValue))}F.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:ft});var gt=e.kha._Color.Color_Impl_={};(i["kha._Color.Color_Impl_"]=gt).__name__=!0,gt.__properties__={set_value:"set_value",get_value:"get_value",set_A:"set_A",get_A:"get_A",set_B:"set_B",get_B:"get_B",set_G:"set_G",get_G:"get_G",set_R:"set_R",get_R:"get_R",set_Ab:"set_Ab",get_Ab:"get_Ab",set_Bb:"set_Bb",get_Bb:"get_Bb",set_Gb:"set_Gb",get_Gb:"get_Gb",set_Rb:"set_Rb",get_Rb:"get_Rb"},gt.fromValue=function(e){return gt._new(e)},gt.fromBytes=function(e,t,i,n){return null==n&&(n=255),gt._new(n<<24|e<<16|t<<8|i)},gt.fromFloats=function(e,t,i,n){return null==n&&(n=1),gt._new((255*n|0)<<24|(255*e|0)<<16|(255*t|0)<<8|255*i|0)},gt.fromString=function(e){if(7!=e.length&&9!=e.length||35!=e.charCodeAt(0))throw new dt("Invalid Color string: '"+e+"'");var t=N.parseInt("0x"+$.substr(e,1,null));return 7==e.length&&(t+=-16777216),gt._new(t)},gt._new=function(e){return e},gt.get_value=function(e){return e},gt.set_value=function(e,t){return t},gt.get_Rb=function(e){return(16711680&e)>>>16},gt.get_Gb=function(e){return(65280&e)>>>8},gt.get_Bb=function(e){return 255&e},gt.get_Ab=function(e){return e>>>24},gt.set_Rb=function(e,t){return e=e>>>24<<24|t<<16|(65280&e)>>>8<<8|255&e,t},gt.set_Gb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|t<<8|255&e,t},gt.set_Bb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},gt.set_Ab=function(e,t){return e=t<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|255&e,t},gt.get_R=function(e){return.00392156862745098*((16711680&e)>>>16)},gt.get_G=function(e){return.00392156862745098*((65280&e)>>>8)},gt.get_B=function(e){return.00392156862745098*(255&e)},gt.get_A=function(e){return.00392156862745098*(e>>>24)},gt.set_R=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(255*t|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t},gt.set_G=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(255*t|0)<<8|.00392156862745098*(255&e)*255|0,t},gt.set_B=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|255*t|0,t},gt.set_A=function(e,t){return e=(255*t|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t};var mt=function(){};(i["kha.CompilerDefines"]=mt).__name__=!0;var pt=function(){};(i["kha.EnvironmentVariables"]=pt).__name__=!0,pt.prototype={getVariable:function(e){return""},__class__:pt};var vt=function(e,t,i){this.bold=e,this.italic=t,this.underlined=i};(i["kha.FontStyle"]=vt).__name__=!0,vt.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:vt};var yt=function(e,t,i,n){this.windowId=e,this.graphics1=t,this.graphics2=i,this.graphics4=n};(i["kha.Framebuffer"]=yt).__name__=!0,yt.__interfaces__=[ht],yt.prototype={windowId:null,graphics1:null,graphics2:null,graphics4:null,init:function(e,t,i){this.graphics1=e,this.graphics2=t,this.graphics4=i},g1:null,get_g1:function(){return this.graphics1},g2:null,get_g2:function(){return this.graphics2},g4:null,get_g4:function(){return this.graphics4},width:null,get_width:function(){return M.windowWidth(this.windowId)},height:null,get_height:function(){return M.windowHeight(this.windowId)},__class__:yt,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1"}};var bt=function(){};(i["kha.AlignedQuad"]=bt).__name__=!0,bt.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:bt};var wt=function(e,t,i,n,s,r,a,o){this.mySize=e,this.width=s,this.height=r,this.chars=a,this.baseline=t;for(var l=0;l<a.length;){var _=a[l];++l,_.yoff+=this.baseline}this.texture=ct.create(s,r,cn.L8);for(var h=this.texture.lock(),u=0,c=0,d=r;c<d;){c++;for(var f=0,g=s;f<g;){f++;var m=o.readU8(u);h.b[u]=255&m,++u}}this.texture.unlock()};(i["kha.KravurImage"]=wt).__name__=!0,wt.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(e,t,i,n){if(t>=this.chars.length)return null;var s=1/this.width,r=1/this.height,a=this.chars[t];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return e.x0=o,e.y0=l,e.x1=o+a.x1-a.x0,e.y1=l+a.y1-a.y0,e.s0=a.x0*s,e.t0=a.y0*r,e.s1=a.x1*s,e.t1=a.y1*r,e.xadvance=a.xadvance,e},getCharWidth:function(e){if(0==this.chars.length)return 0;var t=wt.gaps[0];if(e<t)return this.chars[0].xadvance;for(var i=1,n=wt.gaps.length/2|0;i<n;){var s=i++,r=wt.gaps[2*s-1],a=wt.gaps[2*s];a-1<e&&(t+=a-1-r)}return e-t>=this.chars.length?this.chars[0].xadvance:this.chars[e-t].xadvance},getHeight:function(){return this.mySize},stringWidth:function(e){for(var t=new String(e),i=0,n=0,s=t.length;n<s;){var r=n++;i+=this.getCharWidth($.cca(t,r))}return i},charactersWidth:function(e,t,i){for(var n=0,s=t,r=t+i;s<r;){var a=s++;n+=this.getCharWidth(e[a])}return n},getBaselinePosition:function(){return this.baseline},__class__:wt};var xt=function(e){this.images=new Ge,this.blob=e};(i["kha.Kravur"]=xt).__name__=!0,xt.__interfaces__=[ut],xt.fromBytes=function(e){return new xt(In.fromBytes(e))},xt.prototype={oldGlyphs:null,blob:null,images:null,_get:function(e,t){if(null==t&&(t=yi._glyphs),t!=this.oldGlyphs){this.oldGlyphs=t;for(var i=(wt.gaps=[t[0]])[0]+1,n=1,s=t.length;n<s;){var r=n++;t[r]!=i?(wt.gaps.push(t[r-1]),wt.gaps.push(t[r]),i=t[r]+1):++i}wt.gaps.push(t[t.length-1])}var a=null==t?e:1e4*e+t.length;if(!this.images.h.hasOwnProperty(a)){for(var o=64,l=32,_=t.length,h=new Array(_),u=0,c=h.length;u<c;){h[u++]=new Ni}for(var d=null,f=-1;f<0;)l<o?l*=2:o*=2,d=In.alloc(o*l),f=zi.stbtt_BakeFontBitmap(this.blob,0,e,d,o,l,t,h);var g=new Fi;zi.stbtt_InitFont(g,this.blob,0);var m=zi.stbtt_GetFontVMetrics(g),p=zi.stbtt_ScaleForPixelHeight(g,e),v=Math.round(m.ascent*p),y=Math.round(m.descent*p),b=Math.round(m.lineGap*p),w=new wt(0|e,v,y,b,o,l,h,d);return this.images.h[a]=w}return this.images.h[a]},height:function(e){return this._get(e).getHeight()},width:function(e,t){return this._get(e).stringWidth(t)},widthOfCharacters:function(e,t,i,n){return this._get(e).charactersWidth(t,i,n)},baseline:function(e){return this._get(e).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:xt};var St=function(){};(i["kha.LoaderImpl"]=St).__name__=!0,St.getImageFormats=function(){return["png","jpg","hdr"]},St.loadImageFromDescription=function(t,n,i){var s=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;if(X.endsWith(t.files[0],".hdr"))St.loadBlobFromDescription(t,function(e){var t=An.parse(e.toBytes()),i=ct.fromBytes(Fe.ofData(t.data.buffer),t.width,t.height,cn.RGBA128,s?fn.DynamicUsage:fn.StaticUsage);n(i)},i);else{var r=window.document.createElement("img");r.onerror=function(e){i({url:t.files[0],error:e})},r.onload=function(e){var t=ct.fromImage(r,s);n(t)},r.src=t.files[0],r.crossOrigin=""}},St.getSoundFormats=function(){var e=window.document.createElement("audio"),t=[];return""!=e.canPlayType("audio/mp4")&&t.push("mp4"),""!=e.canPlayType("audio/mp3")&&t.push("mp3"),(F._hasWebAudio||""!=e.canPlayType("audio/ogg"))&&t.push("ogg"),t},St.loadSoundFromDescription=function(e,t,i){if(F._hasWebAudio){var n=window.document.createElement("audio");if(""!=n.canPlayType("audio/mp4"))for(var s=0,r=e.files.length;s<r;){var a=s++,o=e.files[a];if(X.endsWith(o,".mp4"))return void new Gn(o,t,i)}if(""!=n.canPlayType("audio/mp3"))for(var l=0,_=e.files.length;l<_;){var h=l++,u=e.files[h];if(X.endsWith(u,".mp3"))return void new Gn(u,t,i)}for(var c=0,d=e.files.length;c<d;){var f=c++,g=e.files[f];if(X.endsWith(g,".ogg"))return void new Gn(g,t,i)}}else if(F.mobile){var m=window.document.createElement("audio");if(""!=m.canPlayType("audio/mp4"))for(var p=0,v=e.files.length;p<v;){var y=p++,b=e.files[y];if(X.endsWith(b,".mp4"))return void new Fn(b,t,i)}if(""!=m.canPlayType("audio/mp3"))for(var w=0,x=e.files.length;w<x;){var S=w++,B=e.files[S];if(X.endsWith(B,".mp3"))return void new Fn(B,t,i)}for(var T=0,k=e.files.length;T<k;){var I=T++,A=e.files[I];if(X.endsWith(A,".ogg"))return void new Fn(A,t,i)}}else new Vn(e.files,t,i)},St.getVideoFormats=function(){return["mp4","webm"]},St.loadVideoFromDescription=function(e,t,i){On.fromFile(e.files,t)},St.loadRemote=function(o,l,_){var h=new XMLHttpRequest;h.open("GET",o.files[0],!0),h.responseType="arraybuffer",h.onreadystatechange=function(){if(4==h.readyState)if(200<=h.status&&h.status<400||0==h.status&&""==h.statusText){var e=null,t=h.response;if(null!=t){var i=new Fs(t);e=Fe.ofData(i)}else{if(null==h.responseBody)return void _({url:o.files[0]});var n=VBArray(h.responseBody).toArray();e=new Fe(new Es(n.length));for(var s=0,r=n.length;s<r;){var a=s++;e.b[a]=255&n[a]}}l(new In(e))}else _({url:o.files[0]})},h.send(null)},St.loadBlobFromDescription=function(e,t,i){St.loadRemote(e,t,i)},St.loadFontFromDescription=function(e,t,i){St.loadBlobFromDescription(e,function(e){t(new xt(e))},i)};var Bt=function(e,t){this.center=e,this.angle=t};(i["kha.Rotation"]=Bt).__name__=!0,Bt.prototype={center:null,angle:null,__class__:Bt};var Tt=function(){};(i["kha.TimeTask"]=Tt).__name__=!0,Tt.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:Tt};var kt=function(e,t,i){this.task=e,this.priority=t,this.id=i,this.active=!0,this.paused=!1};(i["kha.FrameTask"]=kt).__name__=!0,kt.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:kt};var It=i["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"]};It.RotationNone=["RotationNone",0],It.RotationNone.toString=n,(It.RotationNone.__enum__=It).Rotation90=["Rotation90",1],It.Rotation90.toString=n,(It.Rotation90.__enum__=It).Rotation180=["Rotation180",2],It.Rotation180.toString=n,(It.Rotation180.__enum__=It).Rotation270=["Rotation270",3],It.Rotation270.toString=n,It.Rotation270.__enum__=It;var At=function(){};(i["kha.Shaders"]=At).__name__=!0,At.init=function(){for(var e=[],t=0;t<3;){var i=t++,n=K.field(At,"painter_colored_fragData"+i),s=Me.run(n);e.push(In.fromBytes(s))}At.painter_colored_frag=new Xi(e,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);for(var r=[],a=0;a<3;){var o=a++,l=K.field(At,"painter_colored_vertData"+o),_=Me.run(l);r.push(In.fromBytes(_))}At.painter_colored_vert=new vn(r,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);for(var h=[],u=0;u<3;){var c=u++,d=K.field(At,"painter_image_fragData"+c),f=Me.run(d);h.push(In.fromBytes(f))}At.painter_image_frag=new Xi(h,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);for(var g=[],m=0;m<3;){var p=m++,v=K.field(At,"painter_image_vertData"+p),y=Me.run(v);g.push(In.fromBytes(y))}At.painter_image_vert=new vn(g,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);for(var b=[],w=0;w<3;){var x=w++,S=K.field(At,"painter_text_fragData"+x),B=Me.run(S);b.push(In.fromBytes(B))}At.painter_text_frag=new Xi(b,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);for(var T=[],k=0;k<3;){var I=k++,A=K.field(At,"painter_text_vertData"+I),D=Me.run(A);T.push(In.fromBytes(D))}At.painter_text_vert=new vn(T,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);for(var C=[],P=0;P<3;){var N=P++,E=K.field(At,"painter_video_fragData"+N),R=Me.run(E);C.push(In.fromBytes(R))}At.painter_video_frag=new Xi(C,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);for(var L=[],M=0;M<3;){var F=M++,V=K.field(At,"painter_video_vertData"+F),O=Me.run(V);L.push(In.fromBytes(O))}At.painter_video_vert=new vn(L,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"])};var Dt=function(){};(i["kha.Sound"]=Dt).__name__=!0,Dt.__interfaces__=[ut],Dt.prototype={compressedData:null,uncompressedData:null,uncompress:function(e){if(null==this.uncompressedData){var t=new Ke,i=qt.readAll(this.compressedData,t,!0),n=t.getBytes(),s=n.length/4|0;if(1==i.channel){var r=new Ms(2*s);this.uncompressedData=r;for(var a=0,o=s;a<o;){var l=a++;this.uncompressedData[2*l]=n.getFloat(4*l),this.uncompressedData[2*l+1]=n.getFloat(4*l)}}else{var _=new Ms(s);this.uncompressedData=_;for(var h=0,u=s;h<u;){var c=h++;this.uncompressedData[c]=n.getFloat(4*c)}}this.compressedData=null,e()}else e()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:Dt};var Ct=function(){this.axes=[],this.buttons=[]};(i["kha.GamepadStates"]=Ct).__name__=!0,Ct.prototype={axes:null,buttons:null,__class__:Ct};var Pt=function(){};(i["kha.Video"]=Pt).__name__=!0,Pt.__interfaces__=[ut],Pt.prototype={width:function(){return 100},height:function(){return 100},play:function(e){null==e&&(e=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(e){return 0},getVolume:function(){return 1},setVolume:function(e){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:Pt,__properties__:{set_position:"set_position",get_position:"get_position"}};var Nt=function(e,t,i,n,s,r){this.pixels=null,this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=n,this.samples=r,this.image=null,this.video=null,this.depthStencilFormat=s,Nt.init(),n&&this.createTexture()};(i["kha.WebGLImage"]=Nt).__name__=!0,Nt.init=function(){null==Nt.context&&(Nt.canvas=window.document.createElement("canvas"),null!=Nt.canvas&&(Nt.context=Nt.canvas.getContext("2d"),Nt.canvas.width=4096,Nt.canvas.height=4096,Nt.context.globalCompositeOperation="copy"))},Nt.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},Nt.formatByteSize=function(e){switch(e[1]){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},Nt.__super__=ct,Nt.prototype=s(ct.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics1:null,graphics2:null,graphics4:null,depthStencilFormat:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new bi(this)),this.graphics1},get_g2:function(){return null==this.graphics2&&(this.graphics2=new zn(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new Wn(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},isOpaque:function(e,t){if(null==this.data){if(null==Nt.context)return!0;this.createImageData()}return 0!=this.data.data[t*(0|this.image.width)*4+4*e+3]},at:function(e,t){if(null==this.data){if(null==Nt.context)return-16777216;this.createImageData()}var i=this.data.data[t*(0|this.image.width)*4+4*e],n=this.data.data[t*(0|this.image.width)*4+4*e+1],s=this.data.data[t*(0|this.image.width)*4+4*e+2],r=this.data.data[t*(0|this.image.width)*4+4*e+3];return gt._new(r<<24|i<<16|n<<8|s)},createImageData:function(){if(Ai.__instanceof(this.image,Fs))this.data=new ImageData(new Uint8ClampedArray(this.image.buffer),this.get_width(),this.get_height());else{if(this.get_width()>Nt.canvas.width||this.get_height()>Nt.canvas.height){for(var e=Nt.canvas.width,t=Nt.canvas.height;this.get_width()>e||this.get_height()>t;)e*=2,t*=2;Nt.canvas.width=e,Nt.canvas.height=t}Nt.context.strokeStyle="rgba(0,0,0,0)",Nt.context.fillStyle="rgba(0,0,0,0)",Nt.context.fillRect(0,0,this.image.width,this.image.height),Nt.context.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.image.width,this.image.height),this.data=Nt.context.getImageData(0,0,this.image.width,this.image.height)}},createTexture:function(){if(null!=F.gl){if(this.texture=F.gl.createTexture(),F.gl.bindTexture(3553,this.texture),F.gl.texParameteri(3553,10240,9729),F.gl.texParameteri(3553,10241,9729),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=F.gl.createFramebuffer(),F.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:F.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:F.gl.texImage2D(3553,0,F.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:F.gl.texImage2D(3553,0,F.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:F.gl.texImage2D(3553,0,F.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,F.halfFloat.HALF_FLOAT_OES,null);break;case 5:F.gl.texImage2D(3553,0,F.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,F.gl2?6403:6406,5126,null);break;case 6:F.gl.texImage2D(3553,0,F.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,F.gl2?6403:6406,F.halfFloat.HALF_FLOAT_OES,null);break;default:F.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==cn.DEPTH16){if(F.gl.texParameteri(3553,10240,9728),F.gl.texParameteri(3553,10241,9728),F.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!F.gl2){var e=F.gl.createTexture();F.gl.bindTexture(3553,e),F.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),F.gl.framebufferTexture2D(36160,36064,3553,e,0),F.gl.bindTexture(3553,this.texture)}}else F.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=F.gl.checkFramebufferStatus(36160)&&Re.trace("WebGL error: Framebuffer incomplete",{fileName:"WebGLImage.hx",lineNumber:226,className:"kha.WebGLImage",methodName:"createTexture"}),F.gl.bindRenderbuffer(36161,null),F.gl.bindFramebuffer(36160,null)}else if(null!=this.video)F.gl.texImage2D(3553,0,6408,6408,5121,this.video);else{switch(this.format[1]){case 0:Ai.__instanceof(this.image,Fs)?F.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):F.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 2:F.gl.texImage2D(3553,0,F.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:F.gl.texImage2D(3553,0,F.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,F.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:F.gl.texImage2D(3553,0,F.gl2?33326:6406,this.myWidth,this.myHeight,0,F.gl2?6403:6406,5126,this.image);break;case 6:F.gl.texImage2D(3553,0,F.gl2?33325:6406,this.myWidth,this.myHeight,0,F.gl2?6403:6406,F.halfFloat.HALF_FLOAT_OES,this.image);break;default:F.gl.texImage2D(3553,0,6408,6408,5121,this.image)}}F.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:null==F.depthTexture?(this.renderBuffer=F.gl.createRenderbuffer(),F.gl.bindRenderbuffer(36161,this.renderBuffer),F.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),F.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=F.gl.createTexture(),F.gl.bindTexture(3553,this.depthTexture),1==e?F.gl.texImage2D(3553,0,F.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):F.gl.texImage2D(3553,0,F.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),F.gl.texParameteri(3553,10240,9728),F.gl.texParameteri(3553,10241,9728),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==F.depthTexture?(this.renderBuffer=F.gl.createRenderbuffer(),F.gl.bindRenderbuffer(36161,this.renderBuffer),F.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),F.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=F.gl.createTexture(),F.gl.bindTexture(3553,this.depthTexture),F.gl.texImage2D(3553,0,F.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,F.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),F.gl.texParameteri(3553,10240,9728),F.gl.texParameteri(3553,10241,9728),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(e){F.gl.activeTexture(33984+e),F.gl.bindTexture(3553,this.texture),null!=this.video&&F.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(e){F.gl.activeTexture(33984+e),F.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(e){F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.framebufferTexture2D(36160,36096,3553,Ai.__cast(e,Nt).depthTexture,0)},bytesToArray:function(e){switch(this.format[1]){case 0:case 1:return new Fs(e.b.bufferValue);case 2:case 4:case 5:case 6:return new Ms(e.b.bufferValue);default:return new Fs(e.b.bufferValue)}},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new Fe(new Es(Nt.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=F.gl){switch(this.texture=F.gl.createTexture(),F.gl.bindTexture(3553,this.texture),F.gl.texParameteri(3553,10240,9729),F.gl.texParameteri(3553,10241,9729),F.gl.texParameteri(3553,10242,33071),F.gl.texParameteri(3553,10243,33071),this.format[1]){case 0:F.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(F.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==F.gl.getError()){for(var e=new Fe(new Es(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var n=t++,s=0,r=this.get_width();s<r;){var a=s++,o=this.bytes,l=n*this.get_width()+a,_=o.b[l],h=n*this.get_width()*4+4*a;e.b[h]=255&_;var u=n*this.get_width()*4+4*a+1;e.b[u]=255&_;var c=n*this.get_width()*4+4*a+2;e.b[c]=255&_;var d=n*this.get_width()*4+4*a+3;e.b[d]=255}F.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(e))}break;case 2:F.gl.texImage2D(3553,0,F.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:F.gl.texImage2D(3553,0,F.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,F.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:F.gl.texImage2D(3553,0,F.gl2?33326:6406,this.get_width(),this.get_height(),0,F.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:F.gl.texImage2D(3553,0,F.gl2?33325:6406,this.get_width(),this.get_height(),0,F.gl2?6403:6406,F.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:F.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}F.gl.bindTexture(3553,null),this.bytes=null}},pixels:null,getPixels:function(){return null==this.frameBuffer?null:(null==this.pixels&&(this.pixels=new Fs(Nt.formatByteSize(this.format)*this.get_width()*this.get_height())),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.readPixels(0,0,this.myWidth,this.myHeight,6408,5121,this.pixels),Fe.ofData(this.pixels.buffer))},unload:function(){null!=this.texture&&F.gl.deleteTexture(this.texture),null!=this.depthTexture&&F.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&F.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&F.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(e){F.gl.bindTexture(3553,this.texture),F.gl.generateMipmap(3553)},setMipmaps:function(e){if(F.gl.bindTexture(3553,this.texture),this.format==cn.RGBA128)for(var t=0,i=e.length;t<i;){var n=t++;F.gl.texImage2D(3553,n+1,F.gl2?34836:6408,e[n].get_width(),e[n].get_height(),0,6408,5126,Ai.__cast(e[n],Nt).image)}else if(this.format==cn.RGBA64)for(var s=0,r=e.length;s<r;){var a=s++;F.gl.texImage2D(3553,a+1,F.gl2?34842:6408,e[a].get_width(),e[a].get_height(),0,6408,F.halfFloat.HALF_FLOAT_OES,Ai.__cast(e[a],Nt).image)}else for(var o=0,l=e.length;o<l;){var _=o++;F.gl.texImage2D(3553,_+1,6408,6408,5121,Ai.__cast(e[_],Nt).image)}},__class__:Nt});var Et=i["kha.WindowMode"]={__ename__:!0,__constructs__:["Window","BorderlessWindow","Fullscreen"]};Et.Window=["Window",0],Et.Window.toString=n,(Et.Window.__enum__=Et).BorderlessWindow=["BorderlessWindow",1],Et.BorderlessWindow.toString=n,(Et.BorderlessWindow.__enum__=Et).Fullscreen=["Fullscreen",2],Et.Fullscreen.toString=n,Et.Fullscreen.__enum__=Et;var Rt=i["kha.Position"]={__ename__:!0,__constructs__:["Center","Fixed"]};Rt.Center=["Center",0],Rt.Center.toString=n,(Rt.Center.__enum__=Rt).Fixed=function(e){var t=["Fixed",1,e];return t.__enum__=Rt,t.toString=n,t};var Lt=i["kha.TargetDisplay"]={__ename__:!0,__constructs__:["Primary","ById"]};Lt.Primary=["Primary",0],Lt.Primary.toString=n,(Lt.Primary.__enum__=Lt).ById=function(e){var t=["ById",1,e];return t.__enum__=Lt,t.toString=n,t};var Mt=function(e,t,i){this.textureFormat=e,this.depthStencilFormat=t,this.samplesPerPixel=i};(i["kha.RendererOptions"]=Mt).__name__=!0,Mt.prototype={textureFormat:null,depthStencilFormat:null,samplesPerPixel:null,__class__:Mt};var Ft=function(e,t,i){this.minimizable=e,this.maximizable=t,this.resizable=i};(i["kha.WindowedModeOptions"]=Ft).__name__=!0,Ft.prototype={minimizable:null,maximizable:null,resizable:null,__class__:Ft};var Vt=function(e,t,i,n,s,r,a,o,l){this.width=e,this.height=t,this.mode=i,this.title=n,this.x=s,this.y=r,this.targetDisplay=a,this.rendererOptions=o,this.windowedModeOptions=l};(i["kha.WindowOptions"]=Vt).__name__=!0,Vt.prototype={width:null,height:null,mode:null,title:null,x:null,y:null,targetDisplay:null,rendererOptions:null,windowedModeOptions:null,__class__:Vt};var Ot={};(i["kha.arrays._Float32Array.Float32Array_Impl_"]=Ot).__name__=!0,Ot.__properties__={get_length:"get_length"},Ot._new=function(e){return new Ms(e)},Ot.get_length=function(e){return e.length},Ot.set=function(e,t,i){return e[t]=i},Ot.get=function(e,t){return e[t]},Ot.data=function(e){return e},Ot.arrayRead=function(e,t){return e[t]},Ot.arrayWrite=function(e,t,i){return e[t]=i},Ot.subarray=function(e,t,i){return e.subarray(t,i)};var Gt={};(i["kha.arrays._Uint32Array.Uint32Array_Impl_"]=Gt).__name__=!0,Gt.__properties__={get_length:"get_length"},Gt._new=function(e){return new Uint32Array(e)},Gt.get_length=function(e){return e.length},Gt.set=function(e,t,i){return e[t]=i},Gt.get=function(e,t){return e[t]},Gt.data=function(e){return e},Gt.arrayRead=function(e,t){return e[t]},Gt.arrayWrite=function(e,t,i){return e[t]=i},Gt.subarray=function(e,t,i){return e.subarray(t,i)};var Ut=function(){};(i["kha.audio1.AudioChannel"]=Ut).__name__=!0,Ut.prototype={play:null,pause:null,stop:null,length:null,get_length:null,position:null,get_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:Ut,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var Wt=function(){};(i["kha.audio2.Audio"]=Wt).__name__=!0,Wt.initContext=function(){try{return void(Wt._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},Wt._init=function(){if(Wt.initContext(),null==Wt._context)return!1;return Wt.buffer=new Zt(8192,2,0|Wt._context.sampleRate),Wt.processingNode=Wt._context.createScriptProcessor(2048,0,2),Wt.processingNode.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(1);if(null!=Wt.audioCallback){Wt.audioCallback(2*e.outputBuffer.length,Wt.buffer);for(var n=0,s=e.outputBuffer.length;n<s;){var r=n++;t[r]=Wt.buffer.data[Wt.buffer.readLocation],Wt.buffer.readLocation+=1,i[r]=Wt.buffer.data[Wt.buffer.readLocation],Wt.buffer.readLocation+=1,Wt.buffer.readLocation>=Wt.buffer.size&&(Wt.buffer.readLocation=0)}}else for(var a=0,o=e.outputBuffer.length;a<o;){var l=a++;t[l]=0,i[l]=0}},Wt.processingNode.connect(Wt._context.destination),!0},Wt.stream=function(e,t){null==t&&(t=!1);var i=window.document.createElement("audio"),n=new Blob([e.compressedData.b.bufferValue],{type:"audio/mp4"});i.src=URL.createObjectURL(n),i.loop=t;var s=new Dn(i);return s.play(),s};var zt=function(){};(i["kha.audio2.Audio1"]=zt).__name__=!0,zt._init=function(){var e=new Array(16);zt.soundChannels=e;var t=new Array(16);zt.streamChannels=t;var i=new Array(16);zt.internalSoundChannels=i;var n=new Array(16);zt.internalStreamChannels=n;var s=new Ms(512);zt.sampleCache1=s;var r=new Ms(512);zt.sampleCache2=r,Wt.audioCallback=zt.mix},zt.max=function(e,t){return t<e?e:t},zt.min=function(e,t){return e<t?e:t},zt.mix=function(e,t){if(zt.sampleCache1.length<e){var i=new Ms(e);zt.sampleCache1=i;var n=new Ms(e);zt.sampleCache2=n}for(var s=0,r=e;s<r;){var a=s++;zt.sampleCache2[a]=0}for(var o=0;o<16;){var l=o++;zt.internalSoundChannels[l]=zt.soundChannels[l]}for(var _=0;_<16;){var h=_++;zt.internalStreamChannels[h]=zt.streamChannels[h]}for(var u=0,c=zt.internalSoundChannels;u<c.length;){var d=c[u];if(++u,null!=d&&!d.get_finished()){d.nextSamples(zt.sampleCache1,e,t.samplesPerSecond);for(var f=0,g=e;f<g;){var m=f++,p=m;zt.sampleCache2[p]+=zt.sampleCache1[m]*d.get_volume()}}}for(var v=0,y=zt.internalStreamChannels;v<y.length;){var b=y[v];if(++v,null!=b&&!b.get_finished()){b.nextSamples(zt.sampleCache1,e,t.samplesPerSecond);for(var w=0,x=e;w<x;){var S=w++,B=S;zt.sampleCache2[B]+=zt.sampleCache1[S]*b.get_volume()}}}for(var T=0,k=e;T<k;){var I=T++,A=zt.sampleCache2[I],D=A<1?A:1;t.data[t.writeLocation]=-1<D?D:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}},zt.play=function(e,t){null==t&&(t=!1);for(var i=null,n=0;n<16;){var s=n++;if(null==zt.soundChannels[s]||zt.soundChannels[s].get_finished()){(i=new Ht(t)).data=e.uncompressedData,zt.soundChannels[s]=i;break}}return i},zt._playAgain=function(e){for(var t=0;t<16;){var i=t++;if(null==zt.soundChannels[i]||zt.soundChannels[i].get_finished()||zt.soundChannels[i]==e){zt.soundChannels[i]=e;break}}},zt.stream=function(e,t){null==t&&(t=!1);var i=Wt.stream(e,t);if(null!=i)return i;for(var n=null,s=0;s<16;){var r=s++;if(null==zt.streamChannels[r]||zt.streamChannels[r].get_finished()){n=new jt(e.compressedData,t),zt.streamChannels[r]=n;break}}return n};var Ht=function(e){this.paused=!1,this.looping=e,this.myVolume=1,this.myPosition=0};(i["kha.audio2.AudioChannel"]=Ht).__name__=!0,Ht.__interfaces__=[Ut],Ht.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(e,t,i){if(this.paused)for(var n=0,s=t;n<s;){e[n++]=0}else{for(var r=0,a=0;r<t;){for(var o=this.data.length-this.myPosition,l=o<t-r?o:t-r;a<l;)e[r]=this.data[this.myPosition],++this.myPosition,++a,++r;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;r<t;)e[r]=0,++r}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,zt._playAgain(this))},pause:function(){this.paused=!0},stop:function(){this.myPosition=this.data.length},length:null,get_length:function(){return this.data.length/44100/2},position:null,get_position:function(){return this.myPosition/44100/2},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},finished:null,get_finished:function(){return this.myPosition>=this.data.length},__class__:Ht,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var Zt=function(e,t,i){this.size=e;var n=new Ms(e);this.data=n,this.channels=t,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(i["kha.audio2.Buffer"]=Zt).__name__=!0,Zt.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Zt};var jt=function(e,t){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=t,this.reader=qt.openFromBytes(e)};(i["kha.audio2.StreamChannel"]=jt).__name__=!0,jt.__interfaces__=[Ut],jt.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(e,t,i){if(this.paused)for(var n=0,s=t;n<s;){e[n++]=0}else{var r=2*this.reader.read(e,t/2|0,2,i,!0);if(r<t){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=r,o=t;a<o;){e[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},position:null,get_position:function(){return this.reader.get_currentMillisecond()/1e3},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},finished:null,get_finished:function(){return this.atend},__class__:jt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var Kt=function(){};(i["kha.audio2.ogg.tools.Crc32"]=Kt).__name__=!0,Kt.init=function(){if(null==Kt.table){var e=new Array(256);Kt.table=e;for(var t=0;t<256;){for(var i=t++,n=i<<24,s=0;s<8;){s++;n=n<<1^(nt.gte(n,1<<31)?79764919:0)}Kt.table[i]=n}}},Kt.update=function(e,t){return e<<8^Kt.table[t^e>>>24]};var Xt=function(){};(i["kha.audio2.ogg.tools.MathTools"]=Xt).__name__=!0,Xt.ilog=function(e){var t=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return e<16384?e<16?t[e]:e<512?5+t[e>>5]:10+t[e>>10]:e<16777216?e<524288?15+t[e>>15]:20+t[e>>20]:e<536870912?25+t[e>>25]:e<-2147483648?30+t[e>>30]:0};var Yt=function(){};(i["kha.audio2.ogg.tools.Mdct"]=Yt).__name__=!0,Yt.inverseTransform=function(e,t,i,n,s,r){for(var a=t>>1,o=t>>2,l=t>>3,_=new Array(a),h=a-2,u=0,c=0,d=a;c!=d;)_[h+1]=e[c]*i[u]-e[c+2]*i[u+1],_[h]=e[c]*i[u+1]+e[c+2]*i[u],h-=2,u+=2,c+=4;for(c=a-3;0<=h;)_[h+1]=-e[c+2]*i[u]- -e[c]*i[u+1],_[h]=-e[c+2]*i[u+1]+-e[c]*i[u],h-=2,u+=2,c-=4;for(var f=e,g=_,m=a-8,p=o,v=0,y=o,b=0;0<=m;){var w=g[p+1]-g[v+1],x=g[p]-g[v];f[y+1]=g[p+1]+g[v+1],f[y]=g[p]+g[v],f[b+1]=w*i[m+4]-x*i[m+5],f[b]=x*i[m+4]+w*i[m+5],w=g[p+3]-g[v+3],x=g[p+2]-g[v+2],f[y+3]=g[p+3]+g[v+3],f[y+2]=g[p+2]+g[v+2],f[b+3]=w*i[m]-x*i[m+1],f[b+2]=x*i[m]+w*i[m+1],m-=8,y+=4,b+=4,p+=4,v+=4}for(var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],B=(t<16384?t<16?S[t]:t<512?5+S[t>>5]:10+S[t>>10]:t<16777216?t<524288?15+S[t>>15]:20+S[t>>20]:t<536870912?25+S[t>>25]:t<-2147483648?30+S[t>>30]:0)-1,T=a-1-0*o,k=T,I=T+-(t>>3),A=0,D=1+(t>>4>>2);0<--D;){var C=f[k]-f[I],P=f[k+-1]-f[I+-1],N=k,E=f;E[N]=E[N]+f[I];var R=k+-1,L=f;L[R]=L[R]+f[I+-1],f[I]=C*i[A]-P*i[A+1],f[I+-1]=P*i[A]+C*i[A+1],A+=8,C=f[k+-2]-f[I+-2],P=f[k+-3]-f[I+-3];var M=k+-2,F=f;F[M]=F[M]+f[I+-2];var V=k+-3,O=f;O[V]=O[V]+f[I+-3],f[I+-2]=C*i[A]-P*i[A+1],f[I+-3]=P*i[A]+C*i[A+1],A+=8,C=f[k+-4]-f[I+-4],P=f[k+-5]-f[I+-5];var G=k+-4,U=f;U[G]=U[G]+f[I+-4];var W=k+-5,z=f;z[W]=z[W]+f[I+-5],f[I+-4]=C*i[A]-P*i[A+1],f[I+-5]=P*i[A]+C*i[A+1],A+=8,C=f[k+-6]-f[I+-6],P=f[k+-7]-f[I+-7];var H=k+-6,Z=f;Z[H]=Z[H]+f[I+-6];var j=k+-7,K=f;K[j]=K[j]+f[I+-7],f[I+-6]=C*i[A]-P*i[A+1],f[I+-7]=P*i[A]+C*i[A+1],A+=8,k-=8,I-=8}for(var X=a-1-o,Y=X,q=X+-(t>>3),Q=0,J=1+(t>>4>>2);0<--J;){var $=f[Y]-f[q],ee=f[Y+-1]-f[q+-1],te=Y,ie=f;ie[te]=ie[te]+f[q];var ne=Y+-1,se=f;se[ne]=se[ne]+f[q+-1],f[q]=$*i[Q]-ee*i[Q+1],f[q+-1]=ee*i[Q]+$*i[Q+1],Q+=8,$=f[Y+-2]-f[q+-2],ee=f[Y+-3]-f[q+-3];var re=Y+-2,ae=f;ae[re]=ae[re]+f[q+-2];var oe=Y+-3,le=f;le[oe]=le[oe]+f[q+-3],f[q+-2]=$*i[Q]-ee*i[Q+1],f[q+-3]=ee*i[Q]+$*i[Q+1],Q+=8,$=f[Y+-4]-f[q+-4],ee=f[Y+-5]-f[q+-5];var _e=Y+-4,he=f;he[_e]=he[_e]+f[q+-4];var ue=Y+-5,ce=f;ce[ue]=ce[ue]+f[q+-5],f[q+-4]=$*i[Q]-ee*i[Q+1],f[q+-5]=ee*i[Q]+$*i[Q+1],Q+=8,$=f[Y+-6]-f[q+-6],ee=f[Y+-7]-f[q+-7];var de=Y+-6,fe=f;fe[de]=fe[de]+f[q+-6];var ge=Y+-7,me=f;me[ge]=me[ge]+f[q+-7],f[q+-6]=$*i[Q]-ee*i[Q+1],f[q+-7]=ee*i[Q]+$*i[Q+1],Q+=8,Y-=8,q-=8}for(var pe=a-1-0*l,ve=0,ye=pe,be=pe+-(t>>4),we=1+(t>>5>>2);0<--we;){var xe=f[ye]-f[be],Se=f[ye+-1]-f[be+-1],Be=ye,Te=f;Te[Be]=Te[Be]+f[be];var ke=ye+-1,Ie=f;Ie[ke]=Ie[ke]+f[be+-1],f[be]=xe*i[ve]-Se*i[ve+1],f[be+-1]=Se*i[ve]+xe*i[ve+1],ve+=16,xe=f[ye+-2]-f[be+-2],Se=f[ye+-3]-f[be+-3];var Ae=ye+-2,De=f;De[Ae]=De[Ae]+f[be+-2];var Ce=ye+-3,Pe=f;Pe[Ce]=Pe[Ce]+f[be+-3],f[be+-2]=xe*i[ve]-Se*i[ve+1],f[be+-3]=Se*i[ve]+xe*i[ve+1],ve+=16,xe=f[ye+-4]-f[be+-4],Se=f[ye+-5]-f[be+-5];var Ne=ye+-4,Ee=f;Ee[Ne]=Ee[Ne]+f[be+-4];var Re=ye+-5,Le=f;Le[Re]=Le[Re]+f[be+-5],f[be+-4]=xe*i[ve]-Se*i[ve+1],f[be+-5]=Se*i[ve]+xe*i[ve+1],ve+=16,xe=f[ye+-6]-f[be+-6],Se=f[ye+-7]-f[be+-7];var Me=ye+-6,Fe=f;Fe[Me]=Fe[Me]+f[be+-6];var Ve=ye+-7,Oe=f;Oe[Ve]=Oe[Ve]+f[be+-7],f[be+-6]=xe*i[ve]-Se*i[ve+1],f[be+-7]=Se*i[ve]+xe*i[ve+1],ye-=8,be-=8,ve+=16}for(var Ge=a-1-l,Ue=0,We=Ge,ze=Ge+-(t>>4),He=1+(t>>5>>2);0<--He;){var Ze=f[We]-f[ze],je=f[We+-1]-f[ze+-1],Ke=We,Xe=f;Xe[Ke]=Xe[Ke]+f[ze];var Ye=We+-1,qe=f;qe[Ye]=qe[Ye]+f[ze+-1],f[ze]=Ze*i[Ue]-je*i[Ue+1],f[ze+-1]=je*i[Ue]+Ze*i[Ue+1],Ue+=16,Ze=f[We+-2]-f[ze+-2],je=f[We+-3]-f[ze+-3];var Qe=We+-2,Je=f;Je[Qe]=Je[Qe]+f[ze+-2];var $e=We+-3,et=f;et[$e]=et[$e]+f[ze+-3],f[ze+-2]=Ze*i[Ue]-je*i[Ue+1],f[ze+-3]=je*i[Ue]+Ze*i[Ue+1],Ue+=16,Ze=f[We+-4]-f[ze+-4],je=f[We+-5]-f[ze+-5];var tt=We+-4,it=f;it[tt]=it[tt]+f[ze+-4];var nt=We+-5,st=f;st[nt]=st[nt]+f[ze+-5],f[ze+-4]=Ze*i[Ue]-je*i[Ue+1],f[ze+-5]=je*i[Ue]+Ze*i[Ue+1],Ue+=16,Ze=f[We+-6]-f[ze+-6],je=f[We+-7]-f[ze+-7];var rt=We+-6,at=f;at[rt]=at[rt]+f[ze+-6];var ot=We+-7,lt=f;lt[ot]=lt[ot]+f[ze+-7],f[ze+-6]=Ze*i[Ue]-je*i[Ue+1],f[ze+-7]=je*i[Ue]+Ze*i[Ue+1],We-=8,ze-=8,Ue+=16}for(var _t=a-1-2*l,ht=0,ut=_t,ct=_t+-(t>>4),dt=1+(t>>5>>2);0<--dt;){var ft=f[ut]-f[ct],gt=f[ut+-1]-f[ct+-1],mt=ut,pt=f;pt[mt]=pt[mt]+f[ct];var vt=ut+-1,yt=f;yt[vt]=yt[vt]+f[ct+-1],f[ct]=ft*i[ht]-gt*i[ht+1],f[ct+-1]=gt*i[ht]+ft*i[ht+1],ht+=16,ft=f[ut+-2]-f[ct+-2],gt=f[ut+-3]-f[ct+-3];var bt=ut+-2,wt=f;wt[bt]=wt[bt]+f[ct+-2];var xt=ut+-3,St=f;St[xt]=St[xt]+f[ct+-3],f[ct+-2]=ft*i[ht]-gt*i[ht+1],f[ct+-3]=gt*i[ht]+ft*i[ht+1],ht+=16,ft=f[ut+-4]-f[ct+-4],gt=f[ut+-5]-f[ct+-5];var Bt=ut+-4,Tt=f;Tt[Bt]=Tt[Bt]+f[ct+-4];var kt=ut+-5,It=f;It[kt]=It[kt]+f[ct+-5],f[ct+-4]=ft*i[ht]-gt*i[ht+1],f[ct+-5]=gt*i[ht]+ft*i[ht+1],ht+=16,ft=f[ut+-6]-f[ct+-6],gt=f[ut+-7]-f[ct+-7];var At=ut+-6,Dt=f;Dt[At]=Dt[At]+f[ct+-6];var Ct=ut+-7,Pt=f;Pt[Ct]=Pt[Ct]+f[ct+-7],f[ct+-6]=ft*i[ht]-gt*i[ht+1],f[ct+-7]=gt*i[ht]+ft*i[ht+1],ut-=8,ct-=8,ht+=16}for(var Nt=a-1-3*l,Et=0,Rt=Nt,Lt=Nt+-(t>>4),Mt=1+(t>>5>>2);0<--Mt;){var Ft=f[Rt]-f[Lt],Vt=f[Rt+-1]-f[Lt+-1],Ot=Rt,Gt=f;Gt[Ot]=Gt[Ot]+f[Lt];var Ut=Rt+-1,Wt=f;Wt[Ut]=Wt[Ut]+f[Lt+-1],f[Lt]=Ft*i[Et]-Vt*i[Et+1],f[Lt+-1]=Vt*i[Et]+Ft*i[Et+1],Et+=16,Ft=f[Rt+-2]-f[Lt+-2],Vt=f[Rt+-3]-f[Lt+-3];var zt=Rt+-2,Ht=f;Ht[zt]=Ht[zt]+f[Lt+-2];var Zt=Rt+-3,jt=f;jt[Zt]=jt[Zt]+f[Lt+-3],f[Lt+-2]=Ft*i[Et]-Vt*i[Et+1],f[Lt+-3]=Vt*i[Et]+Ft*i[Et+1],Et+=16,Ft=f[Rt+-4]-f[Lt+-4],Vt=f[Rt+-5]-f[Lt+-5];var Kt=Rt+-4,Xt=f;Xt[Kt]=Xt[Kt]+f[Lt+-4];var Yt=Rt+-5,qt=f;qt[Yt]=qt[Yt]+f[Lt+-5],f[Lt+-4]=Ft*i[Et]-Vt*i[Et+1],f[Lt+-5]=Vt*i[Et]+Ft*i[Et+1],Et+=16,Ft=f[Rt+-6]-f[Lt+-6],Vt=f[Rt+-7]-f[Lt+-7];var Qt=Rt+-6,Jt=f;Jt[Qt]=Jt[Qt]+f[Lt+-6];var $t=Rt+-7,ei=f;ei[$t]=ei[$t]+f[Lt+-7],f[Lt+-6]=Ft*i[Et]-Vt*i[Et+1],f[Lt+-7]=Vt*i[Et]+Ft*i[Et+1],Rt-=8,Lt-=8,Et+=16}for(var ti=2,ii=B-3>>1;ti<ii;)for(var ni=ti++,si=t>>ni+2,ri=si>>1,ai=0,oi=1<<ni+1;ai<oi;)for(var li=a-1-si*ai++,_i=1<<ni+3,hi=0,ui=li,ci=li+-ri,di=1+(t>>ni+4>>2);0<--di;){var fi=f[ui]-f[ci],gi=f[ui+-1]-f[ci+-1],mi=ui,pi=f;pi[mi]=pi[mi]+f[ci];var vi=ui+-1,yi=f;yi[vi]=yi[vi]+f[ci+-1],f[ci]=fi*i[hi]-gi*i[hi+1],f[ci+-1]=gi*i[hi]+fi*i[hi+1],hi+=_i,fi=f[ui+-2]-f[ci+-2],gi=f[ui+-3]-f[ci+-3];var bi=ui+-2,wi=f;wi[bi]=wi[bi]+f[ci+-2];var xi=ui+-3,Si=f;Si[xi]=Si[xi]+f[ci+-3],f[ci+-2]=fi*i[hi]-gi*i[hi+1],f[ci+-3]=gi*i[hi]+fi*i[hi+1],hi+=_i,fi=f[ui+-4]-f[ci+-4],gi=f[ui+-5]-f[ci+-5];var Bi=ui+-4,Ti=f;Ti[Bi]=Ti[Bi]+f[ci+-4];var ki=ui+-5,Ii=f;Ii[ki]=Ii[ki]+f[ci+-5],f[ci+-4]=fi*i[hi]-gi*i[hi+1],f[ci+-5]=gi*i[hi]+fi*i[hi+1],hi+=_i,fi=f[ui+-6]-f[ci+-6],gi=f[ui+-7]-f[ci+-7];var Ai=ui+-6,Di=f;Di[Ai]=Di[Ai]+f[ci+-6];var Ci=ui+-7,Pi=f;Pi[Ci]=Pi[Ci]+f[ci+-7],f[ci+-6]=fi*i[hi]-gi*i[hi+1],f[ci+-7]=gi*i[hi]+fi*i[hi+1],ui-=8,ci-=8,hi+=_i}for(var Ni=B-3>>1,Ei=B-6;Ni<Ei;)for(var Ri=Ni++,Li=t>>Ri+2,Mi=1<<Ri+3,Fi=Li>>1,Vi=1<<Ri+1,Oi=0,Gi=a-1,Ui=(t>>Ri+6)+1;0<--Ui;){for(var Wi=i[Oi],zi=i[Oi+1],Hi=i[Oi+Mi],Zi=i[Oi+Mi+1],ji=i[Oi+2*Mi],Ki=i[Oi+2*Mi+1],Xi=i[Oi+3*Mi],Yi=i[Oi+3*Mi+1],qi=Gi,Qi=Gi+-Fi,Ji=Vi+1;0<--Ji;){var $i=f[qi]-f[Qi],en=f[qi+-1]-f[Qi+-1];f[qi]=f[qi]+f[Qi],f[qi+-1]=f[qi+-1]+f[Qi+-1],f[Qi]=$i*Wi-en*zi,f[Qi+-1]=en*Wi+$i*zi,$i=f[qi+-2]-f[Qi+-2],en=f[qi+-3]-f[Qi+-3],f[qi+-2]=f[qi+-2]+f[Qi+-2],f[qi+-3]=f[qi+-3]+f[Qi+-3],f[Qi+-2]=$i*Hi-en*Zi,f[Qi+-3]=en*Hi+$i*Zi,$i=f[qi+-4]-f[Qi+-4],en=f[qi+-5]-f[Qi+-5],f[qi+-4]=f[qi+-4]+f[Qi+-4],f[qi+-5]=f[qi+-5]+f[Qi+-5],f[Qi+-4]=$i*ji-en*Ki,f[Qi+-5]=en*ji+$i*Ki,$i=f[qi+-6]-f[Qi+-6],en=f[qi+-7]-f[Qi+-7],f[qi+-6]=f[qi+-6]+f[Qi+-6],f[qi+-7]=f[qi+-7]+f[Qi+-7],f[Qi+-6]=$i*Xi-en*Yi,f[Qi+-7]=en*Xi+$i*Yi,qi-=Li,Qi-=Li}Oi+=4*Mi,Gi-=8}for(var tn=a-1,nn=i[t>>3],sn=tn,rn=tn-16*(t>>5);rn<sn;){var an=f[sn],on=f[sn+-8];f[sn+-8]=an-on,f[sn]=an+on,an=f[sn+-1],on=f[sn+-9],f[sn+-9]=an-on,f[sn+-1]=an+on;var ln=(an=f[sn+-2])-(on=f[sn+-10]);f[sn+-2]=an+on;var _n=(an=f[sn+-3])-(on=f[sn+-11]);f[sn+-3]=an+on,f[sn+-10]=(ln+_n)*nn,f[sn+-11]=(_n-ln)*nn,an=f[sn+-4],ln=(on=f[sn+-12])-an,f[sn+-4]=an+on,_n=(an=f[sn+-5])-(on=f[sn+-13]),f[sn+-5]=an+on,f[sn+-12]=_n,f[sn+-13]=ln,an=f[sn+-6],ln=(on=f[sn+-14])-an,f[sn+-6]=an+on,_n=(an=f[sn+-7])-(on=f[sn+-15]),f[sn+-7]=an+on,f[sn+-14]=(ln+_n)*nn,f[sn+-15]=(ln-_n)*nn;var hn=f[sn],un=f[sn+-4],cn=hn-un,dn=hn+un,fn=(hn=f[sn+-2])+(un=f[sn+-6]),gn=hn-un;f[sn]=dn+fn,f[sn+-2]=dn-fn;var mn=f[sn+-3]-f[sn+-7];f[sn+-4]=cn+mn,f[sn+-6]=cn-mn;var pn=(hn=f[sn+-1])-(un=f[sn+-5]),vn=hn+un,yn=f[sn+-3]+f[sn+-7];f[sn+-1]=vn+yn,f[sn+-3]=vn-yn,f[sn+-5]=pn-gn,f[sn+-7]=pn+gn;var bn=sn-8,wn=f[bn],xn=f[bn+-4],Sn=wn-xn,Bn=wn+xn,Tn=(wn=f[bn+-2])+(xn=f[bn+-6]),kn=wn-xn;f[bn]=Bn+Tn,f[bn+-2]=Bn-Tn;var In=f[bn+-3]-f[bn+-7];f[bn+-4]=Sn+In,f[bn+-6]=Sn-In;var An=(wn=f[bn+-1])-(xn=f[bn+-5]),Dn=wn+xn,Cn=f[bn+-3]+f[bn+-7];f[bn+-1]=Dn+Cn,f[bn+-3]=Dn-Cn,f[bn+-5]=An-kn,f[bn+-7]=An+kn,sn-=16}for(var Pn=0,Nn=o-4,En=a-4;0<=Nn;){var Rn=r[Pn];g[En+3]=f[Rn],g[En+2]=f[Rn+1],g[Nn+3]=f[Rn+2],g[Nn+2]=f[Rn+3],Rn=r[Pn+1],g[En+1]=f[Rn],g[En]=f[Rn+1],g[Nn+1]=f[Rn+2],g[Nn]=f[Rn+3],Nn-=4,En-=4,Pn+=2}for(var Ln=0,Mn=0,Fn=a-4;Mn<Fn;){var Vn=g[Mn]-g[Fn+2],On=g[Mn+1]+g[Fn+3],Gn=s[Ln+1]*Vn+s[Ln]*On,Un=s[Ln+1]*On-s[Ln]*Vn,Wn=g[Mn]+g[Fn+2],zn=g[Mn+1]-g[Fn+3];g[Mn]=Wn+Gn,g[Mn+1]=zn+Un,g[Fn+2]=Wn-Gn,g[Fn+3]=Un-zn,Vn=g[Mn+2]-g[Fn],On=g[Mn+3]+g[Fn+1],Gn=s[Ln+3]*Vn+s[Ln+2]*On,Un=s[Ln+3]*On-s[Ln+2]*Vn,Wn=g[Mn+2]+g[Fn],zn=g[Mn+3]-g[Fn+1],g[Mn+2]=Wn+Gn,g[Mn+3]=zn+Un,g[Fn]=Wn-Gn,g[Fn+1]=Un-zn,Ln+=4,Mn+=4,Fn-=4}for(var Hn=a-8,Zn=a-8,jn=0,Kn=a-4,Xn=a,Yn=t-4;0<=Zn;){var qn=_[Zn+6]*n[Hn+7]-_[Zn+7]*n[Hn+6],Qn=-_[Zn+6]*n[Hn+6]-_[Zn+7]*n[Hn+7];e[jn]=qn,e[Kn+3]=-qn,e[Xn]=Qn,e[Yn+3]=Qn;var Jn=_[Zn+4]*n[Hn+5]-_[Zn+5]*n[Hn+4],$n=-_[Zn+4]*n[Hn+4]-_[Zn+5]*n[Hn+5];e[jn+1]=Jn,e[Kn+2]=-Jn,e[Xn+1]=$n,e[Yn+2]=$n,qn=_[Zn+2]*n[Hn+3]-_[Zn+3]*n[Hn+2],Qn=-_[Zn+2]*n[Hn+2]-_[Zn+3]*n[Hn+3],e[jn+2]=qn,e[Kn+1]=-qn,e[Xn+2]=Qn,e[Yn+1]=Qn,Jn=_[Zn]*n[Hn+1]-_[Zn+1]*n[Hn],$n=-_[Zn]*n[Hn]-_[Zn+1]*n[Hn+1],e[jn+3]=Jn,e[Kn]=-Jn,e[Xn+3]=$n,e[Yn]=$n,Hn-=8,Zn-=8,jn+=4,Xn+=4,Kn-=4,Yn-=4}},Yt.step3Iter0Loop=function(e,t,i,n,s){for(var r=i,a=i+n,o=0,l=1+(e>>2);0<--l;){var _=t[r]-t[a],h=t[r+-1]-t[a+-1],u=r,c=t;c[u]=c[u]+t[a];var d=r+-1,f=t;f[d]=f[d]+t[a+-1],t[a]=_*s[o]-h*s[o+1],t[a+-1]=h*s[o]+_*s[o+1],o+=8,_=t[r+-2]-t[a+-2],h=t[r+-3]-t[a+-3];var g=r+-2,m=t;m[g]=m[g]+t[a+-2];var p=r+-3,v=t;v[p]=v[p]+t[a+-3],t[a+-2]=_*s[o]-h*s[o+1],t[a+-3]=h*s[o]+_*s[o+1],o+=8,_=t[r+-4]-t[a+-4],h=t[r+-5]-t[a+-5];var y=r+-4,b=t;b[y]=b[y]+t[a+-4];var w=r+-5,x=t;x[w]=x[w]+t[a+-5],t[a+-4]=_*s[o]-h*s[o+1],t[a+-5]=h*s[o]+_*s[o+1],o+=8,_=t[r+-6]-t[a+-6],h=t[r+-7]-t[a+-7];var S=r+-6,B=t;B[S]=B[S]+t[a+-6];var T=r+-7,k=t;k[T]=k[T]+t[a+-7],t[a+-6]=_*s[o]-h*s[o+1],t[a+-7]=h*s[o]+_*s[o+1],o+=8,r-=8,a-=8}},Yt.step3InnerRLoop=function(e,t,i,n,s,r){for(var a=0,o=i,l=i+n,_=1+(e>>2);0<--_;){var h=t[o]-t[l],u=t[o+-1]-t[l+-1],c=o,d=t;d[c]=d[c]+t[l];var f=o+-1,g=t;g[f]=g[f]+t[l+-1],t[l]=h*s[a]-u*s[a+1],t[l+-1]=u*s[a]+h*s[a+1],a+=r,h=t[o+-2]-t[l+-2],u=t[o+-3]-t[l+-3];var m=o+-2,p=t;p[m]=p[m]+t[l+-2];var v=o+-3,y=t;y[v]=y[v]+t[l+-3],t[l+-2]=h*s[a]-u*s[a+1],t[l+-3]=u*s[a]+h*s[a+1],a+=r,h=t[o+-4]-t[l+-4],u=t[o+-5]-t[l+-5];var b=o+-4,w=t;w[b]=w[b]+t[l+-4];var x=o+-5,S=t;S[x]=S[x]+t[l+-5],t[l+-4]=h*s[a]-u*s[a+1],t[l+-5]=u*s[a]+h*s[a+1],a+=r,h=t[o+-6]-t[l+-6],u=t[o+-7]-t[l+-7];var B=o+-6,T=t;T[B]=T[B]+t[l+-6];var k=o+-7,I=t;I[k]=I[k]+t[l+-7],t[l+-6]=h*s[a]-u*s[a+1],t[l+-7]=u*s[a]+h*s[a+1],o-=8,l-=8,a+=r}},Yt.step3InnerSLoop=function(e,t,i,n,s,r,a,o){for(var l=s[r],_=s[r+1],h=s[r+a],u=s[r+a+1],c=s[r+2*a],d=s[r+2*a+1],f=s[r+3*a],g=s[r+3*a+1],m=i,p=i+n,v=e+1;0<--v;){var y=t[m]-t[p],b=t[m+-1]-t[p+-1];t[m]=t[m]+t[p],t[m+-1]=t[m+-1]+t[p+-1],t[p]=y*l-b*_,t[p+-1]=b*l+y*_,y=t[m+-2]-t[p+-2],b=t[m+-3]-t[p+-3],t[m+-2]=t[m+-2]+t[p+-2],t[m+-3]=t[m+-3]+t[p+-3],t[p+-2]=y*h-b*u,t[p+-3]=b*h+y*u,y=t[m+-4]-t[p+-4],b=t[m+-5]-t[p+-5],t[m+-4]=t[m+-4]+t[p+-4],t[m+-5]=t[m+-5]+t[p+-5],t[p+-4]=y*c-b*d,t[p+-5]=b*c+y*d,y=t[m+-6]-t[p+-6],b=t[m+-7]-t[p+-7],t[m+-6]=t[m+-6]+t[p+-6],t[m+-7]=t[m+-7]+t[p+-7],t[p+-6]=y*f-b*g,t[p+-7]=b*f+y*g,m-=o,p-=o}},Yt.iter54=function(e,t){var i=e[t],n=e[t+-4],s=i-n,r=i+n,a=(i=e[t+-2])+(n=e[t+-6]),o=i-n;e[t]=r+a,e[t+-2]=r-a;var l=e[t+-3]-e[t+-7];e[t+-4]=s+l,e[t+-6]=s-l;var _=(i=e[t+-1])-(n=e[t+-5]),h=i+n,u=e[t+-3]+e[t+-7];e[t+-1]=h+u,e[t+-3]=h-u,e[t+-5]=_-o,e[t+-7]=_+o},Yt.step3InnerSLoopLd654=function(e,t,i,n,s){for(var r=n[s>>3],a=i,o=i-16*e;o<a;){var l=t[a],_=t[a+-8];t[a+-8]=l-_,t[a]=l+_,l=t[a+-1],_=t[a+-9],t[a+-9]=l-_,t[a+-1]=l+_;var h=(l=t[a+-2])-(_=t[a+-10]);t[a+-2]=l+_;var u=(l=t[a+-3])-(_=t[a+-11]);t[a+-3]=l+_,t[a+-10]=(h+u)*r,t[a+-11]=(u-h)*r,l=t[a+-4],h=(_=t[a+-12])-l,t[a+-4]=l+_,u=(l=t[a+-5])-(_=t[a+-13]),t[a+-5]=l+_,t[a+-12]=u,t[a+-13]=h,l=t[a+-6],h=(_=t[a+-14])-l,t[a+-6]=l+_,u=(l=t[a+-7])-(_=t[a+-15]),t[a+-7]=l+_,t[a+-14]=(h+u)*r,t[a+-15]=(h-u)*r;var c=t[a],d=t[a+-4],f=c-d,g=c+d,m=(c=t[a+-2])+(d=t[a+-6]),p=c-d;t[a]=g+m,t[a+-2]=g-m;var v=t[a+-3]-t[a+-7];t[a+-4]=f+v,t[a+-6]=f-v;var y=(c=t[a+-1])-(d=t[a+-5]),b=c+d,w=t[a+-3]+t[a+-7];t[a+-1]=b+w,t[a+-3]=b-w,t[a+-5]=y-p,t[a+-7]=y+p;var x=a-8,S=t[x],B=t[x+-4],T=S-B,k=S+B,I=(S=t[x+-2])+(B=t[x+-6]),A=S-B;t[x]=k+I,t[x+-2]=k-I;var D=t[x+-3]-t[x+-7];t[x+-4]=T+D,t[x+-6]=T-D;var C=(S=t[x+-1])-(B=t[x+-5]),P=S+B,N=t[x+-3]+t[x+-7];t[x+-1]=P+N,t[x+-3]=P-N,t[x+-5]=C-A,t[x+-7]=C+A,a-=16}};var qt=function(e,t,i){this.seekFunc=t,this.inputLength=i,this.decoder=$t.start(e),this.decoder.setupSampleNumber(t,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(i["kha.audio2.ogg.vorbis.Reader"]=qt).__name__=!0,qt.openFromBytes=function(e){var t=new Ze(e),i=t;return new qt(t,function(e){qt.seekBytes(i,e)},e.length)},qt.seekBytes=function(e,t){e.set_position(t)},qt.readAll=function(e,t,i){null==i&&(i=!1);var n=new Ze(e),s=$t.start(n),r=n;s.setupSampleNumber(function(e){qt.seekBytes(r,e)},e.length);for(var a=s.header,o=new Ms(4096*a.channel);;){for(var l=s.read(o,4096,a.channel,a.sampleRate,i),_=0,h=l*a.channel;_<h;){var u=_++;t.writeFloat(o[u])}if(0==l)break;l}return s.header},qt.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var e=this.decoder.totalSample,t=this.get_header().sampleRate;return nt.toFloat(e)/nt.toFloat(t)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(e){return this.decoder.seek(this.seekFunc,this.inputLength,e),this.decoder.currentSample},get_currentMillisecond:function(){var e=this.get_currentSample(),t=this.get_header().sampleRate;return nt.toFloat(e)/nt.toFloat(t)*1e3},set_currentMillisecond:function(e){var t=e/1e3,i=this.get_header().sampleRate;return this.set_currentSample(Math.floor(nt.toFloat(i)*t)),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(e,t,i,n,s){return null==s&&(s=!1),this.decoder.ensurePosition(this.seekFunc),null==t&&(t=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==n&&(n=this.get_header().sampleRate),this.decoder.read(e,t,i,n,s)},clone:function(){var e=te.createEmptyInstance(qt);return e.seekFunc=this.seekFunc,e.inputLength=this.inputLength,e.decoder=this.decoder.clone(this.seekFunc),e.loopStart=this.loopStart,e.loopLength=this.loopLength,e},sampleToMillisecond:function(e){var t=this.get_header().sampleRate;return nt.toFloat(e)/nt.toFloat(t)*1e3},millisecondToSample:function(e){var t=e/1e3,i=this.get_header().sampleRate;return Math.floor(nt.toFloat(i)*t)},__class__:qt,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_totalMillisecond:"get_totalMillisecond",get_totalSample:"get_totalSample",get_header:"get_header"}};var Qt=function(e){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=e,this.inputPosition=0,this.page=new ui,Kt.init()};(i["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Qt).__name__=!0,Qt.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(e,t){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var n=new Array(i),s=0,r=i;s<r;){n[s++]=this.input.readByte()}if(this.segments=n,this.endSegWithKnownLoc=-2,-1!=e||-1!=t)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=e),--a;if(this.firstDecode){for(var o=0,l=new di,_=0,h=i;_<h;){var u=_++;o+=this.segments[u]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=e,this.pFirst=l}this.nextSeg=0},clone:function(e){var t=te.createEmptyInstance(Qt);return e(this.inputPosition),t.input=this.input,t.eof=this.eof,t.validBits=this.validBits,t.discardSamplesDeferred=this.discardSamplesDeferred,t.firstDecode=this.firstDecode,t.nextSeg=this.nextSeg,t.bytesInSeg=this.bytesInSeg,t.acc=t.acc,t.lastSeg=this.lastSeg,t.lastSegWhich=this.lastSegWhich,t.currentLoc=this.currentLoc,t.currentLocValid=this.currentLocValid,t.inputPosition=this.inputPosition,t.firstAudioPageOffset=this.firstAudioPageOffset,t.error=this.error,t.segments=this.segments,t.pFirst=this.pFirst,t.pLast=this.pLast,t.page=this.page.clone(),t},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(e){if(e instanceof dt&&(e=e.val),Ai.__instanceof(e,fi))return this.lastSeg=!0,this.error=e,0;throw e}if(0==(1&this.page.flag))throw new dt(new fi(gi.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var e=this.segments[this.nextSeg++];e<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1);this.bytesInSeg;return this.bytesInSeg=e},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new dt(new fi(gi.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var t,e,i,n,s=!1;try{this.inputPosition+=1,t=this.input.readByte()}catch(e){if(e instanceof dt&&(e=e.val),!Ai.__instanceof(e,Xe))throw e;s=!0,t=0}if(s)return!1;if(79==t?(this.inputPosition+=1,n=103!=this.input.readByte()):n=!0,n?i=!0:(this.inputPosition+=1,i=103!=this.input.readByte()),i?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new dt(new fi(gi.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(e){if(this.validBits<0)return 0;if(this.validBits<e){if(24<e)return this.readBits(24)+(this.readBits(e-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<e))break}if(this.validBits<0)return 0;var t=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,t}var i=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var e;return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,e=this.input.readByte()):e=-1,this.validBits=0,e},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){for(var e=new Fe(new Es(6)),t=0;t<6;){var i,n=t++;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,i=this.input.readByte()):i=-1,this.validBits=0,e.b[n]=255&i}if("vorbis"!=e.toString())throw new dt(new fi(gi.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new dt(new fi(gi.INVALID_FIRST_PAGE,"segmentCount",{fileName:"VorbisDecodeState.hx",lineNumber:307,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new dt(new fi(gi.INVALID_FIRST_PAGE,"decodeState head",{fileName:"VorbisDecodeState.hx",lineNumber:310,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){var e,t,i;if(this.inputPosition+=1,79==this.input.readByte()?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?t=!0:(this.inputPosition+=1,t=103!=this.input.readByte()),t?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new dt(new fi(gi.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(e){this.inputPosition+=e;for(var t=new Array(e),i=0,n=e;i<n;){t[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(e){this.validBits<10&&this.prepHuffman();var t,i=e.fastHuffman[1023&this.acc];if(0<=i){var n=e.codewordLengths[i];this.acc=this.acc>>>n,this.validBits-=n,this.validBits<0?(this.validBits=0,t=-1):t=i}else t=this.decodeScalarRaw(e);return e.sparse&&(t=e.sortedValues[t]),t},decodeRaw:function(e){this.validBits<10&&this.prepHuffman();var t=e.fastHuffman[1023&this.acc];if(0<=t){var i=e.codewordLengths[t];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):t}return this.decodeScalarRaw(e)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(e,t,i){var n=i.left.start,s=!1,r=t>>1;if(this.firstDecode)this.currentLoc=-r,this.discardSamplesDeferred=t-i.right.end,s=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,n=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(s&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(t-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:n,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(r-i.left.start),s=!0}return s&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:n,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(e){this.inputPosition+=e;for(var t=new Array(e),i=0,n=e;i<n;){t[i++]=this.input.readByte()}return t},readBytes:function(e){return this.inputPosition+=e,this.input.read(e)},readString:function(e){return this.inputPosition+=e,this.input.readString(e)},getSampleNumber:function(e,t){var i=this.inputPosition,n=nt.gte(t,65536)&&nt.gte(t-65536,this.firstAudioPageOffset)?t-65536:this.firstAudioPageOffset;e(this.inputPosition=n);var s=0,r=!1,a=this.findPage(e,t);switch(a[1]){case 0:var o=a[3];s=a[2],r=o;break;case 1:throw new dt(new fi(gi.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:518,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;try{for(;!r;){e(this.inputPosition=s);var _=this.findPage(e,t);switch(_[1]){case 0:var h=_[3];s=_[2],r=h;break;case 1:throw"__break__"}n=l+1,l=this.inputPosition}}catch(e){if("__break__"!=e)throw e}e(this.inputPosition=l),this.inputPosition+=6;for(var u=new Array(6),c=0;c<6;){u[c++]=this.input.readByte()}this.inputPosition+=4;var d=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==d&&-1==f||0<f)throw new dt(new fi(gi.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:552,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new di,this.pLast.pageStart=l,this.pLast.pageEnd=s,this.pLast.lastDecodedSample=d,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=n,e(this.inputPosition=i),d},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(e,t){e(this.inputPosition=t)},findPage:function(e,t){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i,n,s=this.inputPosition;if(t<s-25)return Jt.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,n=103!=this.input.readByte()):n=!0,n?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)continue;var r=new Array(27);r[0]=79,r[1]=103,r[2]=103,r[3]=83;for(var a=4;a<27;){var o=a++;this.inputPosition+=1,r[o]=this.input.readByte()}if(0!=r[4]){e(this.inputPosition=s);continue}for(var l=r[22]+(r[23]<<8)+(r[24]<<16)+(r[25]<<24),_=22;_<26;){r[_++]=0}for(var h=0,u=0;u<27;){var c=u++;h=h<<8^Kt.table[r[c]^h>>>24]}var d=0;try{for(var f=0,g=r[26];f<g;){f++;this.inputPosition+=1;var m=this.input.readByte();h=h<<8^Kt.table[m^h>>>24],d+=m}for(var p=0,v=d;p<v;){p++;this.inputPosition+=1;var y=this.input.readByte();h=h<<8^Kt.table[y^h>>>24]}}catch(e){if(e instanceof dt&&(e=e.val),Ai.__instanceof(e,Xe))return Jt.NotFound;throw e}if(h==l){var b=this.inputPosition;return e(this.inputPosition=s-1),Jt.Found(b,0!=(4&r[5]))}}}}catch(e){if(e instanceof dt&&(e=e.val),Ai.__instanceof(e,Xe))return Jt.NotFound;throw e}},analyzePage:function(e,t){var i=new di,n=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var s=new Array(27),r=0;r<27;){s[r++]=this.input.readByte()}var a=s,o=a[26];this.inputPosition+=o;for(var l=new Array(o),_=0,h=o;_<h;){l[_++]=this.input.readByte()}for(var u=l,c=0,d=0,f=a[26];d<f;){c+=u[d++]}if(i.pageEnd=i.pageStart+27+a[26]+c,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,e(this.inputPosition=i.pageStart),i;for(var g=0,m=0==(1&a[5]),p=t.modes.length,v=0,y=a[26];v<y;){var b=v++;if(m){if(0==u[b])return e(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var w=this.input.readByte();if(0!=(1&w))return e(this.inputPosition=i.pageStart),null;w>>=1;var x=p-1,S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(p<=(w&=(1<<(x<16384?x<16?S[x]:x<512?5+S[x>>5]:10+S[x>>10]:x<16777216?x<524288?15+S[x>>15]:20+S[x>>20]:x<536870912?25+S[x>>25]:x<-2147483648?30+S[x>>30]:0))-1))return e(this.inputPosition=i.pageStart),null;n[g++]=t.modes[w].blockflag;var B=u[b]-1;this.inputPosition+=B;for(var T=new Array(B),k=0,I=B;k<I;){T[k++]=this.input.readByte()}}else{var A=u[b];this.inputPosition+=A;for(var D=new Array(A),C=0,P=A;C<P;){D[C++]=this.input.readByte()}}m=u[b]<255}var N=0;1<g&&(N+=n[g-1]?t.blocksize1:t.blocksize0);for(var E=g-2;1<=E;)n[--E]?n[E+1]?N+=t.blocksize1>>1:N+=(t.blocksize1-t.blocksize0>>2)+(t.blocksize0>>1):N+=t.blocksize0>>1,--E;return i.firstDecodedSample=i.lastDecodedSample-N,e(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(e){this.prepHuffman();null!=e.sortedCodewords||e.codewords;var t=e.codewordLengths,i=e.codewords,n=e.sortedCodewords;if(8<e.entries?null!=n:null!=i){for(var s=this.acc,r=(s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8)>>>16|s<<16,a=0,o=e.sortedEntries;1<o;){var l=a+(o>>1);nt.gte(r,n[l])?(a=l,o-=o>>1):o>>=1}e.sparse||(a=e.sortedValues[a]);var _=t[a];return this.validBits>=_?(this.acc=this.acc>>>_,this.validBits-=_,a):(this.validBits=0,-1)}e.sparse;for(var h=0,u=e.entries;h<u;){var c=h++,d=t[c];if(255!=d&&i[c]==(this.acc&(1<<d)-1))return this.validBits>=d?(this.acc=this.acc>>>d,this.validBits-=d,c):(this.validBits=0,-1)}return this.error=new fi(gi.INVALID_STREAM,null,{fileName:"VorbisDecodeState.hx",lineNumber:846,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Qt};var Jt=i["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"]};Jt.Found=function(e,t){var i=["Found",0,e,t];return i.__enum__=Jt,i.toString=n,i},Jt.NotFound=["NotFound",1],Jt.NotFound.toString=n,Jt.NotFound.__enum__=Jt;var $t=function(e,t){this.header=e,this.decodeState=t,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=e.channel,n=new Array(i);this.channelBuffers=n;var s=e.channel,r=new Array(s);this.previousWindow=r;var a=e.channel,o=new Array(a);this.finalY=o;for(var l=0,_=e.channel;l<_;){var h=l++,u=this.channelBuffers,c=e.blocksize1,d=new Array(c);u[h]=d;var f=this.previousWindow,g=e.blocksize1/2|0,m=new Array(g);f[h]=m,this.finalY[h]=[]}var p=new Array(2);this.a=p;var v=new Array(2);this.b=v;var y=new Array(2);this.c=y;var b=new Array(2);this.window=b;var w=new Array(2);this.bitReverseData=w,this.initBlocksize(0,e.blocksize0),this.initBlocksize(1,e.blocksize1)};(i["kha.audio2.ogg.vorbis.VorbisDecoder"]=$t).__name__=!0,$t.start=function(e){var t=new Qt(e),i=ai.read(t),n=new $t(i,t);return t.startFirstDecode(),n.pumpFirstFrame(),n},$t.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(e,t,i,n,s){var r=this.header.sampleRate;if(0!=(nt.toFloat(n)%nt.toFloat(r)|0))throw new dt("Unsupported sampleRate : can't convert "+N.string(nt.toFloat(this.header.sampleRate))+" to "+n);if(i%this.header.channel!=0)throw new dt("Unsupported channels : can't convert "+this.header.channel+" to "+i);var a=this.header.sampleRate,o=nt.toFloat(n)/nt.toFloat(a)|0,l=i/this.header.channel|0,_=0,h=Math.floor(t/o);null!=this.totalSample&&h>this.totalSample-this.currentSample&&(h=this.totalSample-this.currentSample);for(var u=0;_<h;){var c=this.channelBufferEnd-this.channelBufferStart;h-_<=c&&(c=h-_);for(var d=this.channelBufferStart,f=this.channelBufferStart+c;d<f;)for(var g=d++,m=0,p=o;m<p;){m++;for(var v=0,y=this.header.channel;v<y;)for(var b=v++,w=0,x=l;w<x;){w++;var S=this.channelBuffers[b][g];1<S?S=1:S<-1&&(S=-1),s&&(e[u]=S,++u)}}if(_+=c,this.channelBufferStart+=c,_==h||0==this.getFrameFloat())break}for(var B=_,T=h;B<T;){B++;for(var k=0,I=o;k<I;){k++;for(var A=0,D=this.header.channel;A<D;){A++;for(var C=0,P=l;C<P;){C++;s&&(e[u]=0,++u)}}}}return this.currentSample+=h,h*o},skipSamples:function(e){var t=0;for(null!=this.totalSample&&e>this.totalSample-this.currentSample&&(e=this.totalSample-this.currentSample);t<e;){var i=this.channelBufferEnd-this.channelBufferStart;if(e-t<=i&&(i=e-t),t+=i,this.channelBufferStart+=i,t==e||0==this.getFrameFloat())break}return this.currentSample+=e,e},setupSampleNumber:function(e,t){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(e,t))},seek:function(e,t,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(e,t),0==this.totalSample))throw new dt(new fi(gi.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var n=this.decodeState.pFirst,s=this.decodeState.pLast;if(i>=s.lastDecodedSample&&(i=s.lastDecodedSample-1),i<n.lastDecodedSample)this.seekFrameFromPage(e,n.pageStart,0,i);else{for(var r=0;n.pageEnd<s.pageStart;){var a=n.pageEnd,o=s.afterPreviousPageStart,l=n.lastDecodedSample,_=s.lastDecodedSample;if(null==l||null==_)throw new dt(new fi(gi.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));nt.gt(o,a+4e3)&&(o-=4e3);var h=a+Math.floor(nt.toFloat(o-a)/nt.toFloat(_-l)*(i-l));if(4<=r){var u=a+(o-a>>>1);8<=r?h=u:nt.gt(u,h)?h+=u-h>>>1:h=u+(h-u>>>1)}switch(++r,e(this.decodeState.inputPosition=h),this.decodeState.findPage(e,t)[1]){case 0:break;case 1:throw new dt(new fi(gi.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var c=this.decodeState.analyzePage(e,this.header);if(null==c)throw new dt(new fi(gi.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));c.afterPreviousPageStart=h,c.pageStart!=s.pageStart?i<c.lastDecodedSample?s=c:n=c:s=c}if(!(n.lastDecodedSample<=i&&i<s.lastDecodedSample))throw new dt(new fi(gi.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(e,s.pageStart,n.lastDecodedSample,i)}}},seekFrameFromPage:function(e,t,i,n){var s=0,r=i;e(this.decodeState.inputPosition=t),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,_=null;;){l=_,_=this.decodeState.clone(e);var h=this.decodeInitial();if(null==h){_=l;break}o=h.left.start,a=h.left.end;var u=0==s?a:o;if(n<r+h.right.start-u)break;for(var c=this.decodeState;0!=c.bytesInSeg||!c.lastSeg&&0!=c.next();)c.bytesInSeg--,c.inputPosition+=1,c.input.readByte();r+=h.right.start-u,++s}this.decodeState=_,e(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=r,this.skipSamples(n-r)},clone:function(e){var t=te.createEmptyInstance($t);t.currentSample=this.currentSample,t.totalSample=this.totalSample,t.previousLength=this.previousLength,t.channelBufferStart=this.channelBufferStart,t.channelBufferEnd=this.channelBufferEnd,t.a=this.a,t.b=this.b,t.c=this.c,t.window=this.window,t.bitReverseData=this.bitReverseData,t.header=this.header,t.decodeState=this.decodeState.clone(e);var i=this.header.channel,n=new Array(i);t.channelBuffers=n;var s=this.header.channel,r=new Array(s);t.previousWindow=r;var a=this.header.channel,o=new Array(a);t.finalY=o;for(var l=0,_=this.header.channel;l<_;){var h=l++;t.channelBuffers[h]=ei.copyVector(this.channelBuffers[h]),t.previousWindow[h]=ei.copyVector(this.previousWindow[h]),t.finalY[h]=u.array(this.finalY[h])}return t},ensurePosition:function(e){e(this.decodeState.inputPosition)},getFrameFloat:function(){var e=this.decodePacket();if(null==e)return this.channelBufferStart=this.channelBufferEnd=0,0;var t=this.finishFrame(e);return this.channelBufferStart=e.left,this.channelBufferEnd=e.left+t,t},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(e){var t=e.len,i=e.right,n=e.left;if(0!=this.previousLength)for(var s=this.previousLength,r=this.getWindow(s),a=0,o=this.header.channel;a<o;)for(var l=a++,_=this.channelBuffers[l],h=this.previousWindow[l],u=0,c=s;u<c;){var d=u++;_[n+d]=_[n+d]*r[d]+h[d]*r[s-1-d]}var f=this.previousLength;this.previousLength=t-i;for(var g=0,m=this.header.channel;g<m;)for(var p=g++,v=this.previousWindow[p],y=this.channelBuffers[p],b=0,w=t-i;b<w;){var x=b++;v[x]=y[i+x]}return 0==f?0:(t<i&&(i=t),i-n)},getWindow:function(e){return(e<<=1)==this.header.blocksize0?this.window[0]:e==this.header.blocksize1?this.window[1]:null},initBlocksize:function(e,t){var i=t>>1,n=t>>2,s=t>>3,r=this.a,a=new Array(i);r[e]=a;var o=this.b,l=new Array(i);o[e]=l;var _=this.c,h=new Array(n);_[e]=h;var u=this.window,c=new Array(i);u[e]=c;var d=this.bitReverseData,f=new Array(s);d[e]=f,ei.computeTwiddleFactors(t,this.a[e],this.b[e],this.c[e]),ei.computeWindow(t,this.window[e]),ei.computeBitReverse(t,this.bitReverseData[e])},inverseMdct:function(e,t,i){for(var n=i?1:0,s=this.a[n],r=this.b[n],a=this.c[n],o=this.bitReverseData[n],l=t>>1,_=t>>2,h=t>>3,u=new Array(l),c=l-2,d=0,f=0,g=l;f!=g;)u[c+1]=e[f]*s[d]-e[f+2]*s[d+1],u[c]=e[f]*s[d+1]+e[f+2]*s[d],c-=2,d+=2,f+=4;for(f=l-3;0<=c;)u[c+1]=-e[f+2]*s[d]- -e[f]*s[d+1],u[c]=-e[f+2]*s[d+1]+-e[f]*s[d],c-=2,d+=2,f-=4;for(var m=e,p=u,v=l-8,y=_,b=0,w=_,x=0;0<=v;){var S=p[y+1]-p[b+1],B=p[y]-p[b];m[w+1]=p[y+1]+p[b+1],m[w]=p[y]+p[b],m[x+1]=S*s[v+4]-B*s[v+5],m[x]=B*s[v+4]+S*s[v+5],S=p[y+3]-p[b+3],B=p[y+2]-p[b+2],m[w+3]=p[y+3]+p[b+3],m[w+2]=p[y+2]+p[b+2],m[x+3]=S*s[v]-B*s[v+1],m[x+2]=B*s[v]+S*s[v+1],v-=8,w+=4,x+=4,y+=4,b+=4}for(var T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(t<16384?t<16?T[t]:t<512?5+T[t>>5]:10+T[t>>10]:t<16777216?t<524288?15+T[t>>15]:20+T[t>>20]:t<536870912?25+T[t>>25]:t<-2147483648?30+T[t>>30]:0)-1,I=l-1-0*_,A=I,D=I+-(t>>3),C=0,P=1+(t>>4>>2);0<--P;){var N=m[A]-m[D],E=m[A+-1]-m[D+-1],R=A,L=m;L[R]=L[R]+m[D];var M=A+-1,F=m;F[M]=F[M]+m[D+-1],m[D]=N*s[C]-E*s[C+1],m[D+-1]=E*s[C]+N*s[C+1],C+=8,N=m[A+-2]-m[D+-2],E=m[A+-3]-m[D+-3];var V=A+-2,O=m;O[V]=O[V]+m[D+-2];var G=A+-3,U=m;U[G]=U[G]+m[D+-3],m[D+-2]=N*s[C]-E*s[C+1],m[D+-3]=E*s[C]+N*s[C+1],C+=8,N=m[A+-4]-m[D+-4],E=m[A+-5]-m[D+-5];var W=A+-4,z=m;z[W]=z[W]+m[D+-4];var H=A+-5,Z=m;Z[H]=Z[H]+m[D+-5],m[D+-4]=N*s[C]-E*s[C+1],m[D+-5]=E*s[C]+N*s[C+1],C+=8,N=m[A+-6]-m[D+-6],E=m[A+-7]-m[D+-7];var j=A+-6,K=m;K[j]=K[j]+m[D+-6];var X=A+-7,Y=m;Y[X]=Y[X]+m[D+-7],m[D+-6]=N*s[C]-E*s[C+1],m[D+-7]=E*s[C]+N*s[C+1],C+=8,A-=8,D-=8}for(var q=l-1-_,Q=q,J=q+-(t>>3),$=0,ee=1+(t>>4>>2);0<--ee;){var te=m[Q]-m[J],ie=m[Q+-1]-m[J+-1],ne=Q,se=m;se[ne]=se[ne]+m[J];var re=Q+-1,ae=m;ae[re]=ae[re]+m[J+-1],m[J]=te*s[$]-ie*s[$+1],m[J+-1]=ie*s[$]+te*s[$+1],$+=8,te=m[Q+-2]-m[J+-2],ie=m[Q+-3]-m[J+-3];var oe=Q+-2,le=m;le[oe]=le[oe]+m[J+-2];var _e=Q+-3,he=m;he[_e]=he[_e]+m[J+-3],m[J+-2]=te*s[$]-ie*s[$+1],m[J+-3]=ie*s[$]+te*s[$+1],$+=8,te=m[Q+-4]-m[J+-4],ie=m[Q+-5]-m[J+-5];var ue=Q+-4,ce=m;ce[ue]=ce[ue]+m[J+-4];var de=Q+-5,fe=m;fe[de]=fe[de]+m[J+-5],m[J+-4]=te*s[$]-ie*s[$+1],m[J+-5]=ie*s[$]+te*s[$+1],$+=8,te=m[Q+-6]-m[J+-6],ie=m[Q+-7]-m[J+-7];var ge=Q+-6,me=m;me[ge]=me[ge]+m[J+-6];var pe=Q+-7,ve=m;ve[pe]=ve[pe]+m[J+-7],m[J+-6]=te*s[$]-ie*s[$+1],m[J+-7]=ie*s[$]+te*s[$+1],$+=8,Q-=8,J-=8}for(var ye=l-1-0*h,be=0,we=ye,xe=ye+-(t>>4),Se=1+(t>>5>>2);0<--Se;){var Be=m[we]-m[xe],Te=m[we+-1]-m[xe+-1],ke=we,Ie=m;Ie[ke]=Ie[ke]+m[xe];var Ae=we+-1,De=m;De[Ae]=De[Ae]+m[xe+-1],m[xe]=Be*s[be]-Te*s[be+1],m[xe+-1]=Te*s[be]+Be*s[be+1],be+=16,Be=m[we+-2]-m[xe+-2],Te=m[we+-3]-m[xe+-3];var Ce=we+-2,Pe=m;Pe[Ce]=Pe[Ce]+m[xe+-2];var Ne=we+-3,Ee=m;Ee[Ne]=Ee[Ne]+m[xe+-3],m[xe+-2]=Be*s[be]-Te*s[be+1],m[xe+-3]=Te*s[be]+Be*s[be+1],be+=16,Be=m[we+-4]-m[xe+-4],Te=m[we+-5]-m[xe+-5];var Re=we+-4,Le=m;Le[Re]=Le[Re]+m[xe+-4];var Me=we+-5,Fe=m;Fe[Me]=Fe[Me]+m[xe+-5],m[xe+-4]=Be*s[be]-Te*s[be+1],m[xe+-5]=Te*s[be]+Be*s[be+1],be+=16,Be=m[we+-6]-m[xe+-6],Te=m[we+-7]-m[xe+-7];var Ve=we+-6,Oe=m;Oe[Ve]=Oe[Ve]+m[xe+-6];var Ge=we+-7,Ue=m;Ue[Ge]=Ue[Ge]+m[xe+-7],m[xe+-6]=Be*s[be]-Te*s[be+1],m[xe+-7]=Te*s[be]+Be*s[be+1],we-=8,xe-=8,be+=16}for(var We=l-1-h,ze=0,He=We,Ze=We+-(t>>4),je=1+(t>>5>>2);0<--je;){var Ke=m[He]-m[Ze],Xe=m[He+-1]-m[Ze+-1],Ye=He,qe=m;qe[Ye]=qe[Ye]+m[Ze];var Qe=He+-1,Je=m;Je[Qe]=Je[Qe]+m[Ze+-1],m[Ze]=Ke*s[ze]-Xe*s[ze+1],m[Ze+-1]=Xe*s[ze]+Ke*s[ze+1],ze+=16,Ke=m[He+-2]-m[Ze+-2],Xe=m[He+-3]-m[Ze+-3];var $e=He+-2,et=m;et[$e]=et[$e]+m[Ze+-2];var tt=He+-3,it=m;it[tt]=it[tt]+m[Ze+-3],m[Ze+-2]=Ke*s[ze]-Xe*s[ze+1],m[Ze+-3]=Xe*s[ze]+Ke*s[ze+1],ze+=16,Ke=m[He+-4]-m[Ze+-4],Xe=m[He+-5]-m[Ze+-5];var nt=He+-4,st=m;st[nt]=st[nt]+m[Ze+-4];var rt=He+-5,at=m;at[rt]=at[rt]+m[Ze+-5],m[Ze+-4]=Ke*s[ze]-Xe*s[ze+1],m[Ze+-5]=Xe*s[ze]+Ke*s[ze+1],ze+=16,Ke=m[He+-6]-m[Ze+-6],Xe=m[He+-7]-m[Ze+-7];var ot=He+-6,lt=m;lt[ot]=lt[ot]+m[Ze+-6];var _t=He+-7,ht=m;ht[_t]=ht[_t]+m[Ze+-7],m[Ze+-6]=Ke*s[ze]-Xe*s[ze+1],m[Ze+-7]=Xe*s[ze]+Ke*s[ze+1],He-=8,Ze-=8,ze+=16}for(var ut=l-1-2*h,ct=0,dt=ut,ft=ut+-(t>>4),gt=1+(t>>5>>2);0<--gt;){var mt=m[dt]-m[ft],pt=m[dt+-1]-m[ft+-1],vt=dt,yt=m;yt[vt]=yt[vt]+m[ft];var bt=dt+-1,wt=m;wt[bt]=wt[bt]+m[ft+-1],m[ft]=mt*s[ct]-pt*s[ct+1],m[ft+-1]=pt*s[ct]+mt*s[ct+1],ct+=16,mt=m[dt+-2]-m[ft+-2],pt=m[dt+-3]-m[ft+-3];var xt=dt+-2,St=m;St[xt]=St[xt]+m[ft+-2];var Bt=dt+-3,Tt=m;Tt[Bt]=Tt[Bt]+m[ft+-3],m[ft+-2]=mt*s[ct]-pt*s[ct+1],m[ft+-3]=pt*s[ct]+mt*s[ct+1],ct+=16,mt=m[dt+-4]-m[ft+-4],pt=m[dt+-5]-m[ft+-5];var kt=dt+-4,It=m;It[kt]=It[kt]+m[ft+-4];var At=dt+-5,Dt=m;Dt[At]=Dt[At]+m[ft+-5],m[ft+-4]=mt*s[ct]-pt*s[ct+1],m[ft+-5]=pt*s[ct]+mt*s[ct+1],ct+=16,mt=m[dt+-6]-m[ft+-6],pt=m[dt+-7]-m[ft+-7];var Ct=dt+-6,Pt=m;Pt[Ct]=Pt[Ct]+m[ft+-6];var Nt=dt+-7,Et=m;Et[Nt]=Et[Nt]+m[ft+-7],m[ft+-6]=mt*s[ct]-pt*s[ct+1],m[ft+-7]=pt*s[ct]+mt*s[ct+1],dt-=8,ft-=8,ct+=16}for(var Rt=l-1-3*h,Lt=0,Mt=Rt,Ft=Rt+-(t>>4),Vt=1+(t>>5>>2);0<--Vt;){var Ot=m[Mt]-m[Ft],Gt=m[Mt+-1]-m[Ft+-1],Ut=Mt,Wt=m;Wt[Ut]=Wt[Ut]+m[Ft];var zt=Mt+-1,Ht=m;Ht[zt]=Ht[zt]+m[Ft+-1],m[Ft]=Ot*s[Lt]-Gt*s[Lt+1],m[Ft+-1]=Gt*s[Lt]+Ot*s[Lt+1],Lt+=16,Ot=m[Mt+-2]-m[Ft+-2],Gt=m[Mt+-3]-m[Ft+-3];var Zt=Mt+-2,jt=m;jt[Zt]=jt[Zt]+m[Ft+-2];var Kt=Mt+-3,Xt=m;Xt[Kt]=Xt[Kt]+m[Ft+-3],m[Ft+-2]=Ot*s[Lt]-Gt*s[Lt+1],m[Ft+-3]=Gt*s[Lt]+Ot*s[Lt+1],Lt+=16,Ot=m[Mt+-4]-m[Ft+-4],Gt=m[Mt+-5]-m[Ft+-5];var Yt=Mt+-4,qt=m;qt[Yt]=qt[Yt]+m[Ft+-4];var Qt=Mt+-5,Jt=m;Jt[Qt]=Jt[Qt]+m[Ft+-5],m[Ft+-4]=Ot*s[Lt]-Gt*s[Lt+1],m[Ft+-5]=Gt*s[Lt]+Ot*s[Lt+1],Lt+=16,Ot=m[Mt+-6]-m[Ft+-6],Gt=m[Mt+-7]-m[Ft+-7];var $t=Mt+-6,ei=m;ei[$t]=ei[$t]+m[Ft+-6];var ti=Mt+-7,ii=m;ii[ti]=ii[ti]+m[Ft+-7],m[Ft+-6]=Ot*s[Lt]-Gt*s[Lt+1],m[Ft+-7]=Gt*s[Lt]+Ot*s[Lt+1],Mt-=8,Ft-=8,Lt+=16}for(var ni=2,si=k-3>>1;ni<si;)for(var ri=ni++,ai=t>>ri+2,oi=ai>>1,li=0,_i=1<<ri+1;li<_i;)for(var hi=l-1-ai*li++,ui=1<<ri+3,ci=0,di=hi,fi=hi+-oi,gi=1+(t>>ri+4>>2);0<--gi;){var mi=m[di]-m[fi],pi=m[di+-1]-m[fi+-1],vi=di,yi=m;yi[vi]=yi[vi]+m[fi];var bi=di+-1,wi=m;wi[bi]=wi[bi]+m[fi+-1],m[fi]=mi*s[ci]-pi*s[ci+1],m[fi+-1]=pi*s[ci]+mi*s[ci+1],ci+=ui,mi=m[di+-2]-m[fi+-2],pi=m[di+-3]-m[fi+-3];var xi=di+-2,Si=m;Si[xi]=Si[xi]+m[fi+-2];var Bi=di+-3,Ti=m;Ti[Bi]=Ti[Bi]+m[fi+-3],m[fi+-2]=mi*s[ci]-pi*s[ci+1],m[fi+-3]=pi*s[ci]+mi*s[ci+1],ci+=ui,mi=m[di+-4]-m[fi+-4],pi=m[di+-5]-m[fi+-5];var ki=di+-4,Ii=m;Ii[ki]=Ii[ki]+m[fi+-4];var Ai=di+-5,Di=m;Di[Ai]=Di[Ai]+m[fi+-5],m[fi+-4]=mi*s[ci]-pi*s[ci+1],m[fi+-5]=pi*s[ci]+mi*s[ci+1],ci+=ui,mi=m[di+-6]-m[fi+-6],pi=m[di+-7]-m[fi+-7];var Ci=di+-6,Pi=m;Pi[Ci]=Pi[Ci]+m[fi+-6];var Ni=di+-7,Ei=m;Ei[Ni]=Ei[Ni]+m[fi+-7],m[fi+-6]=mi*s[ci]-pi*s[ci+1],m[fi+-7]=pi*s[ci]+mi*s[ci+1],di-=8,fi-=8,ci+=ui}for(var Ri=k-3>>1,Li=k-6;Ri<Li;)for(var Mi=Ri++,Fi=t>>Mi+2,Vi=1<<Mi+3,Oi=Fi>>1,Gi=1<<Mi+1,Ui=0,Wi=l-1,zi=(t>>Mi+6)+1;0<--zi;){for(var Hi=s[Ui],Zi=s[Ui+1],ji=s[Ui+Vi],Ki=s[Ui+Vi+1],Xi=s[Ui+2*Vi],Yi=s[Ui+2*Vi+1],qi=s[Ui+3*Vi],Qi=s[Ui+3*Vi+1],Ji=Wi,$i=Wi+-Oi,en=Gi+1;0<--en;){var tn=m[Ji]-m[$i],nn=m[Ji+-1]-m[$i+-1];m[Ji]=m[Ji]+m[$i],m[Ji+-1]=m[Ji+-1]+m[$i+-1],m[$i]=tn*Hi-nn*Zi,m[$i+-1]=nn*Hi+tn*Zi,tn=m[Ji+-2]-m[$i+-2],nn=m[Ji+-3]-m[$i+-3],m[Ji+-2]=m[Ji+-2]+m[$i+-2],m[Ji+-3]=m[Ji+-3]+m[$i+-3],m[$i+-2]=tn*ji-nn*Ki,m[$i+-3]=nn*ji+tn*Ki,tn=m[Ji+-4]-m[$i+-4],nn=m[Ji+-5]-m[$i+-5],m[Ji+-4]=m[Ji+-4]+m[$i+-4],m[Ji+-5]=m[Ji+-5]+m[$i+-5],m[$i+-4]=tn*Xi-nn*Yi,m[$i+-5]=nn*Xi+tn*Yi,tn=m[Ji+-6]-m[$i+-6],nn=m[Ji+-7]-m[$i+-7],m[Ji+-6]=m[Ji+-6]+m[$i+-6],m[Ji+-7]=m[Ji+-7]+m[$i+-7],m[$i+-6]=tn*qi-nn*Qi,m[$i+-7]=nn*qi+tn*Qi,Ji-=Fi,$i-=Fi}Ui+=4*Vi,Wi-=8}for(var sn=l-1,rn=s[t>>3],an=sn,on=sn-16*(t>>5);on<an;){var ln=m[an],_n=m[an+-8];m[an+-8]=ln-_n,m[an]=ln+_n,ln=m[an+-1],_n=m[an+-9],m[an+-9]=ln-_n,m[an+-1]=ln+_n;var hn=(ln=m[an+-2])-(_n=m[an+-10]);m[an+-2]=ln+_n;var un=(ln=m[an+-3])-(_n=m[an+-11]);m[an+-3]=ln+_n,m[an+-10]=(hn+un)*rn,m[an+-11]=(un-hn)*rn,ln=m[an+-4],hn=(_n=m[an+-12])-ln,m[an+-4]=ln+_n,un=(ln=m[an+-5])-(_n=m[an+-13]),m[an+-5]=ln+_n,m[an+-12]=un,m[an+-13]=hn,ln=m[an+-6],hn=(_n=m[an+-14])-ln,m[an+-6]=ln+_n,un=(ln=m[an+-7])-(_n=m[an+-15]),m[an+-7]=ln+_n,m[an+-14]=(hn+un)*rn,m[an+-15]=(hn-un)*rn;var cn=m[an],dn=m[an+-4],fn=cn-dn,gn=cn+dn,mn=(cn=m[an+-2])+(dn=m[an+-6]),pn=cn-dn;m[an]=gn+mn,m[an+-2]=gn-mn;var vn=m[an+-3]-m[an+-7];m[an+-4]=fn+vn,m[an+-6]=fn-vn;var yn=(cn=m[an+-1])-(dn=m[an+-5]),bn=cn+dn,wn=m[an+-3]+m[an+-7];m[an+-1]=bn+wn,m[an+-3]=bn-wn,m[an+-5]=yn-pn,m[an+-7]=yn+pn;var xn=an-8,Sn=m[xn],Bn=m[xn+-4],Tn=Sn-Bn,kn=Sn+Bn,In=(Sn=m[xn+-2])+(Bn=m[xn+-6]),An=Sn-Bn;m[xn]=kn+In,m[xn+-2]=kn-In;var Dn=m[xn+-3]-m[xn+-7];m[xn+-4]=Tn+Dn,m[xn+-6]=Tn-Dn;var Cn=(Sn=m[xn+-1])-(Bn=m[xn+-5]),Pn=Sn+Bn,Nn=m[xn+-3]+m[xn+-7];m[xn+-1]=Pn+Nn,m[xn+-3]=Pn-Nn,m[xn+-5]=Cn-An,m[xn+-7]=Cn+An,an-=16}for(var En=0,Rn=_-4,Ln=l-4;0<=Rn;){var Mn=o[En];p[Ln+3]=m[Mn],p[Ln+2]=m[Mn+1],p[Rn+3]=m[Mn+2],p[Rn+2]=m[Mn+3],Mn=o[En+1],p[Ln+1]=m[Mn],p[Ln]=m[Mn+1],p[Rn+1]=m[Mn+2],p[Rn]=m[Mn+3],Rn-=4,Ln-=4,En+=2}for(var Fn=0,Vn=0,On=l-4;Vn<On;){var Gn=p[Vn]-p[On+2],Un=p[Vn+1]+p[On+3],Wn=a[Fn+1]*Gn+a[Fn]*Un,zn=a[Fn+1]*Un-a[Fn]*Gn,Hn=p[Vn]+p[On+2],Zn=p[Vn+1]-p[On+3];p[Vn]=Hn+Wn,p[Vn+1]=Zn+zn,p[On+2]=Hn-Wn,p[On+3]=zn-Zn,Gn=p[Vn+2]-p[On],Un=p[Vn+3]+p[On+1],Wn=a[Fn+3]*Gn+a[Fn+2]*Un,zn=a[Fn+3]*Un-a[Fn+2]*Gn,Hn=p[Vn+2]+p[On],Zn=p[Vn+3]-p[On+1],p[Vn+2]=Hn+Wn,p[Vn+3]=Zn+zn,p[On]=Hn-Wn,p[On+1]=zn-Zn,Fn+=4,Vn+=4,On-=4}for(var jn=l-8,Kn=l-8,Xn=0,Yn=l-4,qn=l,Qn=t-4;0<=Kn;){var Jn=u[Kn+6]*r[jn+7]-u[Kn+7]*r[jn+6],$n=-u[Kn+6]*r[jn+6]-u[Kn+7]*r[jn+7];e[Xn]=Jn,e[Yn+3]=-Jn,e[qn]=$n,e[Qn+3]=$n;var es=u[Kn+4]*r[jn+5]-u[Kn+5]*r[jn+4],ts=-u[Kn+4]*r[jn+4]-u[Kn+5]*r[jn+5];e[Xn+1]=es,e[Yn+2]=-es,e[qn+1]=ts,e[Qn+2]=ts,Jn=u[Kn+2]*r[jn+3]-u[Kn+3]*r[jn+2],$n=-u[Kn+2]*r[jn+2]-u[Kn+3]*r[jn+3],e[Xn+2]=Jn,e[Yn+1]=-Jn,e[qn+2]=$n,e[Qn+1]=$n,es=u[Kn]*r[jn+1]-u[Kn+1]*r[jn],ts=-u[Kn]*r[jn]-u[Kn+1]*r[jn+1],e[Xn+3]=es,e[Yn]=-es,e[qn+3]=ts,e[Qn]=ts,jn-=8,Kn-=8,Xn+=4,qn+=4,Yn-=4,Qn-=4}},decodePacket:function(){var e=this.decodeInitial();return null==e?null:this.decodePacketRest(e)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;var e,t=this.decodeState;if(t.validBits<0)e=0;else if(t.validBits<1){for(0==t.validBits&&(t.acc=0);;){if(0==t.bytesInSeg&&(t.lastSeg||0==t.next())){t.validBits=-1;break}if(t.bytesInSeg--,t.inputPosition+=1,t.acc=t.acc+(t.input.readByte()<<t.validBits),t.validBits+=8,!(t.validBits<1))break}if(t.validBits<0)e=0;else{var i=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=i}}else{var n=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=n}if(0==e)break;for(;;){var s,r=this.decodeState;if(0!=r.bytesInSeg||!r.lastSeg&&0!=r.next()?(r.bytesInSeg--,r.inputPosition+=1,s=r.input.readByte()):s=-1,r.validBits=0,-1==s)break}}var a,o=this.decodeState,l=this.header.modes.length-1,_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],h=l<16384?l<16?_[l]:l<512?5+_[l>>5]:10+_[l>>10]:l<16777216?l<524288?15+_[l>>15]:20+_[l>>20]:l<536870912?25+_[l>>25]:l<-2147483648?30+_[l>>30]:0;if(o.validBits<0)a=0;else if(o.validBits<h)if(24<h)a=o.readBits(24)+(o.readBits(h-24)<<24);else{for(0==o.validBits&&(o.acc=0);;){if(0==o.bytesInSeg&&(o.lastSeg||0==o.next())){o.validBits=-1;break}if(o.bytesInSeg--,o.inputPosition+=1,o.acc=o.acc+(o.input.readByte()<<o.validBits),o.validBits+=8,!(o.validBits<h))break}if(o.validBits<0)a=0;else{var u=o.acc&(1<<h)-1;o.acc=o.acc>>>h,o.validBits-=h,a=u}}else{var c=o.acc&(1<<h)-1;o.acc=o.acc>>>h,o.validBits-=h,a=c}if(-1==a||a>=this.header.modes.length)throw new dt(new fi(gi.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var d,f,g,m=this.header.modes[a];if(m.blockflag){d=this.header.blocksize1;var p=this.decodeState;if(p.validBits<0)f=0;else if(p.validBits<1){for(0==p.validBits&&(p.acc=0);;){if(0==p.bytesInSeg&&(p.lastSeg||0==p.next())){p.validBits=-1;break}if(p.bytesInSeg--,p.inputPosition+=1,p.acc=p.acc+(p.input.readByte()<<p.validBits),p.validBits+=8,!(p.validBits<1))break}if(p.validBits<0)f=0;else{var v=1&p.acc;p.acc=p.acc>>>1,p.validBits-=1,f=v}}else{var y=1&p.acc;p.acc=p.acc>>>1,p.validBits-=1,f=y}var b=this.decodeState;if(b.validBits<0)g=0;else if(b.validBits<1){for(0==b.validBits&&(b.acc=0);;){if(0==b.bytesInSeg&&(b.lastSeg||0==b.next())){b.validBits=-1;break}if(b.bytesInSeg--,b.inputPosition+=1,b.acc=b.acc+(b.input.readByte()<<b.validBits),b.validBits+=8,!(b.validBits<1))break}if(b.validBits<0)g=0;else{var w=1&b.acc;b.acc=b.acc>>>1,b.validBits-=1,g=w}}else{var x=1&b.acc;b.acc=b.acc>>>1,b.validBits-=1,g=x}}else f=g=0,d=this.header.blocksize0;var S=d>>1;return{mode:a,left:m.blockflag&&0==f?{start:d-this.header.blocksize0>>2,end:d+this.header.blocksize0>>2}:{start:0,end:S},right:m.blockflag&&0==g?{start:3*d-this.header.blocksize0>>2,end:3*d+this.header.blocksize0>>2}:{start:S,end:d}}},decodePacketRest:function(e){for(var t=this.header.modes[e.mode],i=new Array(256),n=new Array(256),s=t.blockflag?this.header.blocksize1:this.header.blocksize0,r=this.header.mapping[t.mapping],a=s>>1,o=[256,128,86,64],l=this.header.codebooks,_=0,h=this.header.channel;_<h;){var u=_++,c=r.chan[u].mux;i[u]=!1;var d=this.header.floorConfig[r.submapFloor[c]];if(0==d.type)throw new dt(new fi(gi.INVALID_STREAM,null,{fileName:"VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f,g=d.floor1,m=this.decodeState;if(m.validBits<0)f=0;else if(m.validBits<1){for(0==m.validBits&&(m.acc=0);;){if(0==m.bytesInSeg&&(m.lastSeg||0==m.next())){m.validBits=-1;break}if(m.bytesInSeg--,m.inputPosition+=1,m.acc=m.acc+(m.input.readByte()<<m.validBits),m.validBits+=8,!(m.validBits<1))break}if(m.validBits<0)f=0;else{var p=1&m.acc;m.acc=m.acc>>>1,m.validBits-=1,f=p}}else{var v=1&m.acc;m.acc=m.acc>>>1,m.validBits-=1,f=v}if(0!=f){var y=[],b=new Array(256),w=o[g.floor1Multiplier-1],x=2;y=this.finalY[u];var S,B=this.decodeState,T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(w<16384?w<16?T[w]:w<512?5+T[w>>5]:10+T[w>>10]:w<16777216?w<524288?15+T[w>>15]:20+T[w>>20]:w<536870912?25+T[w>>25]:w<-2147483648?30+T[w>>30]:0)-1;if(B.validBits<0)S=0;else if(B.validBits<k)if(24<k)S=B.readBits(24)+(B.readBits(k-24)<<24);else{for(0==B.validBits&&(B.acc=0);;){if(0==B.bytesInSeg&&(B.lastSeg||0==B.next())){B.validBits=-1;break}if(B.bytesInSeg--,B.inputPosition+=1,B.acc=B.acc+(B.input.readByte()<<B.validBits),B.validBits+=8,!(B.validBits<k))break}if(B.validBits<0)S=0;else{var I=B.acc&(1<<k)-1;B.acc=B.acc>>>k,B.validBits-=k,S=I}}else{var A=B.acc&(1<<k)-1;B.acc=B.acc>>>k,B.validBits-=k,S=A}y[0]=S;var D,C=this.decodeState,P=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],N=(w<16384?w<16?P[w]:w<512?5+P[w>>5]:10+P[w>>10]:w<16777216?w<524288?15+P[w>>15]:20+P[w>>20]:w<536870912?25+P[w>>25]:w<-2147483648?30+P[w>>30]:0)-1;if(C.validBits<0)D=0;else if(C.validBits<N)if(24<N)D=C.readBits(24)+(C.readBits(N-24)<<24);else{for(0==C.validBits&&(C.acc=0);;){if(0==C.bytesInSeg&&(C.lastSeg||0==C.next())){C.validBits=-1;break}if(C.bytesInSeg--,C.inputPosition+=1,C.acc=C.acc+(C.input.readByte()<<C.validBits),C.validBits+=8,!(C.validBits<N))break}if(C.validBits<0)D=0;else{var E=C.acc&(1<<N)-1;C.acc=C.acc>>>N,C.validBits-=N,D=E}}else{var R=C.acc&(1<<N)-1;C.acc=C.acc>>>N,C.validBits-=N,D=R}y[1]=D;for(var L=0,M=g.partitions;L<M;){var F=L++,V=g.partitionClassList[F],O=g.classDimensions[V],G=g.classSubclasses[V],U=(1<<G)-1,W=0;if(0!=G){var z=l[g.classMasterbooks[V]],H=this.decodeState;H.validBits<10&&H.prepHuffman();var Z,j=z.fastHuffman[1023&H.acc];if(0<=j){var K=z.codewordLengths[j];H.acc=H.acc>>>K,H.validBits-=K,H.validBits<0?(H.validBits=0,Z=-1):Z=j}else Z=H.decodeScalarRaw(z);z.sparse&&(Z=z.sortedValues[Z]),W=Z}for(var X=g.subclassBooks[V],Y=0,q=O;Y<q;){Y++;var Q=X[W&U];W>>=G;var J,$=x++;if(0<=Q){var ee=this.decodeState,te=l[Q];ee.validBits<10&&ee.prepHuffman();var ie,ne=te.fastHuffman[1023&ee.acc];if(0<=ne){var se=te.codewordLengths[ne];ee.acc=ee.acc>>>se,ee.validBits-=se,ee.validBits<0?(ee.validBits=0,ie=-1):ie=ne}else ie=ee.decodeScalarRaw(te);te.sparse&&(ie=te.sortedValues[ie]),J=ie}else J=0;y[$]=J}}if(-1==this.decodeState.validBits){i[u]=!0;continue}b[0]=b[1]=!0;for(var re=g.neighbors,ae=g.xlist,oe=2,le=g.values;oe<le;){var _e=oe++,he=re[_e][0],ue=re[_e][1],ce=ae[he],de=y[he],fe=y[ue]-de,ge=ae[ue]-ce,me=Math.abs(fe)*(ae[_e]-ce)/ge|0,pe=fe<0?de-me:de+me,ve=y[_e],ye=w-pe,be=ye<pe?2*ye:2*pe;0!=ve?(b[he]=b[ue]=!0,b[_e]=!0,y[_e]=be<=ve?pe<ye?ve-pe+pe:pe-ve+ye-1:0!=(1&ve)?pe-(ve+1>>1):pe+(ve>>1)):(b[_e]=!1,y[_e]=pe)}for(var we=0,xe=g.values;we<xe;){var Se=we++;b[Se]||(y[Se]=-1)}}else i[u]=!0}for(var Be=0,Te=this.header.channel;Be<Te;){var ke=Be++;n[ke]=i[ke]}for(var Ie=0,Ae=r.couplingSteps;Ie<Ae;){var De=Ie++;i[r.chan[De].magnitude]&&i[r.chan[De].angle]||(i[r.chan[De].magnitude]=i[r.chan[De].angle]=!1)}for(var Ce=0,Pe=r.submaps;Ce<Pe;){for(var Ne=Ce++,Ee=this.header.channel,Re=new Array(Ee),Le=new Array(256),Me=0,Fe=0,Ve=this.header.channel;Fe<Ve;){var Oe=Fe++;r.chan[Oe].mux==Ne&&(i[Oe]?(Le[Me]=!0,Re[Me]=null):(Le[Me]=!1,Re[Me]=this.channelBuffers[Oe]),++Me)}var Ge=r.submapResidue[Ne];this.header.residueConfig[Ge].decode(this.decodeState,this.header,Re,Me,a,Le,this.channelBuffers)}for(var Ue=r.couplingSteps,We=s>>1;0<=--Ue;)for(var ze=this.channelBuffers[r.chan[Ue].magnitude],He=this.channelBuffers[r.chan[Ue].angle],Ze=0,je=We;Ze<je;){var Ke,Xe,Ye=Ze++;0<ze[Ye]?0<He[Ye]?(Xe=ze[Ye],Ke=ze[Ye]-He[Ye]):(Ke=ze[Ye],Xe=ze[Ye]+He[Ye]):0<He[Ye]?(Xe=ze[Ye],Ke=ze[Ye]+He[Ye]):(Ke=ze[Ye],Xe=ze[Ye]-He[Ye]),ze[Ye]=Xe,He[Ye]=Ke}for(var qe=0,Qe=this.header.channel;qe<Qe;){var Je=qe++;if(n[Je])for(var $e=0,et=We;$e<et;){var tt=$e++;this.channelBuffers[Je][tt]=0}else r.doFloor(this.header.floorConfig,Je,s,this.channelBuffers[Je],this.finalY[Je],null)}for(var it=0,nt=this.header.channel;it<nt;){var st=it++;this.inverseMdct(this.channelBuffers[st],s,t.blockflag)}for(var rt=this.decodeState;0!=rt.bytesInSeg||!rt.lastSeg&&0!=rt.next();)rt.bytesInSeg--,rt.inputPosition+=1,rt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,s,e)},__class__:$t};var ei=function(){};(i["kha.audio2.ogg.vorbis.VorbisTools"]=ei).__name__=!0,ei.assert=function(e,t){},ei.neighbors=function(e,t){for(var i=-1,n=65536,s=0,r=0,a=0,o=t;a<o;){var l=a++;e[l]>i&&e[l]<e[t]&&(i=e[s=l]),e[l]<n&&e[l]>e[t]&&(n=e[r=l])}return{low:s,high:r}},ei.floatUnpack=function(e){var t=nt.toFloat(2097151&e),i=(2145386496&e)>>>21;return(0!=(-2147483648&e)?-t:t)*Math.pow(2,i-788)},ei.bitReverse=function(e){return(e=(-16711936&(e=(-252645136&(e=(-858993460&(e=(-1431655766&e)>>>1|(1431655765&e)<<1))>>>2|(858993459&e)<<2))>>>4|(252645135&e)<<4))>>>8|(16711935&e)<<8)>>>16|e<<16},ei.pointCompare=function(e,t){return e.x<t.x?-1:e.x>t.x?1:0},ei.uintAsc=function(e,t){return nt.gt(t,e)?-1:e==t?0:1},ei.lookup1Values=function(e,t){var i=0|Math.exp(Math.log(e)/t);(0|Math.pow(i+1,t))<=e&&++i;Math.pow(i+1,t),Math.pow(i,t);return i},ei.computeWindow=function(e,t){for(var i=e>>1,n=0,s=i;n<s;){var r=n++;t[r]=Math.sin(1.5707963267948966*ei.square(Math.sin((r+.5)/i*.5*3.141592653589793)))}},ei.square=function(e){return e*e},ei.computeBitReverse=function(e,t){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=(e<16384?e<16?i[e]:e<512?5+i[e>>5]:10+i[e>>10]:e<16777216?e<524288?15+i[e>>15]:20+i[e>>20]:e<536870912?25+i[e>>25]:e<-2147483648?30+i[e>>30]:0)-1,s=0,r=e>>3;s<r;){var a=s++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,t[a]=(o>>>16|o<<16)>>>32-n+3<<2}},ei.computeTwiddleFactors=function(e,t,i,n){for(var s=e>>3,r=0,a=0,o=e>>2;a<o;){var l=a++;t[r]=Math.cos(4*l*3.141592653589793/e),t[r+1]=-Math.sin(4*l*3.141592653589793/e),i[r]=.5*Math.cos(3.141592653589793*(r+1)/e/2),i[r+1]=.5*Math.sin(3.141592653589793*(r+1)/e/2),r+=2}for(var _=0,h=0,u=s;h<u;){h++;n[_]=Math.cos(2*(_+1)*3.141592653589793/e),n[_+1]=-Math.sin(2*(_+1)*3.141592653589793/e),_+=2}},ei.drawLine=function(e,t,i,n,s,r){if(null==ei.integerDivideTable){var a=new Array(32);ei.integerDivideTable=a;for(var o=0;o<32;){var l=o++,_=ei.integerDivideTable,h=new Array(64);_[l]=h;for(var u=1;u<64;){var c=u++;ei.integerDivideTable[l][c]=l/c|0}}}var d,f,g=s-i,m=n-t,p=g<0?-g:g,v=t,y=i,b=0;m<64&&p<32?f=g<0?(d=-ei.integerDivideTable[p][m])-1:(d=ei.integerDivideTable[p][m])+1:(d=g/m|0,f=g<0?d-1:d+1),p-=(d<0?-d:d)*m,r<n&&(n=r);var w=v,x=e;x[w]=x[w]*ei.INVERSE_DB_TABLE[y];for(var S=v+1,B=n;S<B;){m<=(b+=p)?(b-=m,y+=f):y+=d;var T=S++,k=e;k[T]=k[T]*ei.INVERSE_DB_TABLE[y]}},ei.predictPoint=function(e,t,i,n,s){var r=s-n,a=i-t,o=Math.abs(r)*(e-t)/a|0;return r<0?n-o:n+o},ei.emptyFloatVector=function(e){return new Array(e)},ei.copyVector=function(e){for(var t=e.length,i=new Array(t),n=0,s=e.length;n<s;){var r=n++;i[r]=e[r]}return i};var ti=function(){};(i["kha.audio2.ogg.vorbis.data.Codebook"]=ti).__name__=!0,ti.read=function(e){var t,i,n,s,r,a,o,l,_,h,u=new ti;if(e.validBits<0)n=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)n=0;else{var c=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=c}}else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=d}if(66==n){var f;if(e.validBits<0)f=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)f=0;else{var g=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=g}}else{var m=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=m}i=67!=f}else i=!0;if(i)t=!0;else{var p;if(e.validBits<0)p=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)p=0;else{var v=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,p=v}}else{var y=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,p=y}t=86!=p}if(t)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(e.validBits<0)s=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)s=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=b}}else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=w}if(e.validBits<0)r=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)r=0;else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=x}}else{var S=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=S}if(u.dimensions=(r<<8)+s,e.validBits<0)a=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)a=0;else{var B=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=B}}else{var T=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=T}if(e.validBits<0)o=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)o=0;else{var k=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=k}}else{var I=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=I}if(e.validBits<0)l=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)l=0;else{var A=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=A}}else{var D=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=D}if(u.entries=(l<<16)+(o<<8)+a,e.validBits<0)_=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)_=0;else{var C=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,_=C}}else{var P=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,_=P}if(0!=_)h=!1;else{var N;if(e.validBits<0)N=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)N=0;else{var E=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,N=E}}else{var R=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,N=R}h=0!=N}u.sparse=h;var L=u.entries,M=new Array(L);u.sparse||(u.codewordLengths=M);var F,V=0;if(0!=_){var O,G=0;if(e.validBits<0)O=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)O=0;else{var U=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,O=U}}else{var W=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,O=W}for(var z=O+1;G<u.entries;){var H,Z=u.entries-G,j=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],K=Z<16384?Z<16?j[Z]:Z<512?5+j[Z>>5]:10+j[Z>>10]:Z<16777216?Z<524288?15+j[Z>>15]:20+j[Z>>20]:Z<536870912?25+j[Z>>25]:Z<-2147483648?30+j[Z>>30]:0;if(e.validBits<0)H=0;else if(e.validBits<K)if(24<K)H=e.readBits(24)+(e.readBits(K-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<K))break}if(e.validBits<0)H=0;else{var X=e.acc&(1<<K)-1;e.acc=e.acc>>>K,e.validBits-=K,H=X}}else{var Y=e.acc&(1<<K)-1;e.acc=e.acc>>>K,e.validBits-=K,H=Y}if(G+H>u.entries)throw new dt(new fi(gi.INVALID_SETUP,"codebook entrys",{fileName:"Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var q=0,Q=H;q<Q;){M[G+q++]=z}G+=H,++z}}else for(var J=0,$=u.entries;J<$;){var ee,te=J++;if(u.sparse)if(e.validBits<0)ee=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)ee=0;else{var ie=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,ee=ie}}else{var ne=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,ee=ne}else ee=1;if(0!=ee){var se;if(e.validBits<0)se=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)se=0;else{var re=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,se=re}}else{var ae=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,se=ae}M[te]=se+1,++V}else M[te]=255}if(u.sparse&&V>=u.entries>>2&&(u.codewordLengths=M,u.sparse=!1),u.sparse)F=V;else{for(var oe=0,le=0,_e=u.entries;le<_e;){var he=M[le++];10<he&&255!=he&&++oe}F=oe}u.sortedEntries=F;var ue,ce=null;if(u.sparse){if(0!=u.sortedEntries){var de=u.sortedEntries,fe=new Array(de);u.codewordLengths=fe;var ge=u.entries,me=new Array(ge);u.codewords=me;var pe=u.entries;ce=new Array(pe)}u.entries,u.sortedEntries}else{var ve=u.entries,ye=new Array(ve);u.codewords=ye}if(!u.computeCodewords(M,u.entries,ce))throw new dt(new fi(gi.INVALID_SETUP,"compute codewords",{fileName:"Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=u.sortedEntries){u.sortedCodewords=[];var be=u.sortedEntries,we=new Array(be);u.sortedValues=we,u.computeSortedHuffman(M,ce)}if(u.sparse&&(ce=null,M=u.codewords=null),u.computeAcceleratedHuffman(),e.validBits<0)ue=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)ue=0;else{var xe=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ue=xe}}else{var Se=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ue=Se}if(u.lookupType=ue,2<u.lookupType)throw new dt(new fi(gi.INVALID_SETUP,"codebook lookup type",{fileName:"Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<u.lookupType){var Be;if(e.validBits<0)Be=0;else if(e.validBits<32)Be=e.readBits(24)+(e.readBits(8)<<24);else{var Te=-1&e.acc;e.acc=e.acc>>>32,e.validBits-=32,Be=Te}var ke,Ie=nt.toFloat(2097151&Be),Ae=(2145386496&Be)>>>21,De=0!=(-2147483648&Be)?-Ie:Ie;if(u.minimumValue=De*Math.pow(2,Ae-788),e.validBits<0)ke=0;else if(e.validBits<32)ke=e.readBits(24)+(e.readBits(8)<<24);else{var Ce=-1&e.acc;e.acc=e.acc>>>32,e.validBits-=32,ke=Ce}var Pe,Ne,Ee=nt.toFloat(2097151&ke),Re=(2145386496&ke)>>>21,Le=0!=(-2147483648&ke)?-Ee:Ee;if(u.deltaValue=Le*Math.pow(2,Re-788),e.validBits<0)Pe=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)Pe=0;else{var Me=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,Pe=Me}}else{var Fe=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,Pe=Fe}if(u.valueBits=Pe+1,e.validBits<0)Ne=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)Ne=0;else{var Ve=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ne=Ve}}else{var Oe=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ne=Oe}u.sequenceP=0!=Ne,1==u.lookupType?u.lookupValues=ei.lookup1Values(u.entries,u.dimensions):u.lookupValues=u.entries*u.dimensions;for(var Ge=u.lookupValues,Ue=new Array(Ge),We=0,ze=u.lookupValues;We<ze;){var He,Ze=We++,je=u.valueBits;if(e.validBits<0)He=0;else if(e.validBits<je)if(24<je)He=e.readBits(24)+(e.readBits(je-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<je))break}if(e.validBits<0)He=0;else{var Ke=e.acc&(1<<je)-1;e.acc=e.acc>>>je,e.validBits-=je,He=Ke}}else{var Xe=e.acc&(1<<je)-1;e.acc=e.acc>>>je,e.validBits-=je,He=Xe}if(-1==He)throw new dt(new fi(gi.INVALID_SETUP,"fail lookup",{fileName:"Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));Ue[Ze]=He}var Ye=u.lookupValues,qe=new Array(Ye);u.multiplicands=qe;for(var Qe=0,Je=u.lookupValues;Qe<Je;){var $e=Qe++;u.multiplicands[$e]=Ue[$e]*u.deltaValue+u.minimumValue}if(2==u.lookupType&&u.sequenceP){for(var et=1,tt=u.lookupValues;et<tt;){var it=et++;u.multiplicands[it]=u.multiplicands[it-1]}u.sequenceP=!1}}return u},ti.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(e,t,i,n,s){this.sparse?(this.codewords[i]=e,this.codewordLengths[i]=n,s[i]=t):this.codewords[t]=e},includeInSort:function(e){return!!this.sparse||255!=e&&10<e},computeCodewords:function(e,t,i){for(var n=new Array(32),s=0;s<32;){n[s++]=0}for(var r=0;r<t&&!(e[r]<255);)++r;if(r==t){this.sortedEntries;return!0}var a=0,o=a++;this.sparse?(this.codewords[o]=0,this.codewordLengths[o]=e[r],i[o]=r):this.codewords[r]=0;for(var l=0;++l<=e[r];)n[l]=1<<32-l;for(l=r;++l<t;){var _=e[l];if(255!=_){for(;0<_&&0==n[_];)--_;if(0==_)return!1;var h=n[_];n[_]=0;var u=h,c=(u=(-16711936&(u=(-252645136&(u=(-858993460&(u=(-1431655766&u)>>>1|(1431655765&u)<<1))>>>2|(858993459&u)<<2))>>>4|(252645135&u)<<4))>>>8|(16711935&u)<<8)>>>16|u<<16,d=a++;if(this.sparse?(this.codewords[d]=c,this.codewordLengths[d]=e[l],i[d]=l):this.codewords[l]=c,_!=e[l])for(var f=e[l];_<f;)n[f]=h+(1<<32-f),--f}}return!0},computeSortedHuffman:function(e,t){if(this.sparse)for(var i=0,n=this.sortedEntries;i<n;){var s=i++,r=this.codewords[s];r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,this.sortedCodewords[s]=r>>>16|r<<16}else{for(var a=0,o=0,l=this.entries;o<l;){var _=o++,h=e[_];if(this.sparse||255!=h&&10<h){var u=this.codewords[_];u=(-16711936&(u=(-252645136&(u=(-858993460&(u=(-1431655766&u)>>>1|(1431655765&u)<<1))>>>2|(858993459&u)<<2))>>>4|(252645135&u)<<4))>>>8|(16711935&u)<<8,this.sortedCodewords[a++]=u>>>16|u<<16}}this.sortedEntries}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(ei.uintAsc);for(var c=0,d=this.sparse?this.sortedEntries:this.entries;c<d;){var f=c++,g=this.sparse?e[t[f]]:e[f];if(this.sparse||255!=g&&10<g){for(var m=this.codewords[f],p=(m=(-16711936&(m=(-252645136&(m=(-858993460&(m=(-1431655766&m)>>>1|(1431655765&m)<<1))>>>2|(858993459&m)<<2))>>>4|(252645135&m)<<4))>>>8|(16711935&m)<<8)>>>16|m<<16,v=0,y=this.sortedEntries;1<y;){var b=v+(y>>1);nt.gte(p,this.sortedCodewords[b])?(v=b,y-=y>>1):y>>=1}this.sparse?(this.sortedValues[v]=t[f],this.codewordLengths[v]=g):this.sortedValues[v]=f}}},computeAcceleratedHuffman:function(){var e=new Array(1024);this.fastHuffman=e,this.fastHuffman[0]=-1;for(var t=0;t<1024;){var i=t++;this.fastHuffman[i]=-1}for(var n=0,s=this.sparse?this.sortedEntries:this.entries;n<s;){var r=n++;if(this.codewordLengths[r]<=10){var a;if(this.sparse){var o=this.sortedCodewords[r];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[r];for(;a<1024;)this.fastHuffman[a]=r,a+=1<<this.codewordLengths[r]}}},codebookDecode:function(e,t,i,n){e.validBits<10&&e.prepHuffman();var s,r=this.fastHuffman[1023&e.acc];if(0<=r){var a=this.codewordLengths[r];e.acc=e.acc>>>a,e.validBits-=a,e.validBits<0?(e.validBits=0,s=-1):s=r}else s=e.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var o=s,l=this.lookupValues,_=this.sequenceP,h=this.multiplicands,u=this.minimumValue;if(o<0)return!1;if(n>this.dimensions&&(n=this.dimensions),1==this.lookupType){for(var c=1,d=0,f=0,g=n;f<g;){var m=f++,p=h[nt.toFloat(o/c|0)%nt.toFloat(l)|0]+d,v=i+m,y=t;y[v]=y[v]+p,_&&(d=p+u),c*=l}return!0}if(o*=this.dimensions,_)for(var b=0,w=0,x=n;w<x;){var S=w++,B=h[o+S]+b,T=i+S,k=t;k[T]=k[T]+B,b=B+u}else for(var I=0,A=n;I<A;){var D=I++,C=i+D,P=t;P[C]=P[C]+(h[o+D]+0)}return!0},codebookDecodeStep:function(e,t,i,n,s){e.validBits<10&&e.prepHuffman();var r,a=this.fastHuffman[1023&e.acc];if(0<=a){var o=this.codewordLengths[a];e.acc=e.acc>>>o,e.validBits-=o,e.validBits<0?(e.validBits=0,r=-1):r=a}else r=e.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var l=r,_=0;if(l<0)return!1;n>this.dimensions&&(n=this.dimensions);var h=this.lookupValues,u=this.sequenceP,c=this.multiplicands;if(1==this.lookupType){for(var d=1,f=0,g=n;f<g;){var m=f++,p=c[nt.toFloat(l/d|0)%nt.toFloat(h)|0]+_,v=i+m*s,y=t;y[v]=y[v]+p,u&&(_=p),d*=h}return!0}l*=this.dimensions;for(var b=0,w=n;b<w;){var x=b++,S=c[l+x]+_,B=i+x*s,T=t;T[B]=T[B]+S,u&&(_=S)}return!0},decodeStart:function(e){e.validBits<10&&e.prepHuffman();var t,i=this.fastHuffman[1023&e.acc];if(0<=i){var n=this.codewordLengths[i];e.acc=e.acc>>>n,e.validBits-=n,e.validBits<0?(e.validBits=0,t=-1):t=i}else t=e.decodeScalarRaw(this);return this.sparse&&(t=this.sortedValues[t]),t},decodeDeinterleaveRepeat:function(e,t,i,n,s,r,a){var o=this.dimensions;if(0==this.lookupType)throw new dt(new fi(gi.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,_=this.sequenceP,h=this.lookupValues;0<a;){var u=0;e.validBits<10&&e.prepHuffman();var c,d=this.fastHuffman[1023&e.acc];if(0<=d){var f=this.codewordLengths[d];e.acc=e.acc>>>f,e.validBits-=f,e.validBits<0?(e.validBits=0,c=-1):c=d}else c=e.decodeScalarRaw(this);this.sparse&&(c=this.sortedValues[c]);var g=c;if(g<0){if(0==e.bytesInSeg&&e.lastSeg)return null;throw new dt(new fi(gi.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(r*i<n+s*i+o&&(o=r*i-(s*i-n)),1==this.lookupType){var m=1;if(_)for(var p=0,v=o;p<v;){p++;var y=l[nt.toFloat(g/m|0)%nt.toFloat(h)|0]+u,b=s,w=t[n];w[b]=w[b]+y,++n==i&&(n=0,++s),u=y,m*=h}else for(var x=0,S=o;x<S;){x++;var B=l[nt.toFloat(g/m|0)%nt.toFloat(h)|0]+u,T=s,k=t[n];k[T]=k[T]+B,++n==i&&(n=0,++s),m*=h}}else if(g*=this.dimensions,_)for(var I=0,A=o;I<A;){var D=l[g+I++]+u,C=s,P=t[n];P[C]=P[C]+D,++n==i&&(n=0,++s),u=D}else for(var N=0,E=o;N<E;){var R=l[g+N++]+u,L=s,M=t[n];M[L]=M[L]+R,++n==i&&(n=0,++s)}a-=o}return{cInter:n,pInter:s}},residueDecode:function(e,t,i,n,s){if(0==s)for(var r=n/this.dimensions|0,a=0,o=r;a<o;){var l=a++;if(!this.codebookDecodeStep(e,t,i+l,n-i-l,r))return!1}else for(var _=0;_<n;){if(!this.codebookDecode(e,t,i,n-_))return!1;_+=this.dimensions,i+=this.dimensions}return!0},__class__:ti};var ii=function(){this.data=new Ii};(i["kha.audio2.ogg.vorbis.data.Comment"]=ii).__name__=!0,ii.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return N.parseInt(this.getString("loopstart"))},get_loopLength:function(){return N.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(e,t){e=e.toLowerCase();var i=this.data;if(null!=Ns[e]?i.existsReserved(e):i.h.hasOwnProperty(e)){var n=this.data;(null!=Ns[e]?n.getReserved(e):n.h[e]).push(t)}else{var s=[t],r=this.data;null!=Ns[e]?r.setReserved(e,s):r.h[e]=s}},getString:function(e){e=e.toLowerCase();var t=this.data;if(null!=Ns[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var i=this.data;return(null!=Ns[e]?i.getReserved(e):i.h[e])[0]}return null},getArray:function(e){e=e.toLowerCase();var t=this.data;if(null!=Ns[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var i=this.data;return null!=Ns[e]?i.getReserved(e):i.h[e]}return null},__class__:ii,__properties__:{get_artists:"get_artists",get_isrc:"get_isrc",get_contact:"get_contact",get_location:"get_location",get_date:"get_date",get_genre:"get_genre",get_description:"get_description",get_artist:"get_artist",get_license:"get_license",get_copyright:"get_copyright",get_performer:"get_performer",get_tracknumber:"get_tracknumber",get_organization:"get_organization",get_album:"get_album",get_version:"get_version",get_loopLength:"get_loopLength",get_loopStart:"get_loopStart",get_title:"get_title"}};var ni=function(){};(i["kha.audio2.ogg.vorbis.data.Floor"]=ni).__name__=!0,ni.read=function(e,t){var i,n=new ni;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=r}if(n.type=i,1<n.type)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==n.type){var a,o,l,_,h,u,c=n.floor0=new si;if(e.validBits<0)a=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)a=0;else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=d}}else{var f=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,a=f}if(c.order=a,e.validBits<0)o=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)o=0;else{var g=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=g}}else{var m=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=m}if(c.rate=o,e.validBits<0)l=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)l=0;else{var p=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=p}}else{var v=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=v}if(c.barkMapSize=l,e.validBits<0)_=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)_=0;else{var y=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_=y}}else{var b=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_=b}if(c.amplitudeBits=_,e.validBits<0)h=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)h=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,h=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,h=x}if(c.amplitudeOffset=h,e.validBits<0)u=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)u=0;else{var S=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,u=S}}else{var B=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,u=B}c.numberOfBooks=u+1;for(var T=0,k=c.numberOfBooks;T<k;){var I,A=T++,D=c.bookList;if(e.validBits<0)I=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)I=0;else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=C}}else{var P=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=P}D[A]=I}throw new dt(new fi(gi.FEATURE_NOT_SUPPORTED,null,{fileName:"Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var N,E=[],R=n.floor1=new ri,L=-1;if(e.validBits<0)N=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)N=0;else{var M=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,N=M}}else{var F=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,N=F}R.partitions=N;var V=R.partitions,O=new Array(V);R.partitionClassList=O;for(var G=0,U=R.partitions;G<U;){var W,z=G++,H=R.partitionClassList;if(e.validBits<0)W=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)W=0;else{var Z=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,W=Z}}else{var j=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,W=j}H[z]=W,R.partitionClassList[z]>L&&(L=R.partitionClassList[z])}var K=new Array(L+1);R.classDimensions=K;var X=new Array(L+1);R.classMasterbooks=X;var Y=new Array(L+1);R.classSubclasses=Y;var q=new Array(L+1);R.subclassBooks=q;for(var Q,J,$=0,ee=L+1;$<ee;){var te,ie=$++,ne=R.classDimensions;if(e.validBits<0)te=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)te=0;else{var se=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=se}}else{var re=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=re}ne[ie]=te+1;var ae,oe=R.classSubclasses;if(e.validBits<0)ae=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)ae=0;else{var le=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ae=le}}else{var _e=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ae=_e}if(oe[ie]=ae,0!=R.classSubclasses[ie]){var he,ue=R.classMasterbooks;if(e.validBits<0)he=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)he=0;else{var ce=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=ce}}else{var de=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=de}if(ue[ie]=he,R.classMasterbooks[ie]>=t.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var fe=1<<R.classSubclasses[ie],ge=R.subclassBooks,me=new Array(fe);ge[ie]=me;for(var pe=0,ve=fe;pe<ve;){var ye,be=pe++,we=R.subclassBooks[ie];if(e.validBits<0)ye=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)ye=0;else{var xe=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ye=xe}}else{var Se=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ye=Se}if(we[be]=ye-1,R.subclassBooks[ie][be]>=t.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}if(e.validBits<0)Q=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)Q=0;else{var Be=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,Q=Be}}else{var Te=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,Q=Te}if(R.floor1Multiplier=Q+1,e.validBits<0)J=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)J=0;else{var ke=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,J=ke}}else{var Ie=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,J=Ie}R.rangebits=J;var Ae=new Array(250);R.xlist=Ae,R.xlist[0]=0,R.xlist[1]=1<<R.rangebits,R.values=2;for(var De=0,Ce=R.partitions;De<Ce;)for(var Pe=De++,Ne=R.partitionClassList[Pe],Ee=0,Re=R.classDimensions[Ne];Ee<Re;){Ee++;var Le,Me=R.xlist,Fe=R.values,Ve=R.rangebits;if(e.validBits<0)Le=0;else if(e.validBits<Ve)if(24<Ve)Le=e.readBits(24)+(e.readBits(Ve-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<Ve))break}if(e.validBits<0)Le=0;else{var Oe=e.acc&(1<<Ve)-1;e.acc=e.acc>>>Ve,e.validBits-=Ve,Le=Oe}}else{var Ge=e.acc&(1<<Ve)-1;e.acc=e.acc>>>Ve,e.validBits-=Ve,Le=Ge}Me[Fe]=Le,R.values++}for(var Ue=0,We=R.values;Ue<We;){var ze=Ue++;E.push(new oi),E[ze].x=R.xlist[ze],E[ze].y=ze}E.sort(ei.pointCompare);var He=R.values,Ze=new Array(He);R.sortedOrder=Ze;for(var je=0,Ke=R.values;je<Ke;){var Xe=je++;R.sortedOrder[Xe]=E[Xe].y}var Ye=R.values,qe=new Array(Ye);R.neighbors=qe;for(var Qe=2,Je=R.values;Qe<Je;){for(var $e,et,tt=Qe++,it=R.xlist,nt=-1,st=65536,rt=0,at=0,ot=0,lt=tt;ot<lt;){var _t=ot++;it[_t]>nt&&it[_t]<it[tt]&&(nt=it[rt=_t]),it[_t]<st&&it[_t]>it[tt]&&(st=it[at=_t])}$e=rt,et=at;var ht=R.neighbors,ut=R.values,ct=new Array(ut);ht[tt]=ct,R.neighbors[tt][0]=$e,R.neighbors[tt][1]=et}return n},ni.prototype={floor0:null,floor1:null,type:null,__class__:ni};var si=function(){};(i["kha.audio2.ogg.vorbis.data.Floor0"]=si).__name__=!0,si.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:si};var ri=function(){};(i["kha.audio2.ogg.vorbis.data.Floor1"]=ri).__name__=!0,ri.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:ri};var ai=function(){};(i["kha.audio2.ogg.vorbis.data.Header"]=ai).__name__=!0,ai.read=function(e){var t=e.page;if(t.start(e),0==(2&t.flag))throw new dt(new fi(gi.INVALID_FIRST_PAGE,"not firstPage",{fileName:"Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&t.flag))throw new dt(new fi(gi.INVALID_FIRST_PAGE,"lastPage",{fileName:"Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&t.flag))throw new dt(new fi(gi.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.firstPageValidate(),e.inputPosition+=1,1!=e.input.readByte())throw new dt(new fi(gi.INVALID_FIRST_PAGE,"decodeState head",{fileName:"Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var i=new Fe(new Es(6)),n=0;n<6;){var s,r=n++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,s=e.input.readByte()):s=-1,e.validBits=0,i.b[r]=255&s}if("vorbis"!=i.toString())throw new dt(new fi(gi.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));e.inputPosition+=4;var a=e.input.readInt32();if(0!=a)throw new dt(new fi(gi.INVALID_FIRST_PAGE,"vorbis version : "+a,{fileName:"Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var o=new ai;if(e.inputPosition+=1,o.channel=e.input.readByte(),0==o.channel)throw new dt(new fi(gi.INVALID_FIRST_PAGE,"no channel",{fileName:"Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<o.channel)throw new dt(new fi(gi.TOO_MANY_CHANNELS,"too many channels",{fileName:"Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.inputPosition+=4,o.sampleRate=e.input.readInt32(),0==o.sampleRate)throw new dt(new fi(gi.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=4,o.maximumBitRate=e.input.readInt32(),e.inputPosition+=4,o.nominalBitRate=e.input.readInt32(),e.inputPosition+=4,o.minimumBitRate=e.input.readInt32(),e.inputPosition+=1;var l=e.input.readByte(),_=15&l,h=l>>4;if(o.blocksize0=1<<_,o.blocksize1=1<<h,_<6||13<_)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h<6||13<h)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h<_)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=1;var u=e.input.readByte();if(0==(1&u))throw new dt(new fi(gi.INVALID_FIRST_PAGE,null,{fileName:"Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.page.start(e),e.startPacket();for(var c=0,d=new Ke;0!=(c=e.next());)e.inputPosition+=c,d.write(e.input.read(c)),e.bytesInSeg=0;var f=new Ze(d.getBytes());f.readByte(),f.read(6);var g,m=f.readInt32();o.vendor=f.readString(m),o.comment=new ii;for(var p=0,v=f.readInt32();p<v;){p++;var y=f.readInt32(),b=f.readString(y),w=b.indexOf("=");-1!=w&&o.comment.add(b.substring(0,w),b.substring(w+1))}if(0==(1&f.readByte()))throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.startPacket(),0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,g=e.input.readByte()):g=-1,e.validBits=0,5!=g)throw new dt(new fi(gi.INVALID_SETUP,"setup packet",{fileName:"Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var x,S=new Fe(new Es(6)),B=0;B<6;){var T,k=B++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,T=e.input.readByte()):T=-1,e.validBits=0,S.b[k]=255&T}if("vorbis"!=S.toString())throw new dt(new fi(gi.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));if(e.validBits<0)x=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)x=0;else{var I=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,x=I}}else{var A=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,x=A}var D=x+1,C=new Array(D);o.codebooks=C;for(var P,N=0,E=D;N<E;){var R=N++;o.codebooks[R]=ti.read(e)}if(e.validBits<0)P=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)P=0;else{var L=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,P=L}}else{var M=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,P=M}for(var F,V=0,O=u=P+1;V<O;){var G;V++;if(e.validBits<0)G=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)G=0;else{var U=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,G=U}}else{var W=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,G=W}if(0!=G)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}if(e.validBits<0)F=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)F=0;else{var z=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,F=z}}else{var H=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,F=H}var Z=F+1,j=new Array(Z);o.floorConfig=j;for(var K,X=0,Y=Z;X<Y;){var q=X++;o.floorConfig[q]=ni.read(e,o.codebooks)}if(e.validBits<0)K=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)K=0;else{var Q=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,K=Q}}else{var J=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,K=J}var $=K+1,ee=new Array($);o.residueConfig=ee;for(var te,ie=0,ne=$;ie<ne;){var se=ie++;o.residueConfig[se]=mi.read(e,o.codebooks)}if(e.validBits<0)te=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)te=0;else{var re=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,te=re}}else{var ae=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,te=ae}var oe=te+1,le=new Array(oe);o.mapping=le;for(var _e,he=0,ue=oe;he<ue;)for(var ce=he++,de=li.read(e,o.channel),fe=0,ge=(o.mapping[ce]=de).submaps;fe<ge;){var me=fe++;if(de.submapFloor[me]>=o.floorConfig.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(de.submapResidue[me]>=o.residueConfig.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}if(e.validBits<0)_e=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)_e=0;else{var pe=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_e=pe}}else{var ve=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_e=ve}var ye=_e+1,be=new Array(ye);o.modes=be;for(var we=0,xe=ye;we<xe;){var Se=we++,Be=hi.read(e);if((o.modes[Se]=Be).mapping>=o.mapping.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next();)e.bytesInSeg--,e.inputPosition+=1,e.input.readByte();return o},ai.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:ai};var oi=function(){};(i["kha.audio2.ogg.vorbis.data.IntPoint"]=oi).__name__=!0,oi.prototype={x:null,y:null,__class__:oi};var li=function(){};(i["kha.audio2.ogg.vorbis.data.Mapping"]=li).__name__=!0,li.read=function(e,t){var i,n=new li;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=r}if(0!=i)throw new dt(new fi(gi.INVALID_SETUP,"mapping type "+i,{fileName:"Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var a=new Array(t);n.chan=a;for(var o,l,_,h=0,u=t;h<u;){var c=h++;n.chan[c]=new _i}if(e.validBits<0)o=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)o=0;else{var d=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=d}}else{var f=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=f}if(0!=o){var g;if(e.validBits<0)g=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)g=0;else{var m=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,g=m}}else{var p=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,g=p}n.submaps=g+1}else n.submaps=1;if(e.validBits<0)l=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)l=0;else{var v=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=v}}else{var y=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=y}if(0!=l){var b;if(e.validBits<0)b=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)b=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,b=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,b=x}n.couplingSteps=b+1;for(var S=0,B=n.couplingSteps;S<B;){var T,k=S++,I=n.chan[k],A=t-1,D=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],C=A<16384?A<16?D[A]:A<512?5+D[A>>5]:10+D[A>>10]:A<16777216?A<524288?15+D[A>>15]:20+D[A>>20]:A<536870912?25+D[A>>25]:A<-2147483648?30+D[A>>30]:0;if(e.validBits<0)T=0;else if(e.validBits<C)if(24<C)T=e.readBits(24)+(e.readBits(C-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<C))break}if(e.validBits<0)T=0;else{var P=e.acc&(1<<C)-1;e.acc=e.acc>>>C,e.validBits-=C,T=P}}else{var N=e.acc&(1<<C)-1;e.acc=e.acc>>>C,e.validBits-=C,T=N}I.magnitude=T;var E,R=n.chan[k],L=t-1,M=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],F=L<16384?L<16?M[L]:L<512?5+M[L>>5]:10+M[L>>10]:L<16777216?L<524288?15+M[L>>15]:20+M[L>>20]:L<536870912?25+M[L>>25]:L<-2147483648?30+M[L>>30]:0;if(e.validBits<0)E=0;else if(e.validBits<F)if(24<F)E=e.readBits(24)+(e.readBits(F-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<F))break}if(e.validBits<0)E=0;else{var V=e.acc&(1<<F)-1;e.acc=e.acc>>>F,e.validBits-=F,E=V}}else{var O=e.acc&(1<<F)-1;e.acc=e.acc>>>F,e.validBits-=F,E=O}if(R.angle=E,n.chan[k].magnitude>=t)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(n.chan[k].angle>=t)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(n.chan[k].magnitude==n.chan[k].angle)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else n.couplingSteps=0;if(e.validBits<0)_=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)_=0;else{var G=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,_=G}}else{var U=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,_=U}if(0!=_)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<n.submaps)for(var W=0,z=t;W<z;){var H,Z=W++,j=n.chan[Z];if(e.validBits<0)H=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)H=0;else{var K=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,H=K}}else{var X=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,H=X}if(j.mux=H,n.chan[Z].mux>=n.submaps)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var Y=0,q=t;Y<q;){var Q=Y++;n.chan[Q].mux=0}var J=n.submaps,$=new Array(J);n.submapFloor=$;var ee=n.submaps,te=new Array(ee);n.submapResidue=te;for(var ie=0,ne=n.submaps;ie<ne;){var se=ie++;if(0<=e.validBits)if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(0<=e.validBits){e.acc;e.acc=e.acc>>>8,e.validBits-=8}}else{e.acc;e.acc=e.acc>>>8,e.validBits-=8}var re,ae=n.submapFloor;if(e.validBits<0)re=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)re=0;else{var oe=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,re=oe}}else{var le=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,re=le}ae[se]=re;var _e,he=n.submapResidue;if(e.validBits<0)_e=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)_e=0;else{var ue=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_e=ue}}else{var ce=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_e=ce}he[se]=_e}return n},li.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(e,t,i,n,s,r){var a=i>>1,o=this.chan[t].mux,l=e[this.submapFloor[o]];if(0==l.type)throw new dt(new fi(gi.INVALID_STREAM,null,{fileName:"Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var _=l.floor1,h=0,u=s[0]*_.floor1Multiplier,c=1,d=_.values;c<d;){var f=c++,g=_.sortedOrder[f];if(0<=s[g]){var m=s[g]*_.floor1Multiplier,p=_.xlist[g];ei.drawLine(n,h,u,p,m,a),h=p,u=m}}if(h<a)for(var v=h,y=a;v<y;){var b=v++,w=n;w[b]=w[b]*ei.INVERSE_DB_TABLE[u]}},__class__:li};var _i=function(){};(i["kha.audio2.ogg.vorbis.data.MappingChannel"]=_i).__name__=!0,_i.prototype={magnitude:null,angle:null,mux:null,__class__:_i};var hi=function(){};(i["kha.audio2.ogg.vorbis.data.Mode"]=hi).__name__=!0,hi.read=function(e){var t,i,n,s,r=new hi;if(e.validBits<0)t=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)t=0;else{var a=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=a}}else{var o=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=o}if(r.blockflag=0!=t,e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var l=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=l}}else{var _=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=_}if(r.windowtype=i,e.validBits<0)n=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)n=0;else{var h=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,n=h}}else{var u=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,n=u}if(r.transformtype=n,e.validBits<0)s=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)s=0;else{var c=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=c}}else{var d=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=d}if(r.mapping=s,0!=r.windowtype)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=r.transformtype)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return r},hi.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:hi};var ui=function(){};(i["kha.audio2.ogg.vorbis.data.Page"]=ui).__name__=!0,ui.prototype={flag:null,clone:function(){var e=new ui;return e.flag=this.flag,e},start:function(e){var t,i,n;if(e.inputPosition+=1,79==e.input.readByte()?(e.inputPosition+=1,n=103!=e.input.readByte()):n=!0,n?i=!0:(e.inputPosition+=1,i=103!=e.input.readByte()),i?t=!0:(e.inputPosition+=1,t=83!=e.input.readByte()),t)throw new dt(new fi(gi.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(e)},startWithoutCapturePattern:function(e){e.inputPosition+=1;var t=e.input.readByte();if(0!=t)throw new dt(new fi(gi.INVALID_STREAM_STRUCTURE_VERSION,""+t,{fileName:"Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));e.inputPosition+=1,this.flag=e.input.readByte(),e.inputPosition+=4;var i=e.input.readInt32();e.inputPosition+=4;var n=e.input.readInt32();e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.setup(i,n)},__class__:ui};var ci=function(){};(i["kha.audio2.ogg.vorbis.data.PageFlag"]=ci).__name__=!0;var di=function(){};(i["kha.audio2.ogg.vorbis.data.ProbedPage"]=di).__name__=!0,di.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:di};var fi=function(e,t,i){null==t&&(t=""),this.type=e,this.message=t,this.posInfos=i};(i["kha.audio2.ogg.vorbis.data.ReaderError"]=fi).__name__=!0,fi.prototype={type:null,message:null,posInfos:null,__class__:fi};var gi=i["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"]};gi.NEED_MORE_DATA=["NEED_MORE_DATA",0],gi.NEED_MORE_DATA.toString=n,(gi.NEED_MORE_DATA.__enum__=gi).INVALID_API_MIXING=["INVALID_API_MIXING",1],gi.INVALID_API_MIXING.toString=n,(gi.INVALID_API_MIXING.__enum__=gi).OUTOFMEM=["OUTOFMEM",2],gi.OUTOFMEM.toString=n,(gi.OUTOFMEM.__enum__=gi).FEATURE_NOT_SUPPORTED=["FEATURE_NOT_SUPPORTED",3],gi.FEATURE_NOT_SUPPORTED.toString=n,(gi.FEATURE_NOT_SUPPORTED.__enum__=gi).TOO_MANY_CHANNELS=["TOO_MANY_CHANNELS",4],gi.TOO_MANY_CHANNELS.toString=n,(gi.TOO_MANY_CHANNELS.__enum__=gi).FILE_OPEN_FAILURE=["FILE_OPEN_FAILURE",5],gi.FILE_OPEN_FAILURE.toString=n,(gi.FILE_OPEN_FAILURE.__enum__=gi).SEEK_WITHOUT_LENGTH=["SEEK_WITHOUT_LENGTH",6],gi.SEEK_WITHOUT_LENGTH.toString=n,(gi.SEEK_WITHOUT_LENGTH.__enum__=gi).UNEXPECTED_EOF=["UNEXPECTED_EOF",7],gi.UNEXPECTED_EOF.toString=n,(gi.UNEXPECTED_EOF.__enum__=gi).SEEK_INVALID=["SEEK_INVALID",8],gi.SEEK_INVALID.toString=n,(gi.SEEK_INVALID.__enum__=gi).INVALID_SETUP=["INVALID_SETUP",9],gi.INVALID_SETUP.toString=n,(gi.INVALID_SETUP.__enum__=gi).INVALID_STREAM=["INVALID_STREAM",10],gi.INVALID_STREAM.toString=n,(gi.INVALID_STREAM.__enum__=gi).MISSING_CAPTURE_PATTERN=["MISSING_CAPTURE_PATTERN",11],gi.MISSING_CAPTURE_PATTERN.toString=n,(gi.MISSING_CAPTURE_PATTERN.__enum__=gi).INVALID_STREAM_STRUCTURE_VERSION=["INVALID_STREAM_STRUCTURE_VERSION",12],gi.INVALID_STREAM_STRUCTURE_VERSION.toString=n,(gi.INVALID_STREAM_STRUCTURE_VERSION.__enum__=gi).CONTINUED_PACKET_FLAG_INVALID=["CONTINUED_PACKET_FLAG_INVALID",13],gi.CONTINUED_PACKET_FLAG_INVALID.toString=n,(gi.CONTINUED_PACKET_FLAG_INVALID.__enum__=gi).INCORRECT_STREAM_SERIAL_NUMBER=["INCORRECT_STREAM_SERIAL_NUMBER",14],gi.INCORRECT_STREAM_SERIAL_NUMBER.toString=n,(gi.INCORRECT_STREAM_SERIAL_NUMBER.__enum__=gi).INVALID_FIRST_PAGE=["INVALID_FIRST_PAGE",15],gi.INVALID_FIRST_PAGE.toString=n,(gi.INVALID_FIRST_PAGE.__enum__=gi).BAD_PACKET_TYPE=["BAD_PACKET_TYPE",16],gi.BAD_PACKET_TYPE.toString=n,(gi.BAD_PACKET_TYPE.__enum__=gi).CANT_FIND_LAST_PAGE=["CANT_FIND_LAST_PAGE",17],gi.CANT_FIND_LAST_PAGE.toString=n,(gi.CANT_FIND_LAST_PAGE.__enum__=gi).SEEK_FAILED=["SEEK_FAILED",18],gi.SEEK_FAILED.toString=n,(gi.SEEK_FAILED.__enum__=gi).OTHER=["OTHER",19],gi.OTHER.toString=n,gi.OTHER.__enum__=gi;var mi=function(){};(i["kha.audio2.ogg.vorbis.data.Residue"]=mi).__name__=!0,mi.read=function(e,t){var i,n=new mi;if(e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=r}if(n.type=i,2<n.type)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var a,o,l,_,h=new Array(64);if(e.validBits<0)a=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)a=0;else{var u=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,a=u}}else{var c=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,a=c}if(n.begin=a,e.validBits<0)o=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)o=0;else{var d=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=d}}else{var f=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=f}if(n.end=o,e.validBits<0)l=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)l=0;else{var g=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=g}}else{var m=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=m}if(n.partSize=l+1,e.validBits<0)_=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)_=0;else{var p=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_=p}}else{var v=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,_=v}var y,b=n.classifications=_+1;if(e.validBits<0)y=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)y=0;else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,y=w}}else{var x=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,y=x}n.classbook=y;for(var S=0,B=n.classifications;S<B;){var T,k,I=S++,A=0;if(e.validBits<0)T=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)T=0;else{var D=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,T=D}}else{var C=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,T=C}if(e.validBits<0)k=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)k=0;else{var P=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,k=P}}else{var N=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,k=N}if(0!=k)if(e.validBits<0)A=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)A=0;else{var E=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,A=E}}else{var R=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,A=R}h[I]=8*A+T}var L=n.classifications,M=new Array(L);n.residueBooks=M;for(var F=0,V=n.classifications;F<V;){var O=F++,G=n.residueBooks,U=new Array(8);G[O]=U;for(var W=0;W<8;){var z=W++;if(0!=(h[O]&1<<z)){var H,Z=n.residueBooks[O];if(e.validBits<0)H=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)H=0;else{var j=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,H=j}}else{var K=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,H=K}if(Z[z]=H,n.residueBooks[O][z]>=t.length)throw new dt(new fi(gi.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else n.residueBooks[O][z]=-1}}var X=t[n.classbook].entries,Y=t[n.classbook].dimensions,q=new Array(X);n.classdata=q;for(var Q=0,J=X;Q<J;)for(var $=Q++,ee=$,te=Y,ie=n.classdata,ne=new Array(Y),se=ie[$]=ne;0<=--te;)se[te]=ee%b,ee=ee/b|0;return n},mi.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(e,t,i,n,s,r,a){for(var o=t.codebooks,l=o[this.classbook].dimensions,_=this.end-this.begin,h=this.partSize,u=nt.toFloat(_)/nt.toFloat(h)|0,c=t.channel*u+1,d=new Array(c),f=0,g=n;f<g;){var m=f++;if(!r[m])for(var p=i[m],v=0,y=p.length;v<y;){p[v++]=0}}if(2!=this.type||1==n)for(var b=0;b<8;)for(var w=b++,x=0;x<u;){if(0==w)for(var S=0,B=n;S<B;){var T=S++;if(!r[T]){var k=o[this.classbook];e.validBits<10&&e.prepHuffman();var I,A=k.fastHuffman[1023&e.acc];if(0<=A){var D=k.codewordLengths[A];e.acc=e.acc>>>D,e.validBits-=D,e.validBits<0?(e.validBits=0,I=-1):I=A}else I=e.decodeScalarRaw(k);k.sparse&&(I=k.sortedValues[I]);var C=I;if(-1==C)return;for(var P=l;0<=--P;)d[T*u+P+x]=C%this.classifications,C=C/this.classifications|0}}for(var N=0,E=l;N<E;){N++;if(u<=x)break;for(var R=0,L=n;R<L;){var M=R++;if(!r[M]){var F=d[M*u+x],V=this.residueBooks[F][w];if(0<=V){var O=i[M],G=this.begin+x*h,U=h;if(!o[V].residueDecode(e,O,G,U,this.type))return}}}++x}}else{for(var W=0,z=n;W<z;){var H=W++;if(!r[H])break;if(H==n-1)return}for(var Z=0;Z<8;){var j=Z++,K=0;if(2==n)for(;K<u;){var X=this.begin+K*h,Y=1&X,q=X>>>1;if(0==j){var Q=o[this.classbook];e.validBits<10&&e.prepHuffman();var J,$=Q.fastHuffman[1023&e.acc];if(0<=$){var ee=Q.codewordLengths[$];e.acc=e.acc>>>ee,e.validBits-=ee,e.validBits<0?(e.validBits=0,J=-1):J=$}else J=e.decodeScalarRaw(Q);Q.sparse&&(J=Q.sortedValues[J]);var te=J;if(-1==te)return;for(var ie=l;0<=--ie;)d[ie+K]=te%this.classifications,te=te/this.classifications|0}for(var ne=0,se=l;ne<se;){ne++;if(u<=K)break;var re=this.begin+K*h,ae=d[K],oe=this.residueBooks[ae][j];if(0<=oe){var le=o[oe].decodeDeinterleaveRepeat(e,i,n,Y,q,s,h);if(null==le)return;Y=le.cInter,q=le.pInter}else Y=1&(re+=h),q=re>>>1;++K}}else if(1==n)for(;K<u;){var _e=0,he=this.begin+K*h;if(0==j){var ue=o[this.classbook];e.validBits<10&&e.prepHuffman();var ce,de=ue.fastHuffman[1023&e.acc];if(0<=de){var fe=ue.codewordLengths[de];e.acc=e.acc>>>fe,e.validBits-=fe,e.validBits<0?(e.validBits=0,ce=-1):ce=de}else ce=e.decodeScalarRaw(ue);ue.sparse&&(ce=ue.sortedValues[ce]);var ge=ce;if(-1==ge)return;for(var me=l;0<=--me;)d[me+K]=ge%this.classifications,ge=ge/this.classifications|0}for(var pe=0,ve=l;pe<ve;){pe++;if(u<=K)break;var ye=this.begin+K*h,be=this.residueBooks[d[K]][j];if(0<=be){var we=o[be].decodeDeinterleaveRepeat(e,i,n,_e,he,s,h);if(null==we)return;_e=we.cInter,he=we.pInter}else _e=0,he=ye+=h;++K}}else for(;K<u;){var xe=this.begin+K*h,Se=nt.toFloat(xe)%nt.toFloat(n)|0,Be=nt.toFloat(xe)/nt.toFloat(n)|0;if(0==j){var Te=o[this.classbook];e.validBits<10&&e.prepHuffman();var ke,Ie=Te.fastHuffman[1023&e.acc];if(0<=Ie){var Ae=Te.codewordLengths[Ie];e.acc=e.acc>>>Ae,e.validBits-=Ae,e.validBits<0?(e.validBits=0,ke=-1):ke=Ie}else ke=e.decodeScalarRaw(Te);Te.sparse&&(ke=Te.sortedValues[ke]);var De=ke;if(-1==De)return;for(var Ce=l;0<=--Ce;)d[Ce+K]=De%this.classifications,De=De/this.classifications|0}for(var Pe=0,Ne=l;Pe<Ne;){Pe++;if(u<=K)break;var Ee=this.begin+K*h,Re=this.residueBooks[d[K]][j];if(0<=Re){var Le=o[Re].decodeDeinterleaveRepeat(e,i,n,Se,Be,s,h);if(null==Le)return;Se=Le.cInter,Be=Le.pInter}else Ee+=h,Se=nt.toFloat(Ee)%nt.toFloat(n)|0,Be=nt.toFloat(Ee)/nt.toFloat(n)|0;++K}}}}},__class__:mi};var pi=function(){};(i["kha.audio2.ogg.vorbis.data.Setting"]=pi).__name__=!0;var vi=function(){};(i["kha.graphics1.Graphics"]=vi).__name__=!0,vi.prototype={begin:null,end:null,setPixel:null,__class__:vi};var yi=function(){this.transformations=[],this.transformations.push(new D(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(i["kha.graphics2.Graphics"]=yi).__name__=!0,yi.prototype={begin:function(e,t){null==e&&(e=!0)},end:function(){},flush:function(){},clear:function(e){},drawImage:function(e,t,i){this.drawSubImage(e,t,i,0,0,e.get_width(),e.get_height())},drawSubImage:function(e,t,i,n,s,r,a){this.drawScaledSubImage(e,n,s,r,a,t,i,r,a)},drawScaledImage:function(e,t,i,n,s){this.drawScaledSubImage(e,0,0,e.get_width(),e.get_height(),t,i,n,s)},drawScaledSubImage:function(e,t,i,n,s,r,a,o,l){},drawRect:function(e,t,i,n,s){null==s&&(s=1)},fillRect:function(e,t,i,n){},drawString:function(e,t,i){},drawCharacters:function(e,t,i,n,s){},drawLine:function(e,t,i,n,s){null==s&&(s=1)},drawVideo:function(e,t,i,n,s){},fillTriangle:function(e,t,i,n,s,r){},get_imageScaleQuality:function(){return Si.Low},set_imageScaleQuality:function(e){return Si.High},get_mipmapScaleQuality:function(){return Si.Low},set_mipmapScaleQuality:function(e){return Si.High},get_color:function(){return-16777216},set_color:function(e){return-16777216},get_font:function(){return null},set_font:function(e){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(e){return this.myFontSize=e},get_fontGlyphs:function(){return yi._glyphs},set_fontGlyphs:function(e){return yi._glyphs=e},pushTransformation:function(e){var t=new D(1,0,0,0,1,0,0,0,1);t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,this.setTransformation(t),this.transformations.push(t)},popTransformation:function(){var e=this.transformations.pop();return this.setTransformation(this.transformations[this.transformations.length-1]),e},get_transformation:function(){return this.transformations[this.transformations.length-1]},set_transformation:function(e){this.setTransformation(e);var t=this.transformations[this.transformations.length-1];return t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,e},translation:function(e,t){var i,n;n=e,i=t;var s=this.transformations[this.transformations.length-1];return new D(1*s._00+0*s._01+n*s._02,1*s._10+0*s._11+n*s._12,1*s._20+0*s._21+n*s._22,0*s._00+1*s._01+i*s._02,0*s._10+1*s._11+i*s._12,0*s._20+1*s._21+i*s._22,0*s._00+0*s._01+1*s._02,0*s._10+0*s._11+1*s._12,0*s._20+0*s._21+1*s._22)},translate:function(e,t){var i,n;n=e,i=t;var s=this.transformations[this.transformations.length-1],r=new D(1*s._00+0*s._01+n*s._02,1*s._10+0*s._11+n*s._12,1*s._20+0*s._21+n*s._22,0*s._00+1*s._01+i*s._02,0*s._10+1*s._11+i*s._12,0*s._20+1*s._21+i*s._22,0*s._00+0*s._01+1*s._02,0*s._10+0*s._11+1*s._12,0*s._20+0*s._21+1*s._22);this.setTransformation(r);var a=this.transformations[this.transformations.length-1];a._00=r._00,a._10=r._10,a._20=r._20,a._01=r._01,a._11=r._11,a._21=r._21,a._02=r._02,a._12=r._12,a._22=r._22},pushTranslation:function(e,t){var i,n;n=e,i=t;var s=this.transformations[this.transformations.length-1];this.pushTransformation(new D(1*s._00+0*s._01+n*s._02,1*s._10+0*s._11+n*s._12,1*s._20+0*s._21+n*s._22,0*s._00+1*s._01+i*s._02,0*s._10+1*s._11+i*s._12,0*s._20+1*s._21+i*s._22,0*s._00+0*s._01+1*s._02,0*s._10+0*s._11+1*s._12,0*s._20+0*s._21+1*s._22))},rotation:function(e,t,i){var n,s,r,a,o,l,_,h,u,c,d,f,g,m,p,v,y,b,w,x,S,B;w=t,b=i;var T,k,I=Math.cos(e);S=-Math.sin(e);u=1*(y=1*I+0*(B=Math.sin(e))+0*w)+0*(m=1*S+0*(x=Math.cos(e))+0*w)+0*(d=0+1*w),l=0*y+1*m+0*d,r=y*(k=-t)+m*(T=-i)+1*d,h=1*(v=0*I+1*B+0*b)+0*(g=0*S+1*x+0*b)+0*(c=0+1*b),o=0*v+1*g+0*c,s=v*k+g*T+1*c,_=1*(p=0*I+0*B+0)+0*(f=0*S+0*x+0)+0,a=0*p+1*f+0,n=p*k+f*T+1;var A=this.transformations[this.transformations.length-1];return new D(u*A._00+l*A._01+r*A._02,u*A._10+l*A._11+r*A._12,u*A._20+l*A._21+r*A._22,h*A._00+o*A._01+s*A._02,h*A._10+o*A._11+s*A._12,h*A._20+o*A._21+s*A._22,_*A._00+a*A._01+n*A._02,_*A._10+a*A._11+n*A._12,_*A._20+a*A._21+n*A._22)},rotate:function(e,t,i){var n,s,r,a,o,l,_,h,u,c,d,f,g,m,p,v,y,b,w,x,S,B,T,k,I,A,D,C,P,N,E;C=t,D=i;var R,L,M=Math.cos(e);N=-Math.sin(e);b=1*(A=1*M+0*(E=Math.sin(e))+0*C)+0*(T=1*N+0*(P=Math.cos(e))+0*C)+0*(x=0+1*C),p=0*A+1*T+0*x,f=A*(L=-t)+T*(R=-i)+1*x,y=1*(I=0*M+1*E+0*D)+0*(B=0*N+1*P+0*D)+0*(w=0+1*D),m=0*I+1*B+0*w,d=I*L+B*R+1*w,v=1*(k=0*M+0*E+0)+0*(S=0*N+0*P+0)+0,g=0*k+1*S+0,c=k*L+S*R+1;var F=this.transformations[this.transformations.length-1];u=b*F._00+p*F._01+f*F._02,l=b*F._10+p*F._11+f*F._12,r=b*F._20+p*F._21+f*F._22,h=y*F._00+m*F._01+d*F._02,o=y*F._10+m*F._11+d*F._12,s=y*F._20+m*F._21+d*F._22,_=v*F._00+g*F._01+c*F._02,a=v*F._10+g*F._11+c*F._12,n=v*F._20+g*F._21+c*F._22,this.transformations[this.transformations.length-1]._00=u,this.transformations[this.transformations.length-1]._01=h,this.transformations[this.transformations.length-1]._02=_,this.transformations[this.transformations.length-1]._10=l,this.transformations[this.transformations.length-1]._11=o,this.transformations[this.transformations.length-1]._12=a,this.transformations[this.transformations.length-1]._20=r,this.transformations[this.transformations.length-1]._21=s,this.transformations[this.transformations.length-1]._22=n},pushRotation:function(e,t,i){var n,s,r,a,o,l,_,h,u,c,d,f,g,m,p,v,y,b,w,x,S,B;w=t,b=i;var T,k,I=Math.cos(e);S=-Math.sin(e);u=1*(y=1*I+0*(B=Math.sin(e))+0*w)+0*(m=1*S+0*(x=Math.cos(e))+0*w)+0*(d=0+1*w),l=0*y+1*m+0*d,r=y*(k=-t)+m*(T=-i)+1*d,h=1*(v=0*I+1*B+0*b)+0*(g=0*S+1*x+0*b)+0*(c=0+1*b),o=0*v+1*g+0*c,s=v*k+g*T+1*c,_=1*(p=0*I+0*B+0)+0*(f=0*S+0*x+0)+0,a=0*p+1*f+0,n=p*k+f*T+1;var A=this.transformations[this.transformations.length-1];this.pushTransformation(new D(u*A._00+l*A._01+r*A._02,u*A._10+l*A._11+r*A._12,u*A._20+l*A._21+r*A._22,h*A._00+o*A._01+s*A._02,h*A._10+o*A._11+s*A._12,h*A._20+o*A._21+s*A._22,_*A._00+a*A._01+n*A._02,_*A._10+a*A._11+n*A._12,_*A._20+a*A._21+n*A._22))},pushOpacity:function(e){this.setOpacity(e),this.opacities.push(e)},popOpacity:function(){var e=this.opacities.pop();return this.setOpacity(this.get_opacity()),e},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(e){return this.setOpacity(e),this.opacities[this.opacities.length-1]=e},scissor:function(e,t,i,n){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(e){return this.setPipeline(e),this.pipe=e},transformations:null,opacities:null,myFontSize:null,setTransformation:function(e){},setOpacity:function(e){},setPipeline:function(e){},__class__:yi,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline",set_opacity:"set_opacity",get_opacity:"get_opacity",set_transformation:"set_transformation",get_transformation:"get_transformation",set_fontGlyphs:"set_fontGlyphs",get_fontGlyphs:"get_fontGlyphs",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_mipmapScaleQuality:"set_mipmapScaleQuality",get_mipmapScaleQuality:"get_mipmapScaleQuality",set_imageScaleQuality:"set_imageScaleQuality",get_imageScaleQuality:"get_imageScaleQuality"}};var bi=function(e){this.canvas=e};(i["kha.graphics2.Graphics1"]=bi).__name__=!0,bi.__interfaces__=[vi],bi.prototype={canvas:null,texture:null,pixels:null,begin:function(){null==this.texture&&(this.texture=ct.create(this.canvas.get_width(),this.canvas.get_height(),cn.RGBA32,fn.ReadableUsage)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(e,t,i){this.pixels.setInt32(t*this.texture.get_realWidth()*4+4*e,gt.fromBytes(255&i,(65280&i)>>>8,(16711680&i)>>>16,i>>>24))},__class__:bi};var wi=function(){};(i["kha.graphics2.GraphicsExtension"]=wi).__name__=!0,wi.drawArc=function(e,t,i,n,s,r,a,o,l){if(null==l&&(l=0),null==o&&(o=!1),null==a&&(a=1),null==F.gl)return n-=a/2,void e.drawArc(t,i,n,s,r,a,o);s%=2*Math.PI,r%=2*Math.PI,o?s<r&&(r-=2*Math.PI):r<s&&(r+=2*Math.PI),l<=0&&(l=Math.floor(10*Math.sqrt(n)));for(var _=(r-s)/l,h=Math.cos(_),u=Math.sin(_),c=Math.cos(s)*n,d=Math.sin(s)*n,f=0,g=l;f<g;){f++;var m=c+t,p=d+i,v=c;c=h*c-u*d,d=h*d+u*v,e.drawLine(m,p,c+t,d+i,a)}},wi.fillArc=function(e,t,i,n,s,r,a,o){if(null==o&&(o=0),null==a&&(a=!1),null!=F.gl){s%=2*Math.PI,r%=2*Math.PI,a?s<r&&(r-=2*Math.PI):r<s&&(r+=2*Math.PI),o<=0&&(o=Math.floor(10*Math.sqrt(n)));for(var l=(r-s)/o,_=Math.cos(l),h=Math.sin(l),u=Math.cos(s)*n,c=Math.sin(s)*n,d=u+t,f=c+i,g=0,m=o;g<m;){g++;var p=u+t,v=c+i,y=u;u=_*u-h*c,c=_*c+h*y,e.fillTriangle(p,v,u+t,c+i,d,f)}}else{e.fillArc(t,i,n,s,r,a)}},wi.drawCircle=function(e,t,i,n,s,r){if(null==r&&(r=0),null==s&&(s=1),null==F.gl)return n-=s/2,void e.drawCircle(t,i,n,s);r<=0&&(r=Math.floor(10*Math.sqrt(n)));for(var a=2*Math.PI/r,o=Math.cos(a),l=Math.sin(a),_=n,h=0,u=0,c=r;u<c;){u++;var d=_+t,f=h+i,g=_;_=o*_-l*h,h=o*h+l*g,e.drawLine(d,f,_+t,h+i,s)}},wi.fillCircle=function(e,t,i,n,s){if(null==s&&(s=0),null!=F.gl){s<=0&&(s=Math.floor(10*Math.sqrt(n)));for(var r=2*Math.PI/s,a=Math.cos(r),o=Math.sin(r),l=n,_=0,h=0,u=s;h<u;){h++;var c=l+t,d=_+i,f=l;l=a*l-o*_,_=a*_+o*f,e.fillTriangle(c,d,l+t,_+i,t,i)}}else{e.fillCircle(t,i,n)}},wi.drawPolygon=function(e,t,i,n,s){null==s&&(s=1);for(var r=$.iter(n),a=r.next(),o=a;r.hasNext();){var l=r.next();e.drawLine(o.x+t,o.y+i,l.x+t,l.y+i,s),o=l}e.drawLine(o.x+t,o.y+i,a.x+t,a.y+i,s)},wi.fillPolygon=function(e,t,i,n){var s=$.iter(n);if(s.hasNext()){var r=s.next();if(s.hasNext())for(var a=s.next();s.hasNext();){var o=s.next();e.fillTriangle(r.x+t,r.y+i,a.x+t,a.y+i,o.x+t,o.y+i),a=o}}},wi.drawCubicBezier=function(e,t,i,n,s){var r;null==s&&(s=1),null==n&&(n=20);for(var a,o=wi.calculateCubicBezierPoint(0,t,i),l=1,_=n+1;l<_;){r=l++/n,a=wi.calculateCubicBezierPoint(r,t,i),e.drawLine(o[0],o[1],a[0],a[1],s),o=a}},wi.drawCubicBezierPath=function(e,t,i,n,s){null==s&&(s=1),null==n&&(n=20);for(var r,a=0,o=null,l=null;a<t.length-3;){0==a&&(o=wi.calculateCubicBezierPoint(0,[t[a],t[a+1],t[a+2],t[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]));for(var _=1,h=n+1;_<h;){r=_++/n,l=wi.calculateCubicBezierPoint(r,[t[a],t[a+1],t[a+2],t[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]),e.drawLine(o[0],o[1],l[0],l[1],s),o=l}a+=3}},wi.calculateCubicBezierPoint=function(e,t,i){var n=1-e,s=e*e,r=n*n,a=r*n,o=s*e,l=[a*t[0],a*i[0]];return l[0]+=3*r*e*t[1],l[1]+=3*r*e*i[1],l[0]+=3*n*s*t[2],l[1]+=3*n*s*i[2],l[0]+=o*t[3],l[1]+=o*i[3],l},wi.drawAlignedString=function(e,t,i,n,s,r){var a=Ai.__cast(e.get_font(),xt)._get(e.get_fontSize(),e.get_fontGlyphs()),o=0;if(s==xi.TextCenter||s==xi.TextRight){var l=a.stringWidth(t);o=s==xi.TextCenter?.5*-l:-l}var _=0;if(r==Bi.TextMiddle||r==Bi.TextBottom){var h=a.getHeight();_=r==Bi.TextMiddle?.5*-h:-h}e.drawString(t,i+o,n+_)},wi.drawAlignedCharacters=function(e,t,i,n,s,r,a,o){var l=Ai.__cast(e.get_font(),xt)._get(e.get_fontSize(),e.get_fontGlyphs()),_=0;if(a==xi.TextCenter||a==xi.TextRight){var h=l.charactersWidth(t,i,n);_=a==xi.TextCenter?.5*-h:-h}var u=0;if(o==Bi.TextMiddle||o==Bi.TextBottom){var c=l.getHeight();u=o==Bi.TextMiddle?.5*-c:-c}e.drawCharacters(t,i,n,s+_,r+u)};var xi=i["kha.graphics2.HorTextAlignment"]={__ename__:!0,__constructs__:["TextLeft","TextCenter","TextRight"]};xi.TextLeft=["TextLeft",0],xi.TextLeft.toString=n,(xi.TextLeft.__enum__=xi).TextCenter=["TextCenter",1],xi.TextCenter.toString=n,(xi.TextCenter.__enum__=xi).TextRight=["TextRight",2],xi.TextRight.toString=n,xi.TextRight.__enum__=xi;var Si=i["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"]};Si.Low=["Low",0],Si.Low.toString=n,(Si.Low.__enum__=Si).High=["High",1],Si.High.toString=n,Si.High.__enum__=Si;var Bi=i["kha.graphics2.VerTextAlignment"]={__ename__:!0,__constructs__:["TextTop","TextMiddle","TextBottom"]};Bi.TextTop=["TextTop",0],Bi.TextTop.toString=n,(Bi.TextTop.__enum__=Bi).TextMiddle=["TextMiddle",1],Bi.TextMiddle.toString=n,(Bi.TextMiddle.__enum__=Bi).TextBottom=["TextBottom",2],Bi.TextBottom.toString=n,Bi.TextBottom.__enum__=Bi;var Ti=function(){};(i["kha.graphics2.truetype.VectorOfIntPointer"]=Ti).__name__=!0,Ti.prototype={value:null,__class__:Ti};var ki=function(){};(i["kha.graphics2.truetype.Stbtt_temp_rect"]=ki).__name__=!0,ki.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ki};var Di=function(){};(i["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Di).__name__=!0,Di.prototype={advanceWidth:null,leftSideBearing:null,__class__:Di};var Ci=function(){};(i["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Ci).__name__=!0,Ci.prototype={ascent:null,descent:null,lineGap:null,__class__:Ci};var Pi=function(){};(i["kha.graphics2.truetype.Stbtt_temp_region"]=Pi).__name__=!0,Pi.prototype={width:null,height:null,xoff:null,yoff:null,__class__:Pi};var Ni=function(){};(i["kha.graphics2.truetype.Stbtt_bakedchar"]=Ni).__name__=!0,Ni.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Ni};var Ei=function(){};(i["kha.graphics2.truetype.Stbtt_aligned_quad"]=Ei).__name__=!0,Ei.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:Ei};var Ri=function(){};(i["kha.graphics2.truetype.Stbtt_packedchar"]=Ri).__name__=!0,Ri.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:Ri};var Li=function(){};(i["kha.graphics2.truetype.Stbtt_pack_range"]=Li).__name__=!0,Li.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:Li};var Mi=function(){};(i["kha.graphics2.truetype.Stbtt_pack_context"]=Mi).__name__=!0,Mi.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:Mi};var Fi=function(){};(i["kha.graphics2.truetype.Stbtt_fontinfo"]=Fi).__name__=!0,Fi.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:Fi};var Vi=function(){};(i["kha.graphics2.truetype.Stbtt_vertex"]=Vi).__name__=!0,Vi.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:Vi};var Oi=function(){};(i["kha.graphics2.truetype.Stbtt__bitmap"]=Oi).__name__=!0,Oi.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:Oi};var Gi=function(){};(i["kha.graphics2.truetype.Stbtt__edge"]=Gi).__name__=!0,Gi.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:Gi};var Ui=function(){};(i["kha.graphics2.truetype.Stbtt__active_edge"]=Ui).__name__=!0,Ui.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Ui};var Wi=function(){};(i["kha.graphics2.truetype.Stbtt__point"]=Wi).__name__=!0,Wi.prototype={x:null,y:null,__class__:Wi};var zi=function(){};(i["kha.graphics2.truetype.StbTruetype"]=zi).__name__=!0,zi.STBTT_assert=function(e){if(!e)throw new dt("Error")},zi.STBTT_POINT_SIZE=function(e){return-e},zi.ttBYTE=function(e,t){return null==t&&(t=0),e.readU8(t)},zi.ttCHAR=function(e,t){null==t&&(t=0);var i=e.readU8(t);return 128<=i?i-256:i},zi.ttUSHORT=function(e,t){null==t&&(t=0);var i=e.readU8(t);return e.readU8(t+1)|i<<8},zi.ttSHORT=function(e,t){null==t&&(t=0);var i=e.readU8(t),n=e.readU8(t+1)|i<<8;return 0!=(32768&n)?n-65536:n},zi.ttULONG=function(e,t){null==t&&(t=0);var i=e.readU8(t),n=e.readU8(t+1),s=e.readU8(t+2);return e.readU8(t+3)|s<<8|n<<16|i<<24},zi.ttLONG=function(e,t){null==t&&(t=0);var i=e.readU8(t),n=e.readU8(t+1),s=e.readU8(t+2);return e.readU8(t+3)|s<<8|n<<16|i<<24},zi.ttFixed=function(e,t){null==t&&(t=0);var i=e.readU8(t),n=e.readU8(t+1),s=e.readU8(t+2);return e.readU8(t+3)|s<<8|n<<16|i<<24},zi.stbtt_tag4=function(e,t,i,n,s,r){return e.readU8(t)==i&&e.readU8(t+1)==n&&e.readU8(t+2)==s&&e.readU8(t+3)==r},zi.stbtt_tag=function(e,t,i){var n=$.cca(i,0),s=$.cca(i,1),r=$.cca(i,2),a=$.cca(i,3);return e.readU8(t)==n&&e.readU8(t+1)==s&&e.readU8(t+2)==r&&e.readU8(t+3)==a},zi.stbtt__isfont=function(e){var t=$.cca("1",0);if(e.readU8(0)==t&&0==e.readU8(1)&&0==e.readU8(2)&&0==e.readU8(3))return!0;var i=$.cca("typ1",0),n=$.cca("typ1",1),s=$.cca("typ1",2),r=$.cca("typ1",3);if(e.readU8(0)==i&&e.readU8(1)==n&&e.readU8(2)==s&&e.readU8(3)==r)return!0;var a=$.cca("OTTO",0),o=$.cca("OTTO",1),l=$.cca("OTTO",2),_=$.cca("OTTO",3);return e.readU8(0)==a&&e.readU8(1)==o&&e.readU8(2)==l&&e.readU8(3)==_||0==e.readU8(0)&&1==e.readU8(1)&&0==e.readU8(2)&&0==e.readU8(3)},zi.stbtt__find_table=function(e,t,i){for(var n=t+4,s=e.readU8(n),r=t+12,a=0,o=e.readU8(n+1)|s<<8;a<o;){var l=r+16*a++,_=$.cca(i,0),h=$.cca(i,1),u=$.cca(i,2),c=$.cca(i,3);if(e.readU8(l)==_&&e.readU8(l+1)==h&&e.readU8(l+2)==u&&e.readU8(l+3)==c){var d=l+8,f=e.readU8(d),g=e.readU8(d+1),m=e.readU8(d+2);return e.readU8(d+3)|m<<8|g<<16|f<<24}}return 0},zi.stbtt_GetFontOffsetForIndex=function(e,t){if(zi.stbtt__isfont(e))return 0==t?0:-1;var i=$.cca("ttcf",0),n=$.cca("ttcf",1),s=$.cca("ttcf",2),r=$.cca("ttcf",3);if(e.readU8(0)==i&&e.readU8(1)==n&&e.readU8(2)==s&&e.readU8(3)==r){var a,o=e.readU8(4),l=e.readU8(5),_=e.readU8(6);if(65536!=(e.readU8(7)|_<<8|l<<16|o<<24)){var h=e.readU8(4),u=e.readU8(5),c=e.readU8(6);a=131072==(e.readU8(7)|c<<8|u<<16|h<<24)}else a=!0;if(a){var d=e.readU8(8),f=e.readU8(9),g=e.readU8(10);if((e.readU8(11)|g<<8|f<<16|d<<24)<=t)return-1;var m=12+4*t,p=e.readU8(m),v=e.readU8(m+1),y=e.readU8(m+2);return e.readU8(m+3)|y<<8|v<<16|p<<24}}return-1},zi.stbtt_InitFont=function(e,t,i){var n,s,r;if(e.data=t,e.fontstart=i,n=zi.stbtt__find_table(t,i,"cmap"),e.loca=zi.stbtt__find_table(t,i,"loca"),e.head=zi.stbtt__find_table(t,i,"head"),e.glyf=zi.stbtt__find_table(t,i,"glyf"),e.hhea=zi.stbtt__find_table(t,i,"hhea"),e.hmtx=zi.stbtt__find_table(t,i,"hmtx"),e.kern=zi.stbtt__find_table(t,i,"kern"),0==n||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;if(0!=(s=zi.stbtt__find_table(t,i,"maxp"))){var a=s+4,o=t.readU8(a),l=t.readU8(a+1);e.numGlyphs=l|o<<8}else e.numGlyphs=65535;var _=n+2,h=t.readU8(_);r=t.readU8(_+1)|h<<8;for(var u=e.index_map=0,c=r;u<c;){var d=n+4+8*u++,f=t.readU8(d);switch(t.readU8(d+1)|f<<8){case 0:var g=d+4,m=t.readU8(g),p=t.readU8(g+1),v=t.readU8(g+2),y=t.readU8(g+3);e.index_map=n+(y|v<<8|p<<16|m<<24);break;case 3:var b=d+2,w=t.readU8(b);switch(t.readU8(b+1)|w<<8){case 1:case 10:var x=d+4,S=t.readU8(x),B=t.readU8(x+1),T=t.readU8(x+2),k=t.readU8(x+3);e.index_map=n+(k|T<<8|B<<16|S<<24)}}}if(0==e.index_map)return!1;var I=e.head+50,A=t.readU8(I),D=t.readU8(I+1);return e.indexToLocFormat=D|A<<8,!0},zi.stbtt_FindGlyphIndex=function(e,t){var i=e.data,n=e.index_map,s=i.readU8(n),r=i.readU8(n+1)|s<<8;if(0==r){var a=n+2,o=i.readU8(a);return t<(i.readU8(a+1)|o<<8)-6?i.readU8(n+6+t):0}if(6==r){var l=n+6,_=i.readU8(l),h=i.readU8(l+1)|_<<8,u=n+8,c=i.readU8(u),d=i.readU8(u+1);if(h<=t&&t<h+(d|c<<8)){var f=n+10+2*(t-h),g=i.readU8(f);return i.readU8(f+1)|g<<8}return 0}if(2==r)throw new dt("Error");if(4==r){var m=n+6,p=i.readU8(m),v=(i.readU8(m+1)|p<<8)>>1,y=n+8,b=i.readU8(y),w=(i.readU8(y+1)|b<<8)>>1,x=n+10,S=i.readU8(x),B=i.readU8(x+1)|S<<8,T=n+12,k=i.readU8(T),I=(i.readU8(T+1)|k<<8)>>1,A=n+14,D=A;if(65535<t)return 0;var C,P,N=D+2*I,E=i.readU8(N);for((i.readU8(N+1)|E<<8)<=t&&(D+=2*I),D-=2;0!=B;){var R=D+2*(w>>=1),L=i.readU8(R);(i.readU8(R+1)|L<<8)<t&&(D+=2*w),--B}var M=(D+=2)-A>>1,F=A+2*M,V=i.readU8(F);if((i.readU8(F+1)|V<<8)<t)throw new dt("Error");var O=n+14+2*v+2+2*M,G=i.readU8(O);if(t<(P=i.readU8(O+1)|G<<8))return 0;var U=n+14+6*v+2+2*M,W=i.readU8(U);if(0==(C=i.readU8(U+1)|W<<8)){var z=n+14+4*v+2+2*M,H=i.readU8(z),Z=i.readU8(z+1)|H<<8;return t+(0!=(32768&Z)?Z-65536:Z)}var j=C+2*(t-P)+n+14+6*v+2+2*M,K=i.readU8(j);return i.readU8(j+1)|K<<8}if(12==r||13==r){var X,Y,q=n+12,Q=i.readU8(q),J=i.readU8(q+1),$=i.readU8(q+2);for(X=0,Y=i.readU8(q+3)|$<<8|J<<16|Q<<24;X<Y;){var ee=X+(Y-X>>1),te=n+16+12*ee,ie=i.readU8(te),ne=i.readU8(te+1),se=i.readU8(te+2),re=i.readU8(te+3)|se<<8|ne<<16|ie<<24,ae=n+16+12*ee+4,oe=i.readU8(ae),le=i.readU8(ae+1),_e=i.readU8(ae+2),he=i.readU8(ae+3);if(t<re)Y=ee;else{if(!((he|_e<<8|le<<16|oe<<24)<t)){var ue=n+16+12*ee+8,ce=i.readU8(ue),de=i.readU8(ue+1),fe=i.readU8(ue+2),ge=i.readU8(ue+3)|fe<<8|de<<16|ce<<24;return 12==r?ge+t-re:ge}X=ee+1}}return 0}throw new dt("Error")},zi.stbtt_GetCodepointShape=function(e,t){return zi.stbtt_GetGlyphShape(e,zi.stbtt_FindGlyphIndex(e,t))},zi.stbtt_setvertex=function(e,t,i,n,s,r){e.type=t,e.x=i,e.y=n,e.cx=s,e.cy=r},zi.stbtt__GetGlyfOffset=function(e,t){var i,n;if(t>=e.numGlyphs)return-1;if(2<=e.indexToLocFormat)return-1;if(0==e.indexToLocFormat){var s=e.glyf,r=e.data,a=e.loca+2*t,o=r.readU8(a);i=s+2*(r.readU8(a+1)|o<<8);var l=e.glyf,_=e.data,h=e.loca+2*t+2,u=_.readU8(h);n=l+2*(_.readU8(h+1)|u<<8)}else{var c=e.glyf,d=e.data,f=e.loca+4*t,g=d.readU8(f),m=d.readU8(f+1),p=d.readU8(f+2);i=c+(d.readU8(f+3)|p<<8|m<<16|g<<24);var v=e.glyf,y=e.data,b=e.loca+4*t+4,w=y.readU8(b),x=y.readU8(b+1),S=y.readU8(b+2);n=v+(y.readU8(b+3)|S<<8|x<<16|w<<24)}return i==n?-1:i},zi.stbtt_GetGlyphBox=function(e,t,i){var n=zi.stbtt__GetGlyfOffset(e,t);if(n<0)return!1;var s=e.data,r=n+2,a=s.readU8(r),o=s.readU8(r+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=e.data,_=n+4,h=l.readU8(_),u=l.readU8(_+1)|h<<8;i.y0=0!=(32768&u)?u-65536:u;var c=e.data,d=n+6,f=c.readU8(d),g=c.readU8(d+1)|f<<8;i.x1=0!=(32768&g)?g-65536:g;var m=e.data,p=n+8,v=m.readU8(p),y=m.readU8(p+1)|v<<8;return i.y1=0!=(32768&y)?y-65536:y,!0},zi.stbtt_GetCodepointBox=function(e,t,i){return zi.stbtt_GetGlyphBox(e,zi.stbtt_FindGlyphIndex(e,t),i)},zi.stbtt_IsGlyphEmpty=function(e,t){var i=zi.stbtt__GetGlyfOffset(e,t);if(i<0)return!0;var n=e.data,s=n.readU8(i),r=n.readU8(i+1)|s<<8;return 0==(0!=(32768&r)?r-65536:r)},zi.stbtt__close_shape=function(e,t,i,n,s,r,a,o,l,_){return n?(i&&zi.stbtt_setvertex(e[t++],3,l+a>>1,_+o>>1,l,_),zi.stbtt_setvertex(e[t++],3,s,r,a,o)):i?zi.stbtt_setvertex(e[t++],3,s,r,l,_):zi.stbtt_setvertex(e[t++],2,s,r,0,0),t},zi.copyVertices=function(e,t,i,n){for(var s=0,r=n;s<r;){var a=s++;t[i+a]=e[a]}},zi.stbtt_GetGlyphShape=function(e,t){var i,n,s=e.data,r=null,a=0,o=zi.stbtt__GetGlyfOffset(e,t);if(o<0)return null;var l=s.readU8(o),_=s.readU8(o+1)|l<<8;if(0<(i=0!=(32768&_)?_-65536:_)){var h,u,c,d,f,g,m,p,v,y,b,w,x,S,B=0,T=0,k=0,I=!1,A=!1,D=0;n=s.sub(o+10,s.get_length()-(o+10));var C=o+10+2*i,P=s.readU8(C);u=s.readU8(C+1)|P<<8,S=s.sub(o+10+2*i+2+u,s.get_length()-(o+10+2*i+2+u));var N=2*i-2,E=n.readU8(N);if(c=(d=1+(n.readU8(N+1)|E<<8))+2*i,null==(r=new Array(c)))return null;for(var R=0,L=r.length;R<L;){r[R++]=new Vi}f=c-d;for(var M=h=k=0,F=d;M<F;){var V=M++;0==h?0!=(8&(B=S.readU8(D++)))&&(h=S.readU8(D++)):--h,r[f+V].type=B}for(var O=g=0,G=d;O<G;){var U=O++;if(0!=(2&(B=r[f+U].type))){var W=S.readU8(D++);g+=0!=(16&B)?W:-W}else if(0==(16&B)){var z=S.readU8(D),H=S.readU8(D+1)|z<<8;g+=0!=(32768&H)?H-65536:H,D+=2}r[f+U].x=g}for(var Z=m=0,j=d;Z<j;){var K=Z++;if(0!=(4&(B=r[f+K].type))){var X=S.readU8(D++);m+=0!=(32&B)?X:-X}else if(0==(32&B)){var Y=S.readU8(D),q=S.readU8(D+1)|Y<<8;m+=0!=(32768&q)?q-65536:q,D+=2}r[f+K].y=m}y=b=p=v=w=x=a=0;for(var Q=0;Q<d;){if(B=r[f+Q].type,g=r[f+Q].x,m=r[f+Q].y,k==Q){0!=Q&&(a=zi.stbtt__close_shape(r,a,I,A,y,b,w,x,p,v)),(A=0==(1&B))?(w=g,x=m,0==(1&r[f+Q+1].type)?(y=g+r[f+Q+1].x>>1,b=m+r[f+Q+1].y>>1):(y=r[f+Q+1].x,b=r[f+Q+1].y,++Q)):(y=g,b=m),zi.stbtt_setvertex(r[a++],1,y,b,0,0),I=!1;var J=2*T,$=n.readU8(J);k=1+(n.readU8(J+1)|$<<8),++T}else 0==(1&B)?(I&&zi.stbtt_setvertex(r[a++],3,p+g>>1,v+m>>1,p,v),p=g,v=m,I=!0):(I?zi.stbtt_setvertex(r[a++],3,g,m,p,v):zi.stbtt_setvertex(r[a++],2,g,m,0,0),I=!1);++Q}a=zi.stbtt__close_shape(r,a,I,A,y,b,w,x,p,v)}else if(-1==i){var ee=1,te=s.sub(o+10,s.get_length()-(o+10)),ie=0;for(a=0,r=null;0!=ee;){var ne,se,re,ae,oe,le=0,_e=null,he=1,ue=0,ce=0,de=1,fe=0,ge=0,me=te.readU8(ie),pe=te.readU8(ie+1)|me<<8;ne=0!=(32768&pe)?pe-65536:pe,ie+=2;var ve=te.readU8(ie),ye=te.readU8(ie+1)|ve<<8;if(se=0!=(32768&ye)?ye-65536:ye,ie+=2,0==(2&ne))throw new dt("Error");if(0!=(1&ne)){var be=te.readU8(ie),we=te.readU8(ie+1)|be<<8;fe=0!=(32768&we)?we-65536:we,ie+=2;var xe=te.readU8(ie),Se=te.readU8(ie+1)|xe<<8;ge=0!=(32768&Se)?Se-65536:Se,ie+=2}else{var Be=te.readU8(ie);fe=128<=Be?Be-256:Be,++ie;var Te=te.readU8(ie);ge=128<=Te?Te-256:Te,++ie}if(0!=(8&ne)){var ke=te.readU8(ie),Ie=te.readU8(ie+1)|ke<<8;he=de=(0!=(32768&Ie)?Ie-65536:Ie)/16384,ie+=2,ue=ce=0}else if(0!=(64&ne)){var Ae=te.readU8(ie),De=te.readU8(ie+1)|Ae<<8;he=(0!=(32768&De)?De-65536:De)/16384,ie+=2,ue=ce=0;var Ce=te.readU8(ie),Pe=te.readU8(ie+1)|Ce<<8;de=(0!=(32768&Pe)?Pe-65536:Pe)/16384,ie+=2}else if(0!=(128&ne)){var Ne=te.readU8(ie),Ee=te.readU8(ie+1)|Ne<<8;he=(0!=(32768&Ee)?Ee-65536:Ee)/16384,ie+=2;var Re=te.readU8(ie),Le=te.readU8(ie+1)|Re<<8;ue=(0!=(32768&Le)?Le-65536:Le)/16384,ie+=2;var Me=te.readU8(ie),Fe=te.readU8(ie+1)|Me<<8;ce=(0!=(32768&Fe)?Fe-65536:Fe)/16384,ie+=2;var Ve=te.readU8(ie),Oe=te.readU8(ie+1)|Ve<<8;de=(0!=(32768&Oe)?Oe-65536:Oe)/16384,ie+=2}if(ae=Math.sqrt(he*he+ue*ue),oe=Math.sqrt(ce*ce+de*de),0<(le=null==(re=zi.stbtt_GetGlyphShape(e,se))?0:re.length)){for(var Ge=0,Ue=le;Ge<Ue;){var We,ze,He=re[Ge++];We=He.x,ze=He.y,He.x=ae*(he*We+ce*ze+fe)|0,He.y=oe*(ue*We+de*ze+ge)|0,We=He.cx,ze=He.cy,He.cx=ae*(he*We+ce*ze+fe)|0,He.cy=oe*(ue*We+de*ze+ge)|0}if(null==(_e=new Array(a+le)))return null;0<a&&zi.copyVertices(r,_e,0,a),zi.copyVertices(re,_e,a,le),r=_e,a+=le}ee=32&ne}}else if(i<0)throw new dt("Error");if(null==r)return null;if(r.length<a)throw new dt("Error");if(a<r.length){var Ze=new Array(a);return zi.copyVertices(r,Ze,0,a),Ze}return r},zi.stbtt_GetGlyphHMetrics=function(e,t){var i=e.data,n=e.hhea+34,s=i.readU8(n),r=i.readU8(n+1)|s<<8,a=new Di;if(t<r){var o=e.data,l=e.hmtx+4*t,_=o.readU8(l),h=o.readU8(l+1)|_<<8;a.advanceWidth=0!=(32768&h)?h-65536:h;var u=e.data,c=e.hmtx+4*t+2,d=u.readU8(c),f=u.readU8(c+1)|d<<8;a.leftSideBearing=0!=(32768&f)?f-65536:f}else{var g=e.data,m=e.hmtx+4*(r-1),p=g.readU8(m),v=g.readU8(m+1)|p<<8;a.advanceWidth=0!=(32768&v)?v-65536:v;var y=e.data,b=e.hmtx+4*r+2*(t-r),w=y.readU8(b),x=y.readU8(b+1)|w<<8;a.leftSideBearing=0!=(32768&x)?x-65536:x}return a},zi.stbtt_GetGlyphKernAdvance=function(e,t,i){var n,s,r,a,o,l=e.data.sub(e.kern,e.data.get_length()-e.kern);if(0==e.kern)return 0;var _=l.readU8(2);if((l.readU8(3)|_<<8)<1)return 0;var h=l.readU8(8);if(1!=(l.readU8(9)|h<<8))return 0;r=0;var u=l.readU8(10);for(a=(l.readU8(11)|u<<8)-1,n=t<<16|i;r<=a;){var c=18+6*(o=r+a>>1),d=l.readU8(c),f=l.readU8(c+1),g=l.readU8(c+2);if(n<(s=l.readU8(c+3)|g<<8|f<<16|d<<24))a=o-1;else{if(!(s<n)){var m=22+6*o,p=l.readU8(m),v=l.readU8(m+1)|p<<8;return 0!=(32768&v)?v-65536:v}r=o+1}}return 0},zi.stbtt_GetCodepointKernAdvance=function(e,t,i){return 0==e.kern?0:zi.stbtt_GetGlyphKernAdvance(e,zi.stbtt_FindGlyphIndex(e,t),zi.stbtt_FindGlyphIndex(e,i))},zi.stbtt_GetCodepointHMetrics=function(e,t){return zi.stbtt_GetGlyphHMetrics(e,zi.stbtt_FindGlyphIndex(e,t))},zi.stbtt_GetFontVMetrics=function(e){var t=new Ci,i=e.data,n=e.hhea+4,s=i.readU8(n),r=i.readU8(n+1)|s<<8;t.ascent=0!=(32768&r)?r-65536:r;var a=e.data,o=e.hhea+6,l=a.readU8(o),_=a.readU8(o+1)|l<<8;t.descent=0!=(32768&_)?_-65536:_;var h=e.data,u=e.hhea+8,c=h.readU8(u),d=h.readU8(u+1)|c<<8;return t.lineGap=0!=(32768&d)?d-65536:d,t},zi.stbtt_GetFontBoundingBox=function(e){var t=new ki,i=e.data,n=e.head+36,s=i.readU8(n),r=i.readU8(n+1)|s<<8;t.x0=0!=(32768&r)?r-65536:r;var a=e.data,o=e.head+38,l=a.readU8(o),_=a.readU8(o+1)|l<<8;t.y0=0!=(32768&_)?_-65536:_;var h=e.data,u=e.head+40,c=h.readU8(u),d=h.readU8(u+1)|c<<8;t.x1=0!=(32768&d)?d-65536:d;var f=e.data,g=e.head+42,m=f.readU8(g),p=f.readU8(g+1)|m<<8;return t.y1=0!=(32768&p)?p-65536:p,t},zi.stbtt_ScaleForPixelHeight=function(e,t){var i=e.data,n=e.hhea+4,s=i.readU8(n),r=i.readU8(n+1)|s<<8,a=e.data,o=e.hhea+6,l=a.readU8(o),_=a.readU8(o+1)|l<<8;return t/((0!=(32768&r)?r-65536:r)-(0!=(32768&_)?_-65536:_))},zi.stbtt_ScaleForMappingEmToPixels=function(e,t){var i=e.data,n=e.head+18,s=i.readU8(n);return t/(i.readU8(n+1)|s<<8)},zi.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,i,n,s,r){var a=new ki;if(zi.stbtt_GetGlyphBox(e,t,a)){var o=a.x0,l=a.x1,_=a.y0,h=a.y1;a.x0=Math.floor(o*i+s),a.y0=Math.floor(-h*n+r),a.x1=Math.ceil(l*i+s),a.y1=Math.ceil(-_*n+r)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},zi.stbtt_GetGlyphBitmapBox=function(e,t,i,n){return zi.stbtt_GetGlyphBitmapBoxSubpixel(e,t,i,n,0,0)},zi.stbtt_GetCodepointBitmapBoxSubpixel=function(e,t,i,n,s,r){return zi.stbtt_GetGlyphBitmapBoxSubpixel(e,zi.stbtt_FindGlyphIndex(e,t),i,n,s,r)},zi.stbtt_GetCodepointBitmapBox=function(e,t,i,n){return zi.stbtt_GetCodepointBitmapBoxSubpixel(e,t,i,n,0,0)},zi.stbtt__new_active=function(e,t,i,n){var s=new Ui,r=(e[t].x1-e[t].x0)/(e[t].y1-e[t].y0);return null==s||(s.fdx=r,s.fdy=0!=r?1/r:0,s.fx=e[t].x0+r*(n-e[t].y0),s.fx-=i,s.direction=e[t].invert?1:-1,s.sy=e[t].y0,s.ey=e[t].y1,s.next=null),s},zi.stbtt__handle_clipped_edge=function(e,t,i,n,s,r,a,o){if(r!=o){if(!(r<o))throw new dt("Error");if(!(n.sy<=n.ey))throw new dt("Error");if(!(r>n.ey||o<n.sy)){if(r<n.sy&&(s+=(a-s)*(n.sy-r)/(o-r),r=n.sy),o>n.ey&&(a+=(a-s)*(n.ey-o)/(o-r),o=n.ey),s==i){if(!(a<=i+1))throw new dt("Error")}else if(s==i+1){if(!(i<=a))throw new dt("Error")}else if(s<=i){if(!(a<=i))throw new dt("Error")}else if(i+1<=s){if(!(i+1<=a))throw new dt("Error")}else if(!(i<=a&&a<=i+1))throw new dt("Error");if(s<=i&&a<=i){var l=t+i,_=e;_[l]=_[l]+n.direction*(o-r)}else if(!(i+1<=s&&i+1<=a)){if(!(i<=s&&s<=i+1&&i<=a&&a<=i+1))throw new dt("Error");var h=t+i,u=e;u[h]=u[h]+n.direction*(o-r)*(1-(s-i+(a-i))/2)}}}},zi.stbtt__fill_active_edges_new=function(e,t,i,n,s,r){for(var a=r+1;null!=s;){if(!(s.ey>=r))throw new dt("Error");if(0==s.fdx){var o=s.fx;o<n&&(0<=o?(zi.stbtt__handle_clipped_edge(e,0,0|o,s,o,r,o,a),zi.stbtt__handle_clipped_edge(t,i-1,o+1|0,s,o,r,o,a)):zi.stbtt__handle_clipped_edge(t,i-1,0,s,o,r,o,a))}else{var l,_,h,u,c=s.fx,d=s.fdx,f=c+d,g=s.fdy;if(!(s.sy<=a&&s.ey>=r))throw new dt("Error");if(s.sy>r?(l=c+d*(s.sy-r),h=s.sy):(l=c,h=r),s.ey<a?(_=c+d*(s.ey-r),u=s.ey):(_=f,u=a),0<=l&&0<=_&&l<n&&_<n)if((0|l)==(0|_)){var m,p=0|l;if(m=u-h,!(0<=p&&p<n))throw new dt("Error");var v=p,y=e;y[v]=y[v]+s.direction*(1-(l-p+(_-p))/2)*m;var b=i+p,w=t;w[b]=w[b]+s.direction*m}else{var x,S,B,T,k,I,A;if(_<l)A=h=a-(h-r),h=u=a-(u-r),u=A,A=_,_=l,l=A,d=-d,g=-g,A=c,c=f,f=A;S=0|_,B=((x=0|l)+1-c)*g+r,I=(k=s.direction)*(B-h);var D=x,C=e;C[D]=C[D]+I*(1-(l-x+(x+1-x))/2),T=k*g;for(var P=x+1,N=S;P<N;){var E=P++,R=e;R[E]=R[E]+(I+T/2),I+=T}if(B+=g*(S-(x+1)),!(Math.abs(I)<=1.01))throw new dt("Error");var L=S,M=e;M[L]=M[L]+(I+k*(1-(S-S+(_-S))/2)*(u-B));var F=i+S,V=t;V[F]=V[F]+k*(u-h)}else for(var O=0,G=n;O<G;){var U,W,z=O++,H=r,Z=z,j=z+1,K=f,X=a;U=(z-c)/d+r,W=(z+1-c)/d+r,c<Z&&j<K?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,Z,U),zi.stbtt__handle_clipped_edge(e,0,z,s,Z,U,j,W),zi.stbtt__handle_clipped_edge(e,0,z,s,j,W,K,X)):K<Z&&j<c?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,j,W),zi.stbtt__handle_clipped_edge(e,0,z,s,j,W,Z,U),zi.stbtt__handle_clipped_edge(e,0,z,s,Z,U,K,X)):c<Z&&Z<K?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,Z,U),zi.stbtt__handle_clipped_edge(e,0,z,s,Z,U,K,X)):K<Z&&Z<c?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,Z,U),zi.stbtt__handle_clipped_edge(e,0,z,s,Z,U,K,X)):c<j&&j<K?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,j,W),zi.stbtt__handle_clipped_edge(e,0,z,s,j,W,K,X)):K<j&&j<c?(zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,j,W),zi.stbtt__handle_clipped_edge(e,0,z,s,j,W,K,X)):zi.stbtt__handle_clipped_edge(e,0,z,s,c,H,K,X)}}s=s.next}},zi.stbtt__rasterize_sorted_edges=function(e,t,i,n,s,r){var a,o,l,_,h=null,u=0,c=0;if(64<e.w){var d=2*e.w+1;o=new Array(d)}else{o=new Array(129)}for(l=o,_=e.w,a=r,t[c+i].y0=r+e.h+1;u<e.h;){var f,g,m=a+0,p=a+1;f=h,g=null;for(var v=0,y=e.w;v<y;){o[v++]=0}for(var b=0,w=e.w+1;b<w;){l[_+b++]=0}for(;null!=f;){var x=f;if(x.ey<=m){if(null==g?h=x.next:g.next=x.next,f=x.next,0==x.direction)throw new dt("Error");x.direction=0}else f=(g=f).next}for(;t[c].y0<=p;){if(t[c].y0!=t[c].y1){var S=zi.stbtt__new_active(t,c,s,m);if(!(S.ey>=m))throw new dt("Error");S.next=h,h=S}++c}null!=h&&zi.stbtt__fill_active_edges_new(o,l,_+1,e.w,h,m);for(var B=0,T=0,k=e.w;T<k;){var I,A,D=T++;B+=l[_+D],I=o[D]+B,255<(A=0|(I=255*Math.abs(I)+.5))&&(A=255),e.pixels.writeU8(e.pixels_offset+u*e.stride+D,A)}for(g=null,f=h;null!=f;){var C=f;C.fx+=C.fdx,f=(g=f).next}++a,++u}},zi.STBTT__COMPARE=function(e,t){return e.y0<t.y0},zi.stbtt__sort_edges_ins_sort=function(e,t){for(var i,n=1,s=t;n<s;){var r=n++,a=e[r],o=a;for(i=r;0<i;){var l=e[i-1];if(!zi.STBTT__COMPARE(o,l))break;e[i]=e[i-1],--i}r!=i&&(e[i]=a)}},zi.stbtt__sort_edges_quicksort=function(e,t,i){for(;12<i;){var n,s,r,a,o,l;if(r=i>>1,zi.STBTT__COMPARE(e[t],e[t+r])!=(s=zi.STBTT__COMPARE(e[t+r],e[t+i-1])))n=e[t+(l=zi.STBTT__COMPARE(e[t],e[t+i-1])==s?0:i-1)],e[t+l]=e[t+r],e[t+r]=n;for(n=e[t],e[t]=e[t+r],e[t+r]=n,o=i-(a=1);;){for(;zi.STBTT__COMPARE(e[t+a],e[t]);)++a;for(;zi.STBTT__COMPARE(e[t],e[t+o]);)--o;if(o<=a)break;n=e[t+a],e[t+a]=e[t+o],e[t+o]=n,++a,--o}o<i-a?(zi.stbtt__sort_edges_quicksort(e,t,o),t+=a,i-=a):(zi.stbtt__sort_edges_quicksort(e,t+a,i-a),i=o)}},zi.stbtt__sort_edges=function(e,t){zi.stbtt__sort_edges_quicksort(e,0,t),zi.stbtt__sort_edges_ins_sort(e,t)},zi.stbtt__rasterize=function(e,t,i,n,s,r,a,o,l,_,h){for(var u,c,d,f,g=h?-r:r,m=c=0,p=n;m<p;){c+=i[m++]}if(null!=(u=new Array(c+1))){for(var v=0,y=u.length;v<y;){u[v++]=new Gi}for(var b=f=c=0,w=n;b<w;){var x=b++,S=t,B=0+f;f+=i[x],d=i[x]-1;for(var T=0,k=i[x];T<k;){var I=T++,A=I,D=d;S[B+d].y!=S[B+I].y?(u[c].invert=!1,(h?S[B+d].y>S[B+I].y:S[B+d].y<S[B+I].y)&&(u[c].invert=!0,A=d,D=I),u[c].x0=S[B+A].x*s+a,u[c].y0=1*(S[B+A].y*g+o),u[c].x1=S[B+D].x*s+a,u[c].y1=1*(S[B+D].y*g+o),++c,d=I):d=I}}zi.stbtt__sort_edges(u,c),zi.stbtt__rasterize_sorted_edges(e,u,c,1,l,_)}},zi.stbtt__add_point=function(e,t,i,n){null!=e&&(e[t].x=i,e[t].y=n)},zi.stbtt__tesselate_curve=function(e,t,i,n,s,r,a,o,l,_){var h=(i+2*s+a)/4,u=(n+2*r+o)/4,c=(i+a)/2-h,d=(n+o)/2-u;return 16<_||(l<c*c+d*d?(zi.stbtt__tesselate_curve(e,t,i,n,(i+s)/2,(n+r)/2,h,u,l,_+1),zi.stbtt__tesselate_curve(e,t,h,u,(s+a)/2,(r+o)/2,a,o,l,_+1)):(zi.stbtt__add_point(e,t.value,a,o),t.value+=1)),1},zi.stbtt_FlattenCurves=function(e,t,i,n,s){for(var r=null,a=0,o=i*i,l=0,_=0,h=0,u=t;h<u;){1==e[h++].type&&++l}if(0==(s.value=l))return null;var c=new Array(l);if(n.value=c,null==n.value)return s.value=0,null;for(var d=0;d<2;){var f=0,g=0;if(1==d++){if(null==(r=new Array(a)))return n.value=null,s.value=0,null;for(var m=0,p=r.length;m<p;){r[m++]=new Wi}}l=-1;for(var v=a=0,y=t;v<y;){var b=v++;switch(e[b].type){case 1:0<=l&&(n.value[l]=a-_),++l,_=a,f=e[b].x,g=e[b].y,zi.stbtt__add_point(r,a++,f,g);break;case 2:f=e[b].x,g=e[b].y,zi.stbtt__add_point(r,a++,f,g);break;case 3:var w={value:a};zi.stbtt__tesselate_curve(r,w,f,g,e[b].cx,e[b].cy,e[b].x,e[b].y,o,0),a=w.value,f=e[b].x,g=e[b].y}}n.value[l]=a-_}return r},zi.stbtt_Rasterize=function(e,t,i,n,s,r,a,o,l,_,h){var u,c=r<s?r:s,d=0,f={value:d},g=new Ti,m=zi.stbtt_FlattenCurves(i,n,t/c,g,f);d=f.value,u=g.value,null!=m&&zi.stbtt__rasterize(e,m,u,d,s,r,a,o,l,_,h)},zi.stbtt_GetGlyphBitmapSubpixel=function(e,t,i,n,s,r,a){var o,l,_,h,u=new Oi,c=zi.stbtt_GetGlyphShape(e,r),d=c.length;if(0==t&&(t=i),0==i){if(0==t)return null;i=t}var f=zi.stbtt_GetGlyphBitmapBoxSubpixel(e,r,t,i,n,s);return o=f.x0,l=f.y0,_=f.x1,h=f.y1,u.w=_-o,u.h=h-l,u.pixels=null,a.width=u.w,a.height=u.h,a.xoff=o,a.yoff=l,0!=u.w&&0!=u.h&&(u.pixels=In.alloc(u.w*u.h),null!=u.pixels&&(u.stride=u.w,zi.stbtt_Rasterize(u,.35,c,d,t,i,n,s,o,l,!0))),u.pixels},zi.stbtt_GetGlyphBitmap=function(e,t,i,n,s){return zi.stbtt_GetGlyphBitmapSubpixel(e,t,i,0,0,n,s)},zi.stbtt_MakeGlyphBitmapSubpixel=function(e,t,i,n,s,r,a,o,l,_,h){var u,c,d=zi.stbtt_GetGlyphShape(e,h),f=null==d?0:d.length,g=new Oi,m=zi.stbtt_GetGlyphBitmapBoxSubpixel(e,h,a,o,l,_);u=m.x0,c=m.y0,g.pixels=t,g.pixels_offset=i,g.w=n,g.h=s,g.stride=r,0!=g.w&&0!=g.h&&zi.stbtt_Rasterize(g,.35,d,f,a,o,l,_,u,c,!0)},zi.stbtt_MakeGlyphBitmap=function(e,t,i,n,s,r,a,o,l){zi.stbtt_MakeGlyphBitmapSubpixel(e,t,i,n,s,r,a,o,0,0,l)},zi.stbtt_GetCodepointBitmapSubpixel=function(e,t,i,n,s,r,a){return zi.stbtt_GetGlyphBitmapSubpixel(e,t,i,n,s,zi.stbtt_FindGlyphIndex(e,r),a)},zi.stbtt_MakeCodepointBitmapSubpixel=function(e,t,i,n,s,r,a,o,l,_,h){zi.stbtt_MakeGlyphBitmapSubpixel(e,t,i,n,s,r,a,o,l,_,zi.stbtt_FindGlyphIndex(e,h))},zi.stbtt_GetCodepointBitmap=function(e,t,i,n,s){return zi.stbtt_GetCodepointBitmapSubpixel(e,t,i,0,0,n,s)},zi.stbtt_MakeCodepointBitmap=function(e,t,i,n,s,r,a,o,l){zi.stbtt_MakeCodepointBitmapSubpixel(e,t,i,n,s,r,a,o,0,0,l)},zi.stbtt_BakeFontBitmap=function(e,t,i,n,s,r,a,o){var l,_,h,u,c=new Fi;if(!zi.stbtt_InitFont(c,e,t))return-1;for(var d=0,f=s*r;d<f;){var g=d++;n.writeU8(g,0)}_=h=1,u=1,l=zi.stbtt_ScaleForPixelHeight(c,i);for(var m=0,p=0;p<a.length;){var v,y,b,w,x,S=a[p];++p;var B=zi.stbtt_FindGlyphIndex(c,S),T=zi.stbtt_GetGlyphHMetrics(c,B);v=T.advanceWidth,T.leftSideBearing;var k=zi.stbtt_GetGlyphBitmapBox(c,B,l,l);if(y=k.x0,b=k.y0,s<=_+(w=k.x1-y)+1&&(h=u,_=1),r<=h+(x=k.y1-b)+1)return-m;if(s<=_+w)throw new dt("Error");if(r<=h+x)throw new dt("Error");zi.stbtt_MakeGlyphBitmap(c,n,_+h*s,w,x,s,l,l,B),o[m].x0=_,o[m].y0=h,o[m].x1=_+w,o[m].y1=h+x,o[m].xadvance=l*v,o[m].xoff=y,o[m].yoff=b,_=_+w+1,u<h+x+1&&(u=h+x+1),++m}return u},zi.stbtt_GetBakedQuad=function(e,t,i,n,s,r,a,o){var l=o?0:-.5,_=1/t,h=1/i,u=e[n],c=Math.floor(s.value+u.xoff+.5),d=Math.floor(r.value+u.yoff+.5);a.x0=c+l,a.y0=d+l,a.x1=c+u.x1-u.x0+l,a.y1=d+u.y1-u.y0+l,a.s0=u.x0*_,a.t0=u.y0*h,a.s1=u.x1*_,a.t1=u.y1*h,s.value+=u.xadvance};var Hi=i["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"]};Hi.Always=["Always",0],Hi.Always.toString=n,(Hi.Always.__enum__=Hi).Never=["Never",1],Hi.Never.toString=n,(Hi.Never.__enum__=Hi).Equal=["Equal",2],Hi.Equal.toString=n,(Hi.Equal.__enum__=Hi).NotEqual=["NotEqual",3],Hi.NotEqual.toString=n,(Hi.NotEqual.__enum__=Hi).Less=["Less",4],Hi.Less.toString=n,(Hi.Less.__enum__=Hi).LessEqual=["LessEqual",5],Hi.LessEqual.toString=n,(Hi.LessEqual.__enum__=Hi).Greater=["Greater",6],Hi.Greater.toString=n,(Hi.Greater.__enum__=Hi).GreaterEqual=["GreaterEqual",7],Hi.GreaterEqual.toString=n,Hi.GreaterEqual.__enum__=Hi;var Zi=function(){};(i["kha.graphics4.ConstantLocation"]=Zi).__name__=!0;var ji=function(e,t,i,n){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=e,this.format=t,this.renderTarget=i,this.depthStencilFormat=n,i&&this.createTexture()};(i["kha.graphics4.CubeMap"]=ji).__name__=!0,ji.__interfaces__=[ut,ht],ji.createRenderTarget=function(e,t,i,n){return null==n&&(n=0),null==t&&(t=cn.RGBA32),null==i&&(i=0),new ji(e,t,!0,i)},ji.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=F.gl){if(this.texture=F.gl.createTexture(),F.gl.bindTexture(34067,this.texture),F.gl.texParameteri(34067,10240,9729),F.gl.texParameteri(34067,10241,9729),F.gl.texParameteri(34067,10242,33071),F.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=F.gl.createFramebuffer(),F.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:for(var e=0;e<6;){var t=e++;F.gl.texImage2D(34069+t,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}break;case 2:for(var i=0;i<6;){var n=i++;F.gl.texImage2D(34069+n,0,F.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null)}break;case 3:for(var s=0;s<6;){var r=s++;F.gl.texImage2D(34069+r,0,F.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null)}break;case 4:for(var a=0;a<6;){var o=a++;F.gl.texImage2D(34069+o,0,F.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,F.halfFloat.HALF_FLOAT_OES,null)}break;case 5:for(var l=0;l<6;){var _=l++;F.gl.texImage2D(34069+_,0,F.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null)}break;case 6:for(var h=0;h<6;){var u=h++;F.gl.texImage2D(34069+u,0,F.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,F.halfFloat.HALF_FLOAT_OES,null)}break;default:for(var c=0;c<6;){var d=c++;F.gl.texImage2D(34069+d,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}}if(this.format==cn.DEPTH16&&(F.gl.texParameteri(34067,10240,9728),F.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!F.gl2)){var f=F.gl.createTexture();F.gl.bindTexture(34067,f);for(var g=0;g<6;){var m=g++;F.gl.texImage2D(34069+m,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),F.gl.framebufferTexture2D(36160,36064,34069+m,f,0)}F.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),F.gl.bindFramebuffer(36160,null)}F.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:this.depthTexture=F.gl.createTexture(),F.gl.bindTexture(34067,this.depthTexture),1==e?F.gl.texImage2D(34067,0,F.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):F.gl.texImage2D(34067,0,F.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),F.gl.texParameteri(34067,10240,9728),F.gl.texParameteri(34067,10241,9728),F.gl.texParameteri(34067,10242,33071),F.gl.texParameteri(34067,10243,33071),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=F.gl.createTexture(),F.gl.bindTexture(34067,this.depthTexture),F.gl.texImage2D(34067,0,F.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,F.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),F.gl.texParameteri(34067,10240,9728),F.gl.texParameteri(34067,10241,9728),F.gl.texParameteri(34067,10242,33071),F.gl.texParameteri(34067,10243,33071),F.gl.bindFramebuffer(36160,this.frameBuffer),F.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(e){F.gl.activeTexture(33984+e),F.gl.bindTexture(34067,this.texture)},setDepth:function(e){F.gl.activeTexture(33984+e),F.gl.bindTexture(34067,this.depthTexture)},unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},width:null,get_width:function(){return this.myWidth},height:null,get_height:function(){return this.myHeight},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new Wn(this)),this.graphics4},__class__:ji,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var Ki=i["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"]};Ki.Clockwise=["Clockwise",0],Ki.Clockwise.toString=n,(Ki.Clockwise.__enum__=Ki).CounterClockwise=["CounterClockwise",1],Ki.CounterClockwise.toString=n,(Ki.CounterClockwise.__enum__=Ki).None=["None",2],Ki.None.toString=n,Ki.None.__enum__=Ki;var Xi=function(e,t){this.sources=[];for(var i=0;i<e.length;){var n=e[i];++i,this.sources.push(n.toString())}this.type=35632,this.shader=null,this.files=t};(i["kha.graphics4.FragmentShader"]=Xi).__name__=!0,Xi.fromSource=function(e){var t=new Xi([],["runtime-string"]);return t.sources.push(e),t},Xi.prototype={sources:null,type:null,shader:null,files:null,delete:function(){F.gl.deleteShader(this.shader),this.shader=null,this.sources=null},__class__:Xi};var Yi=function(e){};(i["kha.graphics4.GeometryShader"]=Yi).__name__=!0,Yi.prototype={delete:function(){},__class__:Yi};var qi=function(){};(i["kha.graphics4.Graphics"]=qi).__name__=!0,qi.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setCubeMap:null,setCubeMapDepth:null,renderTargetsInvertedY:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:qi};var Qi=function(e){this.destinationBlend=ue.Undefined,this.sourceBlend=ue.Undefined,this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,Qi.bufferIndex=0,Qi.initShaders(),this.initBuffers(),this.projectionLocation=Qi.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Qi.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.ImageShaderPainter"]=Qi).__name__=!0,Qi.initShaders=function(){null==Qi.structure&&(Qi.structure=en.createImageVertexStructure()),null==Qi.shaderPipeline&&(Qi.shaderPipeline=en.createImagePipeline(Qi.structure),Qi.shaderPipeline.compile())},Qi.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,sourceBlend:null,destinationBlend:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return null==e?(this.projectionLocation=Qi.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Qi.shaderPipeline.getTextureUnit("tex")):(this.projectionLocation=e.getConstantLocation("projectionMatrix"),this.textureLocation=e.getTextureUnit("tex")),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Qi.rectVertexBuffer){Qi.rectVertexBuffer=new gn(6e3,Qi.structure,fn.DynamicUsage),Qi.rectVertices=Qi.rectVertexBuffer.lock(),Qi.indexBuffer=new tn(9e3,fn.StaticUsage);for(var e=Qi.indexBuffer.lock(),t=0;t<1500;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}Qi.indexBuffer.unlock()}},setRectVertices:function(e,t,i,n,s,r,a,o){var l=9*Qi.bufferIndex*4;Qi.rectVertices[l]=e,Qi.rectVertices[l+1]=t,Qi.rectVertices[l+2]=-5,Qi.rectVertices[l+9]=i,Qi.rectVertices[l+10]=n,Qi.rectVertices[l+11]=-5,Qi.rectVertices[l+18]=s,Qi.rectVertices[l+19]=r,Qi.rectVertices[l+20]=-5,Qi.rectVertices[l+27]=a,Qi.rectVertices[l+28]=o,Qi.rectVertices[l+29]=-5},setRectTexCoords:function(e,t,i,n){var s=9*Qi.bufferIndex*4;Qi.rectVertices[s+3]=e,Qi.rectVertices[s+4]=n,Qi.rectVertices[s+12]=e,Qi.rectVertices[s+13]=t,Qi.rectVertices[s+21]=i,Qi.rectVertices[s+22]=t,Qi.rectVertices[s+30]=i,Qi.rectVertices[s+31]=n},setRectColor:function(e,t,i,n){var s=9*Qi.bufferIndex*4;Qi.rectVertices[s+5]=e,Qi.rectVertices[s+6]=t,Qi.rectVertices[s+7]=i,Qi.rectVertices[s+8]=n,Qi.rectVertices[s+14]=e,Qi.rectVertices[s+15]=t,Qi.rectVertices[s+16]=i,Qi.rectVertices[s+17]=n,Qi.rectVertices[s+23]=e,Qi.rectVertices[s+24]=t,Qi.rectVertices[s+25]=i,Qi.rectVertices[s+26]=n,Qi.rectVertices[s+32]=e,Qi.rectVertices[s+33]=t,Qi.rectVertices[s+34]=i,Qi.rectVertices[s+35]=n},drawBuffer:function(){Qi.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Qi.rectVertexBuffer),this.g.setIndexBuffer(Qi.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Qi.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Qi.lastTexture),this.g.setTextureParameters(this.textureLocation,hn.Clamp,hn.Clamp,this.bilinear?un.LinearFilter:un.PointFilter,this.bilinear?un.LinearFilter:un.PointFilter,this.bilinearMipmaps?nn.LinearMipFilter:nn.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Qi.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Qi.bufferIndex=0,Qi.rectVertices=Qi.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setBilinearMipmapFilter:function(e){this.end(),this.bilinearMipmaps=e},drawImage:function(e,t,i,n,s,r,a,o,l,_,h){var u=e;(1500<=Qi.bufferIndex+1||null!=Qi.lastTexture&&u!=Qi.lastTexture)&&this.drawBuffer();var c=.00392156862745098*((16711680&h)>>>16),d=.00392156862745098*((65280&h)>>>8),f=.00392156862745098*(255&h),g=.00392156862745098*(h>>>24)*_,m=9*Qi.bufferIndex*4;Qi.rectVertices[m+5]=c,Qi.rectVertices[m+6]=d,Qi.rectVertices[m+7]=f,Qi.rectVertices[m+8]=g,Qi.rectVertices[m+14]=c,Qi.rectVertices[m+15]=d,Qi.rectVertices[m+16]=f,Qi.rectVertices[m+17]=g,Qi.rectVertices[m+23]=c,Qi.rectVertices[m+24]=d,Qi.rectVertices[m+25]=f,Qi.rectVertices[m+26]=g,Qi.rectVertices[m+32]=c,Qi.rectVertices[m+33]=d,Qi.rectVertices[m+34]=f,Qi.rectVertices[m+35]=g;var p=u.get_width()/u.get_realWidth(),v=u.get_height()/u.get_realHeight(),y=9*Qi.bufferIndex*4;Qi.rectVertices[y+3]=0,Qi.rectVertices[y+4]=v,Qi.rectVertices[y+12]=0,Qi.rectVertices[y+13]=0,Qi.rectVertices[y+21]=p,Qi.rectVertices[y+22]=0,Qi.rectVertices[y+30]=p,Qi.rectVertices[y+31]=v;var b=9*Qi.bufferIndex*4;Qi.rectVertices[b]=t,Qi.rectVertices[b+1]=i,Qi.rectVertices[b+2]=-5,Qi.rectVertices[b+9]=n,Qi.rectVertices[b+10]=s,Qi.rectVertices[b+11]=-5,Qi.rectVertices[b+18]=r,Qi.rectVertices[b+19]=a,Qi.rectVertices[b+20]=-5,Qi.rectVertices[b+27]=o,Qi.rectVertices[b+28]=l,Qi.rectVertices[b+29]=-5,++Qi.bufferIndex,Qi.lastTexture=u},drawImage2:function(e,t,i,n,s,r,a,o,l,_,h,u,c,d,f){var g=e;(1500<=Qi.bufferIndex+1||null!=Qi.lastTexture&&g!=Qi.lastTexture)&&this.drawBuffer();var m=t/g.get_realWidth(),p=i/g.get_realHeight(),v=(t+n)/g.get_realWidth(),y=(i+s)/g.get_realHeight(),b=9*Qi.bufferIndex*4;Qi.rectVertices[b+3]=m,Qi.rectVertices[b+4]=y,Qi.rectVertices[b+12]=m,Qi.rectVertices[b+13]=p,Qi.rectVertices[b+21]=v,Qi.rectVertices[b+22]=p,Qi.rectVertices[b+30]=v,Qi.rectVertices[b+31]=y;var w=.00392156862745098*((16711680&f)>>>16),x=.00392156862745098*((65280&f)>>>8),S=.00392156862745098*(255&f),B=.00392156862745098*(f>>>24)*d,T=9*Qi.bufferIndex*4;Qi.rectVertices[T+5]=w,Qi.rectVertices[T+6]=x,Qi.rectVertices[T+7]=S,Qi.rectVertices[T+8]=B,Qi.rectVertices[T+14]=w,Qi.rectVertices[T+15]=x,Qi.rectVertices[T+16]=S,Qi.rectVertices[T+17]=B,Qi.rectVertices[T+23]=w,Qi.rectVertices[T+24]=x,Qi.rectVertices[T+25]=S,Qi.rectVertices[T+26]=B,Qi.rectVertices[T+32]=w,Qi.rectVertices[T+33]=x,Qi.rectVertices[T+34]=S,Qi.rectVertices[T+35]=B;var k=9*Qi.bufferIndex*4;Qi.rectVertices[k]=r,Qi.rectVertices[k+1]=a,Qi.rectVertices[k+2]=-5,Qi.rectVertices[k+9]=o,Qi.rectVertices[k+10]=l,Qi.rectVertices[k+11]=-5,Qi.rectVertices[k+18]=_,Qi.rectVertices[k+19]=h,Qi.rectVertices[k+20]=-5,Qi.rectVertices[k+27]=u,Qi.rectVertices[k+28]=c,Qi.rectVertices[k+29]=-5,++Qi.bufferIndex,Qi.lastTexture=g},drawImageScale:function(e,t,i,n,s,r,a,o,l,_,h){var u=e;(1500<=Qi.bufferIndex+1||null!=Qi.lastTexture&&u!=Qi.lastTexture)&&this.drawBuffer();var c=t/u.get_realWidth(),d=i/u.get_realHeight(),f=(t+n)/u.get_realWidth(),g=(i+s)/u.get_realHeight(),m=9*Qi.bufferIndex*4;Qi.rectVertices[m+3]=c,Qi.rectVertices[m+4]=g,Qi.rectVertices[m+12]=c,Qi.rectVertices[m+13]=d,Qi.rectVertices[m+21]=f,Qi.rectVertices[m+22]=d,Qi.rectVertices[m+30]=f,Qi.rectVertices[m+31]=g;var p=.00392156862745098*((16711680&h)>>>16),v=.00392156862745098*((65280&h)>>>8),y=.00392156862745098*(255&h),b=9*Qi.bufferIndex*4;Qi.rectVertices[b+5]=p,Qi.rectVertices[b+6]=v,Qi.rectVertices[b+7]=y,Qi.rectVertices[b+8]=_,Qi.rectVertices[b+14]=p,Qi.rectVertices[b+15]=v,Qi.rectVertices[b+16]=y,Qi.rectVertices[b+17]=_,Qi.rectVertices[b+23]=p,Qi.rectVertices[b+24]=v,Qi.rectVertices[b+25]=y,Qi.rectVertices[b+26]=_,Qi.rectVertices[b+32]=p,Qi.rectVertices[b+33]=v,Qi.rectVertices[b+34]=y,Qi.rectVertices[b+35]=_;var w=9*Qi.bufferIndex*4;Qi.rectVertices[w]=r,Qi.rectVertices[w+1]=l,Qi.rectVertices[w+2]=-5,Qi.rectVertices[w+9]=r,Qi.rectVertices[w+10]=a,Qi.rectVertices[w+11]=-5,Qi.rectVertices[w+18]=o,Qi.rectVertices[w+19]=a,Qi.rectVertices[w+20]=-5,Qi.rectVertices[w+27]=o,Qi.rectVertices[w+28]=l,Qi.rectVertices[w+29]=-5,++Qi.bufferIndex,Qi.lastTexture=u},end:function(){0<Qi.bufferIndex&&this.drawBuffer(),Qi.lastTexture=null},__class__:Qi,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ji=function(e){this.destinationBlend=ue.Undefined,this.sourceBlend=ue.Undefined,this.myPipeline=null,this.g=e,Ji.bufferIndex=0,Ji.triangleBufferIndex=0,Ji.initShaders(),this.initBuffers(),this.projectionLocation=Ji.shaderPipeline.getConstantLocation("projectionMatrix")};(i["kha.graphics4.ColoredShaderPainter"]=Ji).__name__=!0,Ji.initShaders=function(){null==Ji.structure&&(Ji.structure=en.createColoredVertexStructure()),null==Ji.shaderPipeline&&(Ji.shaderPipeline=en.createColoredPipeline(Ji.structure),Ji.shaderPipeline.compile())},Ji.prototype={projectionMatrix:null,g:null,myPipeline:null,projectionLocation:null,sourceBlend:null,destinationBlend:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return this.projectionLocation=null==e?Ji.shaderPipeline.getConstantLocation("projectionMatrix"):e.getConstantLocation("projectionMatrix"),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Ji.rectVertexBuffer){Ji.rectVertexBuffer=new gn(400,Ji.structure,fn.DynamicUsage),Ji.rectVertices=Ji.rectVertexBuffer.lock(),Ji.indexBuffer=new tn(600,fn.StaticUsage);for(var e=Ji.indexBuffer.lock(),t=0;t<100;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}Ji.indexBuffer.unlock(),Ji.triangleVertexBuffer=new gn(300,Ji.structure,fn.DynamicUsage),Ji.triangleVertices=Ji.triangleVertexBuffer.lock(),Ji.triangleIndexBuffer=new tn(300,fn.StaticUsage);for(var n=Ji.triangleIndexBuffer.lock(),s=0;s<100;){var r=s++;n[3*r]=3*r,n[3*r+1]=3*r+1,n[3*r+2]=3*r+2}Ji.triangleIndexBuffer.unlock()}},setRectVertices:function(e,t,i,n,s,r,a,o){var l=7*Ji.bufferIndex*4;Ji.rectVertices[l]=e,Ji.rectVertices[l+1]=t,Ji.rectVertices[l+2]=-5,Ji.rectVertices[l+7]=i,Ji.rectVertices[l+8]=n,Ji.rectVertices[l+9]=-5,Ji.rectVertices[l+14]=s,Ji.rectVertices[l+15]=r,Ji.rectVertices[l+16]=-5,Ji.rectVertices[l+21]=a,Ji.rectVertices[l+22]=o,Ji.rectVertices[l+23]=-5},setRectColors:function(e,t){var i=7*Ji.bufferIndex*4,n=e*(.00392156862745098*(t>>>24));Ji.rectVertices[i+3]=.00392156862745098*((16711680&t)>>>16),Ji.rectVertices[i+4]=.00392156862745098*((65280&t)>>>8),Ji.rectVertices[i+5]=.00392156862745098*(255&t),Ji.rectVertices[i+6]=n,Ji.rectVertices[i+10]=.00392156862745098*((16711680&t)>>>16),Ji.rectVertices[i+11]=.00392156862745098*((65280&t)>>>8),Ji.rectVertices[i+12]=.00392156862745098*(255&t),Ji.rectVertices[i+13]=n,Ji.rectVertices[i+17]=.00392156862745098*((16711680&t)>>>16),Ji.rectVertices[i+18]=.00392156862745098*((65280&t)>>>8),Ji.rectVertices[i+19]=.00392156862745098*(255&t),Ji.rectVertices[i+20]=n,Ji.rectVertices[i+24]=.00392156862745098*((16711680&t)>>>16),Ji.rectVertices[i+25]=.00392156862745098*((65280&t)>>>8),Ji.rectVertices[i+26]=.00392156862745098*(255&t),Ji.rectVertices[i+27]=n},setTriVertices:function(e,t,i,n,s,r){var a=7*Ji.triangleBufferIndex*3;Ji.triangleVertices[a]=e,Ji.triangleVertices[a+1]=t,Ji.triangleVertices[a+2]=-5,Ji.triangleVertices[a+7]=i,Ji.triangleVertices[a+8]=n,Ji.triangleVertices[a+9]=-5,Ji.triangleVertices[a+14]=s,Ji.triangleVertices[a+15]=r,Ji.triangleVertices[a+16]=-5},setTriColors:function(e,t){var i=7*Ji.triangleBufferIndex*3,n=e*(.00392156862745098*(t>>>24));Ji.triangleVertices[i+3]=.00392156862745098*((16711680&t)>>>16),Ji.triangleVertices[i+4]=.00392156862745098*((65280&t)>>>8),Ji.triangleVertices[i+5]=.00392156862745098*(255&t),Ji.triangleVertices[i+6]=n,Ji.triangleVertices[i+10]=.00392156862745098*((16711680&t)>>>16),Ji.triangleVertices[i+11]=.00392156862745098*((65280&t)>>>8),Ji.triangleVertices[i+12]=.00392156862745098*(255&t),Ji.triangleVertices[i+13]=n,Ji.triangleVertices[i+17]=.00392156862745098*((16711680&t)>>>16),Ji.triangleVertices[i+18]=.00392156862745098*((65280&t)>>>8),Ji.triangleVertices[i+19]=.00392156862745098*(255&t),Ji.triangleVertices[i+20]=n},drawBuffer:function(e){e||0<Ji.triangleBufferIndex&&this.drawTriBuffer(!0),Ji.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ji.rectVertexBuffer),this.g.setIndexBuffer(Ji.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ji.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ji.bufferIndex*3),Ji.bufferIndex=0,Ji.rectVertices=Ji.rectVertexBuffer.lock()},drawTriBuffer:function(e){e||0<Ji.bufferIndex&&this.drawBuffer(!0),Ji.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(Ji.triangleVertexBuffer),this.g.setIndexBuffer(Ji.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ji.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ji.triangleBufferIndex),Ji.triangleBufferIndex=0,Ji.triangleVertices=Ji.triangleVertexBuffer.lock()},fillRect:function(e,t,i,n,s,r,a,o,l,_){0<Ji.triangleBufferIndex&&this.drawTriBuffer(!0),100<=Ji.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(i,n,s,r,a,o,l,_),++Ji.bufferIndex},fillTriangle:function(e,t,i,n,s,r,a,o){0<Ji.bufferIndex&&this.drawBuffer(!0),100<=Ji.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(e,t),this.setTriVertices(i,n,s,r,a,o),++Ji.triangleBufferIndex},endTris:function(e){0<Ji.triangleBufferIndex&&this.drawTriBuffer(e)},endRects:function(e){0<Ji.bufferIndex&&this.drawBuffer(e)},end:function(){0<Ji.triangleBufferIndex&&this.drawTriBuffer(!1),0<Ji.bufferIndex&&this.drawBuffer(!1)},__class__:Ji,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var $i=function(e){this.bakedQuadCache=new bt,this.destinationBlend=ue.Undefined,this.sourceBlend=ue.Undefined,this.bilinear=!1,this.myPipeline=null,this.g=e,$i.bufferIndex=0,$i.initShaders(),this.initBuffers(),this.projectionLocation=$i.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=$i.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.TextShaderPainter"]=$i).__name__=!0,$i.initShaders=function(){null==$i.structure&&($i.structure=en.createTextVertexStructure()),null==$i.shaderPipeline&&($i.shaderPipeline=en.createTextPipeline($i.structure),$i.shaderPipeline.compile())},$i.findIndex=function(e,t){for(var i=0,n=t.length;i<n;){var s=i++;if(t[s]==e)return s}return 0},$i.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,fontSize:null,bilinear:null,sourceBlend:null,destinationBlend:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return null==e?(this.projectionLocation=$i.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=$i.shaderPipeline.getTextureUnit("tex")):(this.projectionLocation=e.getConstantLocation("projectionMatrix"),this.textureLocation=e.getTextureUnit("tex")),this.myPipeline=e},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==$i.rectVertexBuffer){$i.rectVertexBuffer=new gn(400,$i.structure,fn.DynamicUsage),$i.rectVertices=$i.rectVertexBuffer.lock(),$i.indexBuffer=new tn(600,fn.StaticUsage);for(var e=$i.indexBuffer.lock(),t=0;t<100;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}$i.indexBuffer.unlock()}},setRectVertices:function(e,t,i,n,s,r,a,o){var l=9*$i.bufferIndex*4;$i.rectVertices[l]=e,$i.rectVertices[l+1]=t,$i.rectVertices[l+2]=-5,$i.rectVertices[l+9]=i,$i.rectVertices[l+10]=n,$i.rectVertices[l+11]=-5,$i.rectVertices[l+18]=s,$i.rectVertices[l+19]=r,$i.rectVertices[l+20]=-5,$i.rectVertices[l+27]=a,$i.rectVertices[l+28]=o,$i.rectVertices[l+29]=-5},setRectTexCoords:function(e,t,i,n){var s=9*$i.bufferIndex*4;$i.rectVertices[s+3]=e,$i.rectVertices[s+4]=n,$i.rectVertices[s+12]=e,$i.rectVertices[s+13]=t,$i.rectVertices[s+21]=i,$i.rectVertices[s+22]=t,$i.rectVertices[s+30]=i,$i.rectVertices[s+31]=n},setRectColors:function(e,t){var i=9*$i.bufferIndex*4,n=e*(.00392156862745098*(t>>>24));$i.rectVertices[i+5]=.00392156862745098*((16711680&t)>>>16),$i.rectVertices[i+6]=.00392156862745098*((65280&t)>>>8),$i.rectVertices[i+7]=.00392156862745098*(255&t),$i.rectVertices[i+8]=n,$i.rectVertices[i+14]=.00392156862745098*((16711680&t)>>>16),$i.rectVertices[i+15]=.00392156862745098*((65280&t)>>>8),$i.rectVertices[i+16]=.00392156862745098*(255&t),$i.rectVertices[i+17]=n,$i.rectVertices[i+23]=.00392156862745098*((16711680&t)>>>16),$i.rectVertices[i+24]=.00392156862745098*((65280&t)>>>8),$i.rectVertices[i+25]=.00392156862745098*(255&t),$i.rectVertices[i+26]=n,$i.rectVertices[i+32]=.00392156862745098*((16711680&t)>>>16),$i.rectVertices[i+33]=.00392156862745098*((65280&t)>>>8),$i.rectVertices[i+34]=.00392156862745098*(255&t),$i.rectVertices[i+35]=n},drawBuffer:function(){$i.rectVertexBuffer.unlock(),this.g.setVertexBuffer($i.rectVertexBuffer),this.g.setIndexBuffer($i.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?$i.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,$i.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,hn.Clamp,hn.Clamp,this.bilinear?un.LinearFilter:un.PointFilter,this.bilinear?un.LinearFilter:un.PointFilter,nn.NoMipFilter),this.g.drawIndexedVertices(0,2*$i.bufferIndex*3),this.g.setTexture(this.textureLocation,null),$i.bufferIndex=0,$i.rectVertices=$i.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setFont:function(e){this.font=Ai.__cast(e,xt)},text:null,startString:function(e){this.text=e},charCodeAt:function(e){return $.cca(this.text,e)},stringLength:function(){return this.text.length},endString:function(){this.text=null},bakedQuadCache:null,drawString:function(e,t,i,n,s,r,a){var o=this.font._get(this.fontSize,a),l=o.getTexture();null!=$i.lastTexture&&l!=$i.lastTexture&&this.drawBuffer(),$i.lastTexture=l;var _=n,h=s;this.startString(e);for(var u=0,c=this.stringLength();u<c;){var d=u++,f=o.getBakedQuad(this.bakedQuadCache,$i.findIndex(this.charCodeAt(d),a),_,h);if(null!=f){var g,m,p;100<=$i.bufferIndex+1&&this.drawBuffer(),this.setRectColors(t,i),this.setRectTexCoords(f.s0*l.get_width()/l.get_realWidth(),f.t0*l.get_height()/l.get_realHeight(),f.s1*l.get_width()/l.get_realWidth(),f.t1*l.get_height()/l.get_realHeight());var v=f.x0;p=f.y1;var y,b,w,x=r._02*v+r._12*p+r._22;m=(r._00*v+r._10*p+r._20)/x,g=(r._01*v+r._11*p+r._21)/x;var S=f.x0;w=f.y0;var B,T,k,I=r._02*S+r._12*w+r._22;b=(r._00*S+r._10*w+r._20)/I,y=(r._01*S+r._11*w+r._21)/I;var A=f.x1;k=f.y0;var D,C,P,N=r._02*A+r._12*k+r._22;T=(r._00*A+r._10*k+r._20)/N,B=(r._01*A+r._11*k+r._21)/N;var E=f.x1;P=f.y1;var R=r._02*E+r._12*P+r._22;C=(r._00*E+r._10*P+r._20)/R,D=(r._01*E+r._11*P+r._21)/R,this.setRectVertices(m,g,b,y,T,B,C,D),_+=f.xadvance,++$i.bufferIndex}}this.endString()},drawCharacters:function(e,t,i,n,s,r,a,o,l){var _=this.font._get(this.fontSize,l),h=_.getTexture();null!=$i.lastTexture&&h!=$i.lastTexture&&this.drawBuffer(),$i.lastTexture=h;for(var u=r,c=a,d=t,f=t+i;d<f;){var g=d++,m=_.getBakedQuad(this.bakedQuadCache,$i.findIndex(e[g],l),u,c);if(null!=m){var p,v,y;100<=$i.bufferIndex+1&&this.drawBuffer(),this.setRectColors(n,s),this.setRectTexCoords(m.s0*h.get_width()/h.get_realWidth(),m.t0*h.get_height()/h.get_realHeight(),m.s1*h.get_width()/h.get_realWidth(),m.t1*h.get_height()/h.get_realHeight());var b=m.x0;y=m.y1;var w,x,S,B=o._02*b+o._12*y+o._22;v=(o._00*b+o._10*y+o._20)/B,p=(o._01*b+o._11*y+o._21)/B;var T=m.x0;S=m.y0;var k,I,A,D=o._02*T+o._12*S+o._22;x=(o._00*T+o._10*S+o._20)/D,w=(o._01*T+o._11*S+o._21)/D;var C=m.x1;A=m.y0;var P,N,E,R=o._02*C+o._12*A+o._22;I=(o._00*C+o._10*A+o._20)/R,k=(o._01*C+o._11*A+o._21)/R;var L=m.x1;E=m.y1;var M=o._02*L+o._12*E+o._22;N=(o._00*L+o._10*E+o._20)/M,P=(o._01*L+o._11*E+o._21)/M,this.setRectVertices(v,p,x,w,I,k,N,P),u+=m.xadvance,++$i.bufferIndex}}},end:function(){0<$i.bufferIndex&&this.drawBuffer(),$i.lastTexture=null},__class__:$i,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var en=function(e){this.myMipmapScaleQuality=Si.High,this.myImageScaleQuality=Si.High,yi.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new Qi(this.g),this.coloredPainter=new Ji(this.g),this.textPainter=new $i(this.g),this.textPainter.fontSize=this.get_fontSize(),this.setProjection(),null==en.videoPipeline&&(en.videoPipeline=en.createImagePipeline(en.createImageVertexStructure()),en.videoPipeline.fragmentShader=At.painter_video_frag,en.videoPipeline.vertexShader=At.painter_video_vert,en.videoPipeline.compile())};(i["kha.graphics4.Graphics2"]=en).__name__=!0,en.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},en.createImageVertexStructure=function(){var e=new yn;return e.add("vertexPosition",mn.Float3),e.add("texPosition",mn.Float2),e.add("vertexColor",mn.Float4),e},en.createImagePipeline=function(e){var t=new rn;return t.fragmentShader=At.painter_image_frag,t.vertexShader=At.painter_image_vert,t.inputLayout=[e],t.blendSource=ue.BlendOne,t.blendDestination=ue.InverseSourceAlpha,t.alphaBlendSource=ue.BlendOne,t.alphaBlendDestination=ue.InverseSourceAlpha,t},en.createColoredVertexStructure=function(){var e=new yn;return e.add("vertexPosition",mn.Float3),e.add("vertexColor",mn.Float4),e},en.createColoredPipeline=function(e){var t=new rn;return t.fragmentShader=At.painter_colored_frag,t.vertexShader=At.painter_colored_vert,t.inputLayout=[e],t.blendSource=ue.SourceAlpha,t.blendDestination=ue.InverseSourceAlpha,t.alphaBlendSource=ue.SourceAlpha,t.alphaBlendDestination=ue.InverseSourceAlpha,t},en.createTextVertexStructure=function(){var e=new yn;return e.add("vertexPosition",mn.Float3),e.add("texPosition",mn.Float2),e.add("vertexColor",mn.Float4),e},en.createTextPipeline=function(e){var t=new rn;return t.fragmentShader=At.painter_text_frag,t.vertexShader=At.painter_text_vert,t.inputLayout=[e],t.blendSource=ue.SourceAlpha,t.blendDestination=ue.InverseSourceAlpha,t.alphaBlendSource=ue.SourceAlpha,t.alphaBlendDestination=ue.InverseSourceAlpha,t},en.__super__=yi,en.prototype=s(yi.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();Ai.__instanceof(this.canvas,yt)?this.projectionMatrix=Kn.orthogonalProjection(0,e,t,0,.1,1e3):(ct.get_nonPow2Supported()||(e=en.upperPowerOfTwo(e),t=en.upperPowerOfTwo(t)),this.g.renderTargetsInvertedY()?this.projectionMatrix=Kn.orthogonalProjection(0,e,0,t,.1,1e3):this.projectionMatrix=Kn.orthogonalProjection(0,e,t,0,.1,1e3)),this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(e,t,i){var n=this.coloredPainter;0<Ji.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ji.bufferIndex&&n.drawBuffer(!1),this.textPainter.end();var s,r,a,o=t+e.get_width(),l=i+e.get_height(),_=this.transformations[this.transformations.length-1],h=t;a=l;var u,c,d=_._02*h+_._12*a+_._22;r=(_._00*h+_._10*a+_._20)/d,s=(_._01*h+_._11*a+_._21)/d;var f,g=this.transformations[this.transformations.length-1],m=t;f=i;var p,v,y=g._02*m+g._12*f+g._22;c=(g._00*m+g._10*f+g._20)/y,u=(g._01*m+g._11*f+g._21)/y;var b,w=this.transformations[this.transformations.length-1],x=o;b=i;var S,B,T=w._02*x+w._12*b+w._22;v=(w._00*x+w._10*b+w._20)/T,p=(w._01*x+w._11*b+w._21)/T;var k,I=this.transformations[this.transformations.length-1],A=o;k=l;var D=I._02*A+I._12*k+I._22;B=(I._00*A+I._10*k+I._20)/D,S=(I._01*A+I._11*k+I._21)/D;var C=this.imagePainter,P=this.get_opacity(),N=this.get_color(),E=e;(1500<=Qi.bufferIndex+1||null!=Qi.lastTexture&&E!=Qi.lastTexture)&&C.drawBuffer();var R=.00392156862745098*((16711680&N)>>>16),L=.00392156862745098*((65280&N)>>>8),M=.00392156862745098*(255&N),F=.00392156862745098*(N>>>24)*P,V=9*Qi.bufferIndex*4;Qi.rectVertices[V+5]=R,Qi.rectVertices[V+6]=L,Qi.rectVertices[V+7]=M,Qi.rectVertices[V+8]=F,Qi.rectVertices[V+14]=R,Qi.rectVertices[V+15]=L,Qi.rectVertices[V+16]=M,Qi.rectVertices[V+17]=F,Qi.rectVertices[V+23]=R,Qi.rectVertices[V+24]=L,Qi.rectVertices[V+25]=M,Qi.rectVertices[V+26]=F,Qi.rectVertices[V+32]=R,Qi.rectVertices[V+33]=L,Qi.rectVertices[V+34]=M,Qi.rectVertices[V+35]=F;var O=E.get_width()/E.get_realWidth(),G=E.get_height()/E.get_realHeight(),U=9*Qi.bufferIndex*4;Qi.rectVertices[U+3]=0,Qi.rectVertices[U+4]=G,Qi.rectVertices[U+12]=0,Qi.rectVertices[U+13]=0,Qi.rectVertices[U+21]=O,Qi.rectVertices[U+22]=0,Qi.rectVertices[U+30]=O,Qi.rectVertices[U+31]=G;var W=9*Qi.bufferIndex*4;Qi.rectVertices[W]=r,Qi.rectVertices[W+1]=s,Qi.rectVertices[W+2]=-5,Qi.rectVertices[W+9]=c,Qi.rectVertices[W+10]=u,Qi.rectVertices[W+11]=-5,Qi.rectVertices[W+18]=v,Qi.rectVertices[W+19]=p,Qi.rectVertices[W+20]=-5,Qi.rectVertices[W+27]=B,Qi.rectVertices[W+28]=S,Qi.rectVertices[W+29]=-5,++Qi.bufferIndex,Qi.lastTexture=E},drawScaledSubImage:function(e,t,i,n,s,r,a,o,l){var _,h,u=this.coloredPainter;0<Ji.triangleBufferIndex&&u.drawTriBuffer(!1),0<Ji.bufferIndex&&u.drawBuffer(!1),this.textPainter.end();var c,d=this.transformations[this.transformations.length-1],f=r;c=a+l;var g,m,p=d._02*f+d._12*c+d._22;h=(d._00*f+d._10*c+d._20)/p,_=(d._01*f+d._11*c+d._21)/p;var v,y=this.transformations[this.transformations.length-1],b=r;v=a;var w,x,S=y._02*b+y._12*v+y._22;m=(y._00*b+y._10*v+y._20)/S,g=(y._01*b+y._11*v+y._21)/S;var B,T=this.transformations[this.transformations.length-1],k=r+o;B=a;var I,A,D=T._02*k+T._12*B+T._22;x=(T._00*k+T._10*B+T._20)/D,w=(T._01*k+T._11*B+T._21)/D;var C,P=this.transformations[this.transformations.length-1],N=r+o;C=a+l;var E=P._02*N+P._12*C+P._22;A=(P._00*N+P._10*C+P._20)/E,I=(P._01*N+P._11*C+P._21)/E;var R=this.imagePainter,L=this.get_opacity(),M=this.get_color(),F=e;(1500<=Qi.bufferIndex+1||null!=Qi.lastTexture&&F!=Qi.lastTexture)&&R.drawBuffer();var V=t/F.get_realWidth(),O=i/F.get_realHeight(),G=(t+n)/F.get_realWidth(),U=(i+s)/F.get_realHeight(),W=9*Qi.bufferIndex*4;Qi.rectVertices[W+3]=V,Qi.rectVertices[W+4]=U,Qi.rectVertices[W+12]=V,Qi.rectVertices[W+13]=O,Qi.rectVertices[W+21]=G,Qi.rectVertices[W+22]=O,Qi.rectVertices[W+30]=G,Qi.rectVertices[W+31]=U;var z=.00392156862745098*((16711680&M)>>>16),H=.00392156862745098*((65280&M)>>>8),Z=.00392156862745098*(255&M),j=.00392156862745098*(M>>>24)*L,K=9*Qi.bufferIndex*4;Qi.rectVertices[K+5]=z,Qi.rectVertices[K+6]=H,Qi.rectVertices[K+7]=Z,Qi.rectVertices[K+8]=j,Qi.rectVertices[K+14]=z,Qi.rectVertices[K+15]=H,Qi.rectVertices[K+16]=Z,Qi.rectVertices[K+17]=j,Qi.rectVertices[K+23]=z,Qi.rectVertices[K+24]=H,Qi.rectVertices[K+25]=Z,Qi.rectVertices[K+26]=j,Qi.rectVertices[K+32]=z,Qi.rectVertices[K+33]=H,Qi.rectVertices[K+34]=Z,Qi.rectVertices[K+35]=j;var X=9*Qi.bufferIndex*4;Qi.rectVertices[X]=h,Qi.rectVertices[X+1]=_,Qi.rectVertices[X+2]=-5,Qi.rectVertices[X+9]=m,Qi.rectVertices[X+10]=g,Qi.rectVertices[X+11]=-5,Qi.rectVertices[X+18]=x,Qi.rectVertices[X+19]=w,Qi.rectVertices[X+20]=-5,Qi.rectVertices[X+27]=A,Qi.rectVertices[X+28]=I,Qi.rectVertices[X+29]=-5,++Qi.bufferIndex,Qi.lastTexture=F},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},drawRect:function(e,t,i,n,s){null==s&&(s=1),this.imagePainter.end(),this.textPainter.end();var r,a=this.transformations[this.transformations.length-1],o=e-s/2;r=t+s/2;var l,_=a._02*o+a._12*r+a._22,h=(a._00*o+a._10*r+a._20)/_,u=(a._01*o+a._11*r+a._21)/_,c=new Xn(h,u),d=this.transformations[this.transformations.length-1],f=e-s/2;l=t-s/2;var g,m=d._02*f+d._12*l+d._22,p=(d._00*f+d._10*l+d._20)/m,v=(d._01*f+d._11*l+d._21)/m,y=new Xn(p,v),b=this.transformations[this.transformations.length-1],w=e+i+s/2;g=t-s/2;var x,S=b._02*w+b._12*g+b._22,B=(b._00*w+b._10*g+b._20)/S,T=(b._01*w+b._11*g+b._21)/S,k=new Xn(B,T),I=this.transformations[this.transformations.length-1],A=e+i+s/2;x=t+s/2;var D=I._02*A+I._12*x+I._22,C=(I._00*A+I._10*x+I._20)/D,P=(I._01*A+I._11*x+I._21)/D,N=new Xn(C,P);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,y.x,y.y,k.x,k.y,N.x,N.y);var E,R=this.transformations[this.transformations.length-1],L=e-s/2;E=t+n+s/2;var M=R._02*L+R._12*E+R._22,F=(R._00*L+R._10*E+R._20)/M,V=(R._01*L+R._11*E+R._21)/M;c=new Xn(F,V);var O,G=this.transformations[this.transformations.length-1],U=e+s/2;O=t-s/2;var W=G._02*U+G._12*O+G._22,z=(G._00*U+G._10*O+G._20)/W,H=(G._01*U+G._11*O+G._21)/W;k=new Xn(z,H);var Z,j=this.transformations[this.transformations.length-1],K=e+s/2;Z=t+n+s/2;var X=j._02*K+j._12*Z+j._22,Y=(j._00*K+j._10*Z+j._20)/X,q=(j._01*K+j._11*Z+j._21)/X;N=new Xn(Y,q),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,y.x,y.y,k.x,k.y,N.x,N.y);var Q,J=this.transformations[this.transformations.length-1],$=e-s/2;Q=t+n-s/2;var ee=J._02*$+J._12*Q+J._22,te=(J._00*$+J._10*Q+J._20)/ee,ie=(J._01*$+J._11*Q+J._21)/ee;y=new Xn(te,ie);var ne,se=this.transformations[this.transformations.length-1],re=e+i+s/2;ne=t+n-s/2;var ae=se._02*re+se._12*ne+se._22,oe=(se._00*re+se._10*ne+se._20)/ae,le=(se._01*re+se._11*ne+se._21)/ae;k=new Xn(oe,le);var _e,he=this.transformations[this.transformations.length-1],ue=e+i+s/2;_e=t+n+s/2;var ce=he._02*ue+he._12*_e+he._22,de=(he._00*ue+he._10*_e+he._20)/ce,fe=(he._01*ue+he._11*_e+he._21)/ce;N=new Xn(de,fe),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,y.x,y.y,k.x,k.y,N.x,N.y);var ge,me=this.transformations[this.transformations.length-1],pe=e+i-s/2;ge=t+n+s/2;var ve=me._02*pe+me._12*ge+me._22,ye=(me._00*pe+me._10*ge+me._20)/ve,be=(me._01*pe+me._11*ge+me._21)/ve;c=new Xn(ye,be);var we,xe=this.transformations[this.transformations.length-1],Se=e+i-s/2;we=t-s/2;var Be=xe._02*Se+xe._12*we+xe._22,Te=(xe._00*Se+xe._10*we+xe._20)/Be,ke=(xe._01*Se+xe._11*we+xe._21)/Be;y=new Xn(Te,ke);var Ie,Ae=this.transformations[this.transformations.length-1],De=e+i+s/2;Ie=t-s/2;var Ce=Ae._02*De+Ae._12*Ie+Ae._22,Pe=(Ae._00*De+Ae._10*Ie+Ae._20)/Ce,Ne=(Ae._01*De+Ae._11*Ie+Ae._21)/Ce;k=new Xn(Pe,Ne);var Ee,Re=this.transformations[this.transformations.length-1],Le=e+i+s/2;Ee=t+n+s/2;var Me=Re._02*Le+Re._12*Ee+Re._22,Fe=(Re._00*Le+Re._10*Ee+Re._20)/Me,Ve=(Re._01*Le+Re._11*Ee+Re._21)/Me;N=new Xn(Fe,Ve),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,y.x,y.y,k.x,k.y,N.x,N.y)},fillRect:function(e,t,i,n){var s,r;this.imagePainter.end(),this.textPainter.end();var a,o=this.transformations[this.transformations.length-1],l=e;a=t+n;var _,h,u=o._02*l+o._12*a+o._22;r=(o._00*l+o._10*a+o._20)/u,s=(o._01*l+o._11*a+o._21)/u;var c,d=this.transformations[this.transformations.length-1],f=e;c=t;var g,m,p=d._02*f+d._12*c+d._22;h=(d._00*f+d._10*c+d._20)/p,_=(d._01*f+d._11*c+d._21)/p;var v,y=this.transformations[this.transformations.length-1],b=e+i;v=t;var w,x,S=y._02*b+y._12*v+y._22;m=(y._00*b+y._10*v+y._20)/S,g=(y._01*b+y._11*v+y._21)/S;var B,T=this.transformations[this.transformations.length-1],k=e+i;B=t+n;var I=T._02*k+T._12*B+T._22;x=(T._00*k+T._10*B+T._20)/I,w=(T._01*k+T._11*B+T._21)/I,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),r,s,h,_,m,g,x,w)},drawString:function(e,t,i){this.imagePainter.end();var n=this.coloredPainter;0<Ji.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ji.bufferIndex&&n.drawBuffer(!1),this.textPainter.drawString(e,this.get_opacity(),this.get_color(),t,i,this.transformations[this.transformations.length-1],this.get_fontGlyphs())},drawCharacters:function(e,t,i,n,s){this.imagePainter.end();var r=this.coloredPainter;0<Ji.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ji.bufferIndex&&r.drawBuffer(!1),this.textPainter.drawCharacters(e,t,i,this.get_opacity(),this.get_color(),n,s,this.transformations[this.transformations.length-1],this.get_fontGlyphs())},get_font:function(){return this.myFont},set_font:function(e){return this.textPainter.setFont(e),this.myFont=e},set_fontSize:function(e){return yi.prototype.set_fontSize.call(this,this.textPainter.fontSize=e)},drawLine:function(e,t,i,n,s){var r;null==s&&(s=1),this.imagePainter.end(),this.textPainter.end(),(r=n==t?new Xn(0,-1):new Xn(1,-(i-e)/(n-t))).set_length(s);var a=new Xn(e+.5*r.x,t+.5*r.y),o=new Xn(i+.5*r.x,n+.5*r.y),l=new Xn(a.x-r.x,a.y-r.y),_=new Xn(o.x-r.x,o.y-r.y),h=this.transformations[this.transformations.length-1],u=h._02*a.x+h._12*a.y+h._22,c=(h._00*a.x+h._10*a.y+h._20)/u,d=(h._01*a.x+h._11*a.y+h._21)/u;a=new Xn(c,d);var f=this.transformations[this.transformations.length-1],g=f._02*o.x+f._12*o.y+f._22,m=(f._00*o.x+f._10*o.y+f._20)/g,p=(f._01*o.x+f._11*o.y+f._21)/g;o=new Xn(m,p);var v=this.transformations[this.transformations.length-1],y=v._02*l.x+v._12*l.y+v._22,b=(v._00*l.x+v._10*l.y+v._20)/y,w=(v._01*l.x+v._11*l.y+v._21)/y;l=new Xn(b,w);var x=this.transformations[this.transformations.length-1],S=x._02*_.x+x._12*_.y+x._22,B=(x._00*_.x+x._10*_.y+x._20)/S,T=(x._01*_.x+x._11*_.y+x._21)/S;_=new Xn(B,T),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,o.x,o.y,l.x,l.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),l.x,l.y,o.x,o.y,_.x,_.y)},fillTriangle:function(e,t,i,n,s,r){var a,o;this.imagePainter.end(),this.textPainter.end();var l,_=this.transformations[this.transformations.length-1],h=e;l=t;var u,c,d=_._02*h+_._12*l+_._22;o=(_._00*h+_._10*l+_._20)/d,a=(_._01*h+_._11*l+_._21)/d;var f,g=this.transformations[this.transformations.length-1],m=i;f=n;var p,v,y=g._02*m+g._12*f+g._22;c=(g._00*m+g._10*f+g._20)/y,u=(g._01*m+g._11*f+g._21)/y;var b,w=this.transformations[this.transformations.length-1],x=s;b=r;var S=w._02*x+w._12*b+w._22;v=(w._00*x+w._10*b+w._20)/S,p=(w._01*x+w._11*b+w._21)/S,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),o,a,c,u,v,p)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(e){return this.imagePainter.setBilinearFilter(e==Si.High),this.textPainter.setBilinearFilter(e==Si.High),this.myImageScaleQuality=e},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(e){return this.imagePainter.setBilinearMipmapFilter(e==Si.High),this.myMipmapScaleQuality=e},setPipeline:function(e){this.flush(),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e),null!=e&&this.g.setPipeline(e)},scissor:function(e,t,i,n){this.flush(),this.g.scissor(e,t,i,n)},disableScissor:function(){this.flush(),this.g.disableScissor()},begin:function(e,t){null==e&&(e=!0),this.g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;0<Ji.triangleBufferIndex&&e.drawTriBuffer(!1),0<Ji.bufferIndex&&e.drawBuffer(!1)},end:function(){this.flush(),this.g.end()},drawVideoInternal:function(e,t,i,n,s){},drawVideo:function(e,t,i,n,s){this.setPipeline(en.videoPipeline),this.drawVideoInternal(e,t,i,n,s),this.setPipeline(null)},__class__:en});var tn=function(e,t,i){null==i&&(i=!1),this.usage=t,this.mySize=e,this.buffer=F.gl.createBuffer();var n=new Uint32Array(e);this._data=n};(i["kha.graphics4.IndexBuffer"]=tn).__name__=!0,tn.prototype={buffer:null,_data:null,mySize:null,usage:null,delete:function(){this._data=null,F.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e,e+t)},unlock:function(){F.gl.bindBuffer(34963,this.buffer);var e=null==F.elementIndexUint?new Uint16Array(this._data):this._data;F.gl.bufferData(34963,e,this.usage==fn.DynamicUsage?35048:35044)},set:function(){F.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:tn};var nn=i["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"]};nn.NoMipFilter=["NoMipFilter",0],nn.NoMipFilter.toString=n,(nn.NoMipFilter.__enum__=nn).PointMipFilter=["PointMipFilter",1],nn.PointMipFilter.toString=n,(nn.PointMipFilter.__enum__=nn).LinearMipFilter=["LinearMipFilter",2],nn.LinearMipFilter.toString=n,nn.LinearMipFilter.__enum__=nn;var sn=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=Ki.None,this.depthWrite=!1,this.depthMode=Hi.Always,this.stencilMode=Hi.Always,this.stencilBothPass=an.Keep,this.stencilDepthFail=an.Keep,this.stencilFail=an.Keep,this.stencilReferenceValue=0,this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=ue.BlendOne,this.blendDestination=ue.BlendZero,this.blendOperation=he.Add,this.alphaBlendSource=ue.BlendOne,this.alphaBlendDestination=ue.BlendZero,this.alphaBlendOperation=he.Add,this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=!0,this.conservativeRasterization=!1};(i["kha.graphics4.PipelineStateBase"]=sn).__name__=!0,sn.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMaskRed:null,colorWriteMaskGreen:null,colorWriteMaskBlue:null,colorWriteMaskAlpha:null,set_colorWriteMask:function(e){return this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=e},conservativeRasterization:null,__class__:sn,__properties__:{set_colorWriteMask:"set_colorWriteMask"}};var rn=function(){this.program=null,sn.call(this),this.textures=[],this.textureValues=[]};(i["kha.graphics4.PipelineState"]=rn).__name__=!0,rn.__super__=sn,rn.prototype=s(sn.prototype,{program:null,textures:null,textureValues:null,delete:function(){null!=this.program&&F.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&F.gl.deleteProgram(this.program),this.program=F.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),F.gl.attachShader(this.program,this.vertexShader.shader),F.gl.attachShader(this.program,this.fragmentShader.shader);for(var e=0,t=0,i=this.inputLayout;t<i.length;){var n=i[t];++t;for(var s=0,r=n.elements;s<r.length;){var a=r[s];++s,F.gl.bindAttribLocation(this.program,e,a.name),a.data==mn.Float4x4?e+=4:++e}}if(F.gl.linkProgram(this.program),!F.gl.getProgramParameter(this.program,35714))throw new dt("Could not link the shader program:\n"+F.gl.getProgramInfoLog(this.program))},set:function(){F.gl.useProgram(this.program);for(var e=0,t=this.textureValues.length;e<t;){var i=e++;F.gl.uniform1i(this.textureValues[i],i)}F.gl.colorMask(this.colorWriteMaskRed,this.colorWriteMaskGreen,this.colorWriteMaskBlue,this.colorWriteMaskAlpha)},compileShader:function(e){if(null==e.shader){for(var t=F.gl.createShader(e.type),i=0!=F.gl.getShaderPrecisionFormat(35632,36338).precision,n=e.files,s=0,r=n.length;s<r;){var a=s++;if(F.gl2){if(0<=n[a].indexOf("-webgl2")||0<=n[a].indexOf("runtime-string")){F.gl.shaderSource(t,e.sources[a]);break}}else{if(!i&&(0<=n[a].indexOf("-relaxed")||0<=n[a].indexOf("runtime-string"))){F.gl.shaderSource(t,e.sources[a]);break}if(i&&(n[a].indexOf("-relaxed")<0||0<=n[a].indexOf("runtime-string"))){F.gl.shaderSource(t,e.sources[a]);break}}}if(F.gl.compileShader(t),!F.gl.getShaderParameter(t,35713))throw new dt("Could not compile shader:\n"+F.gl.getShaderInfoLog(t));e.shader=t}},getConstantLocation:function(e){for(var t=F.gl.getUniformLocation(this.program,e),i=5126,n=0,s=F.gl.getProgramParameter(this.program,35718);n<s;){var r=n++,a=F.gl.getActiveUniform(this.program,r);if(a.name==e||a.name==e+"[0]"){i=a.type;break}}return new Un(t,i)},getTextureUnit:function(e){var t=this.findTexture(e);if(t<0){var i=F.gl.getUniformLocation(this.program,e);t=this.textures.length,this.textureValues.push(i),this.textures.push(e)}return new Hn(t)},findTexture:function(e){for(var t=0,i=this.textures.length;t<i;){var n=t++;if(this.textures[n]==e)return n}return-1},__class__:rn});var an=i["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"]};an.Keep=["Keep",0],an.Keep.toString=n,(an.Keep.__enum__=an).Zero=["Zero",1],an.Zero.toString=n,(an.Zero.__enum__=an).Replace=["Replace",2],an.Replace.toString=n,(an.Replace.__enum__=an).Increment=["Increment",3],an.Increment.toString=n,(an.Increment.__enum__=an).IncrementWrap=["IncrementWrap",4],an.IncrementWrap.toString=n,(an.IncrementWrap.__enum__=an).Decrement=["Decrement",5],an.Decrement.toString=n,(an.Decrement.__enum__=an).DecrementWrap=["DecrementWrap",6],an.DecrementWrap.toString=n,(an.DecrementWrap.__enum__=an).Invert=["Invert",7],an.Invert.toString=n,an.Invert.__enum__=an;var on=function(e,t){};(i["kha.graphics4.TessellationControlShader"]=on).__name__=!0,on.prototype={delete:function(){},__class__:on};var ln=function(e,t){};(i["kha.graphics4.TessellationEvaluationShader"]=ln).__name__=!0,ln.prototype={delete:function(){},__class__:ln};var _n=i["kha.graphics4.TexDir"]={__ename__:!0,__constructs__:["U","V"]};_n.U=["U",0],_n.U.toString=n,(_n.U.__enum__=_n).V=["V",1],_n.V.toString=n,_n.V.__enum__=_n;var hn=i["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"]};hn.Repeat=["Repeat",0],hn.Repeat.toString=n,(hn.Repeat.__enum__=hn).Mirror=["Mirror",1],hn.Mirror.toString=n,(hn.Mirror.__enum__=hn).Clamp=["Clamp",2],hn.Clamp.toString=n,hn.Clamp.__enum__=hn;var un=i["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"]};un.PointFilter=["PointFilter",0],un.PointFilter.toString=n,(un.PointFilter.__enum__=un).LinearFilter=["LinearFilter",1],un.LinearFilter.toString=n,(un.LinearFilter.__enum__=un).AnisotropicFilter=["AnisotropicFilter",2],un.AnisotropicFilter.toString=n,un.AnisotropicFilter.__enum__=un;var cn=i["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"]};cn.RGBA32=["RGBA32",0],cn.RGBA32.toString=n,(cn.RGBA32.__enum__=cn).L8=["L8",1],cn.L8.toString=n,(cn.L8.__enum__=cn).RGBA128=["RGBA128",2],cn.RGBA128.toString=n,(cn.RGBA128.__enum__=cn).DEPTH16=["DEPTH16",3],cn.DEPTH16.toString=n,(cn.DEPTH16.__enum__=cn).RGBA64=["RGBA64",4],cn.RGBA64.toString=n,(cn.RGBA64.__enum__=cn).A32=["A32",5],cn.A32.toString=n,(cn.A32.__enum__=cn).A16=["A16",6],cn.A16.toString=n,cn.A16.__enum__=cn;var dn=function(){};(i["kha.graphics4.TextureUnit"]=dn).__name__=!0;var fn=i["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"]};fn.StaticUsage=["StaticUsage",0],fn.StaticUsage.toString=n,(fn.StaticUsage.__enum__=fn).DynamicUsage=["DynamicUsage",1],fn.DynamicUsage.toString=n,(fn.DynamicUsage.__enum__=fn).ReadableUsage=["ReadableUsage",2],fn.ReadableUsage.toString=n,fn.ReadableUsage.__enum__=fn;var gn=function(e,t,i,n,s){null==s&&(s=!1),null==n&&(n=0),this.usage=i,this.instanceDataStepRate=n,this.mySize=e;for(var r=this.myStride=0,a=t.elements;r<a.length;){var o=a[r];switch(++r,o.data[1]){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=F.gl.createBuffer();var l=new Ms(e*this.myStride/4|0);this._data=l,this.sizes=[],this.offsets=[],this.sizes[t.elements.length-1]=0;for(var _=this.offsets[t.elements.length-1]=0,h=0,u=0,c=t.elements;u<c.length;){var d,f=c[u];switch(++u,f.data[1]){case 0:d=1;break;case 1:d=2;break;case 2:d=3;break;case 3:d=4;break;case 4:d=16}switch(this.sizes[h]=d,this.offsets[h]=_,f.data[1]){case 0:_+=4;break;case 1:_+=8;break;case 2:_+=12;break;case 3:_+=16;break;case 4:_+=64}++h}};(i["kha.graphics4.VertexBuffer"]=gn).__name__=!0,gn.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,usage:null,instanceDataStepRate:null,delete:function(){this._data=null,F.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e*this.stride(),(e+t)*this.stride())},unlock:function(){F.gl.bindBuffer(34962,this.buffer),F.gl.bufferData(34962,this._data,this.usage==fn.DynamicUsage?35048:35044)},stride:function(){return this.myStride},count:function(){return this.mySize},set:function(e){var t=!!F.gl2||F.gl.getExtension("ANGLE_instanced_arrays");F.gl.bindBuffer(34962,this.buffer);for(var i=0,n=0,s=this.sizes.length;n<s;){var r=n++;if(4<this.sizes[r])for(var a=this.sizes[r],o=0;0<a;)F.gl.enableVertexAttribArray(e+i),F.gl.vertexAttribPointer(e+i,4,5126,!1,this.myStride,this.offsets[r]+o),t&&(F.gl2?F.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),a-=4,o+=16,++i;else F.gl.enableVertexAttribArray(e+i),F.gl.vertexAttribPointer(e+i,this.sizes[r],5126,!1,this.myStride,this.offsets[r]),t&&(F.gl2?F.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),++i}return i},__class__:gn};var mn=i["kha.graphics4.VertexData"]={__ename__:!0,__constructs__:["Float1","Float2","Float3","Float4","Float4x4"]};mn.Float1=["Float1",0],mn.Float1.toString=n,(mn.Float1.__enum__=mn).Float2=["Float2",1],mn.Float2.toString=n,(mn.Float2.__enum__=mn).Float3=["Float3",2],mn.Float3.toString=n,(mn.Float3.__enum__=mn).Float4=["Float4",3],mn.Float4.toString=n,(mn.Float4.__enum__=mn).Float4x4=["Float4x4",4],mn.Float4x4.toString=n,mn.Float4x4.__enum__=mn;var pn=function(e,t){this.name=e,this.data=t};(i["kha.graphics4.VertexElement"]=pn).__name__=!0,pn.prototype={name:null,data:null,__class__:pn};var vn=function(e,t){this.sources=[];for(var i=0;i<e.length;){var n=e[i];++i,this.sources.push(n.toString())}this.type=35633,this.shader=null,this.files=t};(i["kha.graphics4.VertexShader"]=vn).__name__=!0,vn.fromSource=function(e){var t=new vn([],["runtime-string"]);return t.sources.push(e),t},vn.prototype={sources:null,type:null,shader:null,files:null,delete:function(){F.gl.deleteShader(this.shader),this.shader=null,this.sources=null},__class__:vn};var yn=function(){this.elements=[],this.instanced=!1};(i["kha.graphics4.VertexStructure"]=yn).__name__=!0,yn.prototype={elements:null,instanced:null,add:function(e,t){this.elements.push(new pn(e,t))},size:function(){return this.elements.length},byteSize:function(){for(var e=0,t=0,i=this.elements.length;t<i;){var n=t++;e+=this.dataByteSize(this.elements[n].data)}return e},dataByteSize:function(e){switch(e[1]){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(e){return this.elements[e]},__class__:yn};var bn=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],bn.instances[e]=this};(i["kha.input.Gamepad"]=bn).__name__=!0,bn.get=function(e){return null==e&&(e=0),e>=bn.instances.length?null:bn.instances[e]},bn.notifyOnConnect=function(e,t){null!=e&&bn.connectListeners.push(e),null!=t&&bn.disconnectListeners.push(t)},bn.removeConnect=function(e,t){null!=e&&$.remove(bn.connectListeners,e),null!=t&&$.remove(bn.disconnectListeners,t)},bn.sendConnectEvent=function(e){bn.instances[e].connected=!0;for(var t=0,i=bn.connectListeners;t<i.length;){var n=i[t];++t,n(e)}},bn.sendDisconnectEvent=function(e){bn.instances[e].connected=!1;for(var t=0,i=bn.disconnectListeners;t<i.length;){var n=i[t];++t,n(e)}},bn.prototype={index:null,notify:function(e,t){null!=e&&this.axisListeners.push(e),null!=t&&this.buttonListeners.push(t)},remove:function(e,t){null!=e&&$.remove(this.axisListeners,e),null!=t&&$.remove(this.buttonListeners,t)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return F.getGamepadId(this.index)},sendAxisEvent:function(e,t){for(var i=0,n=this.axisListeners;i<n.length;){var s=n[i];++i,s(e,t)}},sendButtonEvent:function(e,t){for(var i=0,n=this.buttonListeners;i<n.length;){var s=n[i];++i,s(e,t)}},__class__:bn,__properties__:{get_id:"get_id"}};var wn=function(){this.__id=ss.nextId++,this._inputBuffer=new Fe(new Es(1))};(i["kha.network.Controller"]=wn).__name__=!0,wn.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(e){},__class__:wn};var xn=e.kha.input.Keyboard=function(){wn.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],xn.instance=this};(i["kha.input.Keyboard"]=xn).__name__=!0,xn.get=function(e){return null==e&&(e=0),F.getKeyboard(e)},xn.__super__=wn,xn.prototype=s(wn.prototype,{notify:function(e,t,i){null!=e&&this.downListeners.push(e),null!=t&&this.upListeners.push(t),null!=i&&this.pressListeners.push(i)},remove:function(e,t,i){null!=e&&$.remove(this.downListeners,e),null!=t&&$.remove(this.upListeners,t),null!=i&&$.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(e){if(null!=_s.the()){var t=new Fe(new Es(4));t.setInt32(0,0),_s.the().sendControllerUpdate(this._id(),t)}for(var i=0,n=this.downListeners;i<n.length;){var s=n[i];++i,s(e)}},sendUpEvent:function(e){if(null!=_s.the()){var t=new Fe(new Es(4));t.setInt32(0,1),_s.the().sendControllerUpdate(this._id(),t)}for(var i=0,n=this.upListeners;i<n.length;){var s=n[i];++i,s(e)}},sendPressEvent:function(e){if(null!=_s.the()){var t=new Fe(new Es(5));t.setInt32(0,2);var i=$.cca(e,0);t.b[4]=255&i,_s.the().sendControllerUpdate(this._id(),t)}for(var n=0,s=this.pressListeners;n<s.length;){var r=s[n];++n,r(e)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t);else{var i=String.fromCharCode(e.b[4]);this.sendPressEvent(i)}else{var n=e.b[4];this.sendUpEvent(n)}else{var s=e.b[4];this.sendDownEvent(s)}},__class__:xn});var Sn=e.kha.input.Mouse=function(){wn.call(this),Sn.instance=this};(i["kha.input.Mouse"]=Sn).__name__=!0,Sn.get=function(e){return null==e&&(e=0),F.getMouse(e)},Sn.__super__=wn,Sn.prototype=s(wn.prototype,{notify:function(e,t,i,n,s){this.notifyWindowed(0,e,t,i,n,s)},remove:function(e,t,i,n,s){this.removeWindowed(0,e,t,i,n,s)},notifyWindowed:function(e,t,i,n,s,r){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(n)}if(null!=s){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(s)}if(null!=r){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(r)}},removeWindowed:function(e,t,i,n,s,r){null!=t&&(null!=this.windowDownListeners?e<this.windowDownListeners.length?$.remove(this.windowDownListeners[e],t):Re.trace('no downListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):Re.trace("no downListeners were ever registered",{fileName:"Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?e<this.windowUpListeners.length?$.remove(this.windowUpListeners[e],i):Re.trace('no upListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):Re.trace("no upListeners were ever registered",{fileName:"Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowMoveListeners?e<this.windowMoveListeners.length?$.remove(this.windowMoveListeners[e],n):Re.trace('no moveListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):Re.trace("no moveListeners were ever registered",{fileName:"Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowWheelListeners?e<this.windowWheelListeners.length?$.remove(this.windowWheelListeners[e],s):Re.trace('no wheelListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):Re.trace("no wheelListeners were ever registered",{fileName:"Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowLeaveListeners?e<this.windowLeaveListeners.length?$.remove(this.windowLeaveListeners[e],r):Re.trace('no leaveListeners for window "'+e+'" are registered',{fileName:"Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):Re.trace("no leaveListeners were ever registered",{fileName:"Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(e,t){},removeFromLockChange:function(e,t){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(e){if(null!=_s.the()){var t=new Fe(new Es(8));t.setInt32(0,0),t.setInt32(4,e),_s.the().sendControllerUpdate(this._id(),t)}if(null!=this.windowLeaveListeners)for(var i=0,n=this.windowLeaveListeners[e];i<n.length;){var s=n[i];++i,s()}},sendDownEvent:function(e,t,i,n){if(null!=_s.the()){var s=new Fe(new Es(20));s.setInt32(0,1),s.setInt32(4,e),s.setInt32(8,t),s.setInt32(12,i),s.setInt32(16,n),_s.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowDownListeners)for(var r=0,a=this.windowDownListeners[e];r<a.length;){var o=a[r];++r,o(t,i,n)}},sendUpEvent:function(e,t,i,n){if(null!=_s.the()){var s=new Fe(new Es(20));s.setInt32(0,2),s.setInt32(4,e),s.setInt32(8,t),s.setInt32(12,i),s.setInt32(16,n),_s.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowUpListeners)for(var r=0,a=this.windowUpListeners[e];r<a.length;){var o=a[r];++r,o(t,i,n)}},sendMoveEvent:function(e,t,i,n,s){if(null!=_s.the()){var r=new Fe(new Es(24));r.setInt32(0,3),r.setInt32(4,e),r.setInt32(8,t),r.setInt32(12,i),r.setInt32(16,n),r.setInt32(20,s),_s.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowMoveListeners)for(var a=0,o=this.windowMoveListeners[e];a<o.length;){var l=o[a];++a,l(t,i,n,s)}},sendWheelEvent:function(e,t){if(null!=_s.the()){var i=new Fe(new Es(12));i.setInt32(0,4),i.setInt32(4,e),i.setInt32(8,t),_s.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowWheelListeners)for(var n=0,s=this.windowWheelListeners[e];n<s.length;){var r=s[n];++n,r(t)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t)if(3!=t)if(4!=t);else{var i=e.getInt32(4),n=e.getInt32(8);this.sendWheelEvent(i,n)}else{var s=e.getInt32(4),r=e.getInt32(8),a=e.getInt32(12),o=e.getInt32(16),l=e.getInt32(20);this.sendMoveEvent(s,r,a,o,l)}else{var _=e.getInt32(4),h=e.getInt32(8),u=e.getInt32(12),c=e.getInt32(16);this.sendUpEvent(_,h,u,c)}else{var d=e.getInt32(4),f=e.getInt32(8),g=e.getInt32(12),m=e.getInt32(16);this.sendDownEvent(d,f,g,m)}else{var p=e.getInt32(4);this.sendLeaveEvent(p)}},__class__:Sn});var Bn=function(){Sn.call(this)};(i["kha.input.MouseImpl"]=Bn).__name__=!0,Bn.__super__=Sn,Bn.prototype=s(Sn.prototype,{lock:function(){F.lockMouse()},unlock:function(){F.unlockMouse()},canLock:function(){return F.canLockMouse()},isLocked:function(){return F.isMouseLocked()},notifyOnLockChange:function(e,t){F.notifyOfMouseLockChange(e,t)},removeFromLockChange:function(e,t){F.removeFromMouseLockChange(e,t)},hideSystemCursor:function(){F.khanvas.style.cursor="none"},showSystemCursor:function(){F.khanvas.style.cursor="default"},_receive:function(e){e.getInt32(0)},__class__:Bn});var Tn=function(){Tn.instance=this};(i["kha.input.Pen"]=Tn).__name__=!0,Tn.get=function(e){return null==e&&(e=0),F.getPen(e)},Tn.prototype={notify:function(e,t,i){this.notifyWindowed(0,e,t,i)},remove:function(e,t,i){this.removeWindowed(0,e,t,i)},notifyWindowed:function(e,t,i,n){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(n)}},removeWindowed:function(e,t,i,n){null!=t&&null!=this.windowDownListeners&&e<this.windowDownListeners.length&&$.remove(this.windowDownListeners[e],t),null!=i&&null!=this.windowUpListeners&&e<this.windowUpListeners.length&&$.remove(this.windowUpListeners[e],i),null!=n&&null!=this.windowMoveListeners&&e<this.windowMoveListeners.length&&$.remove(this.windowMoveListeners[e],n)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(e,t,i,n){if(null!=this.windowDownListeners)for(var s=0,r=this.windowDownListeners[e];s<r.length;){var a=r[s];++s,a(t,i,n)}},sendUpEvent:function(e,t,i,n){if(null!=this.windowUpListeners)for(var s=0,r=this.windowUpListeners[e];s<r.length;){var a=r[s];++s,a(t,i,n)}},sendMoveEvent:function(e,t,i,n){if(null!=this.windowMoveListeners)for(var s=0,r=this.windowMoveListeners[e];s<r.length;){var a=r[s];++s,a(t,i,n)}},__class__:Tn};var kn=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],kn.instance=this};(i["kha.input.Surface"]=kn).__name__=!0,kn.get=function(e){return null==e&&(e=0),0!=e?null:kn.instance},kn.prototype={notify:function(e,t,i){null!=e&&this.touchStartListeners.push(e),null!=t&&this.touchEndListeners.push(t),null!=i&&this.moveListeners.push(i)},remove:function(e,t,i){null!=e&&$.remove(this.touchStartListeners,e),null!=t&&$.remove(this.touchEndListeners,t),null!=i&&this.moveListeners.push(i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(e,t,i){for(var n=0,s=this.touchStartListeners;n<s.length;){var r=s[n];++n,r(e,t,i)}},sendTouchEndEvent:function(e,t,i){for(var n=0,s=this.touchEndListeners;n<s.length;){var r=s[n];++n,r(e,t,i)}},sendMoveEvent:function(e,t,i){for(var n=0,s=this.moveListeners;n<s.length;){var r=s[n];++n,r(e,t,i)}},__class__:kn};var In=function(e){this.bytes=e};(i["kha.internal.BytesBlob"]=In).__name__=!0,In.__interfaces__=[ut],In.fromBytes=function(e){return new In(e)},In.alloc=function(e){return new In(new Fe(new Es(e)))},In.readF32=function(e){var t=0==(-2147483648&e)?1:-1,i=e>>23&255,n=8388607&e;switch(i){case 0:return 0;case 255:return 0!=n?NaN:0<t?1/0:-1/0;default:return t*((n+8388608)/8388608)*Math.pow(2,i-127)}},In.bit=function(e,t){if(1==(e>>>t&1)){return 0,!0}return 0,!1},In.toText=function(e,t){for(var i="",n=0,s=t;n<s;){var r=n++;i+=String.fromCharCode(e[r])}return i},In.prototype={bytes:null,sub:function(e,t){return new In(this.bytes.sub(e,t))},length:null,get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=255&t},readU8:function(e){var t=this.bytes.b[e];return++e,t},readS8:function(e){var t=this.bytes.b[e];return++e,(0==(128&t)?1:-1)*(t&=127)},readU16BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];return e+=2,256*t+i},readU16LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];return e+=2,256*i+t},readU32LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],n=this.bytes.b[e+2],s=this.bytes.b[e+3];return e+=4,t+256*i+256*n*256+256*s*256*256},readU32BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],n=this.bytes.b[e+2],s=this.bytes.b[e+3];return e+=4,s+256*n+256*i*256+256*t*256*256},readS16BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1];e+=2;var n=0==(128&t)?1:-1;return t&=127,-1==n?256*t-32767+i:256*t+i},readS16LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],n=0==(128&i)?1:-1;return i&=127,e+=2,-1==n?256*i-32767+t:256*i+t},readS32LE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],n=this.bytes.b[e+2],s=this.bytes.b[e+3],r=0==(128&s)?1:-1;return s&=127,e+=4,-1==r?-2147483647+t+256*i+256*n*256+256*s*256*256:t+256*i+256*n*256+256*s*256*256},readS32BE:function(e){var t=this.bytes.b[e],i=this.bytes.b[e+1],n=this.bytes.b[e+2],s=this.bytes.b[e+3],r=0==(128&t)?1:-1;return t&=127,e+=4,-1==r?-2147483647+s+256*n+256*i*256+256*t*256*256:s+256*n+256*i*256+256*t*256*256},readF32LE:function(e){return In.readF32(this.readS32LE(e))},readF32BE:function(e){return In.readF32(this.readS32BE(e))},toString:function(){return this.bytes.toString()},readUtf8Char:function(e){if(e.value>=this.get_length())return-1;var t=this.readU8(e.value);++e.value;var i=0;if(In.bit(t,7))if(In.bit(t,7)&&In.bit(t,6)&&!In.bit(t,5)){var n=31&t,s=this.readU8(e.value);++e.value,i=n<<6|63&s}else In.bit(t,7)&&In.bit(t,6)&&In.bit(t,5)&&!In.bit(t,4)?e.value+=2:In.bit(t,7)&&In.bit(t,6)&&In.bit(t,5)&&In.bit(t,4)&&!In.bit(t,3)&&(e.value+=3);else i=t;return i},readUtf8Block:function(e,t){var i=0;if(t.value>=this.get_length())return"";for(;i<2e3;){var n=this.readUtf8Char(t);if(n<0)break;e[i]=n,++i}return In.toText(e,i)},readUtf8String:function(){var e=new Array(2e3),t="",i=0;3<=this.get_length()&&239==this.bytes.b[0]&&187==this.bytes.b[1]&&191==this.bytes.b[2]&&(i=3);for(var n={value:i};n.value<this.get_length();)t+=this.readUtf8Block(e,n);return t},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:In,__properties__:{get_length:"get_length"}};var An=function(){};(i["kha.internal.HdrFormat"]=An).__name__=!0,An.readBuf=function(e){for(var t=0;e[t++]=255&An.buffer[An.fileOffset],++An.fileOffset<An.bufferLength&&t<e.length;);return t},An.readBufOffset=function(e,t,i){for(var n=0;e[t+n++]=255&An.buffer[An.fileOffset],++An.fileOffset<An.bufferLength&&n<i;);return n},An.readPixelsRaw=function(e,t,i,n){var s=4*n,r=An.readBufOffset(t,i,s);r<s&&Re.trace("Error reading raw pixels: got "+r+" bytes, expected "+s,{fileName:"HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},An.readPixelsRawRLE=function(e,t,i,n,s){var r,a,o,l=new Fs(4),_=null,h=new Fs(2);for(e.length;0<s;){if(An.readBuf(l)<l.length)return void Re.trace("Error reading bytes: expected "+l.length,{fileName:"HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=l[0]||2!=l[1]||0!=(128&l[2]))return t[i++]=255&l[0],t[i++]=255&l[1],t[i++]=255&l[2],t[i++]=255&l[3],void An.readPixelsRaw(e,t,i,n*s-1);if(((255&l[2])<<8|255&l[3])!=n)return void Re.trace("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+n,{fileName:"HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==_)_=new Fs(4*n);for(var u=r=0;u<4;){for(a=(u+++1)*n;r<a;){if(An.readBuf(h)<h.length)return void Re.trace("Error reading 2-byte buffer",{fileName:"HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&h[0])){if(0==(o=(255&h[0])-128)||a-r<o)return void Re.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<o--;)_[r++]=255&h[1]}else{if(0==(o=255&h[0])||a-r<o)return void Re.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(_[r++]=255&h[1],0<--o){if(An.readBufOffset(_,r,o)<o)return void Re.trace("Error reading non-run data",{fileName:"HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});r+=o}}}}for(var c=0,d=n;c<d;){var f=c++;t[i]=255&_[f],t[i+1]=255&_[f+n],t[i+2]=255&_[f+2*n],t[i+3]=255&_[f+3*n],i+=4}--s}},An.readLine=function(){for(var e="";;){var t=An.buffer[An.fileOffset];if(10==t){++An.fileOffset;break}if(e+=String.fromCharCode(t),!(++An.fileOffset<An.bufferLength))break}return e},An.parse=function(e){An.buffer=Je.fromBytes(e),An.bufferLength=An.buffer.length;for(var t=An.fileOffset=0,i=0,n=!1,s=0;s<20;){s++;var r=An.readLine();if(An.formatPattern.match(r))n=!0;else if(An.exposurePattern.match(r))parseFloat(An.exposurePattern.matched(1));else if(An.widthHeightPattern.match(r)){i=N.parseInt(An.widthHeightPattern.matched(1)),t=N.parseInt(An.widthHeightPattern.matched(2));break}}if(!n)return Re.trace("File is not run length encoded!",{fileName:"HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var a=new Fs(t*i*4),o=t,l=i;An.readPixelsRawRLE(An.buffer,a,0,o,l);for(var _=new Ms(t*i*4),h=0;h<a.length;){var u=a[h]/255,c=a[h+1]/255,d=a[h+2]/255,f=a[h+3],g=Math.pow(2,f-128);u*=g,c*=g,d*=g,_[h]=u,_[h+1]=c,_[h+2]=d,_[h+3]=1,h+=4}return{width:t,height:i,data:_}},An.prototype={__class__:An};var Dn=function(e){this.stopped=!1,this.element=e};(i["kha.js.AEAudioChannel"]=Dn).__name__=!0,Dn.__interfaces__=[Ut],Dn.prototype={element:null,stopped:null,play:function(){this.stopped=!1,F.mobile?F.insideInputEvent?(this.element.play(),F.mobileAudioPlaying=!0):F.mobileAudioPlaying?this.element.play():Dn.todo.push(this):this.element.play()},pause:function(){try{this.element.pause()}catch(e){e instanceof dt&&(e=e.val),Re.trace(e,{fileName:"AEAudioChannel.hx",lineNumber:39,className:"kha.js.AEAudioChannel",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0,this.stopped=!0}catch(e){e instanceof dt&&(e=e.val),Re.trace(e,{fileName:"AEAudioChannel.hx",lineNumber:50,className:"kha.js.AEAudioChannel",methodName:"stop"})}},length:null,get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},position:null,get_position:function(){return this.element.currentTime},get_volume:function(){return this.element.volume},set_volume:function(e){return this.element.volume=e},finished:null,get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:Dn,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var Cn=function(){};(i["kha.js.AudioElementAudio"]=Cn).__name__=!0,Cn._compile=function(){},Cn.play=function(e,t){return null==t&&(t=!1),Cn.stream(e,t)},Cn.stream=function(e,t){null==t&&(t=!1),e.element.loop=t;var i=new Dn(e.element);return i.play(),i};var Pn=function(e){this.bakedQuadCache=new bt,yi.call(this),this.canvas=e,(Pn.instance=this).myColor=gt.fromBytes(0,0,0),e.save()};(i["kha.js.CanvasGraphics"]=Pn).__name__=!0,Pn.stringWidth=function(e,t){return null==Pn.instance?5*t.length:(Pn.instance.set_font(e),Pn.instance.canvas.measureText(t).width)},Pn.__super__=yi,Pn.prototype=s(yi.prototype,{canvas:null,webfont:null,myColor:null,scaleQuality:null,begin:function(e,t){null==e&&(e=!0),e&&this.clear(t)},clear:function(e){null==e&&(e=0),this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",.00392156862745098*(e>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(e,t,i){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(Ai.__cast(e,ft).image,t,i),this.canvas.globalAlpha=1},drawScaledSubImage:function(e,t,i,n,s,r,a,o,l){this.canvas.globalAlpha=this.get_opacity();try{if(o<0||l<0){this.canvas.save(),this.canvas.translate(r,a);var _=0,h=0;o<0&&(this.canvas.scale(-1,1),_=-o),l<0&&(this.canvas.scale(1,-1),h=-l),this.canvas.drawImage(Ai.__cast(e,ft).image,t,i,n,s,_,h,o,l),this.canvas.restore()}else this.canvas.drawImage(Ai.__cast(e,ft).image,t,i,n,s,r,a,o,l)}catch(e){}this.canvas.globalAlpha=1},set_color:function(e){return this.myColor=e,this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",e},get_color:function(){return this.myColor},get_imageScaleQuality:function(){return this.scaleQuality},set_imageScaleQuality:function(e){return e==Si.Low?(this.canvas.mozImageSmoothingEnabled=!1,this.canvas.webkitImageSmoothingEnabled=!1,this.canvas.msImageSmoothingEnabled=!1,this.canvas.imageSmoothingEnabled=!1):(this.canvas.mozImageSmoothingEnabled=!0,this.canvas.webkitImageSmoothingEnabled=!0,this.canvas.msImageSmoothingEnabled=!0,this.canvas.imageSmoothingEnabled=!0),this.scaleQuality=e},drawRect:function(e,t,i,n,s){null==s&&(s=1),this.canvas.beginPath();var r=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.rect(e,t,i,n),this.canvas.stroke(),this.canvas.lineWidth=r},fillRect:function(e,t,i,n){var s=this.get_opacity();this.canvas.globalAlpha=s*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(e,t,i,n),this.canvas.globalAlpha=this.get_opacity()},drawArc:function(e,t,i,n,s,r,a){null==a&&(a=!1),null==r&&(r=1),this.canvas.beginPath();var o=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.arc(e,t,i,n,s,a),this.canvas.stroke(),this.canvas.lineWidth=o},drawCircle:function(e,t,i,n){null==n&&(n=1);var s=2*Math.PI;this.canvas.beginPath();var r=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(n),this.canvas.arc(e,t,i,0,s,!1),this.canvas.stroke(),this.canvas.lineWidth=r},_drawArc:function(e,t,i,n,s,r,a){this.canvas.beginPath();var o=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.arc(e,t,i,n,s,a),this.canvas.stroke(),this.canvas.lineWidth=o},fillArc:function(e,t,i,n,s,r){null==r&&(r=!1),this.canvas.beginPath(),this.canvas.arc(e,t,i,n,s,r),this.canvas.fill()},fillCircle:function(e,t,i){this.canvas.beginPath(),this.canvas.arc(e,t,i,0,2*Math.PI,!1),this.canvas.fill()},bakedQuadCache:null,drawString:function(e,t,i){var n=this.webfont.getImage(this.get_fontSize(),this.myColor,this.get_fontGlyphs());if(0<n.width)for(var s=t,r=i,a=0,o=e.length;a<o;){var l,_=a++;null!=(l=null!=this.get_fontGlyphs()?this.webfont.kravur._get(this.get_fontSize(),this.get_fontGlyphs()).getBakedQuad(this.bakedQuadCache,this.get_fontGlyphs().indexOf($.cca(e,_)),s,r):this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,$.cca(e,_)-32,s,r))&&(0<l.s1-l.s0&&0<l.t1-l.t0&&0<l.x1-l.x0&&0<l.y1-l.y0&&this.canvas.drawImage(n,l.s0*n.width,l.t0*n.height,(l.s1-l.s0)*n.width,(l.t1-l.t0)*n.height,l.x0,l.y0,l.x1-l.x0,l.y1-l.y0),s+=l.xadvance)}},set_font:function(e){return this.webfont=Ai.__cast(e,Rn),this.webfont},get_font:function(){return this.webfont},drawLine:function(e,t,i,n,s){null==s&&(s=1),this.canvas.beginPath();var r=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.moveTo(e,t),this.canvas.lineTo(i,n),this.canvas.moveTo(0,0),this.canvas.stroke(),this.canvas.lineWidth=r},fillTriangle:function(e,t,i,n,s,r){this.canvas.beginPath(),this.canvas.closePath(),this.canvas.fill()},scissor:function(e,t,i,n){this.canvas.beginPath(),this.canvas.rect(e,t,i,n),this.canvas.clip()},disableScissor:function(){this.canvas.restore()},drawVideo:function(e,t,i,n,s){this.canvas.drawImage(Ai.__cast(e,On).element,t,i,n,s)},setTransformation:function(e){this.canvas.setTransform(e._00,e._01,e._10,e._11,e._20,e._21)},__class__:Pn});var Nn=function(e){this._parts=null,this._parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],this.url=e;var t=new r("^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?://)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\\d*))?)(((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[?#]|$)))*/?)?([^?#/]*))(?:\\?([^#]*))?(?:#(.*))?)","");t.match(e);for(var i=0,n=this._parts.length;i<n;){var s=i++;this[this._parts[s]]=t.matched(s)}};(i["kha.js.URLParser"]=Nn).__name__=!0,Nn.parse=function(e){return new Nn(e)},Nn.prototype={url:null,source:null,protocol:null,authority:null,userInfo:null,user:null,password:null,host:null,port:null,relative:null,path:null,directory:null,file:null,query:null,anchor:null,_parts:null,toString:function(){for(var e="For Url -> "+this.url+"\n",t=0,i=this._parts.length;t<i;){var n=t++;e+=this._parts[n]+": "+N.string(K.field(this,this._parts[n]))+(n==this._parts.length-1?"":"\n")}return e},__class__:Nn};var En=function(){pt.call(this)};(i["kha.js.EnvironmentVariables"]=En).__name__=!0,En.__super__=pt,En.prototype=s(pt.prototype,{getVariable:function(e){for(var t=new Nn(window.location.href).query.split("&"),i=0;i<t.length;){var n=t[i];++i;var s=n.split("=");if(s[0]==e)return s[1]}return Re.trace("Environment variables requested.",{fileName:"EnvironmentVariables.hx",lineNumber:90,className:"kha.js.EnvironmentVariables",methodName:"getVariable"}),""},__class__:En});var Rn=function(e){this.images=new Ge,this.kravur=new Rn.Kravur(e)};(i["kha.js.Font"]=Rn).__name__=!0,Rn.__interfaces__=[ut],Rn.fromBytes=function(e){return new Rn(In.fromBytes(e))},Rn.prototype={kravur:null,images:null,height:function(e){return this.kravur._get(e).getHeight()},width:function(e,t){return this.kravur._get(e).stringWidth(t)},widthOfCharacters:function(e,t,i,n){return this.kravur._get(e).charactersWidth(t,i,n)},baseline:function(e){return this.kravur._get(e).getBaselinePosition()},getImage:function(e,t,i){var n=null==i?e:1e4*e+i.length;if(!this.images.h.hasOwnProperty(n)){var s=this.images,r=new Ge;s.h[n]=r}if(!this.images.h[n].h.hasOwnProperty(t)){var a=this.kravur._get(e,i),o=window.document.createElement("canvas");o.width=a.width,o.height=a.height;var l=o.getContext("2d");l.fillStyle="black",l.fillRect(0,0,a.width,a.height);for(var _=l.getImageData(0,0,a.width,a.height),h=Ai.__cast(a.getTexture(),ft).bytes,u=0,c=h.length;u<c;){var d=u++;_.data[4*d]=(16711680&t)>>>16,_.data[4*d+1]=(65280&t)>>>8,_.data[4*d+2]=255&t,_.data[4*d+3]=h.b[d]}l.putImageData(_,0,0);var f=window.document.createElement("img");return f.src=o.toDataURL("image/png"),this.images.h[n].h[t]=f}return this.images.h[n].h[t]},unload:function(){this.kravur=null,this.images=null},__class__:Rn};var Ln=function(){};(i["kha.js.MobileWebAudio"]=Ln).__name__=!0,Ln._init=function(){try{return void(Ln._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},Ln.play=function(e,t){null==t&&(t=!1);var i=new Mn(e,t);return i.play(),i},Ln.stream=function(e,t){return null==t&&(t=!1),Ln.play(e,t)};var Mn=function(e,t){this.stopped=!1,this.paused=!1,this.buffer=e._buffer,this.loop=t,this.createSource()};(i["kha.js.MobileWebAudioChannel"]=Mn).__name__=!0,Mn.__interfaces__=[Ut],Mn.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var e=this;this.source=Ln._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){e.stopped=!0},this.gain=Ln._context.createGain(),this.source.connect(this.gain),this.gain.connect(Ln._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=Ln._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=Ln._context.currentTime,this.source.start())},pause:function(){this.pauseTime=Ln._context.currentTime-this.startTime,this.paused=!0,this.source.stop()},stop:function(){this.paused=!1,this.stopped=!0,this.source.stop()},length:null,get_length:function(){return this.source.buffer.duration},position:null,get_position:function(){return this.stopped?this.get_length():this.paused?this.pauseTime:Ln._context.currentTime-this.startTime},get_volume:function(){return this.gain.gain.value},set_volume:function(e){return this.gain.gain.value=e},finished:null,get_finished:function(){return this.stopped},__class__:Mn,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",get_position:"get_position",get_length:"get_length"}};var Fn=function(e,t,i){var n=this;Dt.call(this);var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onerror=function(){i({url:e})},s.onload=function(){n.compressedData=Fe.ofData(s.response),n.uncompressedData=null,Ln._context.decodeAudioData(n.compressedData.b.bufferValue,function(e){n._buffer=e,t(n)},function(){i({url:e,error:"Audio format not supported"})})},s.send(null)};(i["kha.js.MobileWebAudioSound"]=Fn).__name__=!0,Fn.__super__=Dt,Fn.prototype=s(Dt.prototype,{_buffer:null,uncompress:function(e){e()},__class__:Fn});var Vn=function(e,t,i){Dt.call(this),this.done=t,this.failed=i,Vn.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var n=0;n<e.length;){var s=e[n];++n,""!=this.element.canPlayType("audio/ogg")&&X.endsWith(s,".ogg")&&this.filenames.push(s),""!=this.element.canPlayType("audio/mp4")&&X.endsWith(s,".mp4")&&this.filenames.push(s)}this.element.addEventListener("error",Ts(this,this.errorListener),!1),this.element.addEventListener("canplay",Ts(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(i["kha.js.Sound"]=Vn).__name__=!0,Vn.__super__=Dt,Vn.prototype=s(Dt.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var n=t++;if(this.element.src==this.filenames[n])return void(this.element.src=this.filenames[n+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Ts(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Ts(this,this.canPlayThroughListener),!1),this.done(this),$.remove(Vn.loading,this)},uncompress:function(e){e()},__class__:Vn});var On=function(){Pt.call(this)};(i["kha.js.Video"]=On).__name__=!0,On.fromElement=function(e){var t=new On;return t.element=e,null!=F.gl&&(t.texture=ct.fromVideo(t)),t},On.fromFile=function(e,t){var i=new On;i.done=t,i.element=window.document.createElement("video"),i.filenames=[];for(var n=0;n<e.length;){var s=e[n];++n,""!=i.element.canPlayType("video/webm")&&X.endsWith(s,".webm")&&i.filenames.push(s),""!=i.element.canPlayType("video/mp4")&&X.endsWith(s,".mp4")&&i.filenames.push(s)}i.element.addEventListener("error",Ts(i,i.errorListener),!1),i.element.addEventListener("canplaythrough",Ts(i,i.canPlayThroughListener),!1),i.element.preload="auto",i.element.src=i.filenames[0]},On.__super__=Pt,On.prototype=s(Pt.prototype,{filenames:null,element:null,done:null,texture:null,width:function(){return this.element.videoWidth},height:function(){return this.element.videoHeight},play:function(e){null==e&&(e=!1);try{this.element.loop=e,this.element.play()}catch(e){e instanceof dt&&(e=e.val),Re.trace(e,{fileName:"Video.hx",lineNumber:64,className:"kha.js.Video",methodName:"play"})}},pause:function(){try{this.element.pause()}catch(e){e instanceof dt&&(e=e.val),Re.trace(e,{fileName:"Video.hx",lineNumber:73,className:"kha.js.Video",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0}catch(e){e instanceof dt&&(e=e.val),Re.trace(e,{fileName:"Video.hx",lineNumber:83,className:"kha.js.Video",methodName:"stop"})}},getCurrentPos:function(){return Math.ceil(1e3*this.element.currentTime)},get_position:function(){return Math.ceil(1e3*this.element.currentTime)},set_position:function(e){return this.element.currentTime=e/1e3,e},getLength:function(){return isFinite(this.element.duration)?Math.floor(1e3*this.element.duration):-1},errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var n=t++;if(this.element.src==this.filenames[n])return void(this.element.src=this.filenames[n+1])}Re.trace("Error loading "+this.element.src,{fileName:"Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Ts(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Ts(this,this.canPlayThroughListener),!1),null!=F.gl&&(this.texture=ct.fromVideo(this)),this.done(this)},__class__:On});var Gn=function(e,t,i){var n=this;Dt.call(this);var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onerror=function(){i({url:e})},s.onload=function(){n.compressedData=Fe.ofData(s.response),n.uncompressedData=null,t(n)},s.send(null)};(i["kha.js.WebAudioSound"]=Gn).__name__=!0,Gn.__super__=Dt,Gn.prototype=s(Dt.prototype,{superUncompress:function(e){Dt.prototype.uncompress.call(this,e)},uncompress:function(d){var f=this;Wt._context.decodeAudioData(this.compressedData.b.bufferValue,function(e){var i=e.getChannelData(0),t=i.length,n=new Ms(2*t);if(f.uncompressedData=n,1==e.numberOfChannels){var s=0,r=0,a=2*t,o=function(){};(o=function(){for(var e=s+11025,t=a<e?a:e;s<t;)f.uncompressedData[s]=i[r],f.uncompressedData[s+1]=i[r],s+=2,r+=1;s<a?window.setTimeout(o,0):f.compressedData=null})(),window.setTimeout(d,250)}else{var l=e.getChannelData(1),_=0,h=0,u=2*t,c=function(){};(c=function(){for(var e=_+11025,t=u<e?u:e;_<t;)f.uncompressedData[_]=i[h],f.uncompressedData[_+1]=l[h],_+=2,h+=1;_<u?window.setTimeout(c,0):f.compressedData=null})(),window.setTimeout(d,250)}},function(){f.superUncompress(d)})},__class__:Gn});var Un=function(e,t){this.value=e,this.type=t};(i["kha.js.graphics4.ConstantLocation"]=Un).__name__=!0,Un.__interfaces__=[Zi],Un.prototype={value:null,type:null,__class__:Un};var Wn=function(e){var t=new Ms(9);this.matrix3Cache=t;var i=new Ms(16);this.matrixCache=i,this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=e,this.init(),F.gl2?this.instancedExtension=!0:(this.instancedExtension=F.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=F.gl.getExtension("EXT_blend_minmax"))};(i["kha.js.graphics4.Graphics"]=Wn).__name__=!0,Wn.__interfaces__=[qi],Wn.getBlendFunc=function(e){switch(e[1]){case 0:case 2:return 0;case 1:return 1;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},Wn.getBlendOp=function(e){switch(e[1]){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},Wn.prototype={depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=Ai.__instanceof(this.renderTarget,ji),this.isCubeMap){var e=Ai.__cast(this.renderTarget,ji);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture,this.isDepthAttachment=e.isDepthAttachment}else{var t=Ai.__cast(this.renderTarget,Nt);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture}},begin:function(e){if(F.gl.enable(3042),F.gl.blendFunc(770,771),null==this.renderTarget)F.gl.bindFramebuffer(36160,null),F.gl.viewport(0,0,M.windowWidth(),M.windowHeight());else if(F.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),F.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=e){F.gl.framebufferTexture2D(36160,F.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var t=0,i=e.length;t<i;){var n=t++;F.gl.framebufferTexture2D(36160,F.drawBuffers.COLOR_ATTACHMENT0_WEBGL+n+1,3553,Ai.__cast(e[n],Nt).texture,0)}for(var s=[F.drawBuffers.COLOR_ATTACHMENT0_WEBGL],r=0,a=e.length;r<a;){var o=r++;s.push(F.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}F.gl2?F.gl.drawBuffers(s):F.drawBuffers.drawBuffersWEBGL(s)}},beginFace:function(e){F.gl.enable(3042),F.gl.blendFunc(770,771),F.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),F.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+e,this.renderTargetTexture,0),F.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},beginEye:function(e){F.gl.enable(3042),F.gl.blendFunc(770,771),F.gl.bindFramebuffer(36160,null),0==e?F.gl.viewport(0,0,.5*M.windowWidth()|0,M.windowHeight()):F.gl.viewport(.5*M.windowWidth()|0,0,.5*M.windowWidth()|0,M.windowHeight())},end:function(){},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(e,t,i){var n=0;null!=e&&(n|=16384,F.gl.colorMask(!0,!0,!0,!0),F.gl.clearColor(.00392156862745098*((16711680&e)>>>16),.00392156862745098*((65280&e)>>>8),.00392156862745098*(255&e),.00392156862745098*(e>>>24))),null!=t&&(n|=256,F.gl.enable(2929),F.gl.depthMask(!0),F.gl.clearDepth(t)),null!=i&&(n|=1024,F.gl.enable(2960),F.gl.stencilMask(255),F.gl.clearStencil(i)),F.gl.clear(n),F.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?F.gl.enable(2929):F.gl.disable(2929),F.gl.depthMask(this.depthMask)},viewport:function(e,t,i,n){var s=null==this.renderTarget?M.windowHeight(0):this.renderTarget.get_height();F.gl.viewport(e,s-t-n,i,n)},setDepthMode:function(e,t){switch(t[1]){case 0:e?F.gl.enable(2929):F.gl.disable(2929),this.depthTest=e,F.gl.depthFunc(519);break;case 1:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(512);break;case 2:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(514);break;case 3:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(517);break;case 4:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(513);break;case 5:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(515);break;case 6:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(516);break;case 7:F.gl.enable(2929),this.depthTest=!0,F.gl.depthFunc(518)}F.gl.depthMask(e),this.depthMask=e},setBlendingMode:function(e,t,i,n,s,r){e==ue.BlendOne&&t==ue.BlendZero?F.gl.disable(3042):(F.gl.enable(3042),F.gl.blendFuncSeparate(Wn.getBlendFunc(e),Wn.getBlendFunc(t),Wn.getBlendFunc(n),Wn.getBlendFunc(s)),F.gl.blendEquationSeparate(Wn.getBlendOp(i),Wn.getBlendOp(r)))},createVertexBuffer:function(e,t,i,n){return null==n&&(n=!1),new gn(e,t,i)},setVertexBuffer:function(e){Ai.__cast(e,gn).set(0)},setVertexBuffers:function(e){for(var t=0,i=0;i<e.length;){var n=e[i];++i,t+=Ai.__cast(n,gn).set(t)}},createIndexBuffer:function(e,t,i){return null==i&&(i=!1),new tn(e,t)},setIndexBuffer:function(e){this.indicesCount=e.count(),Ai.__cast(e,tn).set()},setTexture:function(e,t){null==t?(F.gl.activeTexture(33984+Ai.__cast(e,Hn).value),F.gl.bindTexture(3553,null)):Ai.__cast(t,Nt).set(Ai.__cast(e,Hn).value)},setTextureDepth:function(e,t){Ai.__cast(t,Nt).setDepth(Ai.__cast(e,Hn).value)},setTextureArray:function(e,t){},setVideoTexture:function(e,t){null==t?(F.gl.activeTexture(33984+Ai.__cast(e,Hn).value),F.gl.bindTexture(3553,null)):Ai.__cast(Ai.__cast(t,On).texture,Nt).set(Ai.__cast(e,Hn).value)},setImageTexture:function(e,t){},setTextureParameters:function(e,t,i,n,s,r){switch(F.gl.activeTexture(33984+Ai.__cast(e,Hn).value),t[1]){case 0:F.gl.texParameteri(3553,10242,10497);break;case 1:F.gl.texParameteri(3553,10242,33648);break;case 2:F.gl.texParameteri(3553,10242,33071)}switch(i[1]){case 0:F.gl.texParameteri(3553,10243,10497);break;case 1:F.gl.texParameteri(3553,10243,33648);break;case 2:F.gl.texParameteri(3553,10243,33071)}switch(n[1]){case 0:switch(r[1]){case 0:F.gl.texParameteri(3553,10241,9728);break;case 1:F.gl.texParameteri(3553,10241,9984);break;case 2:F.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(r[1]){case 0:F.gl.texParameteri(3553,10241,9729);break;case 1:F.gl.texParameteri(3553,10241,9985);break;case 2:F.gl.texParameteri(3553,10241,9987)}n==un.AnisotropicFilter&&F.gl.texParameteri(3553,F.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(s[1]){case 0:F.gl.texParameteri(3553,10240,9728);break;case 1:case 2:F.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(e,t,i,n,s,r,a){},setCubeMap:function(e,t){null==t?(F.gl.activeTexture(33984+Ai.__cast(e,Hn).value),F.gl.bindTexture(34067,null)):t.set(Ai.__cast(e,Hn).value)},setCubeMapDepth:function(e,t){t.setDepth(Ai.__cast(e,Hn).value)},setCullMode:function(e){switch(e[1]){case 0:F.gl.enable(2884),F.gl.cullFace(1029);break;case 1:F.gl.enable(2884),F.gl.cullFace(1028);break;case 2:F.gl.disable(2884)}},setPipeline:function(e){this.setCullMode(e.cullMode),this.setDepthMode(e.depthWrite,e.depthMode),this.setStencilParameters(e.stencilMode,e.stencilBothPass,e.stencilDepthFail,e.stencilFail,e.stencilReferenceValue,e.stencilReadMask,e.stencilWriteMask),this.setBlendingMode(e.blendSource,e.blendDestination,e.blendOperation,e.alphaBlendSource,e.alphaBlendDestination,e.alphaBlendOperation),e.set(),this.colorMaskRed=e.colorWriteMaskRed,this.colorMaskGreen=e.colorWriteMaskGreen,this.colorMaskBlue=e.colorWriteMaskBlue,this.colorMaskAlpha=e.colorWriteMaskAlpha},setBool:function(e,t){F.gl.uniform1i(Ai.__cast(e,Un).value,t?1:0)},setInt:function(e,t){F.gl.uniform1i(Ai.__cast(e,Un).value,t)},setFloat:function(e,t){F.gl.uniform1f(Ai.__cast(e,Un).value,t)},setFloat2:function(e,t,i){F.gl.uniform2f(Ai.__cast(e,Un).value,t,i)},setFloat3:function(e,t,i,n){F.gl.uniform3f(Ai.__cast(e,Un).value,t,i,n)},setFloat4:function(e,t,i,n,s){F.gl.uniform4f(Ai.__cast(e,Un).value,t,i,n,s)},setFloats:function(e,t){var i=Ai.__cast(e,Un);switch(i.type){case 35664:F.gl.uniform2fv(i.value,t);break;case 35665:F.gl.uniform3fv(i.value,t);break;case 35666:F.gl.uniform4fv(i.value,t);break;case 35676:F.gl.uniformMatrix4fv(i.value,!1,t);break;default:F.gl.uniform1fv(i.value,t)}},setVector2:function(e,t){F.gl.uniform2f(Ai.__cast(e,Un).value,t.x,t.y)},setVector3:function(e,t){F.gl.uniform3f(Ai.__cast(e,Un).value,t.x,t.y,t.z)},setVector4:function(e,t){F.gl.uniform4f(Ai.__cast(e,Un).value,t.x,t.y,t.z,t.w)},matrixCache:null,setMatrix:function(e,t){this.matrixCache[0]=t._00,this.matrixCache[1]=t._01,this.matrixCache[2]=t._02,this.matrixCache[3]=t._03,this.matrixCache[4]=t._10,this.matrixCache[5]=t._11,this.matrixCache[6]=t._12,this.matrixCache[7]=t._13,this.matrixCache[8]=t._20,this.matrixCache[9]=t._21,this.matrixCache[10]=t._22,this.matrixCache[11]=t._23,this.matrixCache[12]=t._30,this.matrixCache[13]=t._31,this.matrixCache[14]=t._32,this.matrixCache[15]=t._33,F.gl.uniformMatrix4fv(Ai.__cast(e,Un).value,!1,this.matrixCache)},matrix3Cache:null,setMatrix3:function(e,t){this.matrix3Cache[0]=t._00,this.matrix3Cache[1]=t._01,this.matrix3Cache[2]=t._02,this.matrix3Cache[3]=t._10,this.matrix3Cache[4]=t._11,this.matrix3Cache[5]=t._12,this.matrix3Cache[6]=t._20,this.matrix3Cache[7]=t._21,this.matrix3Cache[8]=t._22,F.gl.uniformMatrix3fv(Ai.__cast(e,Un).value,!1,this.matrix3Cache)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0);var i=null==F.elementIndexUint?5123:5125,n=5123==i?2:4;F.gl.drawElements(4,-1==t?this.indicesCount:t,i,e*n)},convertStencilAction:function(e){switch(e[1]){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},setStencilParameters:function(e,t,i,n,s,r,a){if(null==a&&(a=255),null==r&&(r=255),e==Hi.Always&&t==an.Keep&&i==an.Keep&&n==an.Keep)F.gl.disable(2960);else{F.gl.enable(2960);var o=0;switch(e[1]){case 0:o=519;break;case 1:o=512;break;case 2:o=514;break;case 3:o=517;break;case 4:o=513;break;case 5:o=515;break;case 6:o=516;break;case 7:o=518}F.gl.stencilMask(a),F.gl.stencilOp(this.convertStencilAction(n),this.convertStencilAction(i),this.convertStencilAction(t)),F.gl.stencilFunc(o,s,r)}},scissor:function(e,t,i,n){F.gl.enable(3089),null==this.renderTarget?F.gl.scissor(e,M.windowHeight(0)-t-n,i,n):F.gl.scissor(e,t,i,n)},disableScissor:function(){F.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},drawIndexedVerticesInstanced:function(e,t,i){if(null==i&&(i=-1),null==t&&(t=0),this.instancedRenderingAvailable()){var n=null==F.elementIndexUint?5123:5125,s=null==F.elementIndexUint?2:4;F.gl2?F.gl.drawElementsInstanced(4,-1==i?this.indicesCount:i,n,t*s,e):this.instancedExtension.drawElementsInstancedANGLE(4,-1==i?this.indicesCount:i,n,t*s,e)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:Wn};var zn=function(e){en.call(this,e)};(i["kha.js.graphics4.Graphics2"]=zn).__name__=!0,zn.__super__=en,zn.prototype=s(en.prototype,{drawVideoInternal:function(e,t,i,n,s){var r=Ai.__cast(e,On);this.drawScaledSubImage(r.texture,0,0,r.texture.get_width(),r.texture.get_height(),t,i,n,s)},begin:function(e,t){null==e&&(e=!0),F.gl.colorMask(!0,!0,!0,!0),F.gl.disable(2929),F.gl.depthFunc(519),en.prototype.begin.call(this,e,t)},__class__:zn});var Hn=function(e){this.value=e};(i["kha.js.graphics4.TextureUnit"]=Hn).__name__=!0,Hn.__interfaces__=[dn],Hn.prototype={value:null,__class__:Hn};var Zn=function(){};(i["kha.vr.VrInterface"]=Zn).__name__=!0,Zn.prototype={GetSensorState:function(){return null},GetPredictedSensorState:function(e){return null},WarpSwapBlack:function(){},WarpSwapLoadingIcon:function(){},WarpSwap:function(e){},IsPresenting:function(){return!1},IsVrEnabled:function(){return!1},GetTimeInSeconds:function(){return 0},GetProjectionMatrix:function(e){return null},GetViewMatrix:function(e){return null},onVRRequestPresent:function(){},onVRExitPresent:function(){},onResetPose:function(){},__class__:Zn};var jn=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.rightViewMatrix=new Kn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.leftViewMatrix=new Kn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.rightProjectionMatrix=new Kn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.leftProjectionMatrix=new Kn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.vrEnabled=!1,Zn.call(this)};(i["kha.js.vr.VrInterface"]=jn).__name__=!0,jn.__super__=Zn,jn.prototype=s(Zn.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,leftProjectionMatrix:null,rightProjectionMatrix:null,leftViewMatrix:null,rightViewMatrix:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var n=this;navigator.getVRDisplays().then(function(e){if(0<e.length){n.frameData=new VRFrameData,n.vrDisplay=e[0],n.vrDisplay.depthNear=.1,n.vrDisplay.depthFar=1024;var t=n.vrDisplay.getEyeParameters("left"),i=n.vrDisplay.getEyeParameters("right");n.width=F.khanvas.width,n.height=F.khanvas.height,n.vrWidth=2*Math.max(t.renderWidth,i.renderWidth)|0,n.vrHeight=0|Math.max(t.renderHeight,i.renderHeight)}else Re.trace("There are no VR displays connected.",{fileName:"VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},onVRRequestPresent:function(){var e=this;try{this.vrDisplay.requestPresent([{source:F.khanvas}]).then(function(){e.onResize(),e.vrDisplay.requestAnimationFrame(Ts(e,e.onAnimationFrame))})}catch(e){e instanceof dt&&(e=e.val),Re.trace("Failed to requestPresent.",{fileName:"VrInterface.hx",lineNumber:71,className:"kha.js.vr.VrInterface",methodName:"onVRRequestPresent"}),Re.trace(e,{fileName:"VrInterface.hx",lineNumber:72,className:"kha.js.vr.VrInterface",methodName:"onVRRequestPresent"})}},onVRExitPresent:function(){var e=this;try{this.vrDisplay.exitPresent([{source:F.khanvas}]).then(function(){e.onResize()})}catch(e){e instanceof dt&&(e=e.val),Re.trace("Failed to exitPresent.",{fileName:"VrInterface.hx",lineNumber:82,className:"kha.js.vr.VrInterface",methodName:"onVRExitPresent"}),Re.trace(e,{fileName:"VrInterface.hx",lineNumber:83,className:"kha.js.vr.VrInterface",methodName:"onVRExitPresent"})}},onResetPose:function(){try{this.vrDisplay.resetPose()}catch(e){e instanceof dt&&(e=e.val),Re.trace("Failed to resetPose",{fileName:"VrInterface.hx",lineNumber:91,className:"kha.js.vr.VrInterface",methodName:"onResetPose"}),Re.trace(e,{fileName:"VrInterface.hx",lineNumber:92,className:"kha.js.vr.VrInterface",methodName:"onResetPose"})}},onAnimationFrame:function(e){null!=this.vrDisplay&&this.vrDisplay.isPresenting&&(this.vrDisplay.requestAnimationFrame(Ts(this,this.onAnimationFrame)),this.vrDisplay.getFrameData(this.frameData),this.leftProjectionMatrix=this.createMatrixFromArray(this.frameData.leftProjectionMatrix),this.leftViewMatrix=this.createMatrixFromArray(this.frameData.leftViewMatrix),this.rightProjectionMatrix=this.createMatrixFromArray(this.frameData.rightProjectionMatrix),this.rightViewMatrix=this.createMatrixFromArray(this.frameData.rightViewMatrix),this.vrDisplay.submitFrame())},onResize:function(){null!=this.vrDisplay&&this.vrDisplay.isPresenting?(F.khanvas.width=this.vrWidth,F.khanvas.height=this.vrHeight):(F.khanvas.width=this.width,F.khanvas.height=this.height)},GetSensorState:function(){return this.GetPredictedSensorState(0)},GetPredictedSensorState:function(e){var t=new fs;t.Predicted=new ds,t.Recorded=t.Predicted,t.Predicted.AngularAcceleration=new ts,t.Predicted.AngularVelocity=new ts,t.Predicted.LinearAcceleration=new ts,t.Predicted.LinearVelocity=new ts,t.Predicted.TimeInSeconds=e,t.Predicted.Pose=new cs,t.Predicted.Pose.Orientation=new $n,t.Predicted.Pose.Position=new ts;var i=this.frameData.pose;return null!=i&&(t.Predicted.AngularVelocity=this.createVectorFromArray(i.angularVelocity),t.Predicted.AngularAcceleration=this.createVectorFromArray(i.angularAcceleration),t.Predicted.LinearVelocity=this.createVectorFromArray(i.linearVelocity),t.Predicted.LinearAcceleration=this.createVectorFromArray(i.linearAcceleration),t.Predicted.Pose.Orientation=this.createQuaternion(i.orientation),t.Predicted.Pose.Position=this.createVectorFromArray(i.position)),t},WarpSwapBlack:function(){},WarpSwapLoadingIcon:function(){},WarpSwap:function(e){},IsPresenting:function(){return null!=this.vrDisplay&&this.vrDisplay.isPresenting},IsVrEnabled:function(){return this.vrEnabled},GetTimeInSeconds:function(){return L.time()},GetProjectionMatrix:function(e){return 0==e?this.leftProjectionMatrix:this.rightProjectionMatrix},GetViewMatrix:function(e){return 0==e?this.leftViewMatrix:this.rightViewMatrix},createMatrixFromArray:function(e){var t=new Kn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._00=e[0],t._01=e[1],t._02=e[2],t._03=e[3],t._10=e[4],t._11=e[5],t._12=e[6],t._13=e[7],t._20=e[8],t._21=e[9],t._22=e[10],t._23=e[11],t._30=e[12],t._31=e[13],t._32=e[14],t._33=e[15],t},createVectorFromArray:function(e){var t=new ts(0,0,0);return null!=e&&(t.x=e[0],t.y=e[1],t.z=e[2]),t},createQuaternion:function(e){var t=new $n(0,0,0,0);return null!=e&&(t.set_x(e[0]),t.set_y(e[1]),t.set_z(e[2]),t.set_w(e[3])),t},__class__:jn});var Kn=function(e,t,i,n,s,r,a,o,l,_,h,u,c,d,f,g){this._00=e,this._10=t,this._20=i,this._30=n,this._01=s,this._11=r,this._21=a,this._31=o,this._02=l,this._12=_,this._22=h,this._32=u,this._03=c,this._13=d,this._23=f,this._33=g};(i["kha.math.FastMatrix4"]=Kn).__name__=!0,Kn.fromMatrix4=function(e){return new Kn(e._00,e._10,e._20,e._30,e._01,e._11,e._21,e._31,e._02,e._12,e._22,e._32,e._03,e._13,e._23,e._33)},Kn.orthogonalProjection=function(e,t,i,n,s,r){return new Kn(2/(t-e),0,0,-(t+e)/(t-e),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},Kn.perspectiveProjection=function(e,t,i,n){var s=1/Math.tan(e/2);return new Kn(s/t,0,0,0,0,s,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},Kn.lookAt=function(e,t,i){var n=new Yn(t.x-e.x,t.y-e.y,t.z-e.z);n.set_length(1);var s,r,a,o=n.y*i.z-n.z*i.y,l=n.z*i.x-n.x*i.z,_=n.x*i.y-n.y*i.x,h=new Yn(o,l,_);return h.set_length(1),a=h.y*n.z-h.z*n.y,r=h.z*n.x-h.x*n.z,s=h.x*n.y-h.y*n.x,new Kn(h.x,h.y,h.z,-(h.x*e.x+h.y*e.y+h.z*e.z),a,r,s,-(a*e.x+r*e.y+s*e.z),-n.x,-n.y,-n.z,n.x*e.x+n.y*e.y+n.z*e.z,0,0,0,1)},Kn.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:Kn};var Xn=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(i["kha.math.FastVector2"]=Xn).__name__=!0,Xn.fromVector2=function(e){return new Xn(e.x,e.y)},Xn.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,e},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:Xn,__properties__:{set_length:"set_length",get_length:"get_length"}};var Yn=function(e,t,i){null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i};(i["kha.math.FastVector3"]=Yn).__name__=!0,Yn.fromVector3=function(e){return new Yn(e.x,e.y,e.z)},Yn.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,e},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:Yn,__properties__:{set_length:"set_length",get_length:"get_length"}};var qn=function(e,t,i,n){null==n&&(n=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i,this.w=n};(i["kha.math.FastVector4"]=qn).__name__=!0,qn.fromVector4=function(e){return new qn(e.x,e.y,e.z,e.w)},qn.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,e},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:qn,__properties__:{set_length:"set_length",get_length:"get_length"}};var Qn=function(e,t,i,n,s,r,a,o,l){this._00=e,this._10=t,this._20=i,this._01=n,this._11=s,this._21=r,this._02=a,this._12=o,this._22=l};(i["kha.math.Matrix3"]=Qn).__name__=!0,Qn.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Qn};var Jn=function(e,t,i,n,s,r,a,o,l,_,h,u,c,d,f,g){this._00=e,this._10=t,this._20=i,this._30=n,this._01=s,this._11=r,this._21=a,this._31=o,this._02=l,this._12=_,this._22=h,this._32=u,this._03=c,this._13=d,this._23=f,this._33=g};(i["kha.math.Matrix4"]=Jn).__name__=!0,Jn.orthogonalProjection=function(e,t,i,n,s,r){return new Jn(2/(t-e),0,0,-(t+e)/(t-e),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},Jn.perspectiveProjection=function(e,t,i,n){var s=1/Math.tan(e/2);return new Jn(s/t,0,0,0,0,s,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},Jn.lookAt=function(e,t,i){var n=new ts(t.x-e.x,t.y-e.y,t.z-e.z);n.set_length(1);var s,r,a,o=n.y*i.z-n.z*i.y,l=n.z*i.x-n.x*i.z,_=n.x*i.y-n.y*i.x,h=new ts(o,l,_);return h.set_length(1),a=h.y*n.z-h.z*n.y,r=h.z*n.x-h.x*n.z,s=h.x*n.y-h.y*n.x,new Jn(h.x,h.y,h.z,-(h.x*e.x+h.y*e.y+h.z*e.z),a,r,s,-(a*e.x+r*e.y+s*e.z),-n.x,-n.y,-n.z,n.x*e.x+n.y*e.y+n.z*e.z,0,0,0,1)},Jn.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:Jn};var $n=function(e,t,i,n){null==n&&(n=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.values=[],this.values.push(e),this.values.push(t),this.values.push(i),this.values.push(n)};(i["kha.math.Quaternion"]=$n).__name__=!0,$n.fromAxisAngle=function(e,t){var i=new $n;i.set_w(Math.cos(t/2)),i.set_x(i.set_y(i.set_z(Math.sin(t/2))));var n=i;n.set_x(n.get_x()*e.x);var s=i;s.set_y(s.get_y()*e.y);var r=i;return r.set_z(r.get_z()*e.z),i},$n.prototype={values:null,slerp:function(e,t){var i=this.dot(t);if(.9995<i){var n=t.add(this.sub(t).scaled(e));return n.normalize(),n}i<0&&(i=0),1<i&&(i=1);var s=Math.acos(i)*e,r=t.sub(this.scaled(i));r.normalize();var a=this.scaled(Math.cos(s)).add(r.scaled(Math.sin(s)));return a.normalize(),a},rotated:function(e){var t=new $n;return t.set_w(this.get_w()*e.get_w()-this.get_x()*e.get_x()-this.get_y()*e.get_y()-this.get_z()*e.get_z()),t.set_x(this.get_w()*e.get_x()+this.get_x()*e.get_w()+this.get_y()*e.get_z()-this.get_z()*e.get_y()),t.set_y(this.get_w()*e.get_y()+this.get_y()*e.get_w()+this.get_z()*e.get_x()-this.get_x()*e.get_z()),t.set_z(this.get_w()*e.get_z()+this.get_z()*e.get_w()+this.get_x()*e.get_y()-this.get_y()*e.get_x()),t.normalize(),t},scaled:function(e){return new $n(this.get_x()*e,this.get_y()*e,this.get_z()*e,this.get_w()*e)},scale:function(e){this.set_x(this.get_x()*e),this.set_y(this.get_y()*e),this.set_z(this.get_z()*e),this.set_w(this.get_w()*e)},matrix:function(){var e=2*this.get_x(),t=2*this.get_y(),i=2*this.get_z(),n=this.get_w()*e,s=this.get_w()*t,r=this.get_w()*i,a=this.get_x()*e,o=this.get_x()*t,l=this.get_x()*i,_=this.get_y()*t,h=this.get_y()*i,u=this.get_z()*i;return new Jn(1-(_+u),o-r,l+s,0,o+r,1-(a+u),h-n,0,l-s,h+n,1-(a+_),0,0,0,0,1)},get:function(e){return this.values[e]},set:function(e,t){this.values[e]=t},get_x:function(){return this.values[0]},set_x:function(e){return this.values[0]=e},get_y:function(){return this.values[1]},set_y:function(e){return this.values[1]=e},get_z:function(){return this.values[2]},set_z:function(e){return this.values[2]=e},get_w:function(){return this.values[3]},set_w:function(e){return this.values[3]=e},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z()+this.get_w()*this.get_w())},set_length:function(e){if(0==this.get_length())return 0;var t=e/this.get_length();this.set_x(this.get_x()*t);this.set_y(this.get_y()*t);return this.set_z(this.get_z()*t),e},addVector:function(e){var t=new $n(this.get_x(),this.get_y(),this.get_z(),this.get_w()),i=new $n(0,e.x,e.y,e.z);i=i.mult(t);var n=t;n.set_x(n.get_x()+.5*i.get_x());var s=t;s.set_y(s.get_y()+.5*i.get_y());var r=t;r.set_z(r.get_z()+.5*i.get_z());var a=t;return a.set_w(a.get_w()+.5*i.get_w()),t},add:function(e){return new $n(this.get_x()+e.get_x(),this.get_y()+e.get_y(),this.get_z()+e.get_z(),this.get_w()+e.get_w())},sub:function(e){return new $n(this.get_x()-e.get_x(),this.get_y()-e.get_y(),this.get_z()-e.get_z(),this.get_w()-e.get_w())},mult:function(e){var t=new $n;return t.set_x(this.get_w()*e.get_x()+this.get_x()*e.get_w()+this.get_y()*e.get_z()-this.get_z()*e.get_y()),t.set_y(this.get_w()*e.get_y()-this.get_x()*e.get_z()+this.get_y()*e.get_w()+this.get_z()*e.get_x()),t.set_z(this.get_w()*e.get_z()+this.get_x()*e.get_y()-this.get_y()*e.get_x()+this.get_z()*e.get_w()),t.set_w(this.get_w()*e.get_w()-this.get_x()*e.get_x()-this.get_y()*e.get_y()-this.get_z()*e.get_z()),t},normalize:function(){this.scale(1/this.get_length())},dot:function(e){return this.get_x()*e.get_x()+this.get_y()*e.get_y()+this.get_z()*e.get_z()+this.get_w()*e.get_w()},getEulerAngles:function(e,t,i,n,s){null==s&&(s=1),null==n&&(n=1);var r=new ts,a=[];a[0]=this.get_x(),a[1]=this.get_y(),a[2]=this.get_z();var o=this.get_w()*this.get_w(),l=a[e]*a[e],_=a[t]*a[t],h=a[i]*a[i],u=-1,c=Math.PI/2;(e+1)%3==t&&(t+1)%3==i&&(u=1);var d=2*u*(u*this.get_w()*a[t]+a[e]*a[i]);return d<1e-7-1?(r.x=0,r.y=-n*s*c,r.z=n*s*Math.atan2(2*(u*a[e]*a[t]+this.get_w()*a[i]),o+_-l-h)):1-1e-7<d?(r.x=0,r.y=n*s*c,r.z=n*s*Math.atan2(2*(u*a[e]*a[t]+this.get_w()*a[i]),o+_-l-h)):(r.x=-n*s*Math.atan2(-2*(this.get_w()*a[e]-u*a[t]*a[i]),o+h-l-_),r.y=n*s*Math.asin(d),r.z=n*s*Math.atan2(2*(this.get_w()*a[i]-u*a[e]*a[t]),o+l-_-h)),r},__class__:$n,__properties__:{set_length:"set_length",get_length:"get_length",set_w:"set_w",get_w:"get_w",set_z:"set_z",get_z:"get_z",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var es=function(e){this.index=0,this.MT=[],this.MT[623]=0,this.MT[0]=e;for(var t=1;t<624;){var i=t++;this.MT[i]=1812433253*(this.MT[i-1]^this.MT[i-1]>>30)+i}};(i["kha.math.Random"]=es).__name__=!0,es.init=function(e){es.Default=new es(e)},es.get=function(){return es.Default.Get()},es.getFloat=function(){return es.Default.GetFloat()},es.getUpTo=function(e){return es.Default.GetUpTo(e)},es.getIn=function(e,t){return es.Default.GetIn(e,t)},es.getFloatIn=function(e,t){return e+es.Default.GetFloat()*(t-e)},es.prototype={Get:function(){0==this.index&&this.GenerateNumbers();var e=this.MT[this.index];return e^=e>>11,e^=e<<7&-1658038656,e^=e<<15&-272236544,e^=e>>18,this.index=(this.index+1)%624,e},GetFloat:function(){return this.Get()/2147483646},GetUpTo:function(e){return this.Get()%(e+1)},GetIn:function(e,t){return this.Get()%(t+1-e)+e},GetFloatIn:function(e,t){return e+this.GetFloat()*(t-e)},MT:null,index:null,GenerateNumbers:function(){for(var e=0;e<624;){var t=e++,i=(1&this.MT[t])+this.MT[(t+1)%624]&2147483647;this.MT[t]=this.MT[(t+397)%624]^i>>1,i%2!=0&&(this.MT[t]^=-1727483681)}},__class__:es};var ts=function(e,t,i){null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i};(i["kha.math.Vector3"]=ts).__name__=!0,ts.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,e},__class__:ts,__properties__:{set_length:"set_length",get_length:"get_length"}};var is=function(e,t,i,n){null==n&&(n=1),null==i&&(i=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=i,this.w=n};(i["kha.math.Vector4"]=is).__name__=!0,is.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=this.get_length();if(0==t)return 0;var i=e/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,e},__class__:is,__properties__:{set_length:"set_length",get_length:"get_length"}};var ns=function(){};(i["kha.network.Client"]=ns).__name__=!0,ns.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:ns,__properties__:{get_id:"get_id"}};var ss=function(){};(i["kha.network.ControllerBuilder"]=ss).__name__=!0;var rs=function(){};(i["kha.network.Entity"]=rs).__name__=!0,rs.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:rs};var as=function(e){this.myId=e};(i["kha.network.LocalClient"]=as).__name__=!0,as.__interfaces__=[ns],as.prototype={myId:null,send:function(e,t){},receive:function(e){},onClose:function(e){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:as,__properties__:{get_id:"get_id",get_controllers:"get_controllers"}};var os=function(e,t,i,n){this.open=!1;var s=this;this.socket=new WebSocket("ws://"+e+":"+t),this.socket.onerror=function(e){Re.trace("Network error.",{fileName:"Network.hx",lineNumber:14,className:"kha.network.Network",methodName:"new"}),i()},this.socket.binaryType="arraybuffer",this.socket.onopen=function(){s.open=!0},this.socket.onclose=function(e){Re.trace("Network connection closed. "+os.webSocketCloseReason(e.code)+" ("+e.reason+").",{fileName:"Network.hx",lineNumber:22,className:"kha.network.Network",methodName:"new"}),n()}};(i["kha.network.Network"]=os).__name__=!0,os.webSocketCloseReason=function(e){switch(e){case 1e3:return"Normal Closure";case 1001:return"Going Away";case 1002:return"Protocol error";case 1003:return"Unsupported Data";case 1005:return"No Status Rcvd";case 1006:return"Abnormal Closure";case 1007:return"Invalid frame";case 1008:return"Policy Violation";case 1009:return"Message Too Big";case 1010:return"Mandatory Ext.";case 1011:return"Internal Server Error";case 1015:return"TLS handshake";default:return""}},os.prototype={socket:null,open:null,send:function(e,t){this.open&&this.socket.send(e.b.bufferValue)},listen:function(i){this.socket.onmessage=function(e){var t=Fe.ofData(e.data);i(t)}},__class__:os};var ls=function(e,t){this.time=e,this.data=t};(i["kha.network.State"]=ls).__name__=!0,ls.prototype={time:null,data:null,__class__:ls};var _s=function(e,t,i){this.ping=1,this.currentPlayers=0,this.controllers=new Ge,this.entities=new Ge,(_s.instance=this).maxPlayers=e,this.address=t,this.port=i};(i["kha.network.Session"]=_s).__name__=!0,_s.the=function(){return _s.instance},_s.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(e){var t=this.entities,i=e._id();t.h[i]=e},addController:function(e){Re.trace("Adding controller id "+e._id(),{fileName:"Session.hx",lineNumber:88,className:"kha.network.Session",methodName:"addController"}),e._inputBufferIndex=0;var t=this.controllers,i=e._id();t.h[i]=e},sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var i=new Fe(new Es(this.controllers.h[e]._inputBufferIndex+4+t.length));i.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=i}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},sendPing:function(){var e=new Fe(new Es(5));e.b[0]=4,e.setFloat(1,L.realTime()),this.sendToServer(e)},sendPlayerUpdate:function(){},receive:function(e,t){switch(e.b[0]){case 0:var i=e.b[1];this.localClient=new as(i),L.resetTime(),this.startCallback();break;case 1:for(var n=e.getDouble(1),s=9,r=this.entities.iterator();r.hasNext();){var a=r.next();a._receive(s,e),s+=a._size()}L.warp(n);break;case 3:switch(e.b[1]){case 0:break;case 1:this.executeRPC(e)}break;case 4:var o=e.getFloat(1);this.ping=L.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=e.getInt32(1)}},executeRPC:function(e){var t=[],i=e.getInt32(2),n=6,s=e.getUInt16(n);n+=2;for(var r="",a=0,o=s;a<o;){a++;r+=String.fromCharCode(e.b[n]),++n}var l=e.getUInt16(n);n+=2;for(var _="",h=0,u=l;h<u;){h++;_+=String.fromCharCode(e.b[n]),++n}for(;n<e.length;){var c=e.b[n];switch(++n,c){case 66:var d=1==e.b[n];++n,Re.trace("Bool: "+(null==d?"null":""+d),{fileName:"Session.hx",lineNumber:295,className:"kha.network.Session",methodName:"executeRPC"}),t.push(d);break;case 70:var f=e.getDouble(n);n+=8,Re.trace("Float: "+f,{fileName:"Session.hx",lineNumber:300,className:"kha.network.Session",methodName:"executeRPC"}),t.push(f);break;case 73:var g=e.getInt32(n);n+=4,Re.trace("Int: "+g,{fileName:"Session.hx",lineNumber:305,className:"kha.network.Session",methodName:"executeRPC"}),t.push(g);break;case 83:var m=e.getUInt16(n);n+=2;for(var p="",v=0,y=m;v<y;){v++;p+=String.fromCharCode(e.b[n]),++n}Re.trace("String: "+p,{fileName:"Session.hx",lineNumber:315,className:"kha.network.Session",methodName:"executeRPC"}),t.push(p);break;default:Re.trace("Unknown argument type.",{fileName:"Session.hx",lineNumber:318,className:"kha.network.Session",methodName:"executeRPC"})}}if(-1==i)K.field(te.resolveClass(r),_+"_remotely").apply(null,t);else{var b=hs.objects[i];K.field(hs.objects[i],_+"_remotely").apply(b,t)}},waitForStart:function(e,t,i,n,s){var r=this;this.startCallback=e,this.refusedCallback=t,this.resetCallback=s,this.network=new os(this.address,this.port,i,function(){n(),r.reset()}),this.network.listen(function(e){r.receive(e)}),this.updateTaskId=L.addFrameTask(Ts(this,this.update),0),this.ping=1,this.pingTaskId=L.addTimeTask(Ts(this,this.sendPing),0,1)},reset:function(){L.removeFrameTask(this.updateTaskId),L.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new Ge,this.entities=new Ge,this.resetCallback()},update:function(){for(var e=this.controllers.iterator();e.hasNext();){var t=e.next();if(0<t._inputBufferIndex){var i=new Fe(new Es(22+t._inputBufferIndex));i.b[0]=2,i.setInt32(1,t._id()),i.setDouble(5,L.time()),i.setInt32(13,M.windowWidth(0)),i.setInt32(17,M.windowHeight(0));var n=M.get_screenRotation()[1];i.b[21]=255&n,i.blit(22,t._inputBuffer,0,t._inputBufferIndex),this.sendToServer(i),t._inputBufferIndex=0}}},sendToServer:function(e){this.network.send(e,!1)},__class__:_s,__properties__:{get_me:"get_me"}};var hs=function(){};(i["kha.network.SyncBuilder"]=hs).__name__=!0;var us=function(e,t,i,n){this._0=e,this._1=t,this._2=i,this._3=n};(i["kha.simd.Float32x4"]=us).__name__=!0,us.create=function(){return new us(0,0,0,0)},us.loadAllFast=function(e){return new us(e,e,e,e)},us.load=function(e,t,i,n){return new us(e,t,i,n)},us.loadFast=function(e,t,i,n){return new us(e,t,i,n)},us.get=function(e,t){var i=0;switch(t){case 0:i=e._0;break;case 1:i=e._1;break;case 2:i=e._2;break;case 3:i=e._3}return i},us.getFast=function(e,t){switch(t){case 0:return e._0;case 1:return e._1;case 2:return e._2;case 3:return e._3}return 0},us.abs=function(e){return new us(Math.abs(e._0),Math.abs(e._1),Math.abs(e._2),Math.abs(e._3))},us.add=function(e,t){return new us(e._0+t._0,e._1+t._1,e._2+t._2,e._3+t._3)},us.div=function(e,t){return new us(e._0/t._0,e._1/t._1,e._2/t._2,e._3/t._3)},us.mul=function(e,t){return new us(e._0*t._0,e._1*t._1,e._2*t._2,e._3*t._3)},us.neg=function(e){return new us(-e._0,-e._1,-e._2,-e._3)},us.reciprocalApproximation=function(e){return new us(0,0,0,0)},us.reciprocalSqrtApproximation=function(e){return new us(0,0,0,0)},us.sub=function(e,t){return new us(e._0-t._0,e._1-t._1,e._2-t._2,e._3-t._3)},us.sqrt=function(e){return new us(Math.sqrt(e._0),Math.sqrt(e._1),Math.sqrt(e._2),Math.sqrt(e._3))},us.prototype={_0:null,_1:null,_2:null,_3:null,__class__:us};var cs=function(){this.Orientation=new $n,this.Position=new ts};(i["kha.vr.Pose"]=cs).__name__=!0,cs.prototype={Orientation:null,Position:null,__class__:cs};var ds=function(){};(i["kha.vr.PoseState"]=ds).__name__=!0,ds.prototype={Pose:null,AngularVelocity:null,LinearVelocity:null,AngularAcceleration:null,LinearAcceleration:null,TimeInSeconds:null,__class__:ds};var fs=function(){};(i["kha.vr.SensorState"]=fs).__name__=!0,fs.prototype={Predicted:null,Recorded:null,Temperature:null,Status:null,__class__:fs};var gs=function(){};(i["kha.vr.TimeWarpImage"]=gs).__name__=!0,gs.prototype={Image:null,TexCoordsFromTanAngles:null,Pose:null,__class__:gs};var ms=function(){};(i["kha.vr.TimeWarpParms"]=ms).__name__=!0,ms.prototype={LeftImage:null,RightImage:null,LeftOverlay:null,RightOverlay:null,__class__:ms};var ps=i["scenes.GameState"]={__ename__:!0,__constructs__:["Playing","End"]};ps.Playing=["Playing",0],ps.Playing.toString=n,(ps.Playing.__enum__=ps).End=["End",1],ps.End.toString=n,ps.End.__enum__=ps;var vs=function(){this.score=0,this.state=ps.Playing,A.call(this)};(i["scenes.GameScene"]=vs).__name__=!0,vs.create=function(){var e=vs.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},vs.getPool=function(){return vs.__pool__},vs.__super__=A,vs.prototype=s(A.prototype,{state:null,score:null,_hud:null,_scoreEntity:null,_spawnTimer:null,init:function(){var e=R.buffer.get_width(),t=R.buffer.get_height(),i=le.__pool__.get();i.init(0,0,e,t),i.isAlreadyDestroyed=!1;var n=i,s=ve.__pool__.get();s.init(),s.isAlreadyDestroyed=!1,this.addSystem(s);var r=pe.__pool__.get();r.init(),r.isAlreadyDestroyed=!1,this.addSystem(r);var a=ye.__pool__.get();a.init(),a.isAlreadyDestroyed=!1,this.addSystem(a);var o=n.x,l=n.y,_=n.width,h=n.height,u=le.__pool__.get();u.init(o,l,_,h),u.isAlreadyDestroyed=!1;var c=ws.__pool__.get();c.init(u),c.isAlreadyDestroyed=!1,this.addSystem(c);var d=n.x,f=n.y,g=n.width,m=n.height,p=le.__pool__.get();p.init(d,f,g,m),p.isAlreadyDestroyed=!1;var v=bs.__pool__.get();v.init(p),v.isAlreadyDestroyed=!1,this.addSystem(v);var y=xs.__pool__.get();y.init(),y.isAlreadyDestroyed=!1,this.addSystem(y),this.state=ps.Playing,this.score=0,this._createHUD(),this._createPlayer(),this._initSpawner(),ae.onPressed.handlers.push(Ts(this,this._onPressed))},_initSpawner:function(){var t=this,e=this.timerManager,i=es.getFloatIn(1,3),n=be.__pool__.get();n.init(i,0,!0,0,e),n.isAlreadyDestroyed=!1,this._spawnTimer=n,this._spawnTimer.onRepeat.handlers.push(function(e){t.state==ps.Playing&&(t._spawnTimer.time=es.getFloatIn(1,3),t._spawnEnemy())}),this._spawnTimer.start()},_spawnEnemy:function(){var t=this;if(this.state==ps.Playing){var i=this.createEntity(),e=m.__pool__.get();e.isAlreadyDestroyed=!1,i.addComponent(e);var n=oe.__pool__.get();n.init(0,250),n.isAlreadyDestroyed=!1;var s=ie.__pool__.get();s.init(n,null,null),s.isAlreadyDestroyed=!1,i.addComponent(s);var r=Q.__pool__.get();r.init("enemyShip.png"),r.isAlreadyDestroyed=!1,i.addComponent(r);var a=H.__pool__.get();a.init(null,null),a.isAlreadyDestroyed=!1,i.addComponent(a).onCollidingWith.handlers.push(function(e){t._destroyShip(i),t._setScore(t.score+1),e.destroy()}),i._tags.set("enemy",!0),i.transform.get_position().set(es.getIn(0|i.transform.get_size()._x,R.buffer.get_width()-i.transform.get_size()._x|0),-i.transform.get_size()._y*i.transform.get_anchor()._y+1)}},_createPlayer:function(){var t=this;if(this.state==ps.Playing){var i=this.createEntity();i.transform.get_position().set(R.centerX,R.centerY);var e=B.__pool__.get();e.init(37,39,38,40,400),e.isAlreadyDestroyed=!1,i.addComponent(e);var n=v.__pool__.get();n.init(90,720,.25),n.isAlreadyDestroyed=!1,i.addComponent(n);var s=oe.__pool__.get();s.init(0,0),s.isAlreadyDestroyed=!1;var r=ie.__pool__.get();r.init(s,null,null),r.isAlreadyDestroyed=!1,i.addComponent(r);var a=Q.__pool__.get();a.init("playerShip.png"),a.isAlreadyDestroyed=!1,i.addComponent(a);var o=H.__pool__.get();o.init(["enemy"],null),o.isAlreadyDestroyed=!1,i.addComponent(o).onCollidingWith.handlers.push(function(e){t._destroyShip(i,!0),t._destroyShip(e),t._gameOver()}),i._tags.set("player",!0)}},_destroyShip:function(t,e){null==e&&(e=!1),t.removeAllComponents(!0);var i=j.__pool__.get();i.init(),i.isAlreadyDestroyed=!1;var n=t.addComponent(i);n._add(Y.createFromAssets("smoke",.5,["smokeOrange0.png","smokeOrange1.png","smokeOrange2.png","smokeOrange3.png"],!0)),n.onEnd.handlers.push(function(e){"smoke"==e&&t.destroy()}),n.play("smoke"),this._explosionSound(e)},_explosionSound:function(e){null==e&&(e=!1);var t=b.__pool__.get();t.init(e?"playerExplosion.wav":"enemyExplosion.wav"),t.isAlreadyDestroyed=!1;var i=t;i.destroyOnEnd=!0,i.play()},_onPressed:function(e){this.state==ps.End&&90==e&&this._restart()},_restart:function(){$.remove(ae.onPressed.handlers,Ts(this,this._onPressed)),d.world.changeScene(vs.create(),!0)},_gameOver:function(){if(this.state==ps.Playing){this.state=ps.End,this._spawnTimer.stop(),this._spawnTimer.destroy();var e=this.createEntity();e.transform.set_parent(this._hud.transform),e.transform.get_localPosition().set(this._hud.transform.get_size()._x/2,100);var t=J.__pool__.get();t.init("GAME OVER","kenpixel_mini_square.ttf",80,"center"),t.isAlreadyDestroyed=!1,e.addComponent(t);var i=this.createEntity();i.transform.set_parent(this._hud.transform),i.transform.get_localPosition().set(this._hud.transform.get_size()._x/2,this._hud.transform.get_size()._y-100);var n=J.__pool__.get();n.init("Press 'Z' to restart","kenpixel_mini_square.ttf",30,"center"),n.isAlreadyDestroyed=!1,i.addComponent(n)}},_setScore:function(e){this.state==ps.Playing&&(this.score=e,this._scoreEntity._components.h[W.fromComponent(J).__componentName__].set_text("score: "+this.score))},_createHUD:function(){this._hud=this.createEntity(),this._hud.transform.get_size().set(R.buffer.get_width(),R.buffer.get_height()),this._hud.transform.get_position().set(R.centerX,R.centerY),this._hud.transform.set_fixedToCamera(!0);var e=this._hud,t=Z.__pool__.get();t.isAlreadyDestroyed=!1,e.addComponent(t),this._scoreEntity=this.createEntity(),this._scoreEntity.transform.get_anchor().set(0,0),this._scoreEntity.transform.get_localPosition().set(10,10);var i=this._scoreEntity,n="score: "+this.score,s=J.__pool__.get();s.init(n,"kenpixel_mini_square.ttf",20,"left"),s.isAlreadyDestroyed=!1,i.addComponent(s),this._scoreEntity.transform.set_parent(this._hud.transform)},beforeDestroy:function(){A.prototype.beforeDestroy.call(this),this._hud=null,this._scoreEntity=null,this._spawnTimer=null},get___typeName__:function(){return"scenes.GameScene"},get___type__:function(){return vs},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),vs.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),vs.__pool__.safePut(this))},__class__:vs});var ys=function(){A.call(this)};(i["scenes.MainScene"]=ys).__name__=!0,ys.create=function(){var e=ys.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},ys.getPool=function(){return ys.__pool__},ys.__super__=A,ys.prototype=s(A.prototype,{init:function(){var e=ve.__pool__.get();e.init(),e.isAlreadyDestroyed=!1,this.addSystem(e),this._createText("KHA SHMUP",R.centerX,100,80),this._createText("Arrow keys to move, 'Z' key to shoot.\nPress 'Z' to start.",R.centerX,R.buffer.get_height()-120,30,"center"),ae.onPressed.handlers.push(Ts(this,this._onPressed))},_onPressed:function(e){if(90==e){$.remove(ae.onPressed.handlers,Ts(this,this._onPressed));var t=d.world,i=vs.__pool__.get();i.init(),i.isAlreadyDestroyed=!1,t.changeScene(i,!0)}},_createText:function(e,t,i,n,s){null==s&&(s="left");var r=this.createEntity();r.transform.get_position().set(t,i);var a=J.__pool__.get();a.init(e,"kenpixel_mini_square.ttf",n,s),a.isAlreadyDestroyed=!1,r.addComponent(a)},get___typeName__:function(){return"scenes.MainScene"},get___type__:function(){return ys},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ys.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ys.__pool__.safePut(this))},__class__:ys});var bs=function(){ge.call(this)};(i["systems.OutBoundsSystem"]=bs).__name__=!0,bs.__interfaces__=[p],bs.create=function(e){var t=bs.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},bs.getPool=function(){return bs.__pool__},bs.__super__=ge,bs.prototype=s(ge.prototype,{bounds:null,init:function(e){this.filter.all([m]),this.bounds=e},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];if(++t,n.enabled){var s,r,a,o=n.transform,l=o.get_position()._y-o.get_scale()._y*o.get_size()._y*o.get_anchor()._y,_=this.bounds;if(l>_.y+_.height)a=!0;else{var h=n.transform;a=h.get_position()._y+h.get_scale()._y*h.get_size()._y*(1-h.get_anchor()._y)<this.bounds.y}if(a)r=!0;else{var u=n.transform,c=u.get_position()._x-u.get_scale()._x*u.get_size()._x*u.get_anchor()._x,d=this.bounds;r=c>d.x+d.width}if(r)s=!0;else{var f=n.transform;s=f.get_position()._x+f.get_scale()._x*f.get_size()._x*(1-f.get_anchor()._x)<this.bounds.x}s&&n.destroy()}}},beforeDestroy:function(){ge.prototype.beforeDestroy.call(this),this.bounds.destroy(),this.bounds=null},get___typeName__:function(){return"systems.OutBoundsSystem"},get___type__:function(){return bs},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),bs.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),bs.__pool__.safePut(this))},__class__:bs});var ws=function(){ge.call(this)};(i["systems.PlayerSystem"]=ws).__name__=!0,ws.__interfaces__=[p],ws.create=function(e){var t=ws.__pool__.get();return t.init(e),t.isAlreadyDestroyed=!1,t},ws.getPool=function(){return ws.__pool__},ws.__super__=ge,ws.prototype=s(ge.prototype,{bounds:null,init:function(e){this.filter.all([B,ie]),this.bounds=e},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];if(++t,n.enabled){var s=n._components.h[W.fromComponent(B).__componentName__],r=n._components.h[W.fromComponent(ie).__componentName__];ae.isDown(s.left)?r.speed.set_x(-s.speed):ae.isDown(s.right)?r.speed.set_x(s.speed):r.speed.set_x(0),ae.isDown(s.up)?r.speed.set_y(-s.speed):ae.isDown(s.down)?r.speed.set_y(s.speed):r.speed.set_y(0);var a=n.transform;if(a.get_position()._x-a.get_scale()._x*a.get_size()._x*a.get_anchor()._x<this.bounds.x){var o=n.transform.get_position(),l=n.transform;o.set_x(this.bounds.x+l.get_scale()._x*l.get_size()._x*n.transform.get_anchor()._x)}else{var _=n.transform,h=_.get_position()._x+_.get_scale()._x*_.get_size()._x*(1-_.get_anchor()._x),u=this.bounds;if(h>u.x+u.width){var c=n.transform.get_position(),d=this.bounds,f=n.transform;c.set_x(d.x+d.width-f.get_scale()._x*f.get_size()._x*n.transform.get_anchor()._x)}}var g=n.transform;if(g.get_position()._y-g.get_scale()._y*g.get_size()._y*g.get_anchor()._y<this.bounds.y){var m=n.transform.get_position(),p=n.transform;m.set_y(this.bounds.y+p.get_scale()._y*p.get_size()._y*n.transform.get_anchor()._y)}else{var v=n.transform,y=v.get_position()._y+v.get_scale()._y*v.get_size()._y*(1-v.get_anchor()._y),b=this.bounds;if(y>b.y+b.height){var w=n.transform.get_position(),x=this.bounds,S=n.transform;w.set_y(x.y+x.height-S.get_scale()._y*S.get_size()._y*n.transform.get_anchor()._y)}}}}},beforeDestroy:function(){ge.prototype.beforeDestroy.call(this),this.bounds.destroy(),this.bounds=null},get___typeName__:function(){return"systems.PlayerSystem"},get___type__:function(){return ws},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),ws.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),ws.__pool__.safePut(this))},__class__:ws});var xs=function(){ge.call(this)};(i["systems.ShootSystem"]=xs).__name__=!0,xs.__interfaces__=[p],xs.create=function(){var e=xs.__pool__.get();return e.init(),e.isAlreadyDestroyed=!1,e},xs.getPool=function(){return xs.__pool__},xs.__super__=ge,xs.prototype=s(ge.prototype,{init:function(){this.filter.equal(v)},update:function(e){for(var t=0,i=this._entitiesList;t<i.length;){var n=i[t];if(++t,n.enabled){var s=n._components.h[W.fromComponent(v).__componentName__];if(s.update(e),ae.isDown(s.key)&&s._time<=0){s._time=s.delay;var r=n.transform,a=r.get_position()._x-r.get_scale()._x*r.get_size()._x*r.get_anchor()._x,o=n.transform,l=a+o.get_scale()._x*o.get_size()._x/2,_=n.transform;this.shoot(l,_.get_position()._y-_.get_scale()._y*_.get_size()._y*_.get_anchor()._y,-s.speed)}}}},shoot:function(e,t,i){if(null!=this._scene){var n=this._scene.createEntity(),s=Q.__pool__.get();s.init("bullet.png"),s.isAlreadyDestroyed=!1,n.addComponent(s);var r=oe.__pool__.get();r.init(0,i),r.isAlreadyDestroyed=!1;var a=ie.__pool__.get();a.init(r,null,null),a.isAlreadyDestroyed=!1,n.addComponent(a);var o=H.__pool__.get();o.init(null,null),o.isAlreadyDestroyed=!1,n.addComponent(o);var l=m.__pool__.get();l.isAlreadyDestroyed=!1,n.addComponent(l),n.transform.get_anchor().set(.5,1),n.transform.get_position().set(e,t),n._tags.set("shot",!0);var _=b.__pool__.get();_.init("bulletShoot.wav"),_.isAlreadyDestroyed=!1;var h=_;h.destroyOnEnd=!0,h.play()}},get___typeName__:function(){return"systems.ShootSystem"},get___type__:function(){return xs},destroy:function(){if(!this.isAlreadyDestroyed){if(!this.__flagToDestroy__)return this.__flagToDestroy__=!0,void d._destroyCallbacks.push(Ts(this,this.destroy));this.isAlreadyDestroyed=!0,this.beforeDestroy(),xs.__pool__.safePut(this),this.__flagToDestroy__=!1}},destroyInmediate:function(){this.isAlreadyDestroyed||(this.isAlreadyDestroyed=!0,this.beforeDestroy(),xs.__pool__.safePut(this))},__class__:xs});var Ss,Bs=0;function Ts(e,t){return null==t?null:(null==t.__id__&&(t.__id__=Bs++),null==e.hx__closures__?e.hx__closures__={}:i=e.hx__closures__[t.__id__],null==i&&((i=function(){return i.method.apply(i.scope,arguments)}).scope=e,i.method=t,e.hx__closures__[t.__id__]=i),i);var i}i.Math=Math,String.prototype.__class__=i.String=String,String.__name__=!0,i.Array=Array,Array.__name__=!0,Date.prototype.__class__=i.Date=Date,Date.__name__=["Date"];var ks=i.Int={__name__:["Int"]},Is=i.Dynamic={__name__:["Dynamic"]},As=i.Float=Number;As.__name__=["Float"];var Ds=i.Bool=Boolean;Ds.__ename__=["Bool"];var Cs=i.Class={__name__:["Class"]},Ps={},Ns={},Es=t.ArrayBuffer||$e;null==Es.prototype.slice&&(Es.prototype.slice=$e.sliceImpl);var Rs,Ls=t.DataView||et,Ms=t.Float32Array||tt._new,Fs=t.Uint8Array||it._new;c._emptyArgs=[],d.isIniaited=!1,d.onSystemUpdate={handlers:[]},d.onUpdate={handlers:[]},d.onDraw={handlers:[]},d.onStart={handlers:[]},d.onStop={handlers:[]},d.onWindowResize={handlers:[]},d.isRunning=!1,d.isProcessing=!1,d._updateTaskId=-1,d._countUniqueID=0,d._dirtyWindowResize=!1,d._onKhaInitCallbacks=[],d._destroyCallbacks=[],d.gameTitle="Gecko2D-KhaShmup",d.Flags=(Rs=new Ii,null!=Ns[""]?Rs.setReserved("",""):Rs.h[""]="",Rs),f.__pool__=new c(f,{amount:1}),g.__pool__=new c(g,{amount:1}),g.__componentTypes__=[],g.__componentName__="gecko.components.Component",m.__componentTypes__=[],m.__componentName__="components.OutBoundsComponent",m.__pool__=new c(m,{amount:1}),B.__componentTypes__=[],B.__componentName__="components.PlayerComponent",B.__pool__=new c(B,{amount:1}),v.__componentTypes__=[],v.__componentName__="components.ShootComponent",v.__pool__=new c(v,{amount:1}),y.images=new Ii,y.videos=new Ii,y.blobs=new Ii,y.sounds=new Ii,y.fonts=new Ii,y.textures=new Ii,y.json=new Ii,y._imageExtensions=["hdr","jpg","png"],y._soundExtensions=["wav"],y._fontExtensions=["ttf"],y._videoExtensions=["mp4"],b.__pool__=new c(b,{amount:1}),w.__pool__=new c(w,{amount:1}),S.AliceBlue=15792383,S.AntiqueWhite=16444375,S.Aqua=65535,S.Aquamarine=8388564,S.Azure=15794175,S.Beige=16119260,S.Bisque=16770244,S.Black=0,S.BlanchedAlmond=16772045,S.Blue=255,S.BlueViolet=9055202,S.Brown=10824234,S.BurlyWood=14596231,S.CadetBlue=6266528,S.Chartreuse=8388352,S.Chocolate=13789470,S.Coral=16744272,S.CornflowerBlue=6591981,S.Cornsilk=16775388,S.Crimson=14423100,S.Cyan=65535,S.DarkBlue=139,S.DarkCyan=35723,S.DarkGoldenRod=12092939,S.DarkGray=11119017,S.DarkGrey=11119017,S.DarkGreen=25600,S.DarkKhaki=12433259,S.DarkMagenta=9109643,S.DarkOliveGreen=5597999,S.DarkOrange=16747520,S.DarkOrchid=10040012,S.DarkRed=9109504,S.DarkSalmon=15308410,S.DarkSeaGreen=9419919,S.DarkSlateBlue=4734347,S.DarkSlateGray=3100495,S.DarkSlateGrey=3100495,S.DarkTurquoise=52945,S.DarkViolet=9699539,S.DeepPink=16716947,S.DeepSkyBlue=49151,S.DimGray=6908265,S.DimGrey=6908265,S.DodgerBlue=2003199,S.FireBrick=11674146,S.FloralWhite=16775920,S.ForestGreen=2263842,S.Fuchsia=16711935,S.Gainsboro=14474460,S.GhostWhite=16316671,S.Gold=16766720,S.GoldenRod=14329120,S.Gray=8421504,S.Grey=8421504,S.Green=32768,S.GreenYellow=11403055,S.HoneyDew=15794160,S.HotPink=16738740,S.IndianRed=13458524,S.Indigo=4915330,S.Ivory=16777200,S.Khaki=15787660,S.Lavender=15132410,S.LavenderBlush=16773365,S.LawnGreen=8190976,S.LemonChiffon=16775885,S.LightBlue=11393254,S.LightCoral=15761536,S.LightCyan=14745599,S.LightGoldenRodYellow=16448210,S.LightGray=13882323,S.LightGrey=13882323,S.LightGreen=9498256,S.LightPink=16758465,S.LightSalmon=16752762,S.LightSeaGreen=2142890,S.LightSkyBlue=8900346,S.LightSlateGray=7833753,S.LightSlateGrey=7833753,S.LightSteelBlue=11584734,S.LightYellow=16777184,S.Lime=65280,S.LimeGreen=3329330,S.Linen=16445670,S.Magenta=16711935,S.Maroon=8388608,S.MediumAquaMarine=6737322,S.MediumBlue=205,S.MediumOrchid=12211667,S.MediumPurple=9662683,S.MediumSeaGreen=3978097,S.MediumSlateBlue=8087790,S.MediumSpringGreen=64154,S.MediumTurquoise=4772300,S.MediumVioletRed=13047173,S.MidnightBlue=1644912,S.MintCream=16121850,S.MistyRose=16770273,S.Moccasin=16770229,S.NavajoWhite=16768685,S.Navy=128,S.OldLace=16643558,S.Olive=8421376,S.OliveDrab=7048739,S.Orange=16753920,S.OrangeRed=16729344,S.Orchid=14315734,S.PaleGoldenRod=15657130,S.PaleGreen=10025880,S.PaleTurquoise=11529966,S.PaleVioletRed=14381203,S.PapayaWhip=16773077,S.PeachPuff=16767673,S.Peru=13468991,S.Pink=16761035,S.Plum=14524637,S.PowderBlue=11591910,S.Purple=8388736,S.RebeccaPurple=6697881,S.Red=16711680,S.RosyBrown=12357519,S.RoyalBlue=4286945,S.SaddleBrown=9127187,S.Salmon=16416882,S.SandyBrown=16032864,S.SeaGreen=3050327,S.SeaShell=16774638,S.Sienna=10506797,S.Silver=12632256,S.SkyBlue=8900331,S.SlateBlue=6970061,S.SlateGray=7372944,S.SlateGrey=7372944,S.Snow=16775930,S.SpringGreen=65407,S.SteelBlue=4620980,S.Tan=13808780,S.Teal=32896,S.Thistle=14204888,S.Tomato=16737095,S.Turquoise=4251856,S.Violet=15631086,S.Wheat=16113331,S.White=16777215,S.WhiteSmoke=16119285,S.Yellow=16776960,S.YellowGreen=10145074,S.invMaxChannelValue=.00392156862745098,T.__pool__=new c(T,{amount:1}),D.width=3,D.height=3,k.emptyMatrix=new D(1,0,0,0,1,0,0,0,1),A.__pool__=new c(A,{amount:1}),R._initiated=!1,R.Anchor=C,R._mode=E.None,R.matrix=new D(1,0,0,0,1,0,0,0,1),R._scale=new P(1,1),R._position=new P(0,0),R._size=new P(0,0),R._anchor=new P(.5,.5),R.windowWidth=0,R.windowHeight=0,R.centerX=0,R.centerY=0,L.timeWarpSaveTime=10,L.DIF_COUNT=3,L.maxframetime=.5,L.startTime=0,M.renderListeners=[],M.foregroundListeners=[],M.resumeListeners=[],M.pauseListeners=[],M.backgroundListeners=[],M.shutdownListeners=[],M.dropFilesListeners=[],F.mobile=!1,F.ios=!1,F.mobileAudioPlaying=!1,F.chrome=!1,F.firefox=!1,F.ie=!1,F.insideInputEvent=!1,F.maxGamepads=4,F.leftMouseCtrlDown=!1,F.minimumScroll=999,F.lastFirstTouchX=0,F.lastFirstTouchY=0,F.iosSoundEnabled=!1,F.iosTouchs=[],V._initTime=L.realTime(),V.scale=1,V.fixedTime=0,V.fixedUnscaledDelta=0,V.fixedUnscaledTime=0,V.time=0,V.unscaledDelta=0,V.unscaledTime=0,V._lastFixedNow=0,V._lastNow=0,G.isDepthEnabled=!1,H.__componentTypes__=[],H.__componentName__="gecko.components.collision.aabb.HitBoxComponent",H.__pool__=new c(H,{amount:1}),Z.__componentTypes__=[],Z.__componentName__="gecko.components.draw.DrawComponent",Z.__pool__=new c(Z,{amount:1}),j.__pool__=new c(j,{amount:1}),j.__componentTypes__=[],j.__componentName__="gecko.components.draw.AnimationComponent",Y.__pool__=new c(Y,{amount:1}),q.__pool__=new c(q,{amount:1}),q.__componentTypes__=[],q.__componentName__="gecko.components.draw.ProgressBarComponent",Q.__pool__=new c(Q,{amount:1}),Q.__componentTypes__=[],Q.__componentName__="gecko.components.draw.SpriteComponent",J.__pool__=new c(J,{amount:1}),J.__componentTypes__=[],J.__componentName__="gecko.components.draw.TextComponent",ie.__componentTypes__=[],ie.__componentName__="gecko.components.motion.MovementComponent",ie.__pool__=new c(ie,{amount:1}),ne.__componentTypes__=[],ne.__componentName__="gecko.components.motion.RotationComponent",ne.__pool__=new c(ne,{amount:1}),se.__pool__=new c(se,{amount:1}),re.__pool__=new c(re,{amount:1}),ae._instance=new ae,ae.isEnabled=!1,ae._pressedKeys=new Ge,ae._releasedKeys=new Ge,ae._downKeys=new Ge,ae._hotKeys=new Ge,ae._combos=new Ii,ae.keyList=function(e){var t=new Ii,i=Ai.__cast(0,ks);null!=Ns.unknown?t.setReserved("unknown",i):t.h.unknown=i;var n=Ai.__cast(1,ks);null!=Ns.back?t.setReserved("back",n):t.h.back=n;var s=Ai.__cast(3,ks);null!=Ns.cancel?t.setReserved("cancel",s):t.h.cancel=s;var r=Ai.__cast(6,ks);null!=Ns.help?t.setReserved("help",r):t.h.help=r;var a=Ai.__cast(8,ks);null!=Ns.backspace?t.setReserved("backspace",a):t.h.backspace=a;var o=Ai.__cast(9,ks);null!=Ns.tab?t.setReserved("tab",o):t.h.tab=o;var l=Ai.__cast(12,ks);null!=Ns.clear?t.setReserved("clear",l):t.h.clear=l;var _=Ai.__cast(13,ks);null!=Ns.return?t.setReserved("return",_):t.h.return=_;var h=Ai.__cast(16,ks);null!=Ns.shift?t.setReserved("shift",h):t.h.shift=h;var u=Ai.__cast(17,ks);null!=Ns.control?t.setReserved("control",u):t.h.control=u;var c=Ai.__cast(18,ks);null!=Ns.alt?t.setReserved("alt",c):t.h.alt=c;var d=Ai.__cast(19,ks);null!=Ns.pause?t.setReserved("pause",d):t.h.pause=d;var f=Ai.__cast(20,ks);null!=Ns.capslock?t.setReserved("capslock",f):t.h.capslock=f;var g=Ai.__cast(21,ks);null!=Ns.kana?t.setReserved("kana",g):t.h.kana=g;var m=Ai.__cast(21,ks);null!=Ns.hangul?t.setReserved("hangul",m):t.h.hangul=m;var p=Ai.__cast(22,ks);null!=Ns.eisu?t.setReserved("eisu",p):t.h.eisu=p;var v=Ai.__cast(23,ks);null!=Ns.junja?t.setReserved("junja",v):t.h.junja=v;var y=Ai.__cast(24,ks);null!=Ns.final?t.setReserved("final",y):t.h.final=y;var b=Ai.__cast(25,ks);null!=Ns.hanja?t.setReserved("hanja",b):t.h.hanja=b;var w=Ai.__cast(25,ks);null!=Ns.kanji?t.setReserved("kanji",w):t.h.kanji=w;var x=Ai.__cast(27,ks);null!=Ns.escape?t.setReserved("escape",x):t.h.escape=x;var S=Ai.__cast(28,ks);null!=Ns.convert?t.setReserved("convert",S):t.h.convert=S;var B=Ai.__cast(29,ks);null!=Ns.nonconvert?t.setReserved("nonconvert",B):t.h.nonconvert=B;var T=Ai.__cast(30,ks);null!=Ns.accept?t.setReserved("accept",T):t.h.accept=T;var k=Ai.__cast(31,ks);null!=Ns.modechange?t.setReserved("modechange",k):t.h.modechange=k;var I=Ai.__cast(32,ks);null!=Ns.space?t.setReserved("space",I):t.h.space=I;var A=Ai.__cast(33,ks);null!=Ns.pageup?t.setReserved("pageup",A):t.h.pageup=A;var D=Ai.__cast(34,ks);null!=Ns.pagedown?t.setReserved("pagedown",D):t.h.pagedown=D;var C=Ai.__cast(35,ks);null!=Ns.end?t.setReserved("end",C):t.h.end=C;var P=Ai.__cast(36,ks);null!=Ns.home?t.setReserved("home",P):t.h.home=P;var N=Ai.__cast(37,ks);null!=Ns.left?t.setReserved("left",N):t.h.left=N;var E=Ai.__cast(38,ks);null!=Ns.up?t.setReserved("up",E):t.h.up=E;var R=Ai.__cast(39,ks);null!=Ns.right?t.setReserved("right",R):t.h.right=R;var L=Ai.__cast(40,ks);null!=Ns.down?t.setReserved("down",L):t.h.down=L;var M=Ai.__cast(41,ks);null!=Ns.select?t.setReserved("select",M):t.h.select=M;var F=Ai.__cast(42,ks);null!=Ns.print?t.setReserved("print",F):t.h.print=F;var V=Ai.__cast(43,ks);null!=Ns.execute?t.setReserved("execute",V):t.h.execute=V;var O=Ai.__cast(44,ks);null!=Ns.printscreen?t.setReserved("printscreen",O):t.h.printscreen=O;var G=Ai.__cast(45,ks);null!=Ns.insert?t.setReserved("insert",G):t.h.insert=G;var U=Ai.__cast(46,ks);null!=Ns.delete?t.setReserved("delete",U):t.h.delete=U;var W=Ai.__cast(48,ks);null!=Ns.zero?t.setReserved("zero",W):t.h.zero=W;var z=Ai.__cast(49,ks);null!=Ns.one?t.setReserved("one",z):t.h.one=z;var H=Ai.__cast(50,ks);null!=Ns.two?t.setReserved("two",H):t.h.two=H;var Z=Ai.__cast(51,ks);null!=Ns.three?t.setReserved("three",Z):t.h.three=Z;var j=Ai.__cast(52,ks);null!=Ns.four?t.setReserved("four",j):t.h.four=j;var K=Ai.__cast(53,ks);null!=Ns.five?t.setReserved("five",K):t.h.five=K;var X=Ai.__cast(54,ks);null!=Ns.six?t.setReserved("six",X):t.h.six=X;var Y=Ai.__cast(55,ks);null!=Ns.seven?t.setReserved("seven",Y):t.h.seven=Y;var q=Ai.__cast(56,ks);null!=Ns.eight?t.setReserved("eight",q):t.h.eight=q;var Q=Ai.__cast(57,ks);null!=Ns.nine?t.setReserved("nine",Q):t.h.nine=Q;var J=Ai.__cast(58,ks);null!=Ns.colon?t.setReserved("colon",J):t.h.colon=J;var $=Ai.__cast(59,ks);null!=Ns.semicolon?t.setReserved("semicolon",$):t.h.semicolon=$;var ee=Ai.__cast(60,ks);null!=Ns.lessthan?t.setReserved("lessthan",ee):t.h.lessthan=ee;var te=Ai.__cast(61,ks);null!=Ns.equals?t.setReserved("equals",te):t.h.equals=te;var ie=Ai.__cast(62,ks);null!=Ns.greaterthan?t.setReserved("greaterthan",ie):t.h.greaterthan=ie;var ne=Ai.__cast(63,ks);null!=Ns.questionmark?t.setReserved("questionmark",ne):t.h.questionmark=ne;var se=Ai.__cast(64,ks);null!=Ns.at?t.setReserved("at",se):t.h.at=se;var re=Ai.__cast(65,ks);null!=Ns.a?t.setReserved("a",re):t.h.a=re;var ae=Ai.__cast(66,ks);null!=Ns.b?t.setReserved("b",ae):t.h.b=ae;var oe=Ai.__cast(67,ks);null!=Ns.c?t.setReserved("c",oe):t.h.c=oe;var le=Ai.__cast(68,ks);null!=Ns.d?t.setReserved("d",le):t.h.d=le;var _e=Ai.__cast(69,ks);null!=Ns.e?t.setReserved("e",_e):t.h.e=_e;var he=Ai.__cast(70,ks);null!=Ns.f?t.setReserved("f",he):t.h.f=he;var ue=Ai.__cast(71,ks);null!=Ns.g?t.setReserved("g",ue):t.h.g=ue;var ce=Ai.__cast(72,ks);null!=Ns.h?t.setReserved("h",ce):t.h.h=ce;var de=Ai.__cast(73,ks);null!=Ns.i?t.setReserved("i",de):t.h.i=de;var fe=Ai.__cast(74,ks);null!=Ns.j?t.setReserved("j",fe):t.h.j=fe;var ge=Ai.__cast(75,ks);null!=Ns.k?t.setReserved("k",ge):t.h.k=ge;var me=Ai.__cast(76,ks);null!=Ns.l?t.setReserved("l",me):t.h.l=me;var pe=Ai.__cast(77,ks);null!=Ns.m?t.setReserved("m",pe):t.h.m=pe;var ve=Ai.__cast(78,ks);null!=Ns.n?t.setReserved("n",ve):t.h.n=ve;var ye=Ai.__cast(79,ks);null!=Ns.o?t.setReserved("o",ye):t.h.o=ye;var be=Ai.__cast(80,ks);null!=Ns.p?t.setReserved("p",be):t.h.p=be;var we=Ai.__cast(81,ks);null!=Ns.q?t.setReserved("q",we):t.h.q=we;var xe=Ai.__cast(82,ks);null!=Ns.r?t.setReserved("r",xe):t.h.r=xe;var Se=Ai.__cast(83,ks);null!=Ns.s?t.setReserved("s",Se):t.h.s=Se;var Be=Ai.__cast(84,ks);null!=Ns.t?t.setReserved("t",Be):t.h.t=Be;var Te=Ai.__cast(85,ks);null!=Ns.u?t.setReserved("u",Te):t.h.u=Te;var ke=Ai.__cast(86,ks);null!=Ns.v?t.setReserved("v",ke):t.h.v=ke;var Ie=Ai.__cast(87,ks);null!=Ns.w?t.setReserved("w",Ie):t.h.w=Ie;var Ae=Ai.__cast(88,ks);null!=Ns.x?t.setReserved("x",Ae):t.h.x=Ae;var De=Ai.__cast(89,ks);null!=Ns.y?t.setReserved("y",De):t.h.y=De;var Ce=Ai.__cast(90,ks);null!=Ns.z?t.setReserved("z",Ce):t.h.z=Ce;var Pe=Ai.__cast(91,ks);null!=Ns.win?t.setReserved("win",Pe):t.h.win=Pe;var Ne=Ai.__cast(93,ks);null!=Ns.contextmenu?t.setReserved("contextmenu",Ne):t.h.contextmenu=Ne;var Ee=Ai.__cast(95,ks);null!=Ns.sleep?t.setReserved("sleep",Ee):t.h.sleep=Ee;var Re=Ai.__cast(96,ks);null!=Ns.numpad0?t.setReserved("numpad0",Re):t.h.numpad0=Re;var Le=Ai.__cast(97,ks);null!=Ns.numpad1?t.setReserved("numpad1",Le):t.h.numpad1=Le;var Me=Ai.__cast(98,ks);null!=Ns.numpad2?t.setReserved("numpad2",Me):t.h.numpad2=Me;var Fe=Ai.__cast(99,ks);null!=Ns.numpad3?t.setReserved("numpad3",Fe):t.h.numpad3=Fe;var Ve=Ai.__cast(100,ks);null!=Ns.numpad4?t.setReserved("numpad4",Ve):t.h.numpad4=Ve;var Oe=Ai.__cast(101,ks);null!=Ns.numpad5?t.setReserved("numpad5",Oe):t.h.numpad5=Oe;var Ge=Ai.__cast(102,ks);null!=Ns.numpad6?t.setReserved("numpad6",Ge):t.h.numpad6=Ge;var Ue=Ai.__cast(103,ks);null!=Ns.numpad7?t.setReserved("numpad7",Ue):t.h.numpad7=Ue;var We=Ai.__cast(104,ks);null!=Ns.numpad8?t.setReserved("numpad8",We):t.h.numpad8=We;var ze=Ai.__cast(105,ks);null!=Ns.numpad9?t.setReserved("numpad9",ze):t.h.numpad9=ze;var He=Ai.__cast(106,ks);null!=Ns.multiply?t.setReserved("multiply",He):t.h.multiply=He;var Ze=Ai.__cast(107,ks);null!=Ns.add?t.setReserved("add",Ze):t.h.add=Ze;var je=Ai.__cast(108,ks);null!=Ns.separator?t.setReserved("separator",je):t.h.separator=je;var Ke=Ai.__cast(109,ks);null!=Ns.subtract?t.setReserved("subtract",Ke):t.h.subtract=Ke;var Xe=Ai.__cast(110,ks);null!=Ns.decimal?t.setReserved("decimal",Xe):t.h.decimal=Xe;var Ye=Ai.__cast(111,ks);null!=Ns.divide?t.setReserved("divide",Ye):t.h.divide=Ye;var qe=Ai.__cast(112,ks);null!=Ns.f1?t.setReserved("f1",qe):t.h.f1=qe;var Qe=Ai.__cast(113,ks);null!=Ns.f2?t.setReserved("f2",Qe):t.h.f2=Qe;var Je=Ai.__cast(114,ks);null!=Ns.f3?t.setReserved("f3",Je):t.h.f3=Je;var $e=Ai.__cast(115,ks);null!=Ns.f4?t.setReserved("f4",$e):t.h.f4=$e;var et=Ai.__cast(116,ks);null!=Ns.f5?t.setReserved("f5",et):t.h.f5=et;var tt=Ai.__cast(117,ks);null!=Ns.f6?t.setReserved("f6",tt):t.h.f6=tt;var it=Ai.__cast(118,ks);null!=Ns.f7?t.setReserved("f7",it):t.h.f7=it;var nt=Ai.__cast(119,ks);null!=Ns.f8?t.setReserved("f8",nt):t.h.f8=nt;var st=Ai.__cast(120,ks);null!=Ns.f9?t.setReserved("f9",st):t.h.f9=st;var rt=Ai.__cast(121,ks);null!=Ns.f10?t.setReserved("f10",rt):t.h.f10=rt;var at=Ai.__cast(122,ks);null!=Ns.f11?t.setReserved("f11",at):t.h.f11=at;var ot=Ai.__cast(123,ks);null!=Ns.f12?t.setReserved("f12",ot):t.h.f12=ot;var lt=Ai.__cast(124,ks);null!=Ns.f13?t.setReserved("f13",lt):t.h.f13=lt;var _t=Ai.__cast(125,ks);null!=Ns.f14?t.setReserved("f14",_t):t.h.f14=_t;var ht=Ai.__cast(126,ks);null!=Ns.f15?t.setReserved("f15",ht):t.h.f15=ht;var ut=Ai.__cast(127,ks);null!=Ns.f16?t.setReserved("f16",ut):t.h.f16=ut;var ct=Ai.__cast(128,ks);null!=Ns.f17?t.setReserved("f17",ct):t.h.f17=ct;var dt=Ai.__cast(129,ks);null!=Ns.f18?t.setReserved("f18",dt):t.h.f18=dt;var ft=Ai.__cast(130,ks);null!=Ns.f19?t.setReserved("f19",ft):t.h.f19=ft;var gt=Ai.__cast(131,ks);null!=Ns.f20?t.setReserved("f20",gt):t.h.f20=gt;var mt=Ai.__cast(132,ks);null!=Ns.f21?t.setReserved("f21",mt):t.h.f21=mt;var pt=Ai.__cast(133,ks);null!=Ns.f22?t.setReserved("f22",pt):t.h.f22=pt;var vt=Ai.__cast(134,ks);null!=Ns.f23?t.setReserved("f23",vt):t.h.f23=vt;var yt=Ai.__cast(135,ks);null!=Ns.f24?t.setReserved("f24",yt):t.h.f24=yt;var bt=Ai.__cast(144,ks);null!=Ns.numlock?t.setReserved("numlock",bt):t.h.numlock=bt;var wt=Ai.__cast(145,ks);null!=Ns.scrolllock?t.setReserved("scrolllock",wt):t.h.scrolllock=wt;var xt=Ai.__cast(146,ks);null!=Ns.winoemfjjisho?t.setReserved("winoemfjjisho",xt):t.h.winoemfjjisho=xt;var St=Ai.__cast(147,ks);null!=Ns.winoemfjmasshou?t.setReserved("winoemfjmasshou",St):t.h.winoemfjmasshou=St;var Bt=Ai.__cast(148,ks);null!=Ns.winoemfjtouroku?t.setReserved("winoemfjtouroku",Bt):t.h.winoemfjtouroku=Bt;var Tt=Ai.__cast(149,ks);null!=Ns.winoemfjloya?t.setReserved("winoemfjloya",Tt):t.h.winoemfjloya=Tt;var kt=Ai.__cast(150,ks);null!=Ns.winoemfjroya?t.setReserved("winoemfjroya",kt):t.h.winoemfjroya=kt;var It=Ai.__cast(160,ks);null!=Ns.circumflex?t.setReserved("circumflex",It):t.h.circumflex=It;var At=Ai.__cast(161,ks);null!=Ns.exclamation?t.setReserved("exclamation",At):t.h.exclamation=At;var Dt=Ai.__cast(162,ks);null!=Ns.doublequote?t.setReserved("doublequote",Dt):t.h.doublequote=Dt;var Ct=Ai.__cast(163,ks);null!=Ns.hash?t.setReserved("hash",Ct):t.h.hash=Ct;var Pt=Ai.__cast(164,ks);null!=Ns.dollar?t.setReserved("dollar",Pt):t.h.dollar=Pt;var Nt=Ai.__cast(165,ks);null!=Ns.percent?t.setReserved("percent",Nt):t.h.percent=Nt;var Et=Ai.__cast(166,ks);null!=Ns.ampersand?t.setReserved("ampersand",Et):t.h.ampersand=Et;var Rt=Ai.__cast(167,ks);null!=Ns.underscore?t.setReserved("underscore",Rt):t.h.underscore=Rt;var Lt=Ai.__cast(168,ks);null!=Ns.openparen?t.setReserved("openparen",Lt):t.h.openparen=Lt;var Mt=Ai.__cast(169,ks);null!=Ns.closeparen?t.setReserved("closeparen",Mt):t.h.closeparen=Mt;var Ft=Ai.__cast(170,ks);null!=Ns.asterisk?t.setReserved("asterisk",Ft):t.h.asterisk=Ft;var Vt=Ai.__cast(171,ks);null!=Ns.plus?t.setReserved("plus",Vt):t.h.plus=Vt;var Ot=Ai.__cast(172,ks);null!=Ns.pipe?t.setReserved("pipe",Ot):t.h.pipe=Ot;var Gt=Ai.__cast(173,ks);null!=Ns.hyphenminus?t.setReserved("hyphenminus",Gt):t.h.hyphenminus=Gt;var Ut=Ai.__cast(174,ks);null!=Ns.opencurlybracket?t.setReserved("opencurlybracket",Ut):t.h.opencurlybracket=Ut;var Wt=Ai.__cast(175,ks);null!=Ns.closecurlybracket?t.setReserved("closecurlybracket",Wt):t.h.closecurlybracket=Wt;var zt=Ai.__cast(176,ks);null!=Ns.tilde?t.setReserved("tilde",zt):t.h.tilde=zt;var Ht=Ai.__cast(181,ks);null!=Ns.volumemute?t.setReserved("volumemute",Ht):t.h.volumemute=Ht;var Zt=Ai.__cast(182,ks);null!=Ns.volumedown?t.setReserved("volumedown",Zt):t.h.volumedown=Zt;var jt=Ai.__cast(183,ks);null!=Ns.volumeup?t.setReserved("volumeup",jt):t.h.volumeup=jt;var Kt=Ai.__cast(188,ks);null!=Ns.comma?t.setReserved("comma",Kt):t.h.comma=Kt;var Xt=Ai.__cast(190,ks);null!=Ns.period?t.setReserved("period",Xt):t.h.period=Xt;var Yt=Ai.__cast(191,ks);null!=Ns.slash?t.setReserved("slash",Yt):t.h.slash=Yt;var qt=Ai.__cast(192,ks);null!=Ns.backquote?t.setReserved("backquote",qt):t.h.backquote=qt;var Qt=Ai.__cast(219,ks);null!=Ns.openbracket?t.setReserved("openbracket",Qt):t.h.openbracket=Qt;var Jt=Ai.__cast(220,ks);null!=Ns.backslash?t.setReserved("backslash",Jt):t.h.backslash=Jt;var $t=Ai.__cast(221,ks);null!=Ns.closebracket?t.setReserved("closebracket",$t):t.h.closebracket=$t;var ei=Ai.__cast(222,ks);null!=Ns.quote?t.setReserved("quote",ei):t.h.quote=ei;var ti=Ai.__cast(224,ks);null!=Ns.meta?t.setReserved("meta",ti):t.h.meta=ti;var ii=Ai.__cast(225,ks);null!=Ns.altgr?t.setReserved("altgr",ii):t.h.altgr=ii;var ni=Ai.__cast(227,ks);null!=Ns.winicohelp?t.setReserved("winicohelp",ni):t.h.winicohelp=ni;var si=Ai.__cast(228,ks);null!=Ns.winico00?t.setReserved("winico00",si):t.h.winico00=si;var ri=Ai.__cast(230,ks);null!=Ns.winicoclear?t.setReserved("winicoclear",ri):t.h.winicoclear=ri;var ai=Ai.__cast(233,ks);null!=Ns.winoemreset?t.setReserved("winoemreset",ai):t.h.winoemreset=ai;var oi=Ai.__cast(234,ks);null!=Ns.winoemjump?t.setReserved("winoemjump",oi):t.h.winoemjump=oi;var li=Ai.__cast(235,ks);null!=Ns.winoempa1?t.setReserved("winoempa1",li):t.h.winoempa1=li;var _i=Ai.__cast(236,ks);null!=Ns.winoempa2?t.setReserved("winoempa2",_i):t.h.winoempa2=_i;var hi=Ai.__cast(237,ks);null!=Ns.winoempa3?t.setReserved("winoempa3",hi):t.h.winoempa3=hi;var ui=Ai.__cast(238,ks);null!=Ns.winoemwsctrl?t.setReserved("winoemwsctrl",ui):t.h.winoemwsctrl=ui;var ci=Ai.__cast(239,ks);null!=Ns.winoemcusel?t.setReserved("winoemcusel",ci):t.h.winoemcusel=ci;var di=Ai.__cast(240,ks);null!=Ns.winoemattn?t.setReserved("winoemattn",di):t.h.winoemattn=di;var fi=Ai.__cast(241,ks);null!=Ns.winoemfinish?t.setReserved("winoemfinish",fi):t.h.winoemfinish=fi;var gi=Ai.__cast(242,ks);null!=Ns.winoemcopy?t.setReserved("winoemcopy",gi):t.h.winoemcopy=gi;var mi=Ai.__cast(243,ks);null!=Ns.winoemauto?t.setReserved("winoemauto",mi):t.h.winoemauto=mi;var pi=Ai.__cast(244,ks);null!=Ns.winoemenlw?t.setReserved("winoemenlw",pi):t.h.winoemenlw=pi;var vi=Ai.__cast(245,ks);null!=Ns.winoembacktab?t.setReserved("winoembacktab",vi):t.h.winoembacktab=vi;var yi=Ai.__cast(246,ks);null!=Ns.attn?t.setReserved("attn",yi):t.h.attn=yi;var bi=Ai.__cast(247,ks);null!=Ns.crsel?t.setReserved("crsel",bi):t.h.crsel=bi;var wi=Ai.__cast(248,ks);null!=Ns.exsel?t.setReserved("exsel",wi):t.h.exsel=wi;var xi=Ai.__cast(249,ks);null!=Ns.ereof?t.setReserved("ereof",xi):t.h.ereof=xi;var Si=Ai.__cast(250,ks);null!=Ns.play?t.setReserved("play",Si):t.h.play=Si;var Bi=Ai.__cast(251,ks);null!=Ns.zoom?t.setReserved("zoom",Bi):t.h.zoom=Bi;var Ti=Ai.__cast(253,ks);null!=Ns.pa1?t.setReserved("pa1",Ti):t.h.pa1=Ti;var ki=Ai.__cast(254,ks);return null!=Ns.winoemclear?t.setReserved("winoemclear",ki):t.h.winoemclear=ki,t}(),oe.__pool__=new c(oe,{amount:1}),le.__pool__=new c(le,{amount:1}),ce.Add=ce.Create(ue.BlendOne,ue.BlendOne),ce.Multiply=ce.Create(ue.DestinationColor,ue.InverseSourceAlpha),ce.Screen=ce.Create(ue.BlendOne,ue.InverseSourceColor),ce.Subtract=ce.Create(ue.BlendZero,ue.InverseSourceColor),ce.Lighten=ce.Create(ue.BlendOne,ue.BlendOne,he.Max),ge.__pool__=new c(ge,{amount:1}),ge.__systemName__="gecko.systems.System",pe.__systemName__="gecko.systems.collision.aabb.AABBSystem",pe.__pool__=new c(pe,{amount:1}),ve.__systemName__="gecko.systems.draw.DrawSystem",ve.__pool__=new c(ve,{amount:1}),ye.__systemName__="gecko.systems.motion.MotionSystem",ye.__pool__=new c(ye,{amount:1}),be.__pool__=new c(be,{amount:1}),we.__pool__=new c(we,{amount:1}),xe.__pool__=new c(xe,{amount:1}),Be.__pool__=new c(Be,{amount:1}),Te.__pool__=new c(Te,{amount:1}),ke.__pool__=new c(ke,{amount:1}),Pe._deg2rad=Math.PI/180,Pe._rad2deg=180/Math.PI,Me.DEFAULT_RESOLVER=new Le,Me.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Ve.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve.BYTES=Fe.ofString(Ve.CHARS),Ue.count=0,qe.i64tmp=new Ee(0,0),Ai.__toStr={}.toString,tt.BYTES_PER_ELEMENT=4,it.BYTES_PER_ELEMENT=1,_t.images=new st,_t.sounds=new rt,_t.blobs=new at,_t.fonts=new ot,_t.videos=new lt,gt.Black=-16777216,gt.White=-1,gt.Red=-65536,gt.Blue=-16776961,gt.Green=-16711936,gt.Magenta=-65281,gt.Yellow=-256,gt.Cyan=-16711681,gt.Purple=-8388480,gt.Pink=-16181,gt.Orange=-23296,gt.Transparent=0,gt.invMaxChannelValue=.00392156862745098,mt.js="1",mt.kha_a1="1",mt.kha_g3="1",mt.kha_html5_js="1",mt["source-header"]="Generated by Haxe 3.4.4",mt.jquery_ver="11204",mt.kha_js="1",mt.sys_html5="1",mt.sys_g4="1",mt.sys_g2="1",mt.kha_webgl="1",mt.kha="1",mt.kha_g2="1",mt["/Users/nazarigonzalez/Gecko2D/Sources"]="1",mt.kha_g4="1",mt.sys_g3="1",mt.kha_g1="1",mt.sys_a1="1",mt.game_name="Gecko2D-KhaShmup",mt.haxe_ver="3.404",mt.canvas_id="kanvas",mt.kha_version="1611",mt.js_es="5",mt.kha_html5="1",mt["js-es5"]="1",mt.js_es5="1",mt.sys_a2="1",mt.dce="std",mt.sys_g1="1",mt.true="1",mt.haxe3="1",mt.kha_a2="1",mt.script_name="game",vt.Default=new vt(!1,!1,!1),At.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",At.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",At.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",At.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",At.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",At.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",At.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",At.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",At.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",At.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",At.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",At.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",At.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",At.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",At.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Nt.GL_RGBA16F=34842,Nt.GL_RGBA32F=34836,Nt.GL_R16F=33325,Nt.GL_R32F=33326,Nt.GL_RED=6403,Nt.GL_DEPTH_COMPONENT24=33190,Nt.GL_DEPTH24_STENCIL8=35056,Nt.GL_DEPTH32F_STENCIL8=36013,zt.channelCount=16,Kt.POLY=79764919,Qt.INVALID_BITS=-1,ei.EOP=-1,ei.M__PI=3.141592653589793,ei.DIVTAB_NUMER=32,ei.DIVTAB_DENOM=64,ei.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],ti.NO_CODE=255,ti.delay=0,ai.PACKET_ID=1,ai.PACKET_COMMENT=3,ai.PACKET_SETUP=5,ci.CONTINUED_PACKET=1,ci.FIRST_PAGE=2,ci.LAST_PAGE=4,pi.MAX_CHANNELS=16,pi.PUSHDATA_CRC_COUNT=4,pi.FAST_HUFFMAN_LENGTH=10,pi.FAST_HUFFMAN_TABLE_SIZE=1024,pi.FAST_HUFFMAN_TABLE_MASK=1023,yi._glyphs=function(e){for(var t=[],i=32;i<256;){var n=i++;t.push(n)}return t}(),zi.STBTT_vmove=1,zi.STBTT_vline=2,zi.STBTT_vcurve=3,zi.STBTT_MACSTYLE_DONTCARE=0,zi.STBTT_MACSTYLE_BOLD=1,zi.STBTT_MACSTYLE_ITALIC=2,zi.STBTT_MACSTYLE_UNDERSCORE=4,zi.STBTT_MACSTYLE_NONE=8,zi.STBTT_PLATFORM_ID_UNICODE=0,zi.STBTT_PLATFORM_ID_MAC=1,zi.STBTT_PLATFORM_ID_ISO=2,zi.STBTT_PLATFORM_ID_MICROSOFT=3,zi.STBTT_UNICODE_EID_UNICODE_1_0=0,zi.STBTT_UNICODE_EID_UNICODE_1_1=1,zi.STBTT_UNICODE_EID_ISO_10646=2,zi.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,zi.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,zi.STBTT_MS_EID_SYMBOL=0,zi.STBTT_MS_EID_UNICODE_BMP=1,zi.STBTT_MS_EID_SHIFTJIS=2,zi.STBTT_MS_EID_UNICODE_FULL=10,zi.STBTT_MAC_EID_ROMAN=0,zi.STBTT_MAC_EID_ARABIC=4,zi.STBTT_MAC_EID_JAPANESE=1,zi.STBTT_MAC_EID_HEBREW=5,zi.STBTT_MAC_EID_CHINESE_TRAD=2,zi.STBTT_MAC_EID_GREEK=6,zi.STBTT_MAC_EID_KOREAN=3,zi.STBTT_MAC_EID_RUSSIAN=7,zi.STBTT_MS_LANG_ENGLISH=1033,zi.STBTT_MS_LANG_ITALIAN=1040,zi.STBTT_MS_LANG_CHINESE=2052,zi.STBTT_MS_LANG_JAPANESE=1041,zi.STBTT_MS_LANG_DUTCH=1043,zi.STBTT_MS_LANG_KOREAN=1042,zi.STBTT_MS_LANG_FRENCH=1036,zi.STBTT_MS_LANG_RUSSIAN=1049,zi.STBTT_MS_LANG_GERMAN=1031,zi.STBTT_MS_LANG_SPANISH=1033,zi.STBTT_MS_LANG_HEBREW=1037,zi.STBTT_MS_LANG_SWEDISH=1053,zi.STBTT_MAC_LANG_ENGLISH=0,zi.STBTT_MAC_LANG_JAPANESE=11,zi.STBTT_MAC_LANG_ARABIC=12,zi.STBTT_MAC_LANG_KOREAN=23,zi.STBTT_MAC_LANG_DUTCH=4,zi.STBTT_MAC_LANG_RUSSIAN=32,zi.STBTT_MAC_LANG_FRENCH=1,zi.STBTT_MAC_LANG_SPANISH=6,zi.STBTT_MAC_LANG_GERMAN=2,zi.STBTT_MAC_LANG_SWEDISH=5,zi.STBTT_MAC_LANG_HEBREW=10,zi.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,zi.STBTT_MAC_LANG_ITALIAN=3,zi.STBTT_MAC_LANG_CHINESE_TRAD=19,zi.STBTT_MAX_OVERSAMPLE=8,zi.STBTT_RASTERIZER_VERSION=2,ji.GL_RGBA16F=34842,ji.GL_RGBA32F=34836,ji.GL_R16F=33325,ji.GL_R32F=33326,ji.GL_DEPTH_COMPONENT24=33190,ji.GL_DEPTH24_STENCIL8=35056,ji.GL_DEPTH32F_STENCIL8=36013,Qi.bufferSize=1500,Qi.vertexSize=9,Ji.bufferSize=100,Ji.triangleBufferSize=100,$i.bufferSize=100,bn.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},bn.instances=[],bn.connectListeners=[],bn.disconnectListeners=[],xn.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Sn.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},In.bufferSize=2e3,An.radiancePattern=new r("#\\?RADIANCE","i"),An.commentPattern=new r("#.*","i"),An.gammaPattern=new r("GAMMA=","i"),An.exposurePattern=new r("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),An.formatPattern=new r("FORMAT=32-bit_rle_rgbe","i"),An.widthHeightPattern=new r("-Y ([0-9]+) \\+X ([0-9]+)","i"),Dn.todo=[],Vn.loading=[],Kn.width=4,Kn.height=4,Qn.width=3,Qn.height=3,Jn.width=4,Jn.height=4,$n.AXIS_X=0,$n.AXIS_Y=1,$n.AXIS_Z=2,ss.nextId=0,_s.START=0,_s.ENTITY_UPDATES=1,_s.CONTROLLER_UPDATES=2,_s.REMOTE_CALL=3,_s.PING=4,_s.SESSION_ERROR=5,_s.PLAYER_UPDATES=6,_s.RPC_SERVER=0,_s.RPC_ALL=1,hs.nextId=0,hs.objects=[],vs.__pool__=new c(vs,{amount:1}),ys.__pool__=new c(ys,{amount:1}),bs.__systemName__="systems.OutBoundsSystem",bs.__pool__=new c(bs,{amount:1}),ws.__systemName__="systems.PlayerSystem",ws.__pool__=new c(ws,{amount:1}),xs.__systemName__="systems.ShootSystem",xs.__pool__=new c(xs,{amount:1}),_.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
